<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>GRAF - Graphic Rendering Architecture Framework</title>
	<style type="text/css">
		iframe {
			border:0px;
			overflow:scroll;
		}
		body {
			margin:0px
		}
		.menu {
			border : 4px outset;
			padding : 10px;
			margin:5px;
			background-color : #ffde49;
		}
		.menu:hover {
			border : 4px inset;
			background-color : white;
		}
		.frame {
			 
   			height: 95%; 
   			overflow: scroll; 
		}
 	</style>
	<link rel="stylesheet" href="lib/jquery/ui/1.12.1/themes/base/jquery-ui.css">
	<script type="text/javascript" src="script/util.js"></script>
	<script type="text/javascript" src="script/strategic.js"></script>
	<script type="text/javascript" src="script/service.js"></script>
	<script type="text/javascript" src="script/process.js"></script>
	<script type="text/javascript" src="script/business.js"></script>
	<script type="text/javascript" src="script/actor.js"></script>
	<script type="text/javascript" src="script/view.js"></script>
	<script type="text/javascript" src="lib/jquery/jquery-3.2.1.min.js"></script>
	<script type="text/javascript" src="lib/jquery/ui/1.12.1/jquery-ui.js"></script>
	<script>
		function displayLogic(){
			hideToolBox();
			$("#logic_toolbox").show();
			clearFrame();
		}
		function displayTechnic(){
			hideToolBox();
			$("#technic_toolbox").show();
			clearFrame();
		}
	</script>
</head>
<body>
<div style="width:10%;height:100%;background-color:#5588EE; float: left;">
	<div style="width:100%;height:100px;text-align:center;color:white;vertical-align:middle;padding-top:10px">
		<div style="font-size:35px">GRAF</div>
		<div style="font-size:14px">Graphic Rendering<br/>Architect Framework</div>
	</div>
	<div class="menu" onclick="displayStrategic(null)">Vue strat&eacute;gique</div>
	<div class="menu" onclick="displayBusiness(null)">Vue métier</div>
	<div class="menu" onclick="displayLogic(null)">Vue logique</div>
	<div class="menu" onclick="displayService(null)">Vue service</div>
	<div class="menu" onclick="displayProcess(null)">Vue processus</div>
	<div class="menu" onclick="displayTechnic(null)">Vue technique</div>
	<div class="menu" onclick="displayViews(null)">Gestion des vues</div>
</div>
<div style="width:90%;height:100%;float:right">
	<table style="width:100%;height:100%;border:0px;border-collapse:collapse">
	<tbody>
		<tr><td>
		<div id="default_toolbox" style="width:100%">
		</div>
		<div id="strategic_toolbox" style="width:100%;display:none" class="controlgroup">
			<button onclick="createDomain()"><img style="height:14px" src="images/78.png"/> domaine</button>
			<label for="strategic_viewprocess">Voir les processus</label>
			<input type="checkbox" name="strategic_viewprocess" id="strategic_viewprocess" onclick="strategic_checkSeeProcess()"/>
		</div>
		<div id="service_toolbox" style="width:100%;display:none" class="controlgroup">
			<button id="service_search_service_button" onclick='$("#search_service_form").dialog({"modal":true,"title":"Chercher un service"})'><img style="height:14px" src="images/65.png"/> chercher un service</button>
			<button id="service_create_device_button" 	title="Importer un matériel" 			onclick="createComponent('device')" 	disabled="true"><img style="height:14px" src="images/1633.png"/> matériel</button>
			<button id="service_create_data_button" 	title="Importer une donnée"				onclick="createComponent('data')" 		disabled="true"><img style="height:14px" src="images/1633.png"/> donnée</button>
			<button id="service_create_software_button" title="Importe un logiciel"				onclick="createComponent('software')" 	disabled="true"><img style="height:14px" src="images/1633.png"/> logiciel</button>
			<button id="service_create_service_button" 	title="Importer un service"				onclick="createComponent('service')" 	disabled="true"><img style="height:14px" src="images/1633.png"/> service</button>
			<button id="service_create_instance_button" title="Créer une instance de ce service" onclick="createServiceInstance()" 		disabled="true"><img style="height:14px" src="images/78.png"/> instance</button>
		</div>
		<div id="process_toolbox" style="width:100%;display:none" class="controlgroup">
			<button id="process_create_step_button" onclick="createStep()" disabled="true"><img style="height:14px" src="images/78.png"/> étape</button>
		</div>
		<div id="business_toolbox" style="width:100%;display:none" class="controlgroup">
			<button id="business_search_domain_button" onclick='$("#search_domain_form").dialog({"modal":true,"title":"Chercher un domain"})'><img style="height:14px" src="images/65.png"/> chercher un domaine</button>
			<button id="business_create_process_button" onclick="createProcess()" disabled="true"><img style="height:14px" src="images/78.png"/> processus</button>
			<button id="business_create_service_button" onclick="createService()" disabled="true"><img style="height:14px" src="images/78.png"/> service</button>
			<button id="business_create_actor_button" onclick="createActor()" disabled="true"><img style="height:14px" src="images/78.png"/> acteur</button>
		</div>
		<div id="technic_toolbox" style="width:100%;vertical-align:middle;display:none" class="controlgroup">
			<label for="transmission-automatic">Automatic</label>
			<input type="checkbox" name="transmission-automatic" id="transmission-automatic"/>
		</div>
		<div id="views_toolbox" style="width:100%;display:none" class="controlgroup">
			<select id="viewSelected">
				<option value="null" selected>--choisir une vue--</option>
			</select>
			<label for="views_fill">Remplir</label>
			<input type="checkbox" name="views_fill" id="views_fill" onclick="views_checkFill()" checked/>
			<button id="views_update_button" onclick="updateView()" disabled="true"><img style="height:14px" src="images/96.png"/> update</button>
	      <!--label for="transmission-standard">Standard</label>
	      <input type="radio" name="transmission" id="transmission-standard">
	      <label for="transmission-automatic">Automatic</label>
     	 <input type="radio" name="transmission" id="transmission-automatic">
      <label for="insurance">Insurance</label>
      <input type="checkbox" name="insurance" id="insurance">
      <label for="horizontal-spinner" class="ui-controlgroup-label"># of cars</label>
      <input id="horizontal-spinner" class="ui-spinner-input">
      <button>Book Now!</button-->
		</div>
		
	</td></tr>
	<tr style="height:100%"><td>
		<object id="frame" type="image/svg+xml" data="" style="width:100%;height:100%"></object>
		<!--img id="frame" src="" style="width:100%;height:100%"-->
		<!--iframe id="frame" style="width:100%;height:100%" scrolling="yes"></iframe-->
	<!--img id="frame" src="views/view_process.php?id=1" style="width:100%;height:100%"/-->
	</td></tr>
	</tbody>
	</table>
</div>
<div id="popup" style="display:none">
</div>
<div id="update_view_form" style="display:none">
	Nom : <input id="update_view_form_name" type="text" disabled="true"/><br/>
	<textarea id="update_view_form_value" style="width:100%;height:80%"></textarea>
	<button onclick='doUpdateView()'><img style="height:14px" src="images/78.png"/> valider</button>
	<button onclick='$("#update_view_form").dialog("close");'><img style="height:14px" src="images/33.png"/> annuler</button>
</div>
<div id="create_actor_form" style="display:none">
	Nom : 		<input type="text" 	id="create_actor_form_name" 		name="name"/><br/>
	<hr/>
	<button onclick='doCreateActor()'><img style="height:14px" src="images/78.png"/> créer</button>
	<button onclick='$("#create_actor_form").dialog("close");'><img style="height:14px" src="images/33.png"/> annuler</button>
</div>
<div id="create_domain_form" style="display:none">
	Nom : 		<input type="text" 	id="create_domain_form_name" 		name="name"/><br/>
	Zone : 		<select id="create_domain_form_area"></select>
	<hr/>
	<button onclick='doCreateDomain()'><img style="height:14px" src="images/78.png"/> cr&eacute;er</button>
	<button onclick='$("#create_domain_form").dialog("close");'><img style="height:14px" src="images/33.png"/> annuler</button>
</div>
<div id="create_component_form" style="display:none">
	<input type="hidden" id="create_component_form_type"/>
	<div id="create_component_form_service">
		<select id="create_component_form_service_list"></select>
	</div>
	<div id="create_component_form_software">
		<select id="create_component_form_software_list"></select>	<button title="Créer un logiciel" onclick="createSoftware()"><img style="height:14px" src="images/78.png"/></button>
	</div>
	<div id="create_component_form_data">
		<select id="create_component_form_data_list"></select>		<button title="Créer une donnée"  onclick="createData()"><img style="height:14px" src="images/78.png"/></button>
	</div>
	<div id="create_component_form_device">
		<select id="create_component_form_device_list"></select>	<button title="Créer un matériel" onclick="createDevice()"><img style="height:14px" src="images/78.png"/></button>
	</div>
	Zone : <select id="create_component_form_area"></select>
	<hr/>
	<button onclick='doCreateComponent()'><img style="height:14px" src="images/78.png"/> ajouter</button>
	<button onclick='$("#create_component_form").dialog("close");'><img style="height:14px" src="images/33.png"/> annuler</button>
</div>
<div id="edit_component_form" style="display:none">
	<p>Composant</p>
	<b>Nom</b> : <input type="text" id="edit_component_form_name" disabled="true"/><br/><br/>
	<b>Zone</b> : <select id="edit_component_form_area"></select><br/><br/>
	<hr/>
	<b>Lié à</b> : <br/>
	<table style="border:1px solid black;width:100%">
		<thead style="background-color:lightgray">
			<tr>
				<th>Composant</th><th>Protocole</th><th>Port</th><th></th>
			</tr>
		</thead>
		<tbody id="edit_component_form_links"></tbody>
	</table>
	<div id="edit_component_form_toggle1" style="width: 100%;text-align: right;">
		<a href="#" onclick="$('#edit_component_form_toggle1').hide();$('#edit_component_form_toggle2').show();">Ajouter un lien</a>
	</div>
	<div id="edit_component_form_toggle2" style="display:none">
	Service : <select id="edit_component_form_service_list"></select><br/>
	Composant : <select id="edit_component_form_component_list"></select><br/>
	Protocole : <input id="edit_component_form_protocole" type='text'/><br/>
	Port : 		<input  id="edit_component_form_port" type='text'/>
	<a href="#" onclick="addComponentLink()">Valider</a>
	<a href="#" onclick="hideAddComponentLinkForm()">Annuler</a>
	</div>
	<hr/>
	<button onclick='$("#edit_component_form").dialog("close");displayComponent(currentComponentId)' id="edit_component_form_ouvrir"><img src='images/63.png'/> ouvrir</button>
	<button onclick='$("#edit_component_form").dialog("close");unlinkComponent(currentComponentId)'><img src='images/14.png'/> retirer</button>
	<button onclick='$("#edit_component_form").dialog("close");' id="edit_component_form_valider" disabled="true"><img src='images/93.png'/> valider</button>
	<button onclick='$("#edit_component_form").dialog("close");'><img src='images/33.png'/> fermer</button>
</div>
<div id="process_create_form" style="display:none">
	Nom : 		<input type="text" 	id="process_create_form_name" 			name="name"/><br/>
	Description : 	<textarea 		id="process_create_form_description" 	name="description"></textarea><br/>
			<input type="hidden" 	id="process_create_form_domain_id" 		name='domain_id' value=""/>
	<hr/>
	<button onclick='doCreateProcess()'><img style="height:14px" src="images/78.png"/> créer</button>
	<button onclick='$("#process_create_form").dialog("close");'><img style="height:14px" src="images/33.png"/> annuler</button>
</div>
<div id="search_domain_form" style="display:none">
	Domaine : <select id="search_domain_form_list"></select>
	<hr/>
	<button onclick='$("#search_domain_form").dialog("close");searchDomain();'><img style="height:14px" src="images/93.png"/> valider</button>
	<button onclick='$("#search_domain_form").dialog("close");'><img style="height:14px" src="images/33.png"/> annuler</button>
</div>
<div id="search_service_form" style="display:none">
	Service : <select id="search_service_form_list"></select>
	<hr/>
	<button onclick='$("#search_service_form").dialog("close");searchService();'><img style="height:14px" src="images/93.png"/> valider</button>
	<button onclick='$("#search_service_form").dialog("close");'><img style="height:14px" src="images/33.png"/> annuler</button>
</div>
<div id="create_service_form" style="display:none">
	Nom : 	<input type="text"		id="create_service_form_name" 		name="name"/><br/>
	Code :	<input type="text"		id="create_service_form_code" 		name="code"/><br/>
			<input type="hidden" 	id="create_service_form_domain_id" 	name='domain_id'/>
	<hr/>
	<button onclick='doCreateService()'><img style="height:14px" src="images/78.png"/> cr&eacute;er</button>
	<button onclick='$("#create_service_form").dialog("close");'><img style="height:14px" src="images/33.png"/> annuler</button>
</div>
<div id="create_instance_form" style="display:none">
	Nom : 			<input type="text"		id="create_instance_form_name" 		name="name"/><br/>
	Environment :	<select id="create_instance_form_environment"/><br/>
			<input type="hidden" 	id="create_instance_form_service_id" 	name='service_id'/>
	<hr/>
	<button onclick='doCreateServiceInstance()'><img style="height:14px" src="images/78.png"/> cr&eacute;er</button>
	<button onclick='$("#create_instance_form").dialog("close");'><img style="height:14px" src="images/33.png"/> annuler</button>
</div>
<!--img id="frame" src="" style="width:90%;height:94%;position:absolute;right:0;bottom:0px"/-->
<!--iframe id="frame" style="width:90%;height:94%;position:absolute;right:0;bottom:0px">
</iframe-->
<script>
	function refreshDomainList(){
		$.getJSON( "api/domain.php", function(result) {
			var domains = result.domains;
			var options = "<option value='null' selected>--choisir un domaine--</option>";
			for (var i = 0; i < domains.length; i++){
				var domain = domains[i];
				options += '<option value="'+domain.id+'">'+domain.name+'</option>';
			}
			$('#search_domain_form_list').html(options);
  		}).fail(function(jxqr,textStatus,error) {
			showPopup("Echec","<h1>Impossible de charger les domaines</h1>"+textStatus+ " : " + error);
		});
	}
	function refreshAreaList(){
		$.getJSON( "api/area.php?view=logique", function(result) {
			var areas = result.areas;
			var options = "";//<option value='null' selected>--choisir une zone--</option>";
			for (var i = 0; i < areas.length; i++){
				var area = areas[i];
				options += '<option value="'+area.id+'">'+area.name+'</option>';
			}
			$('#edit_component_form_area').html(options);
			$('#create_component_form_area').html(options);
  		}).fail(function(jxqr,textStatus,error) {
			showPopup("Echec","<h1>Impossible de charger les zones</h1>"+textStatus+ " : " + error);
		});
	}
	function refreshEnvironmentList(){
		$.getJSON("api/environment.php", function(result){
			var environments = result.environments;
			var options = "<option value='null' selected>--choisir un environement--</option>";
			for (var i = 0; i < environments.length; i++){
				var environment = environments[i];
				options += '<option value="'+environment.id+'">'+environment.name+'</option>';
			}
			$('#create_instance_form_environment').html(options);
		}).fail(function(jxqr,textStatus,error) {
			showPopup("Echec","<h1>Impossible de charger les environnements</h1>"+textStatus+ " : " + error);
		});
	}
	
	$( function() {
	 	$(".controlgroup" ).controlgroup();
		$.getJSON( "api/view.php", function(result) {
			var views = result.views;
			var options = "";
			for (var i = 0; i < views.length; i++){
				var view = views[i];
				options += '<option value="'+view.name+'">'+view.name+'</option>';
			}
			$('#viewSelected').append(options);
  		}).fail(function(jxqr,textStatus,error) {
			showPopup("Echec","<h1>Impossible de charger les vues</h1>"+textStatus+ " : " + error);
		});
		$("#viewSelected").on("selectmenuchange", selectView);
		$("#edit_component_form_service_list").on("change", function(){
			var serviceId = $("#edit_component_form_service_list").val();
			if (serviceId == "null"){
				serviceId = currentServiceId;
			}
			filterComponentList(serviceId);
		});
		refreshDomainList();
		refreshEnvironmentList();
		refreshAreaList();
		refreshServiceList();
	 });
</script>
</body>
</html>