/**
 * Ogma
 * @description Graph visualization library
 * @version 2.2.0 (built on Fri Mar 09 2018 20:09:32 GMT+0100 (CET))
 * @author Linkurious SAS
 * @license (c) Linkurious 2018. All rights reserved.
 * @preserve
 */
(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?module.exports=t():typeof define==="function"&&define.amd?define(t):e.Ogma=t()})(this,function(){"use strict";function e(value){if(this==null){throw new TypeError("this is null or not defined")}var e=Object(this);var t=e.length>>>0;var r=arguments[1];var i=r>>0;var n=i<0?Math.max(t+i,0):Math.min(i,t);var a=arguments[2];var o=a===undefined?t:a>>0;var s=o<0?Math.max(t+o,0):Math.min(o,t);while(n<s){e[n]=value;n++}return e}function t(e,t,r){if(this===null){throw new TypeError("this is null or not defined")}var i=Object(this);var n=i.length>>>0;var a=e>>0;var o=a<0?Math.max(n+a,0):Math.min(a,n);var s=t>>0;var u=s<0?Math.max(n+s,0):Math.min(s,n);var l=r===undefined?n:r>>0;var f=l<0?Math.max(n+l,0):Math.min(l,n);var h=Math.min(f-u,n-o);var d=1;if(u<o&&o<u+h){d=-1;u+=h-1;o+=h-1}while(h>0){if(u in i){i[o]=i[u]}else{delete i[o]}u+=d;o+=d;h--}return i}function r(e){var t,r,i=Object(this),n=i.length>>>0;if(n===0){return-1}t=n-1;if(arguments.length>1){t=Number(arguments[1]);if(t!==t){t=0}else if(t!==0&&t!==1/0&&t!==-(1/0)){t=(t>0||-1)*Math.floor(Math.abs(t))}}for(r=t>=0?Math.min(t,n-1):n-Math.abs(t);r>=0;r--){if(r in i&&i[r]===e){return r}}return-1}if(!Array.from){Array.from=function(){var e=Object.prototype.toString;var t=function(t){return typeof t==="function"||e.call(t)==="[object Function]"};var r=function(value){var e=Number(value);if(isNaN(e)){return 0}if(e===0||!isFinite(e)){return e}return(e>0?1:-1)*Math.floor(Math.abs(e))};var i=Math.pow(2,53)-1;var n=function(value){var e=r(value);return Math.min(Math.max(e,0),i)};return function e(r){var i=this;var a=Object(r);if(r==null){throw new TypeError("Array.from requires an array-like object - not null or undefined")}var o=arguments.length>1?arguments[1]:void undefined;var s;if(typeof o!=="undefined"){if(!t(o)){throw new TypeError("Array.from: when provided, the second argument must be a function")}if(arguments.length>2){s=arguments[2]}}var u=n(a.length);var l=t(i)?Object(new i(u)):new Array(u);var f=0;var h;while(f<u){h=a[f];if(o){l[f]=typeof s==="undefined"?o(h,f):o.call(s,h,f)}else{l[f]=h}f+=1}l.length=u;return l}}()}var i=[Uint32Array,Uint16Array,Uint8Array,Int32Array,Int16Array,Int8Array,Float32Array,Float64Array,Array];var n=["join","slice","reverse","forEach","map","reduce","indexOf","sort","filter","every"];for(var a=0,o=i.length;a<o;++a){var s=i[a].prototype;if(!s.fill){s.fill=e}if(!s.copyWithin){s.copyWithin=t}if(!s.lastIndexOf){s.lastIndexOf=r}if(a<o-1){for(var u=0,l=n.length;u<l;u++){var f=n[u];if(!s[f]){s[f]=Array.prototype[f]}}}}if(!ArrayBuffer.isView){ArrayBuffer.isView=function(e){for(var t=0;t<i.length;++t){if(e instanceof i[t]){return true}}return false}}if(!Float32Array.prototype.from){(function(){Float32Array.prototype.from=function(e,t,r){var i,n;var a=Int8Array.prototype;if(typeof this!=="function"){throw new TypeError("# is not a constructor")}if(this.prototype!==a){throw new TypeError("this is not a typed array.")}t=t||function(e){return e};if(typeof t!=="function"){throw new TypeError("specified argument is not a function")}e=Object(e);if(!e.length){return new this(0)}var o=[];for(i=0,n=e.length;i<n;i++){o.push(e[i])}o=o.map(t,r);var s=new this(o.length);for(i=0,n=s.length;i<n;i++){s[i]=o[i]}return s}})()}if(!Array.prototype.includes){Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(this==null){throw new TypeError('"this" is null or not defined')}var r=Object(this);var i=r.length>>>0;if(i===0){return false}var n=t|0;var a=Math.max(n>=0?n:i-Math.abs(n),0);function o(e,t){return e===t||typeof e==="number"&&typeof t==="number"&&isNaN(e)&&isNaN(t)}while(a<i){if(o(r[a],e)){return true}a++}return false}})}var h=function(e,t){for(t=this.length;~--t&&(!(t in this)||this[t]!==e);){}return t};Int8Array.prototype.lastIndexOf=Int8Array.prototype.lastIndexOf||h;Int16Array.prototype.lastIndexOf=Int16Array.prototype.lastIndexOf||h;Int32Array.prototype.lastIndexOf=Int32Array.prototype.lastIndexOf||h;Float32Array.prototype.lastIndexOf=Float32Array.prototype.lastIndexOf||h;Float64Array.prototype.lastIndexOf=Float64Array.prototype.lastIndexOf||h;if(typeof CanvasRenderingContext2D!=="undefined"&&!CanvasRenderingContext2D.prototype.setLineDash){CanvasRenderingContext2D.prototype.setLineDash=function(){}}if(!Math.log2){Math.log2=function(e){return Math.log(e)/Math.log(2)}}if(!Number.isNaN){Number.isNaN=function(value){return typeof value==="number"&&isNaN(value)}}var d=typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function v(e,t){return t={exports:{}},e(t,t.exports),t.exports}(function(){var e=setTimeout;function t(){}function r(e,t){return function(){e.apply(t,arguments)}}function i(e){if(typeof this!=="object"){throw new TypeError("Promises must be constructed via new")}if(typeof e!=="function"){throw new TypeError("not a function")}this._state=0;this._handled=false;this._value=undefined;this._deferreds=[];l(e,this)}function n(e,t){while(e._state===3){e=e._value}if(e._state===0){e._deferreds.push(t);return}e._handled=true;i._immediateFn(function(){var r=e._state===1?t.onFulfilled:t.onRejected;if(r===null){(e._state===1?a:o)(t.promise,e._value);return}var i;try{i=r(e._value)}catch(e){o(t.promise,e);return}a(t.promise,i)})}function a(e,t){try{if(t===e){throw new TypeError("A promise cannot be resolved with itself.")}if(t&&(typeof t==="object"||typeof t==="function")){var n=t.then;if(t instanceof i){e._state=3;e._value=t;s(e);return}else if(typeof n==="function"){l(r(n,t),e);return}}e._state=1;e._value=t;s(e)}catch(t){o(e,t)}}function o(e,t){e._state=2;e._value=t;s(e)}function s(e){if(e._state===2&&e._deferreds.length===0){i._immediateFn(function(){if(!e._handled){i._unhandledRejectionFn(e._value)}})}for(var t=0,r=e._deferreds.length;t<r;t++){n(e,e._deferreds[t])}e._deferreds=null}function u(e,t,r){this.onFulfilled=typeof e==="function"?e:null;this.onRejected=typeof t==="function"?t:null;this.promise=r}function l(e,t){var r=false;try{e(function(value){if(r){return}r=true;a(t,value)},function(e){if(r){return}r=true;o(t,e)})}catch(e){if(r){return}r=true;o(t,e)}}i.prototype.catch=function(e){return this.then(null,e)};i.prototype.then=function(e,r){var i=new this.constructor(t);n(this,new u(e,r,i));return i};i.all=function(e){var t=Array.prototype.slice.call(e);return new i(function(e,r){if(t.length===0){return e([])}var i=t.length;function n(a,o){try{if(o&&(typeof o==="object"||typeof o==="function")){var s=o.then;if(typeof s==="function"){s.call(o,function(e){n(a,e)},r);return}}t[a]=o;if(--i===0){e(t)}}catch(e){r(e)}}for(var a=0;a<t.length;a++){n(a,t[a])}})};i.resolve=function(value){if(value&&typeof value==="object"&&value.constructor===i){return value}return new i(function(e){e(value)})};i.reject=function(value){return new i(function(e,t){t(value)})};i.race=function(e){return new i(function(t,r){for(var i=0,n=e.length;i<n;i++){e[i].then(t,r)}})};i._immediateFn=typeof d.setImmediate==="function"&&function(e){d.setImmediate(e)}||function(t){e(t,0)};i._unhandledRejectionFn=function e(t){if(typeof console!=="undefined"&&console){console.warn("Possible Unhandled Promise Rejection:",t)}};i._setImmediateFn=function e(t){i._immediateFn=t};i._setUnhandledRejectionFn=function e(t){i._unhandledRejectionFn=t};if(typeof d==="object"&&!d.Promise){d.exports=i}if(typeof window==="object"&&!window.Promise){window.Promise=i}})(d);if(!String.prototype.endsWith){String.prototype.endsWith=function(e,t){var r=this.toString();if(typeof t!=="number"||!isFinite(t)||Math.floor(t)!==t||t>r.length){t=r.length}t-=e.length;var i=r.lastIndexOf(e,t);return i!==-1&&i===t}}if(!String.prototype.startsWith){String.prototype.startsWith=function(e,t){return this.substr(t||0,e.length)===e}}if(typeof Object.assign!=="function"){Object.defineProperty(Object,"assign",{value:function e(t){var r=arguments;if(t==null){throw new TypeError("Cannot convert undefined or null to object")}var i=Object(t);for(var n=1;n<arguments.length;n++){var a=r[n];if(a!=null){for(var o in a){if(Object.prototype.hasOwnProperty.call(a,o)){i[o]=a[o]}}}}return i},writable:true,configurable:true})}var c=1;var _=[];var g=[];var p=[];var y=[];var m=false;var b=function Ogma(e){if(e===void 0)e={};if(this===undefined||this===null||this.constructor!==Ogma){return new Ogma(e)}if(!m){m=true;for(var t=0;t<p.length;++t){p[t]()}}Ogma.instances.push(this);this._init(e)};b.prototype._init=function e(t){var r=this;this._initParameters=t;this._debug=!!t.debug;this._token=c++;this.modules={};this.events={};this.view={};this.styles={};this.parse={};this.export={};this.tools={};this.utils={};_.forEach(function(e){return e(r,t)});g.forEach(function(e){return e(r,t)})};b.prototype._destroy=function e(){var t=this;y.forEach(function(e){return e(t)});Object.keys(this).forEach(function(e){t[e]=undefined})};b.prototype.destroy=function e(){this._destroy();var t=b.instances.indexOf(this);if(t!==-1){b.instances.splice(t,1)}};b.prototype.reset=function e(){var t=this._initParameters;this._destroy();this._init(t)};function x(e,t){if(typeof t!=="function"){throw new TypeError("expected function")}e.push(t)}b.instances=[];b.extend=function(e){x(_,e)};b.atInit=function(e){x(g,e)};b.beforeFirstInstanceCreated=function(e){x(p,e)};b.onDestroy=function(e){x(y,e)};b.version="2.2.0";b.build="1520622572013";var A={1:T(1),2:T(2),4:T(4),8:S(),16:S(),32:S(),int8:S(),int16:S(),int32:S(),float:S(),any:S()};var w={1:M(1),2:M(2),4:M(4),8:E(),16:E(),32:E(),int8:E(),int16:E(),int32:E(),float:E(),any:E()};function S(){return new Function("array","index","return array[index];")}function E(){return new Function("array","index","value","array[index] = value;")}function T(e){var t=8/e;var r="return (array[index / "+t+" | 0] >> ((index % "+t+") * "+e+")) & "+((1<<e)-1)+";";return new Function("array","index",r)}function M(e){return new Function("array","index","value","\n    var offset = (index % "+8/e+") * "+e+",\n        finalIndex = index / "+8/e+" | 0,\n        orMask = value << offset,\n        andMask = 255 - (("+(Math.pow(2,e)-1)+" - value) << offset);\n\n    array[finalIndex] = (array[finalIndex] & andMask) | orMask;")}var C=function e(t){var r=t.name;var i=t.storage;var n=t.size||0;var a=t.default;var o=Math.max(8,L(n+1));var s=i==="resource"?1:i;if(a===undefined&&i!=="any"&&i!=="resource"){a=0}this._name=r;this._storage=i;this._get=A[s];this._set=w[s];this._elementSize=s;this._nbElements=o;this._byName=undefined;this._byIndex=undefined;this._nextIndex=undefined;this._defaultValue=a;this._BASE_VALUE=i==="any"?undefined:0;this._methods=N;this._initialized=false;if(i==="resource"){this._methods=I;this._byName={};this._byIndex=[];this._nextIndex=1;this._byName[a]=0;this._byIndex.push(a)}};C.prototype.getName=function e(){return this._name};C.prototype.getValues=function e(){return this._byIndex?this._byIndex.slice():null};C.prototype.get=function e(){return this._defaultValue};C.prototype.initialize=function e(){if(!this._initialized){this._initialize()}return this};C.prototype._initialize=function e(){this._initialized=true;this._buffer=R(this._nbElements,this._elementSize);this.get=this._methods.get;this.set=this._methods.set;if(this._storage!=="resource"&&this._defaultValue!==this._BASE_VALUE){k(this,0)}};C.prototype.set=function e(t,value){this._initialize();return this._methods.set.call(this,t,value)};C.prototype.increaseNbElements=function e(t){var r=this;var i=L(t+1);if(i<=this._nbElements){return}if(this._initialized){if(this._elementSize==="any"){for(var n=this._nbElements;n<i;++n){r._buffer.push(r._defaultValue)}}else{var a=R(i,this._elementSize);a.set(this._buffer);this._buffer=a;if(this._storage!=="resource"&&this._defaultValue!==this._BASE_VALUE){k(this,this._nbElements)}}}this._nbElements=i};C.prototype.increaseElementSize=function e(){var t=this._elementSize;if(typeof t!=="number"||t===32){throw new Error("FlexArray: cannot increase element size")}var r=t*2,i=A[r],n=w[r];if(this._initialized){var a=this._nbElements,o=this._get,s=this._buffer,u=R(a,r);if(t>=8){u.set(s)}else{for(var l=0;l<a;++l){n(u,l,o(s,l))}}this._buffer=u}this._elementSize=r;this._get=i;this._set=n};C.prototype.buffer=function e(){if(!this._buffer){throw new Error("flexArray: buffer not instanciated")}return this._buffer};C.prototype.elementBitSize=function e(){return this._elementSize};C.prototype.capacity=function e(){return this._nbElements};C.prototype.byteSize=function e(){return this._nbElements*this._elementSize/8};C.prototype.storage=function e(){return this._storage};C.prototype.getMultiple=function e(t,r){var i=this;var n=t.length;if(r===undefined){r=new Array(n)}for(var a=0,o=n;a<o;++a){r[a]=i.get(t[a])}return r};C.prototype.fill=function e(t,value){var r=this;for(var i=0,n=t.length;i<n;++i){r.set(t[i],value)}};C.prototype.setMultiple=function e(t,r,i){var n=this;if(!i&&(Array.isArray(r)||ArrayBuffer.isView(r))){for(var a=0,o=t.length;a<o;++a){n.set(t[a],r[a])}}else{for(var s=0,u=t.length;s<u;++s){n.set(t[s],r)}}};C.prototype.reset=function e(){if(this._initialized){k(this,0)}};function k(e,t){var value=e._storage==="resource"?0:e._defaultValue;if(typeof e._elementSize!=="number"||e._elementSize>=8){e._buffer.fill(value,t)}else{var r=8/e._elementSize,i=0;for(var n=0;n<r;++n){i=i<<e._elementSize;i+=value}if(t===undefined){e._buffer.fill(i)}else{var a=8-t%8,o=t+a;for(var s=t;s<o;++s){e._set(e._buffer,s,value)}e._buffer.fill(i,o/8)}}}var N={get:function e(t){return this._get(this._buffer,t)},set:function e(t,value){this._set(this._buffer,t,value)}};var I={get:function e(t){return this._byIndex[this._get(this._buffer,t)]},set:function e(t,value){var r=this._byName[value];if(r===undefined){r=this._nextIndex++;this._byIndex.push(value);var i=z(this);if(i>this._elementSize){this.increaseElementSize()}this._byName[value]=r}this._set(this._buffer,t,r)}};function z(e){return Math.pow(2,Math.ceil(Math.log2(Math.log2(e._nextIndex))))}function L(e){var t=2;while(t<e){t*=2}return t}function R(e,t){if(t==="any"){var r=new Array(e);return r}else if(t==="float"){return new Float32Array(e)}else if(t==="int8"){return new Int8Array(e)}else if(t==="int16"){return new Int16Array(e)}else if(t==="int32"){return new Int32Array(e)}else if(t===32){return new Uint32Array(e)}else if(t===16){return new Uint16Array(e)}else{return new Uint8Array(Math.ceil(e/8*t))}}var D=Array.isArray;var F=function e(){};F.prototype.on=function e(t,r){if(typeof t!=="string"){throw new TypeError("Event name must be string")}if(typeof r!=="function"){throw new TypeError("Event handler must be function")}var i=this._events=this._events||{};var n=i[t]=i[t]||[];n.push(r);return this};F.prototype.off=function e(t,r){if(typeof t!=="string"){throw new TypeError("Event name must be string")}var i=this._event=this._events||{};var n=i[t];if(D(n)){if(typeof r!=="function"){i[t]=null}else{var a=n.indexOf(r);if(a!==-1){n.splice(a,1)}if(n.length===0){i[t]=null}}}return this};F.prototype.fire=function e(t){var r=this;if(typeof t!=="string"){throw new TypeError("Event name must be string")}var i=this._event=this._events||{};var n=i[t],a;if(D(n)){var o=Array.prototype.slice.call(arguments,1);for(var s=0;s<n.length;s++){a=n[s];if(a){a.apply(r,o)}}}return this};F.prototype.once=function e(t,r){var i=this;var n=function(){r.apply(i,Array.prototype.slice.call(arguments,0));i.off(t,n)};n.handler=r;return this.on(t,n)};F.prototype.hasListener=function e(t,r){if(!t||!r){return false}var i=this._events=this._events||{};var n=i[t];if(D(n)){var a;for(var o=0,s=n.length;o<s;o++){a=n[o];if(a===r||a.handler===r){return true}}}return false};F.prototype.getListeners=function e(t){var r=this._events=this._events||{};return r[t]};F.mixin=function(e){var t=typeof e==="function"?e.prototype:e;var r=["addEventListener","removeEventListener","addOneTimeEventListener","dispatch","on","off","once","fire","trigger"];for(var i=0,n=r.length;i<n;i++){var a=r[i];t[a]=F.prototype[a]}return e};F.prototype.addEventListener=F.prototype.on;F.prototype.removeEventListener=F.prototype.off;F.prototype.addOneTimeEventListener=F.prototype.once;F.prototype.trigger=F.prototype.dispatch=F.prototype.fire;var P=["AliceBlue","#F0F8FF","AntiqueWhite","#FAEBD7","Aqua","#00FFFF","Aquamarine","#7FFFD4","Azure","#F0FFFF","Beige","#F5F5DC","Bisque","#FFE4C4","Black","#000000","BlanchedAlmond","#FFEBCD","Blue","#0000FF","BlueViolet","#8A2BE2","Brown","#A52A2A","BurlyWood","#DEB887","CadetBlue","#5F9EA0","Chartreuse","#7FFF00","Chocolate","#D2691E","Coral","#FF7F50","CornflowerBlue","#6495ED","Cornsilk","#FFF8DC","Crimson","#DC143C","Cyan","#00FFFF","DarkBlue","#00008B","DarkCyan","#008B8B","DarkGoldenRod","#B8860B","DarkGray","#A9A9A9","DarkGrey","#A9A9A9","DarkGreen","#006400","DarkKhaki","#BDB76B","DarkMagenta","#8B008B","DarkOliveGreen","#556B2F","DarkOrange","#FF8C00","DarkOrchid","#9932CC","DarkRed","#8B0000","DarkSalmon","#E9967A","DarkSeaGreen","#8FBC8F","DarkSlateBlue","#483D8B","DarkSlateGray","#2F4F4F","DarkSlateGrey","#2F4F4F","DarkTurquoise","#00CED1","DarkViolet","#9400D3","DeepPink","#FF1493","DeepSkyBlue","#00BFFF","DimGray","#696969","DimGrey","#696969","DodgerBlue","#1E90FF","FireBrick","#B22222","FloralWhite","#FFFAF0","ForestGreen","#228B22","Fuchsia","#FF00FF","Gainsboro","#DCDCDC","GhostWhite","#F8F8FF","Gold","#FFD700","GoldenRod","#DAA520","Gray","#808080","Grey","#808080","Green","#008000","GreenYellow","#ADFF2F","HoneyDew","#F0FFF0","HotPink","#FF69B4","IndianRed","#CD5C5C","Indigo","#4B0082","Ivory","#FFFFF0","Khaki","#F0E68C","Lavender","#E6E6FA","LavenderBlush","#FFF0F5","LawnGreen","#7CFC00","LemonChiffon","#FFFACD","LightBlue","#ADD8E6","LightCoral","#F08080","LightCyan","#E0FFFF","LightGoldenRodYellow","#FAFAD2","LightGray","#D3D3D3","LightGrey","#D3D3D3","LightGreen","#90EE90","LightPink","#FFB6C1","LightSalmon","#FFA07A","LightSeaGreen","#20B2AA","LightSkyBlue","#87CEFA","LightSlateGray","#778899","LightSlateGrey","#778899","LightSteelBlue","#B0C4DE","LightYellow","#FFFFE0","Lime","#00FF00","LimeGreen","#32CD32","Linen","#FAF0E6","Magenta","#FF00FF","Maroon","#800000","MediumAquaMarine","#66CDAA","MediumBlue","#0000CD","MediumOrchid","#BA55D3","MediumPurple","#9370DB","MediumSeaGreen","#3CB371","MediumSlateBlue","#7B68EE","MediumSpringGreen","#00FA9A","MediumTurquoise","#48D1CC","MediumVioletRed","#C71585","MidnightBlue","#191970","MintCream","#F5FFFA","MistyRose","#FFE4E1","Moccasin","#FFE4B5","NavajoWhite","#FFDEAD","Navy","#000080","OldLace","#FDF5E6","Olive","#808000","OliveDrab","#6B8E23","Orange","#FFA500","OrangeRed","#FF4500","Orchid","#DA70D6","PaleGoldenRod","#EEE8AA","PaleGreen","#98FB98","PaleTurquoise","#AFEEEE","PaleVioletRed","#DB7093","PapayaWhip","#FFEFD5","PeachPuff","#FFDAB9","Peru","#CD853F","Pink","#FFC0CB","Plum","#DDA0DD","PowderBlue","#B0E0E6","Purple","#800080","RebeccaPurple","#663399","Red","#FF0000","RosyBrown","#BC8F8F","RoyalBlue","#4169E1","SaddleBrown","#8B4513","Salmon","#FA8072","SandyBrown","#F4A460","SeaGreen","#2E8B57","SeaShell","#FFF5EE","Sienna","#A0522D","Silver","#C0C0C0","SkyBlue","#87CEEB","SlateBlue","#6A5ACD","SlateGray","#708090","SlateGrey","#708090","Snow","#FFFAFA","SpringGreen","#00FF7F","SteelBlue","#4682B4","Tan","#D2B48C","Teal","#008080","Thistle","#D8BFD8","Tomato","#FF6347","Turquoise","#40E0D0","Violet","#EE82EE","Wheat","#F5DEB3","White","#FFFFFF","WhiteSmoke","#F5F5F5","Yellow","#FFFF00","YellowGreen","#9ACD32"];var B=/^rgba?\((\d+),?\s*(\d+),?\s*(\d+),?\s*((\d+)?\.?\d+)*\)$/;function O(e,t){if(t===void 0)t=[];var r=B.exec(e);if(r){t[0]=parseInt(r[1])/255;t[1]=parseInt(r[2])/255;t[2]=parseInt(r[3])/255;t[3]=r[4]===undefined?1:parseFloat(r[4]);return t}else{return null}}function V(e){if(e<16){return"0"+e.toString(16)}else{return e.toString(16)}}function j(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,function(e,t,r,i){return t+t+r+r+i+i});var r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(r){return[parseInt(r[1],16)/255,parseInt(r[2],16)/255,parseInt(r[3],16)/255,1]}else{return null}}var U=function e(){var t=this;this._transparent=[0,0,0,0];this._colorByName={};this._addColor("null",this._transparent);this._addColor("transparent",this._transparent);this._temp=[0,0,0,0];for(var r=0;r<P.length;r+=2){var i=P[r].toLowerCase(),value=P[r+1];t._addColor(i,j(value))}};U.prototype.parseColor=function e(t){var r=this._colorByName[t];if(r===undefined){if(typeof t!=="string"){return null}else{r=t.charAt(0)==="#"?j(t):O(t);this._addColor(r)}}return r};U.prototype.toHexa=function e(t){var r=this.parseColor(t);return"#"+V(r[0])+V(r[1])+V(r[2])};U.prototype._addColor=function e(t,r){var value=r?new Float32Array(r):null;this._colorByName[t]=value;return value};U.prototype.rgbaToRgb=function e(t){var r=1,i=t;if(i&&O(t,this._temp)){i="rgb("+ +this._temp[0]*255+","+ +this._temp[1]*255+","+ +this._temp[2]*255+")";r=parseFloat(this._temp[3])}return{color:i,opacity:r}};var G=function(){var e=0;return typeof requestAnimationFrame!=="undefined"?requestAnimationFrame:function(t){var r=Date.now();var i=Math.min(16,Math.max(0,16-(r-e)));var n=e=r+i;return setTimeout(function(){return t(n)},i)}}();var X=typeof cancelAnimationFrame!=="undefined"?cancelAnimationFrame:function(e){return clearTimeout(e)};function W(e,t){return G(function(r){e.call(t,r)})}function H(e){if(e){X(e)}}var Y=typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{};var q=null;var Z=false;if(typeof window!=="undefined"&&typeof document!=="undefined"){var $={opera:!!window.opr&&!!window.opr.addons||!!window.opera||typeof navigator!=="undefined"&&navigator.userAgent.indexOf(" OPR/")>=0,firefox:typeof InstallTrigger!=="undefined",safari:/^((?!chrome|android).)*safari/i.test(navigator.userAgent),ie:!!document.documentMode,edge:!document.documentMode&&!!window.StyleMedia,chrome:!!window.chrome&&!!window.chrome.webstore||/HeadlessChrome/.test(navigator.userAgent)};for(var K in $){if($.hasOwnProperty(K)&&$[K]){q=K;break}}if(navigator.userAgent.indexOf("MSIE")>=0){Z=true}}var J=!Z;if(!q&&typeof Y!=="undefined"){q="node"}function Q(){return q}b.libraries=Object.create(null);var ee={};var te={};var re=function(){return null};if(typeof Y==="object"){ee=Y}if(typeof window==="object"){te=window}if(typeof module==="object"&&typeof module.require==="function"){re=function(e){try{return module.require(e)}catch(e){return null}}}else if(typeof ee.require==="function"){re=function(e){try{return ee.require(e)}catch(e){return null}}}function ie(e,t){var r=t.globalVarName;var i=t.fallback;var n=t.throwOnError;if(n===void 0)n=true;var a=null;if(!a&&e){a=b.libraries[e]}if(!a&&r){a=b.libraries[r]}if(!a&&e){a=re(e)}if(!a&&r){a=te[r]}if(!a&&r){a=ee[r]}if(!a&&typeof i==="function"){a=i()}if(!a&&i){a=i}if(!a&&n){var o=r?" or global variable "+r:"";var s='unable to find module "'+e+'"'+o+"; make sure one of these statements is true:\n";s+="- require('"+e+"') returns the right library\n";s+="- Ogma.libraries['"+e+"'] is set to the right library\n";if(r){s+="- window['"+r+"'] is set to the right library"}throw new Error(s)}return a}var ne=typeof performance!=="undefined"&&performance.now?function(){return performance.now()|0}:function(){return Date.now()};var ae=ne();function oe(){return ne()-ae}function se(){return oe()}function ue(){var e=new Date;var t=e.getDate();var r=e.getMonth()+1;var i=e.getFullYear();if(t<10){t="0"+t}if(r<10){r="0"+r}return i+"-"+r+"-"+t}function le(){var e=new Date;var t=fe((e.getUTCHours()-(e.getTimezoneOffset()/60|0))%24);var r=fe(e.getUTCMinutes());var i=fe(e.getUTCSeconds());var n=fe(e.getUTCMilliseconds(),3);return"["+t+":"+r+":"+i+":"+n+"]"}function fe(e,t){t=t||2;var r=Math.pow(10,t-1),i=e;while(r>1){if(e<r){i="0"+i}r/=10}return i}function he(){var e=null;return{fire:function(t,r){if(e){clearTimeout(e);e=null}e=setTimeout(function(){e=null;t()},r)},stop:function(){if(e){clearTimeout(e);e=null}}}}function de(e,value,t){var r=Math.abs(value-e[0]),i=0;for(var n=1;n<e.length;++n){var a=Math.abs(value-e[n]);if(a<r){r=a;i=n}}return t?i:e[i]}function ve(e){return ce(Math.log(e)/Math.LN2)}function ce(e){return typeof e==="number"&&e%1===0}function _e(e,t,r){if(r===1){return[e]}var i=(t-e)/(r-1),n=new Array(r);for(var a=0;a<r;++a){n[a]=e+i*a}return n}var ge=100;function pe(e,t,r,i,n){var a=e(r)<=e(i),o=r,s=i;for(var u=0;u<ge;++u){var l=(o+s)/2,value=e(l),f=Math.abs(value-t);if(f<=n){return l}if(value<t){if(a){o=l}else{s=l}}else{if(a){s=l}else{o=l}}}return l}function ye(e,t,r){if(r===void 0)r=0;var value=1;while(value<e||value<r){value*=t}return value}function me(e,t){return ye(e,2,t)}function be(value,e,t){return Math.max(e,Math.min(t,value))}function xe(e,t,r){return e+(t-e)*r}function Ae(){var e=0;return function(){return++e}}function we(e){var t=typeof e;if(t==="string"){return e}else if(t==="function"||t==="number"||t==="boolean"){return e.toString()}else if(e===null){return"null"}else if(e===undefined){return"undefined"}else{return JSON.stringify(e)}}function Se(e){if(typeof e==="string"){return e.split(".")}else if(Array.isArray(e)){for(var t=0;t<e.length;++t){if(typeof e[t]!=="string"){throw new TypeError(e[t]+" is not a string")}}return e.slice()}else{throw new TypeError('invalid property path "'+e+'": expected string or array of strings')}}function Ee(e,t,r){var i,n,a,o;if(t===0){return function(){e.apply(r,arguments)}}o=function(){i=false;if(n){a.apply(r,n);n=false}};a=function(){var a;if(i){n=arguments}else{a=e.apply(r,arguments);setTimeout(o,t);i=true}return a};return a}function Te(e,t,r){var i,n,a,o,s;if(t==null){t=100}function u(){var l=Date.now()-o;if(l<t&&l>=0){i=setTimeout(u,t-l)}else{i=null;if(!r){s=e.apply(a,n);a=n=null}}}var l=function(){a=this;n=arguments;o=Date.now();var l=r&&!i;if(!i){i=setTimeout(u,t)}if(l){s=e.apply(a,n);a=n=null}return s};l.clear=function(){if(i){clearTimeout(i);i=null}};l.flush=function(){if(i){s=e.apply(a,n);a=n=null;clearTimeout(i);i=null}};return l}function Me(e,t,r,i,n){r(e[t],t,e,i,n).then(function(a){if(t===e.length-1){i(a)}else{Me(e,t+1,r,i,n)}}).catch(n)}function Ce(e,t){return new Promise(function(r,i){Me(e,0,t,r,i)})}function ke(e){var t=e.toString();return t.substring(t.indexOf("{")+1,t.lastIndexOf("}"))}var Ne=/^[+-]?(?:\d+|\d*[.,]\d+)(e\d+)?$/;function Ie(e){if(typeof e==="number"){return isFinite(e)?e:NaN}else if(typeof e==="string"){return Ne.test(e)?parseFloat(e):NaN}else{return NaN}}function ze(e){return!isNaN(Ie(e))}function Le(){return new Uint8Array(new Uint32Array([305419896]).buffer)[0]===120}function Re(e,t){var r=e.indexOf(t);if(r!==-1){e.splice(r,1);return true}return false}function De(e){if(!e.length){return-Infinity}var t=e[0];for(var r=1,i=e.length;r<i;++r){var n=e[r];if(n>t){t=n}}return t}function Fe(e){if(!e.length){return Infinity}var t=e[0];for(var r=1,i=e.length;r<i;++r){var n=e[r];if(n<t){t=n}}return t}function Pe(e){return typeof e==="boolean"||e===0||e===1?e:undefined}function Be(e){return typeof e==="number"&&isFinite(e)?e:undefined}function Oe(e){return typeof e==="number"&&isFinite(e)&&e>=0?e:undefined}function Ve(e){return typeof e==="number"&&isFinite(e)&&e>0?e:undefined}function je(e){return typeof e==="string"?e:undefined}function Ue(e){return e===null||typeof e==="string"||typeof e==="number"?e:undefined}function Ge(e,t){return t.parseColor(e)?e:undefined}function Xe(e,t){return e==="inherit"||t.parseColor(e)?e:undefined}function We(e,t){return e==="source"||e==="target"||!!t.parseColor(e)?e:undefined}function He(e){if(e==="none"){return"normal"}return e==="normal"||e==="italic"||e==="bold"?e:undefined}function Ye(e){return e==="left"||e==="center"?e:undefined}function qe(e){if(e==="equilateral"){return"pentagon"}return e==="circle"||e==="square"||e==="cross"||e==="diamond"||e==="pentagon"||e==="star"?e:undefined}function Ze(e){return e==="line"||e==="triangle"?e:undefined}function $e(e){return e===null||e==="arrow"?e:undefined}function Ke(e){return e==="plain"||e==="dashed"||e==="dotted"?e:undefined}function Je(e){return e==="top"||e==="bottom"||e==="left"||e==="right"||e==="center"?e:undefined}function Qe(e,t){if(t.parseColor(e)){return e}if(Array.isArray(e)){if(e.length<1){return undefined}for(var r=0;r<e.length;++r){if(!t.parseColor(e[r])){return undefined}}return e}return undefined}function et(e){return new Function("x",["if (typeof x === 'number') { return (typeof x === 'number' && isFinite(x) && x >= 0) ? x : undefined; }","else if (typeof x !== 'string' || x.charAt(x.length - 1) !== '%') { return undefined; }","else { var p = parseFloat(x); return isNaN(p) ? undefined : ("+e+" * p / 100); }"].join("\n"))}function tt(e){return e!==null&&typeof e==="object"&&!bt(e)&&!(e instanceof RegExp)&&(typeof HTMLElement==="undefined"||!(e instanceof HTMLElement))}function rt(){return le()}function it(e){console.log(rt()+" "+e)}function nt(e){console.info(rt()+" "+e)}function at(e){console.warn(rt()+" "+e)}function ot(e,t){return e===undefined?t:e}function st(e,t){var r=Object.keys(e);for(var i=0,n=r.length;i<n;++i){var a=r[i];t(e[a],a)}}function ut(e,t){return wt(e,t)}function lt(e,t,r){return St(e,t,r)}function ft(e,t){return Et(e,t)}function ht(e,t){if(!t){return{nodes:e?new e:Object.create(null),edges:e?new e:Object.create(null),fetch:function(e){return e?this.nodes:this.edges}}}else{return{nodes:e,edges:t,fetch:function(e){return e?this.nodes:this.edges}}}}function dt(e){return kt(e)}function vt(e){var t=Object.keys(e),r=new Array(t.length);for(var i=0;i<t.length;++i){r[i]=e[t[i]]}return r}function ct(value,e,t){return $t(value,e,t)}function _t(e){var t=arguments;var r,i,n,a;for(r=1,n=arguments.length;r<n;r++){a=t[r];for(i in a){e[i]=a[i]}}return e}function gt(e,t,value,r){if(t in e){throw new Error(r+" "+t+" already exists")}e[t]=value}function pt(e,t,r){if(Array.isArray(e)){var i=e.indexOf(t);if(i===-1){throw new Error(r+" "+t+" does not exist")}return i}else{if(!(t in e)){throw new Error(r+" "+t+" does not exist")}return e[t]}}function yt(e){return e===undefined?"undefined":JSON.stringify(e)}function mt(e){return Object.keys(e)}function bt(value){return Array.isArray(value)||ArrayBuffer.isView(value)}function xt(e,t){return zt(e,t)}function At(e,t){var r=Object.keys(t);for(var i=0;i<r.length;++i){var n=r[i];e[n]=t[n]}return e}function wt(e,t,r){if(Array.isArray(e)){e.forEach(t,r)}else if(tt(e)){var i=Object.keys(e);if(r){for(var n=0;n<i.length;++n){var a=i[n];t.call(r,e[a],a)}}else{for(n=0;n<i.length;++n){a=i[n];t(e[a],a)}}}else{throw new Error("forEach: invalid argument "+JSON.stringify(e))}}function St(e,t,r){var value=r;Object.keys(e).forEach(function(r){value=t(value,e[r])});return value}function Et(e,t){if(Array.isArray(e)){return e.map(t)}else if(tt(e)){var r={},i=Object.keys(e);for(var n=0;n<i.length;++n){var a=i[n];r[a]=t(e[a],a)}return r}else{throw new Error("map: invalid argument "+JSON.stringify(e))}}function Tt(e,t){var r=Object.keys(t);for(var i=0,n=r.length;i<n;++i){var a=r[i];t[a]=e[a]}return t}function Mt(e){var t={};wt(e,function(value,e){t[e]=value});return t}function Ct(e){if(e===undefined){return"undefined"}else{return JSON.stringify(e)}}function kt(e){if(Array.isArray(e)){t=new Array(e.length);for(i=0;i<e.length;++i){t[i]=kt(e[i])}return t}else if(e!==null&&e!==undefined&&e.constructor===Object){var t={},r=Object.keys(e);for(var i=0;i<r.length;++i){var n=r[i];t[n]=kt(e[n])}return t}else{return e}}function Nt(e,t){wt(t,function(t,value){if(typeof value==="object"&&value!==null){if(typeof e[t]!=="object"||e[t]===null){e[t]={}}Nt(e[t],value)}else{e[t]=value}})}function It(e,t){t.forEach(function(t){if(e.indexOf(t)===-1){e.push(t)}})}function zt(e,t){if(typeof t==="string"){if(t.indexOf(".")===-1){return e===null||e===undefined?undefined:e[t]}var r=t.indexOf(".");while(e&&r!==-1){e=e[t.substr(0,r)];t=t.substr(r+1);r=t.indexOf(".")}return e?e[t]:undefined}else{for(var i=0,n=t.length;i<n;++i){if(!e){return undefined}e=e[t[i]]}return e}}function Lt(e,t){var r=t.indexOf(".");while(e&&r!==-1){e=e[t.substr(0,r)];t=t.substr(r+1);r=t.indexOf(".")}return!!e&&e.hasOwnProperty(t)}function Rt(e,t,value){var r=t.indexOf(".");while(r!==-1){var i=t.substr(0,r),n=e[i];if(!n){n={};e[i]=n}t=t.substr(r+1);r=t.indexOf(".");e=n}e[t]=value}var Dt=function(){};function Ft(e,t,r,i){var n=t.indexOf(".");while(n!==-1){var a=t.substr(0,n),o=e[a];if(!o){o={};e[a]=o}t=t.substr(n+1);n=t.indexOf(".");e=o}var s=e[t];Object.defineProperty(e,t,{get:r||function(){return s},set:i||Dt,configurable:true})}function Pt(e,t){var r=t.indexOf("."),i=t;while(e&&r!==-1){e=e[t.substr(0,r)];t=t.substr(r+1);r=t.indexOf(".")}if(!e){throw new Error('No property "'+i+'" exist.')}var value=e[t];Object.defineProperty(e,t,{value:value,configurable:true})}function Bt(){var e=arguments;var t=arguments.reduce(function(e,value){return e+(value?value.length:0)},0),r=new Array(t),i=0;for(var n=0;n<arguments;++n){if(e[n]){for(var a=0;a<arguments[n].length;++a){r[i]=e[n][a];++i}}}return r}function Ot(e){var t=[];for(var r=0,i=e.length;r<i;++r){var n=e[r];if(t.indexOf(n)===-1){t.push(n)}}return t}function Vt(e,t){wt(t,function(t,r){Object.defineProperty(e,r,{enumerable:true,get:t})})}var jt=function(){};var Ut=/\{\s*\[native code\]\s*\}/;function Gt(e){return typeof e==="string"&&!Ut.test(""+e)}function Xt(e){if(typeof e==="object"){var t=e.constructor;if(Gt(t)){var r=Object.keys(t.prototype);for(var i=0;i<r.length;++i){var n=r[i];if(typeof t.prototype[n]==="function"){e[n]=jt}}}}}function Wt(e,t,r){if(r===void 0)r=".";if(!t){t=function(e){return!tt(e)}}var i={},n=Object.keys(e);var a=function(a){var o=n[a],value=e[o];if(!t(value)){var s=Wt(value,t);st(s,function(e,t){i[""+o+r+t]=e})}else{i[o]=value}};for(var o=0;o<n.length;++o)a(o);return i}function Ht(e,t,value){var r=typeof t==="string"?t.split("."):t;for(var i=0;i<r.length-1;++i){var n=r[i],a=e[n];if(!a){a={};e[n]=a}e=a}e[r[r.length-1]]=value}function Yt(e){var t={},r=Object.keys(e);for(var i=0;i<r.length;++i){var n=r[i];Ht(t,n,e[n])}return t}function qt(e,t,r){if(r===void 0)r=[];var i=Object.keys(e);for(var n=0;n<i.length;++n){var a=i[n],value=e[a],o=t?t+a:a;if(typeof value!=="object"||value===null||Array.isArray(value)){r.push(o)}else{qt(value,o+".",r)}}return r}function Zt(e){if(e===void 0)e={};for(var t in e){if(typeof e[t]==="function"){delete e[t]}}return e}function $t(value,e,t){if(value===undefined){return dt(e)}if(!tt(value)&&t){value={};value[t]=value}if(tt(e)){var r={};for(var i in e){var n=e[i],a=value[i];if(tt(n)){r[i]=$t(a,n)}else if(a===undefined){r[i]=dt(n)}else{r[i]=a}}return r}else{return value}}var Kt=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;var Jt=function(e){return Kt.exec(e).slice(1)};function Qt(e){return e.charAt(0)==="/"}function er(e){var t=Jt(e),r=t[0],i=t[1];if(!r&&!i){return"."}if(i){i=i.substr(0,i.length-1)}return r+i}var tr="ab".substr(-1)==="b"?function(e,t,r){return e.substr(t,r)}:function(e,t,r){if(t<0){t=e.length+t}return e.substr(t,r)};var rr=300;var ir=150;var nr;var ar;var or;var sr;var ur;b.beforeFirstInstanceCreated(function(){nr=ie("xmldom",{throwOnError:false});ar=ie("canvas",{throwOnError:false});ur=ie("gl",{throwOnError:false});if(typeof XMLSerializer!=="undefined"){or=XMLSerializer}else if(nr){or=nr.XMLSerializer}else{or=null}if(typeof document!=="undefined"){sr=document}else if(nr){sr=(new nr.DOMImplementation).createDocument()}else{sr=null}});function lr(){if(sr){return sr}else{return{createElementNS:function e(){return null},createElement:function e(){return null},implementation:{createDocument:function e(){throw new Error('unable to create XML document; if you use Node JS install the "xmldom" package')}}}}}function fr(e,t){var value=e.style[t]||e.currentStyle&&e.currentStyle[t];if((!value||value==="auto")&&lr().defaultView){var r=document.defaultView.getComputedStyle(e,null);value=r?r[t]:null}return value==="auto"?null:value}function hr(){if(typeof XMLSerializer!=="undefined"){return XMLSerializer}else if(nr){return nr.XMLSerializer}else{return function(){throw new Error('unable to instantiate XMLSerializer; if you use Node JS install the "xmldom" package')}}}function dr(){if(ar){return function(){var e=new ar(300,150);e.style={};return e}}else if(typeof document!=="undefined"){return function(){return document.createElement("canvas")}}else{return function(){return new gr}}}function vr(e,t){var r=e.getContext("webgl",t);if(!r){r=e.getContext("experimental-webgl",t)}if(!r&&ur){r=ur(e.width,e.height,t)}return r||null}var cr=function e(){this.__dummy=true;this.style={width:"0px",height:"0px"}};var _r={offsetWidth:{configurable:true},offsetHeight:{configurable:true},firstChild:{configurable:true}};_r.offsetWidth.get=function(){return parseFloat(this.style.width)};_r.offsetHeight.get=function(){return parseFloat(this.style.height)};_r.firstChild.get=function(){return null};cr.prototype.appendChild=function e(){};cr.prototype.removeChild=function e(){};cr.prototype.addEventListener=function e(){};cr.prototype.removeEventListener=function e(){};Object.defineProperties(cr.prototype,_r);var gr=function e(){this.__context=new yr;this.style={};this.width=rr;this.height=ir};var pr={__dummy:{configurable:true}};pr.__dummy.get=function(){return true};gr.prototype.getContext=function e(t){return t==="2d"?this.__context:null};gr.prototype.toDataURL=function e(){return"data:image/png;base64,"};gr.prototype.addEventListener=function e(){};gr.prototype.removeEventListener=function e(){};gr.prototype.getBoundingClientRect=function e(){return{left:0,top:0,bottom:0,right:0,width:this.width,height:this.height}};Object.defineProperties(gr.prototype,pr);var yr=function e(){this._fontSize=10};var mr={font:{configurable:true}};mr.font.set=function(e){var t=e.match(/\d+/);if(t){this._fontSize=parseFloat(t[0])}};yr.prototype.fill=function e(){};yr.prototype.stroke=function e(){};yr.prototype.clearRect=function e(){};yr.prototype.fillRect=function e(){};yr.prototype.strokeRect=function e(){};yr.prototype.beginPath=function e(){};yr.prototype.closePath=function e(){};yr.prototype.moveTo=function e(){};yr.prototype.lineTo=function e(){};yr.prototype.rect=function e(){};yr.prototype.arc=function e(){};yr.prototype.save=function e(){};yr.prototype.restore=function e(){};yr.prototype.clip=function e(){};yr.prototype.translate=function e(){};yr.prototype.rotate=function e(){};yr.prototype.fillText=function e(){};yr.prototype.setLineDash=function e(){};yr.prototype.quadraticCurveTo=function e(){};yr.prototype.bezierCurveTo=function e(){};yr.prototype.drawImage=function e(){};yr.prototype.measureText=function e(t){return{width:t.length*Math.ceil(this._fontSize*.625)}};yr.prototype.getImageData=function e(){return{width:0,height:0,data:new Uint8ClampedArray(0)}};Object.defineProperties(yr.prototype,mr);function br(){return new cr}function xr(e,t){var r=sr.createElement(e)||t&&new cr;if(!r){throw new Error('unable to instanciate new DOM element; if you use Node JS install the "xmldom" package')}return r}function Ar(e,t,r){var i=sr.createElementNS(e,t)||r&&new cr;if(!i){throw new Error('unable to instanciate new DOM element; if you use Node JS install the "xmldom" package')}return i}function wr(){return sr.implementation.createDocument("","",null)}function Sr(e){return(new or).serializeToString(e)}function Er(){var e=null;if(typeof document!=="undefined"){e=document.createElement("canvas")}else if(ar){e=new ar(rr,ir);e.style={}}else{e=new gr}return e}function Tr(){return typeof window!=="undefined"&&window.devicePixelRatio||1}function Mr(e){var t=";base64,",r,i,n;if(e.indexOf(t)===-1){r=e.split(",");i=r[0].split(":")[1];n=decodeURIComponent(r[1]);return kr(n,i)}r=e.split(t);i=r[0].split(":")[1];n=window.atob(r[1]);var a=n.length;var o=new Uint8Array(a);for(var s=0;s<a;++s){o[s]=n.charCodeAt(s)}return kr([o],i)}function Cr(e,t){this.data=e;this.type=t}function kr(e,t){if(typeof Blob!=="undefined"){return new Blob(e,{type:t})}else{return new Cr(e,t)}}function Nr(e){if(typeof Blob!=="undefined"){return e instanceof Blob||e instanceof Cr}else{return e instanceof Cr}}function Ir(e,t,r){if(typeof window==="undefined"||window["__OGMA_HEADLESS"]){return e}var i=null,n=null,a=null;if(window.Blob){if(r==="blob"){i=e}else if(r==="dataURL"){i=Mr(e)}else{i=kr([e],"text/xml")}n=window.URL.createObjectURL(i)}else{a="data:text/xml;charset=UTF-8,"+encodeURIComponent('<?xml version="1.0" encoding="UTF-8"?>')+encodeURIComponent(e)}if(navigator.msSaveBlob){navigator.msSaveBlob(i,t)}else if(navigator.msSaveOrOpenBlob){navigator.msSaveOrOpenBlob(i,t)}else{var o=document.createElement("a");o.setAttribute("href",window.Blob?n:a);o.setAttribute("download",t);document.body.appendChild(o);o.click();document.body.removeChild(o)}if(n){setTimeout(function(){window.URL.revokeObjectURL(n)},0)}return e}function zr(e,t,r,i){if(!i){i=Tr()}e.style.width=t+"px";e.style.height=r+"px";e.width=t*i;e.height=r*i}function Lr(e,t){wt(t,function(value,t){if(value!==undefined){e.setAttribute(t,value)}})}function Rr(e,t){var r=sr.createElementNS("http://www.w3.org/2000/svg",e);if(!r.style){r.style={}}if(t){Lr(r,t)}return r}function Dr(e){return sr.createTextNode(e)}function Fr(e,t,r,i,n){if(n===void 0)n=false;i=i||0;var a=se();var o=i===0?r:function(e){var t=se();if(t-a>i){r(e);a=t}};e.addEventListener(t,o,n);return{listener:o,elt:e,eventName:t}}function Pr(e){e.elt.removeEventListener(e.eventName,e.listener)}function Br(e){if(typeof Image==="undefined"){return Promise.resolve(null)}return new Promise(function(t){var r=new Image;r.src=e;r.onload=function(){t(r)};r.onerror=function(){t(null)}})}function Or(e){if(e.indexOf("http://")===0||e.indexOf("https://")===0){return e}var t=window.location.origin,r=window.location.pathname,i=r.lastIndexOf("/");if(i===-1){t+="/"+e}else{t+=r.substr(0,i)+"/"+e}return t}function Vr(e){return new Promise(function(t,r){var i=new XMLHttpRequest;i.open("GET",Or(e),true);i.onreadystatechange=function(){if(i.readyState===4){if(i.status===200){t(i.responseText)}else{r(i.status)}}};i.onerror=function(e){r(e)};i.send()})}function jr(e){return typeof HTMLElement!=="undefined"?e instanceof HTMLElement:false}function Ur(e,t){e.style.cursor=t;if(e.style.cursor!==t){e.style.cursor="-webkit-"+t}}function Gr(e){if(!e.getBoundingClientRect){return null}try{return e.getBoundingClientRect()}catch(e){return null}}function Xr(e){if(typeof window==="undefined"){return}setTimeout(function(){if(typeof document!=="undefined"&&document.fonts&&document.fonts.ready instanceof Promise){document.fonts.ready.then(function(t){if(t.size>0){e()}})}else{setTimeout(e,2e3)}},0)}function Wr(e){if(typeof window!=="undefined"){window.addEventListener("beforeunload",e)}}function Hr(e){return new Promise(function(t,r){var i=new XMLHttpRequest;i.responseType="blob";i.open("GET",Or(e),true);i.onreadystatechange=function(){if(i.readyState===4){if(i.status===200){t(i.response)}else{r(i.status)}}};i.onerror=function(e){return r(e)};i.send()})}function Yr(e){var t=[];var r=/url\(['"]?([^'")]+)['"]?\)\s+format\(['"]?([^'")]+)['"]?\)/g;var i;while(i=r.exec(e)){var n=i[2];if(n!=="embedded-opentype"){t.push({format:n,url:i[1],rule:e})}}return t}function qr(e,t,r){if(e&&e.base64){var i=e.rule.replace(/src:[^;]+;/g,function(){return'src: url("'+e.base64+'") format("'+e.format+'");'});t.appendChild(r.createTextNode(i))}}function Zr(e){return Ce(e,function(e,t,r,i){var n=e.format;var a=e.url;var o=e.rule;return new Promise(function(e){if(a&&a.indexOf("data")!==0){return $r(a).then(function(e){return i({format:n,url:a,base64:e,rule:o})}).catch(e)}e()})})}function $r(e){return Hr(e).then(function(e){return new Promise(function(t,r){var i=new FileReader;i.onerror=r;i.onload=function(){return t(i.result)};i.readAsDataURL(e)})})}function Kr(e){return Object.prototype.toString.call(e)==="[object CSSFontFaceRule]"}function Jr(e){var t=e.getElementsByTagName("text");var r=e.getElementsByTagName("tspan");var i=[];ti(t,function(e){return i.push(e)});ti(r,function(e){return i.push(e)});return i.reduce(function(e,t){var r=t.getAttribute("font-family");if(r){e[r]=true}return e},{})}function Qr(e,t){var r=e.split("/");var i=t.split("/");while(i[0]===".."){r.pop();i.shift()}return r.concat(i).join("/")}function ei(){var e=lr();var t=e.location;var r=e.styleSheets;if(!t){return[]}var i=t.protocol;var n=t.host;var a=t.pathname;var o=i+"//"+n+er(a);var s=/url\(['"]?([^)'"']*)['"]?\)/g;return ri(r,function(e,t){var r=t.href;var i=t.cssRules;ti(i,function(t){if(Kr(t)){var i=t.cssText;if(r&&r.indexOf(n)!==-1){r=er(r.replace(o,""));i=i.replace(s,function(e,t){if(!Qt(t)){return e.replace(t,Qr(r,t))}else{return e}})}e.push({rule:i,href:r})}});return e},[])}function ti(e,t,r){return Array.prototype.forEach.call(e,t,r)}function ri(e,t,r){return Array.prototype.reduce.call(e,t,r)}var ii=function e(){this.list=new Int32Array(8);this.size=0;this.capacity=this.list.length};ii.prototype.add=function e(t){if(this.size===this.capacity){var r=new Int32Array(this.capacity*2);r.set(this.list);this.list=r;this.capacity=this.list.length}this.list[this.size]=t;this.size+=1};ii.prototype.addIfMissing=function e(t){if(!this.has(t)){this.add(t);return true}return false};ii.prototype.remove=function e(t){if(this.size===0){return false}var r=this.list.lastIndexOf(t,this.size-1);if(r!==-1){this.size-=1;this.list[r]=this.list[this.size];return true}return false};ii.prototype.has=function e(t){return this.size!==0&&this.list.lastIndexOf(t,this.size-1)!==-1};ii.prototype.clear=function e(){this.size=0};ii.prototype.pop=function e(){this.size-=1;return this.list[this.size]};var ni={};function ai(e){return typeof e==="number"&&isNaN(e)}var oi=function e(){this._keys=[];this._values=[]};oi.prototype.set=function e(t,value){var r=this._getIndex(t);if(r===-1){this._keys.push(t.slice());this._values.push(value);return true}else{this._values[r]=value;return false}};oi.prototype.get=function e(t){var r=this._getIndex(t);return r===-1?undefined:this._values[r]};oi.prototype.has=function e(t){return this._getIndex(t)!==-1};oi.prototype.delete=function e(t){var r=this._getIndex(t);if(r!==-1){this._keys.splice(r,1);this._values.splice(r,1);return true}else{return false}};oi.prototype.keys=function e(){return this._keys.map(function(e){return e.slice()})};oi.prototype.values=function e(){return this._values.slice()};oi.prototype._getIndex=function e(t){var r=this;for(var i=0;i<this._keys.length;++i){var n=r._keys[i];if(n.length===t.length){var a=true;for(var o=0;o<t.length;++o){var s=n[o],u=t[o];if(s!==u&&(!ai(s)||!ai(u))){a=false;break}}if(a){return i}}}return-1};var si=function e(){this.clear()};var ui={size:{configurable:true}};si.prototype.clear=function e(){this._keys=[];this._values=[];this._arrays=new oi;this._size=0};ui.size.get=function(){return this._size};si.prototype.delete=function e(t){if(bt(t)){if(this._arrays.delete(t)){this._size-=1;return true}else{return false}}else{var r=li(this,t);if(r===-1){return false}else{this._keys.splice(r,1);this._values.splice(r,1);this._size-=1;return true}}};si.prototype.get=function e(t){if(bt(t)){return this._arrays.get(t)}else{var r=li(this,t),value=r===-1?undefined:this._values[r];return value}};si.prototype.has=function e(t){return bt(t)?li(this,t)!==-1:this._arrays.has(t)};si.prototype.set=function e(t,value){if(bt(t)){if(this._arrays.set(t,value)){this._size+=1}}else{var r=li(this,t);if(r===-1){this._size+=1;this._keys.push(ai(t)?ni:t);this._values.push(value)}else{this._values[r]=value}}return this};si.prototype.keys=function e(){var e=this._keys.slice();for(var t=0;t<e.length;++t){if(e[t]===ni){e[t]=NaN}}return e.concat(this._arrays.keys())};si.prototype.values=function e(){return this._values.slice().concat(this._arrays.values())};Object.defineProperties(si.prototype,ui);function li(e,t){if(ai(t)){return e._keys.indexOf(ni)}else{return e._keys.indexOf(t)}}var fi=function e(){this._map=new Map;this._arrays=new oi};var hi={size:{configurable:true}};fi.prototype.clear=function e(){this._arrays=new oi;return this._map.clear()};fi.prototype.delete=function e(t){return bt(t)?this._arrays.delete(t):this._map.delete(t)};fi.prototype.get=function e(t){return bt(t)?this._arrays.get(t):this._map.get(t)};fi.prototype.set=function e(t,value){if(bt(t)){this._arrays.set(t,value)}else{this._map.set(t,value)}return this};fi.prototype.keys=function e(){return Array.from(this._map.keys()).concat(this._arrays.keys())};fi.prototype.values=function e(){return Array.from(this._map.values()).concat(this._arrays.values())};hi.size.get=function(){return this._map.size+this._arrays._keys.length};Object.defineProperties(fi.prototype,hi);var di=si;if(typeof Map!=="undefined"&&typeof Map.prototype.keys!=="undefined"&&typeof Map.prototype.values!=="undefined"){try{(new Map).keys().next();(new Map).values().next();di=fi}catch(e){}}var vi=di;var ci=8;var _i=function e(t){this._constructor=t;this._array=new t(ci);this._capacity=ci;this.length=0};_i.prototype.reserve=function e(t){if(this._capacity<t){t=Math.pow(2,Math.ceil(Math.log2(t+1)));var r=new this._constructor(t);r.set(this._array);this._capacity=t;this._array=r}};_i.prototype.has=function e(value){var t=gi(this._array,value,0,this.length);return t<this.length&&this._array[t]===value};_i.prototype.add=function e(value){var t=gi(this._array,value,0,this.length),r=t<this.length&&this._array[t]===value;if(!r){if(this.length===this._capacity){this.reserve(this.length+1)}this._array.copyWithin(t+1,t,this.length);this._array[t]=value;this.length+=1}return!r};_i.prototype.remove=function e(value){var t=gi(this._array,value,0,this.length),r=t<this.length&&this._array[t]===value;if(r){this._array.copyWithin(t,t+1,this.length);this.length-=1}return r};_i.prototype.removeByPosition=function e(t){if(t>=this.length){return false}this._array.copyWithin(t,t+1,this.length);this.length-=1;return true};_i.prototype.get=function e(t){return this._array[t]};_i.prototype.clear=function e(){this.length=0};_i.prototype.slice=function e(){return this._array.slice(0,this.length)};function gi(e,t,r,i){if(r===i){return r}else{var n=r+((i-r)/2|0),value=e[n],a=t-value;if(a===0){return n}else if(a<0){return gi(e,t,r,n)}else{return gi(e,t,n+1,i)}}}function pi(e,t,r,i,n,a){a=a||{};var o=distance(e,t,r,i),s=(r-e)/o,u=(i-t)/o,l=.5*n*-u,f=.5*n*s;a.x1=e-l;a.y1=t-f;a.x2=e+l;a.y2=t+f;return a}function yi(e,t,r,i,n,a,o,s,u){if(s===void 0)s=0;if(u===void 0)u=false;var l=distance(r,i,n,a),f=o/2*(u?distance(e,t,n,a)/l:1),h=(f+s)/l,d=(n-r)*h,v=(a-i)*h,c=r+v,_=i-d,g=r-v,p=i+d,y=n-v,m=a+d,b=n+v,x=a-d;var A=e-c,w=t-_,S=g-c,E=p-_,T=b-c,M=x-_;var C=A*S+w*E,k=S*S+E*E,N=A*T+w*M,I=T*T+M*M;return C>0&&C<k&&N>0&&N<I}function mi(e,t,r,i,n,a){var o=n-r,s=a-i;return(s*e-o*t+n*i+n*a)/Math.sqrt(o*o+s*s)}function bi(e,t,r,i,n,a){return Math.abs(mi(e,t,r,i,n,a))}function xi(e,t,r,i,n,a){var o=n-r,s=a-i,u=s/o,l=i-u*r,f,h;if(o===0){f=r;h=t}else{f=(o*e+s*t-l*s)/(o+u*s);h=u*f+l}return{x:f-e,y:h-t}}function Ai(e,t,r,i,n){if(n&&(wi(e,r)||wi(e,i)||wi(t,r)||wi(t,i))){return false}var a=(e.y-r.y)*(i.x-r.x)-(e.x-r.x)*(i.y-r.y),o=(t.x-e.x)*(i.y-r.y)-(t.y-e.y)*(i.x-r.x);if(o===0){return false}var s=a/o;a=(e.y-r.y)*(t.x-e.x)-(e.x-r.x)*(t.y-e.y);var u=a/o;return!(s<=0||s>=1||u<=0||u>=1)}function wi(e,t){return e.x===t.x&&e.y===t.y}function Si(e,t,r,i){return Math.atan2(i-t,r-e)}function Ei(e,t,r,i,n,a){a=a||{};var o=distance(e,t,r,i),s=(r-e)/o,u=(i-t)/o;a.x=n*-u;a.y=n*s;return a}function Ti(e,t,r,i,n,a){a=a||{};var o=distance(e,t,r,i);a.x=(r-e)/o*n;a.y=(i-t)/o*n;return a}function Mi(e,t,r,i,n,a){return e>=r&&e<=n&&t>=i&&t<=a}function Ci(e,t,r,i,n,a,o,s){var u,l,f;var h=(s-a)*(r-e)-(o-n)*(i-t);if(h===0){return null}u=t-a;l=e-n;f=(o-n)*u-(s-a)*l;u=f/h;return{x:e+u*(r-e),y:t+u*(i-t)}}function ki(e,t,r,i,n,a,o,s){var u;var l=[];u=Ci(e,t,r,i,n,a,n,s);if(u){l.push(u)}u=Ci(e,t,r,i,n,s,o,s);if(u){l.push(u)}u=Ci(e,t,r,i,o,s,o,a);if(u){l.push(u)}u=Ci(e,t,r,i,o,a,n,a);if(u){l.push(u)}return l}function Ni(e,t,r,i,n){var a=n[0];var o=n[1];var s=n[2];var u=n[3];var l=0,f=1;var h=r-e,d=i-t;var v,c,_;for(var g=0;g<4;g++){if(g===0){v=-h;c=-(a-e)}if(g===1){v=h;c=o-e}if(g===2){v=-d;c=-(s-t)}if(g===3){v=d;c=u-t}_=c/v;if(v===0&&c<0){return null}if(v<0){if(_>f){return null}else if(_>l){l=_}}else if(v>0){if(_<l){return null}else if(_<f){f=_}}}return[[e+l*h,t+l*d],[e+f*h,t+f*d]]}function Ii(e,t,r,i,n,a,o,s){var u,l,f,h,d,v={x:null,y:null,onLine1:false,onLine2:false};u=(s-a)*(r-e)-(o-n)*(i-t);if(u===0){return v}l=t-a;f=e-n;h=(o-n)*l-(s-a)*f;d=(r-e)*l-(i-t)*f;l=h/u;f=d/u;v.x=e+l*(r-e);v.y=t+l*(i-t);if(l>0&&l<1){v.onLine1=true}if(f>0&&f<1){v.onLine2=true}return v}function zi(e,t,r,i,n,a){var o=n-r,s=a-i;if(o===0&&s===0){return{x:r,y:i}}if(o===0){return{x:r,y:t}}if(s===0){return{x:e,y:i}}var u=s/o,l=-(o/s),f=(r*u-e*l+t-i)/(u-l),h=u*f+i-r*u;return{x:f,y:h}}function Li(e,t){var r=t.x-e.x,i=t.y-e.y;return{x:(e.x+t.x)/2,y:(e.y+t.y)/2,length:Math.sqrt(r*r+i*i),angle:Math.atan2(-i,r)}}function Ri(e,t,r,i,n,a){a=a||{x:0,y:0};var o=Math.cos(n),s=Math.sin(n),u=e-r,l=t-i;a.x=o*u-s*l+r;a.y=s*u+o*l+i;return a}function Di(e,t,r,i){if(r===void 0)r=0;if(i===void 0)i={};var n=e.x;var a=e.y;i.x=n+r*Math.sin(t);i.y=a+r*Math.cos(t);return i}function distance(e,t,r,i){return Math.sqrt((e-r)*(e-r)+(t-i)*(t-i))}function Fi(e,t,r,i){var n=e-r;var a=t-i;return n*n+a*a}function Pi(e,t,r,i,n,a){return e-r>=i-a&&e+r>=i+a&&t-r>=n-a&&t+r>=n+a}function Bi(e,t){return(e.y-t.y)/(e.x-t.x)}function Oi(e,t,r){var i=Si(e.x,e.y,t.x,t.y)-Si(r.x,r.y,t.x,t.y);if(i<0){i+=2*Math.PI}return i}function Vi(e){return e/180*Math.PI}function ji(e){return e*180/Math.PI}function Ui(e,t){e.minX-=t;e.minY-=t;e.maxX+=t;e.maxY+=t;e.width+=2*t;e.height+=2*t;return e}function Gi(e,t,r,i,n,a){a=a||{};var o=distance(e,t,r,i);if(o===0){a.x=n;a.y=0}else{var s=n/distance(e,t,r,i);a.x=(r-e)*s;a.y=(i-t)*s}return a}function Xi(e,t,r,i){return e*r+t*i}function Wi(e,t){return Math.sqrt(e*e+t*t)}var Hi=["x","y","ax","ay","zx","zy","ox","oy"];function Yi(){this.x=0;this.y=0;this.ax=0;this.ay=0;this.zx=0;this.zy=0;this.ox=0;this.oy=0}Yi.prototype.reset=function(){var e=this;for(var t=0;t<Hi.length;++t){e[Hi[t]]=0}return this};Yi.prototype.add=function(e){var t=this;for(var r=0;r<Hi.length;++r){var i=Hi[r];t[i]+=e[i]}return this};Yi.prototype.mergeCoordinates=function(){return{x:this.x+this.zx+this.ax+this.ox,y:this.y+this.zy+this.ay+this.oy}};Yi.prototype.set=function(e){var t=this;if(e instanceof Yi){for(var r=0;r<Hi.length;++r){var i=Hi[r];t[i]=e[i]}}else{wt(e,function(value,e){this[e]=value},this)}return this};Yi.prototype.setAll=function(e,t,r,i,n,a,o,s){this.x=e;this.y=t;this.ax=n;this.ay=a;this.zx=r;this.zy=i;this.ox=o;this.oy=s;return this};Yi.prototype.setXY=function(e,t){this.x=e;this.y=t;return this};Yi.prototype.setZXY=function(e,t){this.zx=e;this.zy=t;return this};Yi.prototype.setAXY=function(e,t){this.ax=e;this.ay=t;return this};Yi.prototype.setOXY=function(e,t){this.ox=e;this.oy=t;return this};Yi.prototype.addXY=function(e,t){this.x+=e;this.y+=t;return this};Yi.prototype.addZXY=function(e,t){this.zx+=e;this.zy+=t;return this};Yi.prototype.addOXY=function(e,t){this.ox+=e;this.oy+=t;return this};Yi.prototype.clone=function(){return(new Yi).setAll(this.x,this.y,this.zx,this.zy,this.ax,this.ay,this.ox,this.oy)};function qi(e,t,r,i,n,a){var o=e,s=t;r.x=o.x-s.x;r.y=o.y-s.y;r.ax=o.ax-s.ax;r.ay=o.ay-s.ay;r.zx=o.zx-s.zx;r.zy=o.zy-s.zy;r.ox=o.ox-s.ox;r.oy=o.oy-s.oy;i.x=o.x+s.x;i.y=o.y-s.y;i.ax=o.ax+s.ax;i.ay=o.ay-s.ay;i.zx=o.zx+s.zx;i.zy=o.zy-s.zy;i.ox=o.ox+s.ox;i.oy=o.oy-s.oy;n.x=o.x+s.x;n.y=o.y+s.y;n.ax=o.ax+s.ax;n.ay=o.ay+s.ay;n.zx=o.zx+s.zx;n.zy=o.zy+s.zy;n.ox=o.ox+s.ox;n.oy=o.oy+s.oy;a.x=o.x-s.x;a.y=o.y+s.y;a.ax=o.ax-s.ax;a.ay=o.ay+s.ay;a.zx=o.zx-s.zx;a.zy=o.zy+s.zy;a.ox=o.ox-s.ox;a.oy=o.oy+s.oy}var Zi={x:0,y:0};function $i(e,t,r,i,n,a,o,s){Gi(e.x,e.y,t.x,t.y,.5,Zi);n.x=e.x-Zi.y*r;n.y=e.y+Zi.x*r;n.ax=e.ax-Zi.y*i;n.ay=e.ay+Zi.x*i;n.zx=e.zx;n.zy=e.zy;n.ox=e.ox;n.oy=e.oy;a.x=e.x+Zi.y*r;a.y=e.y-Zi.x*r;a.ax=e.ax+Zi.y*i;a.ay=e.ay-Zi.x*i;a.zx=e.zx;a.zy=e.zy;a.ox=e.ox;a.oy=e.oy;s.x=t.x-Zi.y*r;s.y=t.y+Zi.x*r;s.ax=t.ax-Zi.y*i;s.ay=t.ay+Zi.x*i;s.zx=t.zx;s.zy=t.zy;s.ox=t.ox;s.oy=t.oy;o.x=t.x+Zi.y*r;o.y=t.y-Zi.x*r;o.ax=t.ax+Zi.y*i;o.ay=t.ay-Zi.x*i;o.zx=t.zx;o.zy=t.zy;o.ox=t.ox;o.oy=t.oy}function Ki(e){var t=this;Array.call(this);Object.defineProperty(this,"__internalCounter",{value:{},writable:true});for(var r=0;r<e;++r){t.push(new Yi)}for(r=0;r<Hi.length;++r){Ji(t,Hi[r])}for(r=0;r<Qi.length;++r){t.__internalCounter[Qi[r]]=0}}Ki.prototype=Object.create(Array.prototype);Ki.prototype.constructor=Ki;function Ji(e,t){Object.defineProperty(e,t,{get:function(){var e=this;var r=new Array(this.length);for(var i=0;i<this.length;++i){r[i]=e[i][t]}return r},set:function(value){var e=this;for(var r=0;r<this.length;++r){e[r][t]=value}},enumerable:false})}var Qi=["setXY","setZXY","setAXY","setOXY"];Ki.prototype.reset=function(){var e=this;for(var t=0;t<Qi.length;++t){e.__internalCounter[Qi[t]]=0}for(t=0;t<this.length;++t){e[t].reset()}return this};for(var en=0;en<Qi.length;++en){tn(Qi[en])}function tn(e){Ki.prototype[e]=function(t,r){this[this.__internalCounter[e]][e](t,r);this.__internalCounter[e]+=1;if(this.__internalCounter[e]===this.length){this.__internalCounter[e]=0}return this}}Ki.prototype.mergeCoordinates=function(){var e=this;var t=[];for(var r=0;r<this.length;++r){t.push(e[r].mergeCoordinates())}return t};Ki.prototype.getXYList=function(){var e=this;var t=new Array(this.length);for(var r=0;r<this.length;++r){t[r]={x:e[r].x,y:e[r].y}}return t};var rn=[];var nn=[RegExp,Date];if(typeof HTMLElement!=="undefined"){rn.push(HTMLElement)}function an(e,t){for(var r=0;r<t.length;++r){if(e instanceof t[r]){return true}}return false}var on=function(e){return typeof e!=="object"||e===null||bt(e)||an(e,nn)};function sn(e,t,r,i){if(t===void 0)t=on;if(r===void 0)r=[];if(i===void 0)i=[];if(an(e,rn)){return}if(t(e)){r.push({path:i.slice(),value:e})}else{var n=Object.keys(e);for(var a=0;a<n.length;++a){var o=n[a],s=i.slice();s.push(o);sn(e[o],t,r,s)}}return r}var un=function e(){this._keys=[];this._values=[];this._size=0;this._cachedPath=[];this._cachedIndex=-1};var ln={size:{configurable:true}};ln.size.get=function(){return this._size};un.prototype.set=function e(t,value){var r=fn(this,t);if(r!==-1){this._values=value}else{if(hn(this._cachedPath,t)){this._cachedIndex=this._keys.length}this._keys.push(t);this._values.push(value);this._size+=1}};un.prototype.get=function e(t){var r=fn(this,t);if(r!==-1){return this._values[r]}else{return undefined}};un.prototype.has=function e(t){return fn(this,t)!==-1};un.prototype.keys=function e(){return this._keys.slice()};Object.defineProperties(un.prototype,ln);function fn(e,t){if(hn(t,e._cachedPath)){return e._cachedIndex}e._cachedPath=t.slice();for(var r=0;r<e._keys.length;++r){if(hn(e._keys[r],t)){e._cachedIndex=r;return r}}e._cachedIndex=-1;return-1}function hn(e,t){if(e.length!==t.length){return false}for(var r=0;r<e.length;++r){if(e[r]!==t[r]){return false}}return true}function dn(e,t,r,i,n,a,o,s,u){if(o===0){return e.rectangle(t,{x:r+n/2,y:i+a/2},{zx:n/2,zy:a/2},s,u)}else{var l=e.updateComposite(t,7);l[0]=e.quadrilateral(l[0],{x:r,y:i+o-1},{x:r+n,y:i+o-1},{x:r+n,y:i+a-o+1},{x:r,y:i+a-o+1},s,u);l[1]=e.quadrilateral(l[1],{x:r+o,y:i},{x:r+n-o,y:i},{x:r+n-o,y:i+o},{x:r+o,y:i+o},s,u);l[2]=e.quadrilateral(l[2],{x:r+o,y:i+a-o},{x:r+n-o,y:i+a-o},{x:r+n-o,y:i+a},{x:r+o,y:i+a},s,u);l[3]=e.circle(l[3],{x:r+o,y:i+o},0,o,s,u);l[4]=e.circle(l[4],{x:r+n-o,y:i+o},0,o,s,u);l[5]=e.circle(l[5],{x:r+o,y:i+a-o},0,o,s,u);l[6]=e.circle(l[6],{x:r+n-o,y:i+a-o},0,o,s,u);return e.composite(t,l)}}var vn=50;function cn(e,t,r,i,n,a,o,s){var u=e.updateComposite(t,vn),l=Math.PI*2/vn,f=a/2,h=l,d={x:r,y:i,zx:n,zy:0},v={x:r,y:i,zx:n,zy:0,ox:f,oy:0};for(var c=0;c<vn;++c){var _=Math.cos(h),g=Math.sin(h),p={x:r,y:i,zx:_*n,zy:g*n},y={x:r,y:i,zx:_*n,zy:g*n,ox:_*f,oy:g*f};u[c]=e.quadrilateral(u[c],d,p,y,v,o,s);d=p;v=y;h+=l}return e.composite(t,u)}var _n=function e(){this._values=[]};var gn={size:{configurable:true}};gn.size.get=function(){return this._values.length};_n.prototype.clear=function e(){this._values=[]};_n.prototype.add=function e(value){if(this._getIndex(value)===-1){this._values.push(value)}};_n.prototype.addMultiple=function e(t){var r=this;for(var i=0;i<t.length;++i){r.add(t[i])}};_n.prototype.remove=function e(value){var t=this._getIndex(value);if(t!==-1){this._values.splice(t,1)}};_n.prototype.has=function e(value){return this._getIndex(value)!==-1};_n.prototype.values=function e(){return this._values.slice()};_n.prototype._getIndex=function e(value){return this._values.indexOf(value)};Object.defineProperties(_n.prototype,gn);var pn=function e(){this._set=new Set};var yn={size:{configurable:true}};yn.size.get=function(){return this._set.size};pn.prototype.clear=function e(){this._set.clear()};pn.prototype.add=function e(value){this._set.add(value)};pn.prototype.addMultiple=function e(t){var r=this;for(var i=0;i<t.length;++i){r.add(t[i])}};pn.prototype.remove=function e(value){this._set.delete(value)};pn.prototype.has=function e(value){return this._set.has(value)};pn.prototype.values=function e(){return Array.from(this._set.values())};Object.defineProperties(pn.prototype,yn);var mn=_n;if(typeof Set!=="undefined"){mn=pn;if(!Set.prototype.values){mn.prototype.values=function(){var e=new Array(this._set.size);var t=0;this._set.forEach(function(value){return e[t++]=value});return e}}}var bn=mn;var xn=function e(t){this.size=0;this.totalSize=0;this.exists=[];this.attributes={exists:this.exists};this._attributesList=[this.exists];this._availableIndexes=[];this._nbAvailableIndexes=0;if(t){this.addAttributes(t)}};xn.prototype.addAttribute=function e(t){if(this.attributes[t]){throw new Error("Attribute "+t+" already exists.")}this.attributes[t]=[];this._attributesList.push(this.attributes[t])};xn.prototype.addAttributes=function e(t){var r=this;wt(t,function(e,t){r.addAttribute(t,e)})};xn.prototype.reserve=function e(){};xn.prototype.addElement=function e(){var t=this;var r;if(this._nbAvailableIndexes===0){r=this.size;this.totalSize+=1;for(var i=0;i<this._attributesList.length;++i){t._attributesList[i].push(0)}}else{this._nbAvailableIndexes-=1;r=this._availableIndexes[this._nbAvailableIndexes];for(i=0;i<this._attributesList.length;++i){t._attributesList[i][r]=0}}this.exists[r]=1;this.size+=1;return r};xn.prototype.removeElement=function e(t){if(this.size>0&&this.exists[t]){this.exists[t]=0;this.size-=1;this._availableIndexes[this._nbAvailableIndexes]=t;this._nbAvailableIndexes+=1;return true}return false};xn.prototype.clear=function e(){var t=this;this.size=0;this._nbAvailableIndexes=0;for(var r=0;r<this._attributesList.length;++r){t._attributesList[r].fill(0)}};xn.prototype.filter=function e(t){var r=this.attributes.exists,i=this.attributes[t];if(!i){throw new Error("attribute "+t+" does not exist")}var n=new Array(this.size),a=0;for(var o=0,s=this.totalSize;o<s;++o){if(r[a]){n[a]=i[o];a+=1}}return n};xn.prototype.getIndexList=function e(){var t=this.attributes.exists,r=new Array(this.size),i=0;for(var n=0,a=this.totalSize;n<a;++n){if(t[i]){r[i]=n;i+=1}}return r};xn.prototype.remove=xn.prototype.removeElement;xn.prototype.add=xn.prototype.addElement;var An=function e(t){this._isNode=t;this._name=t?"node":"edge";this._nextIndex=1;this._freeIndexes=[];this._idToIndex=Object.create(null);this._indexToId=[undefined];this._size=0;this._flexArrays=[];this._defaultValues=[];this._flexArraysByName={};this._indexes=[]};An.prototype.addElements=function e(t){var r=this;var i=[];for(var n=0,a=t.length;n<a;++n){var o=t[n],s=r._idToIndex[o];if(s===undefined){s=Sn(r);r._idToIndex[o]=s;r._indexToId[s]=o}i.push(s)}this._size+=t.length;for(var u=0;u<this._flexArrays.length;++u){r._flexArrays[u].increaseNbElements(r._size)}this._indexes=this.getAllIndexes();return i};An.prototype.removeElements=function e(t){var r=this;for(var i=0,n=t.length;i<n;++i){var a=t[i],o=r._indexToId[a];if(o!==undefined){delete r._idToIndex[o];wn(r,a);r._size-=1}}for(var s=0;s<this._flexArrays.length;++s){var u=r._flexArrays[s],l=r._defaultValues[s];for(var f=0,h=t.length;f<h;++f){u.set(t[f],l)}}this._indexes=this.getAllIndexes()};An.prototype.filterIds=function e(t){var r=this;var i=Object.create(null),n=[];for(var a=0,o=t.length;a<o;++a){var s=t[a];if(s in r._idToIndex&&!(s in i)){i[s]=0;n.push(r._idToIndex[s])}}return n};An.prototype.clear=function e(){var t=this;this._idToIndex=Object.create(null);this._indexToId=[undefined];this._size=0;this._nextIndex=1;this._freeIndexes=[];this._indexes=[];for(var r=0;r<this._flexArrays.length;++r){t._flexArrays[r].reset()}};An.prototype.has=function e(t){return this._indexToId[t]!==undefined};An.prototype.hasId=function e(t){return t in this._idToIndex};An.prototype.getIndex=function e(t,r){if(r===void 0)r=false;var i=this._idToIndex[t];if(i===undefined&&r){throw new Error(this._name+' id "'+t+'" not found')}return i};An.prototype.indexList=function e(t){var r=this;var i=new Array(t.length);for(var n=0,a=t.length;n<a;++n){var o=r._idToIndex[t[n]];if(o===undefined){throw new Error(r._name+' id "'+t[n]+'" not found')}i[n]=o}return i};An.prototype.getAllIndexes=function e(){var t=this;var r=this._nextIndex,i=this._freeIndexes.length,n=new Array(r);for(var a=0;a<r;++a){n[a]=a}for(var o=0;o<i;++o){var s=t._freeIndexes[o];for(var u=s;n[u]!==s;--u){}n.splice(u,1)}n.shift();return n};An.prototype.allIndexes=function e(){return this._indexes};An.prototype.createFlexArray=function e(t){var r=t.name;if(r&&this._flexArraysByName[r]){throw new Error(this._name+' flexArray "'+r+'" already exists')}var i=t.default;if(i===undefined&&t.storage!=="any"&&t.storage!=="resource"){i=0}var n=this._nextIndex;var a=new C({storage:t.storage,size:n,default:i,name:r});this._flexArrays.push(a);this._defaultValues.push(t.default);if(r){this._flexArraysByName[r]=a}return a};An.prototype.removeFlexArray=function e(t){if(typeof t==="string"){var r=t;t=this._flexArraysByName[r];delete this._flexArraysByName[r]}var i=this._flexArrays.indexOf(t);if(i!==-1){this._flexArrays.splice(i,1);this._defaultValues.splice(i,1)}};An.prototype.getFlexArray=function e(t){return this._flexArraysByName[t]||null};An.prototype.getAllFlexArrays=function e(){return this._flexArrays.slice()};An.prototype.getId=function e(t){return this._indexToId[t]};An.prototype.getIdList=function e(t,r){var i=this;if(!r){r=new Array(t.length)}for(var n=0;n<t.length;++n){r[n]=i._indexToId[t[n]]}return r};An.prototype.getMaxIndex=function e(){return this._nextIndex};function wn(e,t){e._indexToId[t]=undefined;e._freeIndexes.push(t)}function Sn(e){var t;if(e._freeIndexes.length){t=e._freeIndexes.pop()}else{t=e._nextIndex++}return t}var En=8;var Tn=function e(){this._BIG_LIST=new Uint8Array([-1])[0];this._MAX_LIST_SIZE=8;this._capacity=En;this._buffer=new Uint32Array(this._capacity*this._MAX_LIST_SIZE);this._sizes=new Uint8Array(this._capacity);this._bigLists=[];this._nextIndex=0;this._constList=new Array(this._MAX_LIST_SIZE)};Tn.prototype.addEntry=function e(t){if(t===undefined){t=this._nextIndex++}if(t>=this._capacity){this._expand(t+1)}this._sizes[t]=0;return t};Tn.prototype.get=function e(t){var r=this;var i=this._sizes[t],n=this._MAX_LIST_SIZE*t;if(i<=this._MAX_LIST_SIZE){this._constList.length=i;for(var a=0,o=i;a<o;++a){r._constList[a]=r._buffer[n+a]}return this._constList}else if(i===this._BIG_LIST){var s=this._buffer[n];return this._bigLists[s]}};Tn.prototype.size=function e(t){var e=this._sizes[t];return e<=this._MAX_LIST_SIZE?e:this._bigLists[this._buffer[t*this._MAX_LIST_SIZE]].length};Tn.prototype.sizes=function e(t){var e=this._sizes;var r=this._bigLists;var i=this._buffer;var n=this._MAX_LIST_SIZE;var a=t.length;var o=new Array(a);for(var s=0;s<a;s++){var u=t[s];var l=e[u];o[s]=l<=n?l:r[i[u*n]].length}return o};Tn.prototype.addTo=function e(t,value){var r=this;var i=this._sizes[t],n=t*this._MAX_LIST_SIZE;if(i<this._MAX_LIST_SIZE){this._buffer[n+i]=value;this._sizes[t]=i+1}else if(i===this._BIG_LIST){var a=this._buffer[n];this._bigLists[a].push(value)}else{var o=new Array(this._MAX_LIST_SIZE);for(var s=0;s<this._MAX_LIST_SIZE;++s){o[s]=r._buffer[n+s]}o.push(value);this._bigLists.push(o);this._sizes[t]=this._BIG_LIST;this._buffer[n]=this._bigLists.length-1}};Tn.prototype.removeFrom=function e(t,value){this.removeFromAndGetSize(t,value)};Tn.prototype.removeFromAndGetSize=function e(t,value){var r=this;var i=this._sizes[t],n=this._MAX_LIST_SIZE*t;if(i<=this._MAX_LIST_SIZE){for(var a=n,o=n+i;a<o;++a){if(r._buffer[a]===value){i-=1;r._buffer[a]=r._buffer[o-1];r._sizes[t]=i;return i}}}else if(i===this._BIG_LIST){var s=this._buffer[n],u=this._bigLists[s],l=u.indexOf(value);if(l!==-1){u.splice(l,1);return u.length}}throw new Error('topology: Table: "removeFrom" failed, should not happen')};Tn.prototype.reserve=function e(t){if(this._capacity<t){this._expand(t)}};Tn.prototype._expand=function e(t){this._capacity=Math.pow(2,Math.ceil(Math.log2(t)));this._buffer=Mn(this._buffer,this._capacity*this._MAX_LIST_SIZE);this._sizes=Mn(this._sizes,this._capacity)};function Mn(e,t){var r=new e.constructor(t);r.set(e);return r}var Cn=function e(t,r){this._graph=t;this._onUpdate=r;this._nodesToUpdate=this._graph._createIndexSet(true);this._edgesToUpdate=this._graph._createIndexSet(false);this._updateAll=false;this._timeout=null};Cn.prototype.updateAll=function e(){this._updateAll=true;Nn(this)};Cn.prototype.updateNodes=function e(t){this._nodesToUpdate.addMultiple(t);this._edgesToUpdate.addMultiple(this._graph._collectAdjacentEdges(t));Nn(this)};Cn.prototype.updateEdges=function e(t){this._edgesToUpdate.addMultiple(t);Nn(this)};function kn(e){var t,r;if(e._updateAll){t=e._graph._allIndexes(true).slice();r=e._graph._allIndexes(false).slice();e._nodesToUpdate.clear();e._edgesToUpdate.clear();e._updateAll=false}else{t=e._nodesToUpdate.clear();r=e._edgesToUpdate.clear()}e._timeout=null;e._onUpdate({nodes:t,edges:r})}function Nn(e){if(!e._timeout){e._timeout=setTimeout(kn,0,e)}}var In=ie("webworker-threads",{throwOnError:false});var zn=null;if(In){zn=In.Worker}function Ln(e){if(zn){return Fn(e)}else if(typeof URL==="undefined"||navigator.appVersion.indexOf("MSIE 10")!==-1){return Dn(e)}else{return Rn(e)}}function Rn(e){try{var t=new Blob([e],{type:"application/javascript"}),r=URL.createObjectURL(t),i=new Worker(r);return i}catch(t){return new Pn(e)}}function Dn(e){return new Pn(e)}function Fn(e){return new zn(new Function(e))}var Pn=function e(t){this._f=new Function("self",t);this._main=true;this._listeners=[];this._terminated=false;this._otherSide=new Bn(this);this._f(this._otherSide)};Pn.prototype.terminate=function e(){this._terminated=false;this._otherSide._terminated=true};Pn.prototype.addEventListener=On;Pn.prototype.postMessage=Vn;var Bn=function e(t){this._main=false;this._listeners=[];this._terminated=false;this._otherSide=t};Bn.prototype.addEventListener=On;Bn.prototype.postMessage=Vn;function On(e,t){this._listeners.push(t)}function Vn(e){setTimeout(jn,0,this._otherSide,{data:e})}function jn(e,t){if(e._terminated){return}for(var r=0;r<e._listeners.length;++r){e._listeners[r](t)}}function Un(e,t){for(var r=1,i=e.length;r<i;r++){var n=e[r],a=r;while(t[e[a-1]]>t[n]){e[a]=e[a-1];--a}e[a]=n}return e}function Gn(e,t){for(var r=1,i=e.length;r<i;r++){var n=e[r],a=r;while(t[e[a-1]]<t[n]){e[a]=e[a-1];--a}e[a]=n}return e}var Xn=function e(t){this._name=t;this._attributes={};this._children=[]};var Wn={tagName:{configurable:true},children:{configurable:true},childNodes:{configurable:true},firstChild:{configurable:true}};Xn.prototype.setAttribute=function e(t,value){this._attributes[t]=value};Xn.prototype.appendChild=function e(t){this._children.push(t)};Wn.tagName.get=function(){return this._name};Wn.children.get=function(){return this._children};Wn.childNodes.get=function(){return this._children};Wn.firstChild.get=function(){return this._children[0]||null};Xn.prototype.serialize=function e(){var t=this._name;var r=this._attributes;var i=this._children;var n=Object.keys(r).filter(function(e){return r[e]!==undefined});var a=n.map(function(e){return" "+e+'="'+(""+r[e])+'"'}).join("");var o=i.map(function(e){return e.serialize()}).join("");if(!o.length){return"<"+t+a+"/>"}else{return"<"+t+a+">"+o+"</"+t+">"}};Xn.prototype.cloneNode=function e(t){var r=this;var i=new Xn(this._name);for(var n in r._attributes){i.setAttribute(n,r._attributes[n])}if(t){for(var a=0;a<this._children.length;a++){i.appendChild(r._children[a].cloneNode(t))}}return i};Object.defineProperties(Xn.prototype,Wn);var Hn=function e(t){this._text=t};Hn.prototype.serialize=function e(){return this._text};Hn.prototype.cloneNode=function e(){return new Hn(this._text)};var Yn=function e(){this._children=[];this._meta=[]};Yn.prototype.appendChild=function e(t){this._children.push(t)};Yn.prototype.serialize=function e(){return this._meta.concat(this._children.map(function(e){return e.serialize()})).join("")};Yn.prototype.createElement=function e(t){return new Xn(t)};Yn.prototype.createTextNode=function e(t){return new Hn(t)};function qn(){return new Yn}var Zn=Object.freeze({FlexArray:C,EventTarget:F,ColorManager:U,requestAnimFrame:W,cancelAnimFrame:H,transparentEvents:J,getBrowser:Q,getDocument:lr,getStyle:fr,getXmlSerializerClass:hr,getCanvasFactory:dr,getWebglContext:vr,DummyCanvas:gr,createDummyDomElement:br,createDomElement:xr,createDomElementNS:Ar,createXmlDocument:wr,serializeXMLDocument:Sr,createCanvas:Er,getPixelRatio:Tr,dataUrlToBlob:Mr,createBlob:kr,isBlob:Nr,promptDownload:Ir,resizeElement:zr,setAttributes:Lr,createSvgElement:Rr,createTextNode:Dr,bindEvt:Fr,unbindEvt:Pr,getImage:Br,fetch:Vr,isHTMLElement:jr,applyCursorStyle:Ur,getBoundingClientRect:Gr,onFontsReady:Xr,onBeforeUnload:Wr,fetchBinary:Hr,getExternalFontData:Yr,embedBase64FontIntoStyle:qr,getFontBase64Data:Zr,fetchBinaryAsBase64:$r,isFontFaceRule:Kr,getUsedFontsMapForSVG:Jr,getCSSFontRules:ei,eachNode:ti,reduceNodeList:ri,getClosestValue:de,isPowerOfTwo:ve,isInteger:ce,computeRange:_e,findFunctionParameter:pe,getUpperPowerOf:ye,getUpperPowerOfTwo:me,clamp:be,mix:xe,createCounter:Ae,convertToString:we,toPropertyPath:Se,throttle:Ee,debounce:Te,processQueue:Ce,getFunctionBody:ke,convertToFloat:Ie,isParsableNumber:ze,isLittleEndian:Le,removeFromArray:Re,computeMax:De,computeMin:Fe,forEach:wt,reduce:St,map:Et,merge:Tt,shallowCopy:Mt,stringify:Ct,deepCopy:kt,updateObject:Nt,extendList:It,propertyAccess:zt,hasProperty:Lt,setPathValue:Rt,bindProperty:Ft,unbindProperty:Pt,concat:Bt,removeDuplicates:Ot,setReadOnly:Vt,isNotNative:Gt,destroy:Xt,flatten:Wt,setProperty:Ht,unflatten:Yt,getFlattenedKeys:qt,ensureTransferrable:Zt,getOptions:$t,Position:Yi,PositionList:Ki,rectangleFromCenterAndDimensions:qi,lineFromBoundaries:$i,PathMap:un,objToValueList:sn,roundedRect:dn,circleStroke:cn,smartRequire:ie,getCurrentTime:oe,now:se,getDate:ue,getTime:le,createDelayer:he,isBool:Pe,isNumber:Be,isPositive:Oe,isStrictPositive:Ve,isString:je,isText:Ue,isColor:Ge,isInheritableColor:Xe,isSourceTargetInheritableColor:We,isFontStyle:He,isTextAlign:Ye,isNodeShape:qe,isEdgeType:Ze,isEdgeExtremity:$e,isEdgeStyle:Ke,isTextPosition:Je,isColorOrArrayOfColors:Qe,createCheckSizeFunction:et,createWorker:Ln,insertSortAsc:Un,insertSortDesc:Gn,parseColorRgba:O,toHexa:V,parseColorHex:j,createDummyXmlDocument:qn});function circleCircleIntersection(e,t,r,i,n,a){var o,s,u,l,f,h,d;var v,c;s=i-e;u=n-t;l=Math.sqrt(s*s+u*u);if(l>r+a){return null}if(l<Math.abs(r-a)){return null}o=(r*r-a*a+l*l)/(2*l);v=e+s*o/l;c=t+u*o/l;f=Math.sqrt(r*r-o*o);h=-u*(f/l);d=s*(f/l);return[[v+h,c+d],[v-h,c-d]]}function circleSortCompare(e,t,r,i,n,a){if(e-n>=0&&r-n<0){return 1}if(e-n<0&&r-n>=0){return-1}if(e-n===0&&r-n===0){return t-i>=0||i-a>=0?t-i:i-t}var o=(e-n)*(i-a)-(r-n)*(t-a);if(o<0){return 1}if(o>0){return-1}var s=(e-n)*(e-n)+(t-a)*(t-a);var u=(r-n)*(r-n)+(i-a)*(i-a);return s-u}function $n(e,t,r){var i=e[2];var n=Math.abs(e[0]-t),a=Math.abs(e[1]-r);if(n+a<=i){return true}if(n>i||a>i){return false}return Math.sqrt(n*n+a*a)<i+1e-12}function Kn(e,t,r,i){var n=e[0]-t,a=e[1]-r,o=e[2]-i;return n*n+a*a<o*o+1e-6}function Jn(e,t){var r=Math.max(t.minX,Math.min(t.maxX,e[0]));var i=Math.max(t.minY,Math.min(t.maxY,e[1]));var n=e[0]-r;var a=e[1]-i;var o=n*n+a*a;return o<e[2]*e[2]}function Qn(e,t,r,i,n,a,o,s){var u=s||{x:0,y:0};var l,f,h,d;if(r===e){var v=e-n;var c=o*o-v*v;if(c<0){return null}var _=Math.sqrt(c);l=e;h=e;f=a+_;d=a-_}else{var g=(i-t)/(r-e);var p=t-g*e;var y=p-a;var m=g*g+1;var b=2*(g*y-n);var x=n*n+y*y-o*o;var A=b*b-4*m*x;if(A<0){return null}var w=-b;var S=Math.sqrt(A);var E=2*m;l=(w+S)/E;h=(w-S)/E;f=g*l+p;d=g*h+p}var T=e-l;var M=t-f;var C=e-h;var k=t-d;if(T*T+M*M<C*C+k*k){u.x=l;u.y=f}else{u.x=h;u.y=d}return u}function ea(e,t,r,i,n,a){return 1/2*(-i*n+t*(-r+n)+e*(i-a)+r*a)}function ta(e,t,r,i,n,a,o,s){var u=ea(r,i,n,a,o,s);var l=1/(2*u)*(i*o-r*s+(s-i)*e+(r-o)*t);var f=1/(2*u)*(r*a-i*n+(i-a)*e+(n-r)*t);return l>0&&f>0&&1-l-f>0}function ra(e,t,r,i,n,a){var o=distance(r,i,n,a),s=distance(e,t,n,a),u=distance(e,t,r,i),l=o+s+u;if(l===0){return{x:e,y:t}}else{return{x:(o*e+s*r+u*n)/l,y:(o*t+s*i+u*a)/l}}}function ia(e,t,r,i,n,a){return{x:(e+r+n)/3,y:(t+i+a)/3}}function na(e,t,r,i,n,a){return e>=r&&e<=n&&t>=i&&t<=a}function aa(e,t,r,i){if(i===undefined){i=r.length}var n=i-1,a=false;for(var o=0;o<i;++o){if((r[o].y<t&&r[n].y>=t||r[n].y<t&&r[o].y>=t)&&(r[o].x<=e||r[n].x<=e)){a^=r[o].x+(t-r[o].y)/(r[n].y-r[o].y)*(r[n].x-r[o].x)<e}n=o}return a}function oa(e,t){if(e<0){e+=t}else if(e>=t){e-=t}return e}function sa(e){for(var t=0;t<e.length;++t){if(ua(e,t)){return t}}return 0}function ua(e,t){var r=oa(t-1,e.length),i=oa(t+1,e.length),n=Oi(e[r],e[t],e[i]);if(n>Math.PI){return false}for(var a=0;a<e.length;++a){if(a===t||a===r||a===i){continue}if(ta(e[a].x,e[a].y,e[r].x,e[r].y,e[i].x,e[i].y,e[t].x,e[t].y)){return false}}return true}function la(e){if(e.length===3){return[[e[0].index,e[1].index,e[2].index]]}var t=sa(e),r=[e[oa(t-1,e.length)].index,e[t].index,e[oa(t+1,e.length)].index];e.splice(t,1);var i=la(e);i.push(r);return i}function fa(e){var t=e.length,r=(t-2)*Math.PI,i=0;for(var n=0;n<t;++n){var a=Oi(e[oa(n-1,t)],e[n],e[oa(n+1,t)]);i+=a}var o=e.slice();for(n=0;n<o.length;++n){o[n].index=n}if(i-1e-4>r){o.reverse()}return la(o)}function ha(e){var t=e.x*e.x+e.y*e.y;return{x:e.x/t,y:e.y/t}}function da(e,t){var r=Infinity;var i=-Infinity;for(var n=0,a=e.length;n<a;n++){var o=e[n];var s=o.x*t.x+o.y*t.y;if(s<r){r=s}if(s>i){i=s}}return{x:r,y:i}}function va(e,t){var r=new Array(4);var i,n,a,o;i=e[1],n=e[0];a=ha({x:i.x-n.x,y:i.y-n.y});o=a.x;a.x=-a.y;a.y=o;r[0]=a;i=e[2];n=e[1];a=ha({x:i.x-n.x,y:i.y-n.y});o=a.x;a.x=-a.y;a.y=o;r[1]=a;i=t[1];n=t[0];a=ha({x:i.x-n.x,y:i.y-n.y});o=a.x;a.x=-a.y;a.y=o;r[2]=a;i=t[2];n=t[1];a=ha({x:i.x-n.x,y:i.y-n.y});o=a.x;a.x=-a.y;a.y=o;r[3]=a;return r}function ca(e,t){var r=va(e,t);for(var i=0,n=r.length;i<n;i++){var a=r[i];var o=da(e,a);var s=da(t,a);var u=o.x<=s.y&&o.y>=s.x?Math.min(o.y,s.y)-Math.max(o.x,s.x):0;if(u===0){return false}}return true}var _a=0;var ga=1;var pa=2;var ya=3;var ma=4;var ba=5;var xa=6;var Aa=7;var wa=8;var Sa=9;var Ea=10;var Ta=0;var Ma=1;var Ca=2;var ka=3;var Na=0;var Ia=1;var za=2;var La=3;var Ra=4;var Da=5;var Fa=6;var Pa=1e-5;var Ba=Math.PI;var Oa=Math.PI*2;var Va=Ba*(5/4);var ja=Ba*(7/4);var Ua=Ba*(3/4);var Ga=Ba*(1/4);var Xa=1;var Wa=.17;var Ha=1;var Ya=-Math.PI/2;var qa=Math.PI/2;var Za=3;var $a=-Math.PI/4;var Ka=7;var Ja=41;var Qa=10;var eo=2/3;var to={plain:{dash:0,gap:0},dashed:{dash:3,gap:1},dotted:{dash:1,gap:3}};var ro={right:0,top:-Math.PI/2,left:Math.PI,bottom:Math.PI/2,center:0};var io={right:Math.PI,top:-Math.PI/2,left:0,bottom:Math.PI/2,center:0};function no(e,t,r,i,n,a){if(a===void 0)a={};var o=(e+r)/2;var s=(t+i)/2;var u=r-e;var l=i-t;var f=Math.sqrt(u*u+l*l)+Pa;var h=l/f;var d=-u/f;var v=n*(f/Qa)*2;a.x=o+h*v;a.y=s+d*v;return a}function ao(e,t,r,i){i=i||{};i.x1=e-r*Ka;i.y1=t;i.x2=e;i.y2=t+r*Ka;return i}function oo(e,t,r,i,n){return ao(e,t,i+r,n)}function so(e,t,r,i,n,a,o,s){s=s||{};s.x=(1-e)*(1-e)*t+2*(1-e)*e*a+e*e*i;s.y=(1-e)*(1-e)*r+2*(1-e)*e*o+e*e*n;return s}function uo(e,t,r,i,n,a,o,s,u,l,f){if(l===void 0)l=0;if(f===void 0)f=false;var h=r-2*o+n;var d=2*o-2*r;var v=r-e;var c=i-2*s+a;var _=2*s-2*i;var g=i-t;var p=-(v*c-g*h)/(d*c-_*h);if(p<0||p>1){return false}var y=u/2;if(f){y*=1-p}y+=l;var m=lo(p,r,n,o);var b=lo(p,i,a,s);return distance(m,b,e,t)<=y}function lo(e,t,r,i){var n=1-e;return n*n*t+2*n*e*i+e*e*r}function fo(e,t,r,i,n,a,o,s,u,l){l=l||{};var f=(1-e)*(1-e)*(1-e),h=3*e*(1-e)*(1-e),d=3*e*e*(1-e),v=e*e*e;l.x=f*t+h*a+d*s+v*i;l.y=f*r+h*o+d*u+v*n;return l}function ho(e,t,r,i,n,a,o,s,u,l,f,h){var d=distance(r,i,o,s);if(Math.abs(e-r)>d||Math.abs(t-i)>d){return false}var v=distance(e,t,r,i),c=distance(e,t,n,a),_=.5,g=v<c?-.01:.01,p=.001,y=100,m=fo(_,r,i,n,a,o,s,u,l),b=distance(e,t,m.x,m.y),x;var A=f/2+h;while(y-- >0&&_>=0&&_<=1&&b>A&&(g>p||g<-p)){x=b;fo(_,r,i,n,a,o,s,u,l,m);b=distance(e,t,m.x,m.y);if(b>x){g=-g/2;_+=g}else if(_+g<0||_+g>1){g=g/2;b=x}else{_+=g}}return b<A}function vo(e,t,r,i,n,a){var o=Math.sqrt,s=Math.log,u=e-2*r+n,l=t-2*i+a,f=2*r-2*e,h=2*i-2*t,d=4*(u*u+l*l),v=4*(u*f+l*h),c=f*f+h*h,_=2*o(d+v+c),g=o(d),p=2*d*g,y=2*o(c),m=v/g;return(p*_+g*v*(_-y)+(4*c*d-v*v)*s((2*g+m+_)/(m+y)))/(4*p)}var co=100;var _o=1/co;var go={};function po(e,t,r,i,n,a,o,s){var u=0,l=e,f=t;for(var h=_o;h<=1;h+=_o){fo(h,e,t,o,s,r,i,n,a,go);u+=distance(l,f,go.x,go.y);l=go.x;f=go.y}return u}function yo(e,t,r,i,n,a,o){var s=e+2/3*(r-e);var u=t+2/3*(i-t);var l=s+1/3*(n-e);var f=u+1/3*(a-t);return mo(e,t,s,u,l,f,n,a,o)}function mo(e,t,r,i,n,a,o,s,u){if(u===void 0)u={};var l=Math.min;var f=Math.max;var h=Math.sqrt;var d,v,c,_,g;u.minX=l(e,o);u.maxX=f(e,o);u.minY=l(t,s);u.maxY=f(t,s);for(var p=void 0,y=void 0,m=void 0,b=void 0,x=void 0,A=void 0,w=void 0,S=0;S<2;++S){if(S===0){v=e;c=r;_=n;g=o}else{v=t;c=i;_=a;g=s}y=6*v-12*c+6*_;p=-3*v+9*c-9*_+3*g;m=3*c-3*v;y=y|0;p=p|0;m=m|0;if(p===0){if(y===0){continue}b=-m/y;if(b>0&&b<1){d=bo(b,v,c,_,g);if(S===0){u.minX=l(u.minX,d);u.maxX=f(u.maxX,d)}else{u.minY=l(u.minY,d);u.maxY=f(u.maxY,d)}}continue}x=y*y-4*m*p;if(x<0){continue}A=(-y+h(x))/(2*p);if(A>0&&A<1){d=bo(A,v,c,_,g);if(S===0){u.minX=l(u.minX,d);u.maxX=f(u.maxX,d)}else{u.minY=l(u.minY,d);u.maxY=f(u.maxY,d)}}w=(-y-h(x))/(2*p);if(w>0&&w<1){d=bo(w,v,c,_,g);if(S===0){u.minX=l(u.minX,d);u.maxX=f(u.maxX,d)}else{u.minY=l(u.minY,d);u.maxY=f(u.maxY,d)}}}return u}function bo(e,t,r,i,n){return Math.pow(1-e,3)*t+3*Math.pow(1-e,2)*e*r+3*(1-e)*Math.pow(e,2)*i+Math.pow(e,3)*n}function xo(e,t,r,i,n,a,o,s){if(n===void 0)n=0;if(a===void 0)a=Math.sin(n);if(o===void 0)o=Math.cos(n);if(s===void 0)s=[];var u=r/2,l=i/2;var f=e+u,h=t+l;if(n===0){return[e,t,e+r,t+i]}var d,v,c,_;var g,p,y,m;c=-u;_=-l;d=f+c*o-_*a,v=h+c*a+_*o;g=y=d;p=m=v;c=-u;_=l;d=f+c*o-_*a;v=h+c*a+_*o;if(d<g){g=d}else if(d>y){y=d}if(v<p){p=v}else if(v>m){m=v}c=u;_=l;d=f+c*o-_*a;v=h+c*a+_*o;if(d<g){g=d}else if(d>y){y=d}if(v<p){p=v}else if(v>m){m=v}c=u;_=-l;d=f+c*o-_*a;v=h+c*a+_*o;if(d<g){g=d}else if(d>y){y=d}if(v<p){p=v}else if(v>m){m=v}s[0]=g;s[1]=p;s[2]=y;s[3]=m;return s}function Ao(e,t,r,i,n){if(n===void 0)n=0;var a=r/2,o=i/2;var s=e+a,u=t+o;if(n===0){return[{x:e,y:t},{x:e+r,y:t},{x:e+r,y:t+i},{x:e,y:t+i}]}var l=Math.sin(n),f=Math.cos(n);var h,d,v,c;var _=new Array(4);v=-a;c=-o;h=s+v*f-c*l,d=u+v*l+c*f;_[0]={x:h,y:d};v=-a;c=o;h=s+v*f-c*l;d=u+v*l+c*f;_[1]={x:h,y:d};v=a;c=o;h=s+v*f-c*l;d=u+v*l+c*f;_[2]={x:h,y:d};v=a;c=-o;h=s+v*f-c*l;d=u+v*l+c*f;_[3]={x:h,y:d};return _}function wo(e,t,r,i){if(t===void 0)t=0;if(r===void 0)r=1;if(i===void 0)i=[];var n=r*Math.sin(t);var a=r*Math.cos(t);i[0]=e[0]+n;i[1]=e[1]+a;i[2]=e[2]+n;i[3]=e[3]+a;return i}function So(e,t,r,i,n){if(n===void 0)n=[];var a=Math.sin(t),o=Math.cos(t),s,u;s=e[0]-r,u=e[1]-i;n[0]=r+o*s-a*u;n[1]=i+a*s+o*u;s=e[2]-r,u=e[3]-i;n[2]=r+o*s-a*u;n[3]=i+a*s+o*u;return n}function Eo(e,t){e.minX-=t;e.minY-=t;e.maxX+=t;e.maxY+=t;e.width+=2*t;e.height+=2*t;return e}var To=Object.freeze({circleCircleIntersection:circleCircleIntersection,circleSortCompare:circleSortCompare,circleContainsPoint:$n,circleContainsCircle:Kn,circleIntersectsBox:Jn,circleLineIntersection:Qn,lineFromPoint:pi,isPointInLine:yi,signedDistanceToLine:mi,distanceToLine:bi,vectorToLine:xi,twoSegmentsIntersect:Ai,lineAngle:Si,orthogonal:Ei,normalize:Ti,isPointInsideRectangle:Mi,segmentIntersection:Ci,lineRectangleIntersection:ki,clipLine:Ni,lineIntersection:Ii,findClosestPointOnLine:zi,computeLineInfo:Li,unitVector:Gi,scalarProduct:Xi,vectorLength:Wi,rotate:Ri,move:Di,distance:distance,squaredDistance:Fi,squareContainsSquare:Pi,slope:Bi,angle:Oi,degreeToRadians:Vi,radiansToDegrees:ji,extendBounds:Ui,isPointInTriangle:ta,incenter:ra,centroid:ia,isPointInRectangle:na,isPointInPolygon:aa,triangulatePolygon:fa,polygonsIntersect:ca,getCurveControlPoint:no,getSelfLoopControlPoints:ao,getLoopControlPoints:oo,getPointOnQuadraticCurve:so,isPointOnQuadraticCurve:uo,getPointOnBezierCurve:fo,isPointOnBezierCurve:ho,quadraticCurveLength:vo,cubicCurveLength:po,getQuadraticCurveBoundingBox:yo,getBezierCurveBoundingBox:mo,getAABB:xo,getOBBPoints:Ao,moveAABB:wo,rotateAABB:So,padBounds:Eo});function weightedStress(e,t,r,i,n,a){var o=0,s,u,l,f,h,d;for(l=0;l<i;l++){for(f=0;f<i;f++){var v=a[l],c=a[f];if(v!==c){u=e[v][c];u*=n;s=1/(u*u);if(s){h=t[v]-t[c];d=r[v]-r[c];o+=s*Math.pow(u-Math.sqrt(h*h+d*d),2)}}}}return o}function distanceStress(e,t,r,i,n,a,o){var s=0,u,l,f,h,d,v;if(n===-1){return 0}for(u=0;u<i;u++){for(l=0;l<i;l++){var c=o[u],_=o[l];if(c!==_&&(c===n||_===n)){f=e[c][_];f*=a;h=1/(f*f);if(h){d=t[c]-t[_];v=r[c]-r[_];s+=h*Math.pow(f-Math.sqrt(d*d+v*v),2)}}}}return s}function constrainedStress(e,t,r,i,n,a,o,s){o=o||0;var weightedStress=0;var distanceStress=0;var u,l,f,h,d,v,c;for(u=0;u<i;u++){for(l=0;l<i;l++){var _=s[u],g=s[l];if(_!==g){f=e[_][g];f*=a;h=1/(f*f);if(h){d=t[_]-t[g];v=r[_]-r[g];c=h*Math.pow(f-Math.sqrt(d*d+v*v),2);weightedStress+=c;if(_===n||g===n){distanceStress+=c}}}}}return(1-o)*weightedStress+o*distanceStress}function stressMinimizationStep(e,t,r,i,n,a,o,s,u){var l=t,f=r;var h=1e-6;o=o||0;n=typeof n==="undefined"?-1:n;if(n===-1){o=0}var d,v,c,_,g;var p=t[n],y=r[n];for(var m=0;m<i;m++){var b=s[m];var x=u(e[n][m]);var A=o/(x*x);if(x===0){continue}var w=0,S=0,E=0,T;var M=t[b],C=r[b];for(T=0;T<i;T++){var k=s[T],N,I,z,L,R;if(k!==b){N=e[b][k]*a;I=1/(N*N);z=t[k];L=r[k];if(I!==0){v=M-z;c=C-L;_=v*v+c*c;R=_<h?0:1/Math.sqrt(_);S+=(1-o)*I*(z+N*(M-z)*R);E+=(1-o)*I*(L+N*(C-L)*R)}w+=I}}d=(1-o)*w+A;if(d!==0){v=M-p;c=C-y;_=v*v+c*c;_=_<h?0:1/Math.sqrt(_);g=x===0?0:A*(x*_);l[b]=(S+g*t[b])/d;f[b]=(E+g*r[b])/d}}return{X:l,Y:f}}function stressMinimizationStepGeneral(e,t,r,i,n,a,o,s){var u=t,l=r;var f=1e-6;o=o||0;n=typeof n==="undefined"?-1:n;if(n===-1){o=0}var h;for(var d=0;d<i;d++){var v=s[d];var c=0,_=0,g=0,p,y;var m=t[v],b=r[v];var x,A,w;for(p=0;p<i;p++){var S=s[p],E,T,M,C,k;var N=0;if(S!==v){y=e[v][S]*a;E=1/(y*y);if(v===n||S===n){N=E}k=(1-o)*E+o*N;c+=k;if(E!==0){T=t[S];M=r[S];x=m-T;A=b-M;w=x*x+A*A;if(w>f){C=1/Math.sqrt(w)}_+=k*(T+y*(m-T)*C);g+=k*(M+y*(b-M)*C)}}}h=c;if(h!==0){u[v]=_/h;l[v]=g/h}}return{X:u,Y:l}}function minHeap(e,t,r,i){if(e===void 0)e=function(e,t){return e-t};if(t===void 0)t=[];if(r===void 0)r={};if(i===void 0)i=function(e){return e};var n=t.length;function a(a){while(true){var o=2*a+1;var s=o+1;var u=a;if(o<n&&e(t[o],t[u])<0){u=o}if(s<n&&e(t[s],t[u])<0){u=s}if(u===a){return a}var l=t[u];t[u]=t[a];t[a]=l;r[i(t[u])]=u;r[i(l)]=a;a=u}}var o={heapify:a,pop:function e(){if(n<=0){return undefined}if(n===1){n--;return t[0]}var r=t[0];t[0]=t[n-1];n--;a(0);return r},decreaseKey:function n(a,value){if(value!==undefined){t[a]=value;r[i(value)]=a}while(a>0){var o=a-1>>1;if(e(t[o],t[a])>0){var s=t[a];t[a]=t[o];t[o]=s;r[i(t[a])]=a;r[i(s)]=o;a=o}else{break}}return a},min:function e(){return t[0]},remove:function e(t){this.decreaseKey(t,Number.NEGATIVE_INFINITY);return this.pop()},push:function a(o){n++;var s=n-1;t[s]=o;while(s>0){var u=s-1>>1;if(e(t[u],t[s])>0){var l=t[s];t[s]=t[u];t[u]=l;r[i(t[s])]=s;r[i(l)]=u;s=u}else{break}}return s},empty:function e(){return n<=0},toArray:function e(){return t.slice(0,n)}};Object.defineProperty(o,"keys",{get:function(){return r},enumerable:true});Object.defineProperty(o,"size",{get:function(){return n},enumerable:true});return o}function bellmanFord(e){var t=e.sources;var r=e.targets;var i=e.weights;var n=e.source;var a=e.target;var o=e.undirected;if(o===void 0)o=false;var s=e.indexes;var u=e.N;u=s?s.length:u;if(!isFinite(u)||u===0){throw new Error("Invalid number of nodes "+u)}var l=new Float32Array(u);var f=new Int32Array(u);var h={};var d=Number.POSITIVE_INFINITY;var v,c,_,g,p,y,m;var b,x,A,w;if(!i){for(v=0,i=new Uint8Array(u);v<u;v++){i[v]=1}}if(!s){for(v=0,s=new Uint32Array(u);v<u;v++){s[v]=v+1}}for(v=0;v<u;v++){l[v]=d;f[v]=-1;h[s[v]]=v}l[h[n]]=0;for(v=1,c=u;v<=c;v++){w=false;for(_=0,g=i.length;_<g;_++){b=t[_];x=r[_];y=h[b];m=h[x];if(y!==undefined&&m!==undefined){A=i[_];p=l[y]+A;if(l[y]!==d&&p<l[m]){l[m]=p;f[m]=b;w=true}if(o){p=l[m]+A;if(l[m]!==d&&p<l[y]){l[y]=p;f[y]=x;w=true}}}}if(!w){break}}if(w){for(v=0,c=i.length;v<c;v++){b=t[v];x=r[v];y=h[b];m=h[x];if(y!==undefined&&m!==undefined){A=i[v];if(l[y]+A<l[m]){return null}}}}var S=null;var E=null;if(a!==undefined){var T=h[a];if(T!==undefined&&l[T]!==d){for(v=a,S=[];v!==-1;v=f[h[v]]){S.push(v)}S=S.reverse();E=l[T]}}return{distances:l,path:S,pathLength:E}}function dijkstra(e,t,r,i,n,a,o){var s=i?i.length:e.length;var u=new Float32Array(s);var l=new Int32Array(s);var f=new Uint32Array(s);var h=Number.POSITIVE_INFINITY;var d={};var v,c;if(s===0){return{distances:u,path:null,pathLength:null}}if(!i){for(v=0,i=new Uint32Array(s);v<s;v++){i[v]=v+1}}if(!n){for(v=0,n={};v<s;v++){n[i[v]]=v}}for(v=0;v<s;v++){u[v]=h;l[v]=-1;f[v]=d[v]=v}var _=minHeap(function(e,t){return u[e]-u[t]},f,d);u[n[t]]=0;_.decreaseKey(d[n[t]]);while(_.size!==0){var g=_.pop();var p=u[g];var y=e[g];if(p===h){break}for(v=0,c=y.nodes.length;v<c;v++){var m=y.nodes[v];var b=a?1:o?o(i[g],m):y.weights[v];var x=n[m];if(x===undefined){continue}var A=p+b;if(A<u[x]){u[x]=A;l[x]=g;_.decreaseKey(d[x])}}}var w=null;var S=null;if(r!==undefined){var E=n[r];if(u[E]!==h){for(v=E,w=[];v!==-1;v=l[v]){w.push(i[v])}w=w.reverse();S=u[r]}}return{distances:u,path:w,pathLength:S}}function johnson(e){var t=e.sources;var r=e.targets;var i=e.weights;var n=e.indexes;var a=e.adjacency;var o=e.undirected;var s=e.ignoreWeights;var u=Number.POSITIVE_INFINITY;var l=n?n.length:a.length;var f,h,d,v,c,_;if(!n){for(f=0,n=new Uint32Array(l);f<l;f++){n[f]=f+1}}var g=new Array(l);var p={};for(f=0;f<l;f++){g[f]=new Float32Array(l);for(d=0;d<l;d++){g[f][d]=f===d?0:u}p[n[f]]=f}var y=l;var m=i.length;t=t.slice();r=r.slice();i=i.slice();for(f=0;f<l;f++){t[m+f]=y;r[m+f]=n[f];i[m+f]=0;if(s){i[f]=1}}var b=bellmanFord({sources:t,targets:r,weights:i,undirected:o,N:l+1,source:y});if(b===null){throw new Error("Graph has negative weight loops")}v=b.distances;for(f=0,h=i.length;f<h;f++){c=p[t[f]];_=p[r[f]];if(c!==undefined&&_!==undefined){i[f]=i[f]+v[c]-v[_]}}t=t.slice(0,m);r=r.slice(0,m);i=i.slice(0,m);for(f=0;f<l;f++){var x=n[f];c=p[x];v=dijkstra(a,x,undefined,n,p,s).distances;for(d=0;d<l;d++){g[f][d]=f===d?0:v[d]}}return g}var Mo=v(function(e){(function(){"use strict";function t(e){if(!(this instanceof t)){return new t(e)}this.points=e||[]}t.prototype={triangulate:function(){var e=this.points;e.sort(function(e,t){if(e[0]===t[0]){return e[1]-t[1]}return e[0]-t[0]});for(var t=e.length-1;t>=1;t--){if(e[t][0]===e[t-1][0]&&e[t][1]===e[t-1][1]){e.splice(t,1)}}if(e.length<2){return{}}var r=d(e).le;var i=[];var a=0;var o=[r];while(n(r.onext.dest,r)){r=r.onext}var s=r;do{o.push(s.sym);s.mark=true;s=s.lnext}while(s!==r);do{var u=o[a++];if(!u.mark){s=u;do{i.push(s.orig);if(!s.sym.mark){o.push(s.sym)}s.mark=true;s=s.lnext}while(s!=u)}}while(a<o.length);return i}};function r(e,t,r){return(t[0]-e[0])*(r[1]-e[1])-(t[1]-e[1])*(r[0]-e[0])>0}function i(e,t){return r(e,t.dest,t.orig)}function n(e,t){return r(e,t.orig,t.dest)}function a(e,t){return i(e.dest,t)}function o(e,t,r,i){if(e[0]===i[0]&&e[1]===i[1]||t[0]===i[0]&&t[1]===i[1]||r[0]===i[0]&&r[1]===i[1]){return false}var n=e[0]*e[0]+e[1]*e[1],a=t[0]*t[0]+t[1]*t[1],o=r[0]*r[0]+r[1]*r[1],s=i[0]*i[0]+i[1]*i[1];var u=o-s,l=r[1]-i[1],f=r[1]*s-o*i[1],h=r[0]-i[0],d=r[0]*s-o*i[0],v=r[0]*i[1]-r[1]*i[0];return e[0]*(t[1]*u-a*l+f)-e[1]*(t[0]*u-a*h+d)+n*(t[0]*l-t[1]*h+v)-t[0]*f+t[1]*d-a*v>1}function s(e,t,r){this.onext=e;this.rot=t;this.orig=r;this.mark=false}s.prototype={get sym(){return this.rot.rot},get dest(){return this.sym.orig},get rotSym(){return this.rot.sym},get oprev(){return this.rot.onext.rot},get dprev(){return this.rotSym.onext.rotSym},get lnext(){return this.rotSym.onext.rot},get lprev(){return this.onext.sym},get rprev(){return this.sym.onext}};function u(e,t){var r=new s(null,null,e),i=new s(null,null,null),n=new s(null,null,t),a=new s(null,null,null);r.onext=r;n.onext=n;i.onext=a;a.onext=i;r.rot=i;i.rot=n;n.rot=a;a.rot=r;return r}function l(e,t){var r=e.onext.rot,i=t.onext.rot;var n=e.onext,a=i.onext,o=r.onext;e.onext=t.onext;t.onext=n;r.onext=a;i.onext=o}function f(e,t){var r=u(e.dest,t.orig);l(r,e.lnext);l(r.sym,t);return r}function h(e){l(e,e.oprev);l(e.sym,e.sym.oprev)}function d(e){var t,s,v,c;if(e.length===2){t=u(e[0],e[1]);return{le:t,re:t.sym}}else if(e.length===3){t=u(e[0],e[1]);s=u(e[1],e[2]);l(t.sym,s);if(r(e[0],e[1],e[2])){v=f(s,t);return{le:t,re:s.sym}}else if(r(e[0],e[2],e[1])){v=f(s,t);return{le:v.sym,re:v}}else{return{le:t,re:s.sym}}}else{var _=Math.ceil(e.length/2);var g=d(e.slice(0,_));var p=d(e.slice(_));var y=g.le,m=g.re,b=p.le,x=p.re;do{if(n(b.orig,m)){m=m.lnext}else if(i(m.orig,b)){b=b.rprev}else{break}}while(true);var A=f(b.sym,m);if(m.orig===y.orig){y=A.sym}if(b.orig===x.orig){x=A}do{var w=A.sym.onext;if(a(w,A)){while(o(A.dest,A.orig,w.dest,w.onext.dest)){c=w.onext;h(w);w=c}}var S=A.oprev;if(a(S,A)){while(o(A.dest,A.orig,S.dest,S.oprev.dest)){c=S.oprev;h(S);S=c}}if(!a(w,A)&&!a(S,A)){break}if(!a(w,A)||a(S,A)&&o(w.dest,w.orig,S.orig,S.dest)){A=f(S,A.sym)}else{A=f(A.sym,w.sym)}}while(true);return{le:y,re:x}}}t.prototype.ccw=r;t.prototype.rightOf=i;t.prototype.leftOf=n;t.prototype.inCircle=o;if(typeof undefined==="function"&&undefined.amd){undefined("Delaunay",function(){return t})}else{e.exports=t}})()});function Co(e,t,r){return(t[0]-e[0])*(r[1]-e[1])-(t[1]-e[1])*(r[0]-e[0])}function ko(e){var t=e.length,r=[0,1],i=2;for(var n=2;n<t;n++){while(i>1&&Co(e[r[i-2]],e[r[i-1]],e[n])<=0){--i}r[i++]=n}return r.slice(0,i)}function No(e){var t=e.length,r;if(t<3){return null}var i=new Array(t);var n=new Array(t);for(r=0;r<t;r++){i[r]=[+e[r][0],+e[r][1],r]}i.sort(function(e,t){return e[0]-t[0]||e[1]-t[1]});for(r=0;r<t;r++){n[r]=[i[r][0],-i[r][1]]}var a=ko(i),o=ko(n);var s=o[0]===a[0],u=o[o.length-1]===a[a.length-1],l=[];for(r=a.length-1;r>=0;--r){l.push(e[i[a[r]][2]])}for(r=+s;r<o.length-u;r++){l.push(e[i[o[r]][2]])}return l}function Io(e,t,r,i,convexhull){if(t===void 0)t=1;if(r===void 0)r=0;if(!i||!convexhull){e=e.map(function(e){return[e.x,e.y]});i=new Mo(e.slice()).triangulate();convexhull=No(e)}var n=r*r;var a=[],o={},s,u,l,f,h;for(l=0,f=i.length;l<f;l+=3){u=Do(i[l],i[l+1],i[l+2]);if(zo(convexhull,u)){h=Ro(i[l],i[l+1],i[l+2]);if(h>n){a.push(l);o[l]=h}}}if(a.length===0){return a}a.sort(function(e,t){return o[e]-o[t]});var d=a[0];var v=o[d];var c=[];for(l=0,f=a.length;l<f;l++){s=a[l];h=o[s];if(h>v&&h>n){d=s;v=h;c.push(d);if(c.length>t){c.shift()}}}return c.map(function(e){return Lo(i[e],i[e+1],i[e+2])})}function zo(e,t){var r=e.length;var i=e[r-1];var n=t[0];var a=t[1];var o=i[0];var s=i[1];var u,l;var f=false;for(var h=0;h<r;h++){i=e[h],u=i[0],l=i[1];if(l>a!==s>a&&n<(o-u)*(a-l)/(s-l)+u){f=!f}o=u,s=l}return f}function Lo(e,t,r){var i=arguments;var n=Do(e,t,r);var a=0;for(var o=0;o<3;o++){var s=i[o];var u=s[0]-n[0];var l=s[1]-n[1];var f=Math.sqrt(u*u+l*l);if(f>a){a=f}}return n.concat(a)}function Ro(e,t,r){var i=Do(e,t,r);var n=i[0];var a=i[1];var o=e[0];var s=e[1];var u=n-o;var l=a-s;return u*u+l*l}function Do(e,t,r){var i=[(e[0]+t[0])/2,(e[1]+t[1])/2];var n=[(t[0]+r[0])/2,(t[1]+r[1])/2];var a=-1/((t[1]-e[1])/(t[0]-e[0]));var o=-1/((r[1]-t[1])/(r[0]-t[0]));var s=i[1]-a*i[0];var u=n[1]-o*n[0];var l=(s-u)/(o-a);return[l,a*l+s]}function minDisk(e,t,r,i){if(!i){i=new Uint32Array(e.length);for(var n=0,a=e.length;n<a;n++){i[n]=n}}function o(e){for(var t=e.length-1;t>=0;t--){var r=Math.floor(Math.random()*(t+1));r=Math.max(Math.min(r,t),0);var i=e[t];e[t]=e[r];e[r]=i}return e}function s(e,t,r,i,n,a,o){var s=null;var u=t.length;var l,f,h;if(u===1){l=t[0];s=[r[l],i[l],n[l]||0]}else if(u===2){l=t[0];f=t[1];s=a(r[l],i[l],r[f],i[f],n[l],n[f])}else if(u===3){l=t[0];f=t[1];h=t[2];s=o(r[l],i[l],r[f],i[f],r[h],i[h],n[l],n[f],n[h])}return s}function u(e,t,r,i,n,a,o,l,f){var h=null;if(r===0||t.length===3){h=s(e,t,i,n,a,l,f)}else{var d=e[r-1];h=u(e,t,r-1,i,n,a,o,l,f);if(h===null||!o(h,i[d],n[d],a[d])){t.push(d);h=u(e,t,r-1,i,n,a,o,l,f);t.pop()}}return h}function l(e,t,r,i){var n=e-r,a=t-i;return[(e+r)/2,(t+i)/2,Math.sqrt(n*n+a*a)/2]}function f(e,t,r,i,n,a){var o=r-e;var s=i-t;var u=a-n;var l=Math.sqrt(o*o+s*s);return[(e+r+o/l*u)/2,(t+i+s/l*u)/2,(l+n+a)/2]}function h(e,t,r,i,n,a,o,s,u){var l=2*(e-r),f=2*(t-i),h=2*(s-o);var d=e*e+t*t-o*o-r*r-i*i+s*s;var v=2*(e-n),c=2*(t-a),_=2*(u-o);var g=e*e+t*t-o*o-n*n-a*a+u*u;var p=v*f-l*c,y=(f*g-c*d)/p-e,m=(c*h-f*_)/p,b=(v*d-l*g)/p-t,x=(l*_-v*h)/p;var A=m*m+x*x-1,w=2*(y*m+b*x+o),S=y*y+b*b-o*o,E=(-w-Math.sqrt(w*w-4*A*S))/(2*A);return[y+m*E+e,b+x*E+t,E]}function d(e,t,r,i,n,a){var o=(e*(i-a)+r*(a-t)+n*(t-i))*2;if(o===0){return null}var s=((e*e+t*t)*(i-a)+(r*r+i*i)*(a-t)+(n*n+a*a)*(t-i))/o;var u=((e*e+t*t)*(n-r)+(r*r+i*i)*(e-n)+(n*n+a*a)*(r-e))/o;var l=s-e,f=u-t;return[s,u,Math.sqrt(l*l+f*f)]}i=o(i);var v=r?f:l;var c=r?h:d;var _=r?Kn:$n;r=r||[];return u(i,[],i.length,e,t,r,_,v,c)}function removeRadialOverlap(e){var t=e.X;var r=e.Y;var i=e.sizes;var n=e.indexes;var a=e.R;var o=e.center;var s=e.gap;if(s===void 0)s=0;var u=e.epsilon;if(u===void 0)u=.001;var l=e.maxLoops;if(l===void 0)l=5;var f=e.inPlace;if(f===void 0)f=true;var h=n.length;var d=h;var v=o[0],c=o[1];if(!f){t=t.slice();r=r.slice()}var _=circleCircleIntersection;var g=circleSortCompare;var p=n.slice().sort(function(e,i){return g(t[e],r[e],t[i],r[i],v,c)});var y=p[h-1];var m=t[y],b=r[y];var x,A,w,S,E,T;for(var M=0,C=false;M<d-1;M++){var k=M%h,N=(M+1)%h;if(M===-1){k=h-1;N=0}k=p[k];N=p[N];x=t[k];A=r[k];w=t[N];S=r[N];var I=i[k],z=i[N];var L=I+z+s;var R=g(x,A,w,S,v,c);if(R===-1&&C){R=1}if(L>a){continue}if(R===1||L-distance(x,A,w,S)>u){var D=_(v,c,a,x,A,L);if(D){D=D[0];C=w>v&&D[0]<v;w=t[N]=D[0];S=r[N]=D[1]}}else{C=false}if(M%h===h-2){var F=p[h-1],P=p[0];if(r[F]>c&&r[P]>c&&t[F]-i[F]<t[P]+i[F]){E=0;d=Math.min(h*l,d+h);while(r[p[F]]>c&&r[p[0]]>c&&t[p[F]]<t[p[0]]&&++E<h){p.unshift(p.pop())}}}}x=m-v;A=b-c,w=t[y]-v;S=r[y]-c;var B=x===w?0:Math.abs(Math.acos((x*w+A*S)/(Math.sqrt(x*x+A*A)*Math.sqrt(w*w+S*S))));if(B!==0){var O=Math.sin(-B);var V=Math.cos(-B);var j;for(M=0;M<h;M++){j=p[M];E=t[j]-v;T=r[j]-c;t[j]=E*V-T*O+v;r[j]=E*O+T*V+c}}return{X:t,Y:r}}function circlePack(e){var t=e.X;var r=e.Y;var i=e.R;var n=e.center;var a=e.maxSteps;if(a===void 0)a=1e3;var o=e.padding;if(o===void 0)o=5;var s=e.epsilon;if(s===void 0)s=1e-5;var u=e.damping;if(u===void 0)u=2;var l=e.pinned;var f=e.indexes;var h=e.onUpdate;var d=e.pushSmallerOut;if(d===void 0)d=true;var v=f?f.length:t.length;var c=f;var _;if(!isFinite(l)){l=-1}if(c===undefined){c=new Uint32Array(v);for(_=0;_<v;_++){c[_]=_}}else{c=f}if(l!==-1){n=[t[l],r[l]]}else if(!n){var g=0,p=0;for(_=0;_<v;_++){g+=t[c[_]];p+=r[c[_]]}n=[g/v,p/v]}var y=function(e){return--e*e*e+1};var m=function(e,t){var r=e-n[0];var i=t-n[1];return r*r+i*i};var b=-Infinity,x=Infinity;c.sort(function(e,n){var a=i[e],o=i[n];b=Math.max(b,a,o);x=Math.min(x,a,o);return o*m(t[n],r[n])-a*m(t[e],r[e])});function A(e,a){var s=0;var f,h,_,g,p,y;for(f=0;f<v-1;f++){for(h=f+1;h<v;h++){if(f===h){continue}_=c[f];g=c[h];var m=t[_],A=r[_],w=i[_];var S=t[g],E=r[g],T=i[g];var M=S-m;var C=E-A;var k=w+T+o;var N=M*M+C*C;if(N<k*k-e){var I=(k-Math.sqrt(N))*a;var z=1/N;var L=M*z*I;var R=C*z*I;y=L*L+R*R;if(g!==l){p=w/x;s+=y*p;t[g]+=L*p;r[g]+=R*p}if(_!==l){p=T/x;s+=y*p;t[_]-=L*p;r[_]-=R*p}}}}var D=e*u*(1-a);var F=n[0],P=n[1],B,O;for(f=0;f<v;f++){_=c[f];if(_!==l){B=t[_];O=r[_];k=i[_];p=k/b;var V=d?D*p:D;L=(B-F)*V;R=(O-P)*V;y=L*L+R*R;s+=y;t[_]-=L;r[_]-=R}}return s}var w=0,S=0;var E=y(1/v);for(_=0;_<a;_++){w=A(E,y((_+1)/a));if(h){setTimeout(function(){return h(t,r)})}if(Math.abs(w-S)<s){break}S=w}return{X:t,Y:r}}var Fo=3;var Po=function e(t,r,i){var n=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var a=new Int32Array(this.arrayBuffer);t=a[0];r=a[1];i=a[2];this.d=r+2*i;for(var o=0;o<this.d*this.d;o++){var s=a[Fo+o];var u=a[Fo+o+1];n.push(s===u?null:a.subarray(s,u))}var l=a[Fo+n.length];var f=a[Fo+n.length+1];this.keys=a.subarray(l,f);this.bboxes=a.subarray(f);this.insert=this._insertReadonly}else{this.d=r+2*i;for(var h=0;h<this.d*this.d;h++){n.push([])}this.keys=[];this.bboxes=[]}this.n=r;this.extent=t;this.padding=i;this.scale=r/t;this.uid=0;this.freeIndexes=[];this.freeIndexMap={};var d=i/r*t;this.min=-d;this.max=t+d};Po.prototype.clear=function e(){var t=this.cells=[];for(var r=0;r<this.d*this.d;r++){t.push([])}this.keys=[];this.bboxes=[];this.freeIndexMap={};this.freeIndexes=[];this.uid=0};Po.prototype.insert=function e(t,r,i,n,a){var o;if(this.freeIndexes.length===0){o=this.uid++}else{o=this.freeIndexes.pop();delete this.freeIndexMap[o]}var s=o*4;var u=this.bboxes;this._forEachCell(r,i,n,a,this._insertCell,o);this.keys[o]=t;u[s+0]=r;u[s+1]=i;u[s+2]=n;u[s+3]=a;return this};Po.prototype.remove=function e(t){var r=this.keys.indexOf(t);if(r!==-1&&!this.freeIndexMap[r]){var i=r*4;var n=this.bboxes;var a=n[i+0];var o=n[i+1];var s=n[i+2];var u=n[i+3];this._forEachCell(a,o,s,u,this._removeCell,r);this.freeIndexes.push(r);this.freeIndexMap[r]=true}return this};Po.prototype._removeCell=function e(t,r,i,n,a,o){var s=this.cells[a];for(var u=0,l=s.length;u<l;u++){if(s[u]===o){s.splice(u,1);u--;l--}}};Po.prototype._insertReadonly=function e(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."};Po.prototype._insertCell=function e(t,r,i,n,a,o){this.cells[a].push(o)};Po.prototype.query=function e(t,r,i,n){var a=this;var o=this.min;var s=this.max;var u,l;var f={};var h=[];for(u=0,l=this.freeIndexes.length;u<l;u++){f[a.freeIndexes[u]]=true}if(t<=o&&r<=o&&s<=i&&s<=n){var d=this.keys;for(u=0,l=d.length;u<l;u++){if(!f[u]){h.push(d[u])}}return h}else{this._forEachCell(t,r,i,n,this._queryCell,h,f);return h}};Po.prototype._queryCell=function e(t,r,i,n,a,o,s){var u=this.cells[a];if(u!==null){var l=this.keys;var f=this.bboxes;for(var h=0;h<u.length;h++){var d=u[h];if(s[d]===undefined){var v=d*4;if(t<=f[v+2]&&r<=f[v+3]&&i>=f[v+0]&&n>=f[v+1]){s[d]=true;o.push(l[d])}else{s[d]=false}}}}};Po.prototype._forEachCell=function e(t,r,i,n,a,o,s){var u=this;var l=this.scale;var f=this.padding;var h=this.d;var d=Math.max(0,Math.min(h-1,Math.floor(t*l)+f));var v=Math.max(0,Math.min(h-1,Math.floor(r*l)+f));var c=Math.max(0,Math.min(h-1,Math.floor(i*l)+f));var _=Math.max(0,Math.min(h-1,Math.floor(n*l)+f));for(var g=d;g<=c;g++){for(var p=v;p<=_;p++){var y=h*p+g;if(a.call(u,t,r,i,n,y,o,s)){return}}}};Po.prototype.toArrayBuffer=function e(){var t=this;if(this.arrayBuffer){return this.arrayBuffer}var r=this.cells;var i=Fo+this.cells.length+1+1;var n=0;for(var a=0;a<this.cells.length;a++){n+=t.cells[a].length}var o=new Int32Array(i+n+this.keys.length+this.bboxes.length);o[0]=this.extent;o[1]=this.n;o[2]=this.padding;var s=i;for(var u=0;u<r.length;u++){var l=r[u];o[Fo+u]=s;o.set(l,s);s+=l.length}o[Fo+r.length]=s;o.set(this.keys,s);s+=this.keys.length;o[Fo+r.length+1]=s;o.set(this.bboxes,s);s+=this.bboxes.length;return o.buffer};function Bo(e,t){return e[3]>t[1]&&e[1]<t[3]&&(e[2]>t[0]&&e[0]<t[2])}var Oo=function e(t,r,i){if(i===void 0)i=16;if(i<2||i>16||i%2!==0){throw new Error("Wrong grid resolution '"+i+"' - it must be 2, 4, 8 or 16")}this._getBBox=r;this._bbox=t;this._res=i;this._inX=Math.pow(2,i)-1;this._inY=this._inX<<i;this.clear()};Oo.prototype._updateResolution=function e(){var t=this;this._xres=(this._bbox[2]-this._bbox[0])/this._res;this._yres=(this._bbox[3]-this._bbox[1])/this._res;this._clear();var r=Object.keys(this._codes);for(var i=0,n=r.len;i<n;i++){var a=r[i];t._codes[a]=0;t.insert(a)}return this};Oo.prototype.insert=function e(t){var r=this._getBBox(t);var i=this._res;var n=this._bbox[0],a=this._bbox[1];var o=(r[0]-n)/this._xres|0;var s=(r[1]-a)/this._yres|0;var u=(r[2]-n)/this._xres|0;var l=(r[3]-a)/this._yres|0;var f=o,h=s;var d=this._x,v=this._y;var c=this._codes;while(f<=u&&f<i){d[f][t]=true;c[t]|=1<<f;f++}while(h<=l&&h<i){v[h][t]=true;c[t]|=1<<i+h;h++}return this};Oo.prototype.updateBBox=function e(t){var r=this._bbox;var i=this._res;this._bbox=t;var n=(r[0]-t[0])/this._xres|0;var a=(r[1]-t[1])/this._yres|0;if(Math.abs(n)>=i||Math.abs(a)>=i){this.clear()}else{var o=this._updateDim(this._x,0,n);var s=this._updateDim(this._y,i,a);var u=this._inX,l=this._inY;var f=Object.keys(this._codes);var h=this._x,d=this._y,v=this._codes;for(var c=0,_=f.length;c<_;c++){var g=f[c];var p=v[g];if((p&u)===0||(p&l)===0){for(var y=0;y<i;y++){if(p&1<<y){delete h[y][g]}if(p&1<<i+y){delete d[y][g]}}delete v[g]}}if(n<0){this._x=this._x.slice(-n).concat(o)}else if(n>0){this._x=o.concat(this._x.slice(0,i-n))}if(a<0){this._y=this._y.slice(-a).concat(s)}else if(a>0){this._y=s.concat(this._y.slice(0,i-a))}}return this};Oo.prototype._updateDim=function e(t,r,i){var n,a,o,s,u;var l=this._codes;var f=[];if(i<0){for(n=0;n<-i;n++){s=1<<r+n;u=Object.keys(t[n]);for(a=0,o=u.length;a<o;a++){l[u[a]]^=s}f.push({})}}else if(i>0){for(n=this._res-i;n<this._res;n++){s=1<<r+n;u=Object.keys(t[n]);for(a=0,o=u.length;a<o;a++){l[u[a]]^=s}f.push({})}}return f};Oo.prototype.resize=function e(t){var r=this;this._bbox=t;for(var i=0;i<this._res;i++){r._x[i]={};r._y[i]={}}this._updateResolution()};Oo.prototype.removeMultiple=function e(t){var r=this;var i=t.length,n,a,o;for(var s=0;s<this._res;s++){a=r._x[s],o=r._y[s];for(var u=0;u<i;u++){n=t[u];if(r._codes[n]){if(a[n]){delete a[n]}if(o[n]){delete o[n]}delete r._codes[n]}}}return this};Oo.prototype.remove=function e(t){var r=this._codes[t];var i=this._x,n=this._y,a=this._res;for(var o=0;o<a;o++){var s=1<<o,u=1<<a+o;if(r&s){delete i[o][t]}if(r&u){delete n[o][t]}}delete this._codes[t];return this};Oo.prototype.point=function e(t){return this.query([t[0],t[1],t[0],t[1]])};Oo.prototype.query=function e(t){var r=this;var i=this._bbox[0],n=this._bbox[1],a=this._res;var o=Math.max(0,(t[0]-i)/this._xres|0);var s=Math.max(0,(t[1]-n)/this._yres|0);var u=Math.min(a-1,(t[2]-i)/this._xres|0);var l=Math.min(a-1,(t[3]-n)/this._yres|0);var f=this._getBBox;var h=[];var d=o,v=s,c={},_=[],g,p,y;while(d<=u){_=_.concat(Object.keys(r._x[d++]))}while(v<=l){_=_.concat(Object.keys(r._y[v++]))}for(g=0,p=_.length;g<p;g++){y=_[g];if(!c[y]){if(Bo(f(y),t)){h.push(y)}c[y]=true}}return h};Oo.prototype.getAll=function e(){var t=this;return Object.keys(this._codes).map(function(e){return t._getBBox(e)})};Oo.prototype.getOverlaps=function e(){var t=this;var r=this._res,i={};var n=this._getBBox;var a=[];var o=this._ycode;for(var s=0;s<r;s++){var u=Object.keys(t._x[s]);for(var l=0;l<r;l++){var f=[],h=1<<l;for(var d=0,v=u.length;d<v;d++){if(o[u[d]]&h){f.push(u[d])}}var c=f.length;for(var _=0;_<c;_++){for(var g=0;g<c;g++){var p=f[_],y=f[g];if(g!==_&&!i[p+":"+y]&&!i[y+":"+p]){i[p+":"+y]=true;if(Bo(n(p),n(y))){a.push(p,y)}}}}}}return a};Oo.prototype.clear=function e(){var t=this;var r=this._bbox;var i=this._res;this._x=new Array(i);this._y=new Array(i);for(var n=0;n<i;n++){t._x[n]={};t._y[n]={}}this._xres=(r[2]-r[0])/i;this._yres=(r[3]-r[1])/i;this._codes={}};function Vo(e,t,r){return{bbox:e,leaf:true,level:r,parent:t,objects:[],final:false}}function jo(e,t){var r=(e[0]+e[2])/2;var i=(e[1]+e[3])/2;return r>=t[0]&&r<=t[2]&&(i>=t[1]&&i<=t[3])}function Uo(e,t){return e[0]>t[0]&&e[0]<t[2]&&(e[1]>t[1]&&e[1]<t[3])||e[2]>t[0]&&e[2]<t[2]&&(e[3]>t[1]&&e[3]<t[3])}function Go(e,t){return e[3]>=t[1]&&e[1]<=t[3]&&(e[2]>=t[0]&&e[0]<=t[2])}var Xo=0;var Wo=1;var Ho=2;var Yo=3;function qo(e,t){var r=(t[0]+t[2])/2,i=(t[1]+t[3])/2;var n=(e[0]+e[2])/2,a=(e[1]+e[3])/2;if(n<=r){return a<=i?Xo:Wo}else{return a<=i?Yo:Ho}}var Zo=function(e){return e};var $o=function e(t,r,i,n){if(t===void 0)t=Zo;if(r===void 0)r=10;if(n===void 0)n=0;this._nodeCapacity=r;this._root=null;this._getBBox=t;this._upScale=4;this._objects={};this._size=0;this._rootLevel=n;this._maxLevel=n+100;this._idToCell={};if(i){this._root=Vo(i,null,n)}};var Ko={size:{configurable:true},root:{configurable:true}};Ko.size.get=function(){return this._size};Ko.root.get=function(){return this._root};$o.prototype.clear=function e(){this._root=null;this._objects={};this._size=0;this._idToCell={};this._rootLevel=0;return this};$o.prototype.insert=function e(t,r,i){var n=this;if(i===void 0)i=this._root;r=r||this._getBBox(t);if(this._objects[t]){return}this._objects[t]=true;this._size++;if(!this._root){var a=Math.max(Math.abs(r[2]-r[0]),Math.abs(r[3]-r[1]));this._root=Vo([r[0],r[1],r[0]+a,r[1]+a],null,this._rootLevel);this._root.objects.push(t);return t}var o=[i],s,u,l=false;var f=this._nodeCapacity,h=this._idToCell;var d=this._maxLevel;while(s=o.pop()){u=s.bbox;if(Go(r,u)){if(s.leaf){if(s.final||s.objects.length<f){s.objects.push(t);if(h[t]){h[t].push(s)}else{h[t]=[s]}if(s.level>=d||Math.abs(u[2]-u[0])<=Math.abs(r[2]-r[0])||Math.abs(u[3]-u[1])<=Math.abs(r[3]-r[1])){s.final=true}l=true}else{n.splitNode(s);o.push.apply(o,s.children)}}else{o.push.apply(o,s.children)}}}if(l){return t}if(!jo(r,this._root.bbox)){var v=this._rootLevel;while(!jo(r,this._root.bbox)){i=n._root;u=i.bbox;var c=(r[0]+r[2])/2,_=(r[1]+r[3])/2;var g=u.slice(),p;var y=Math.abs(u[2]-u[0]),m=Math.abs(u[3]-u[1]);if(m===0&&y===0){break}if(c<=u[0]){g[0]-=y}if(_<=u[1]){g[1]-=m}if(c>u[0]){g[2]+=y}if(_>u[1]){g[3]+=m}p=Vo(g,null,--v);n.splitNode(p);p.children[qo(u,g)]=i;n._root=i.parent=p}o=[this._root];this._root.level=this._rootLevel;while(s=o.shift()){if(!s.leaf){for(var b=0;b<4;b++){var x=s.children[b];x.level=s.level+1;o.push(x)}}}}s=this._root.children[qo(r,this._root.bbox)];if(s.leaf){s.objects.push(t);if(h[t]){h[t].push(s)}else{h[t]=[s]}}return t};$o.prototype.removeById=function e(t){if(!this._objects[t]){return t}this._size--;var r=this._idToCell[t];for(var i=0;i<r.length;i++){var n=r[i];var a=n.objects;for(var o=0,s=a.length;o<s;o++){if(a[o]===t){a.splice(o,1);break}}}delete this._objects[t];delete this._idToCell[t];return t};$o.prototype.remove=function e(t){var r=this._getBBox(t);var i=[this._root],n;var a,o,s;while(n=i.pop()){a=n.bbox;if(Go(r,a)){if(n.leaf){var u=n.objects;for(var l=0,f=u.length;l<f;l++){if(u[l]===t){u.splice(l,1);if(f===1){s=s||[];s.push(n)}break}}}else{i.push.apply(i,n.children)}}}delete this._idToCell[t];delete this._objects[t];this._size--;if(s){while(o=s.pop()){var h=o.parent;var d=true;while(h&&d){if(!h.leaf){for(var v=0;v<4;v++){n=h.children[v];if(!n.leaf||n.objects.length!==0){d=false;break}}if(d){h.leaf=true;h.children=null;h.objects=[]}}h=h.parent}}}return t};$o.prototype.splitNode=function e(t){var r=t.bbox;var i=r[0];var n=r[1];var a=r[2];var o=r[3];var s=(i+a)/2,u=(n+o)/2;var l=t.level+1,f;var h=this._idToCell;var d=[Vo([i,n,s,u],t,l),Vo([i,u,s,o],t,l),Vo([s,u,a,o],t,l),Vo([s,n,a,u],t,l)];if(t.objects){var v=t.objects;var c=this._getBBox;for(var _=0,g=v.length;_<g;_++){var p=v[_];var y=c(p);var m=h[p];for(var b=0;b<4;b++){f=d[b];if(Go(y,f.bbox)){f.objects.push(p);if(m){m.push(f)}else{m=[f]}}}m.splice(m.indexOf(t),1)}}t.children=d;t.objects=null;t.leaf=false};$o.prototype.point=function e(t,r){var i=[];var n=[this._root],a,o,s;var u=t[0];var l=t[1];var f=this._getBBox;while(a=n.pop()){o=a.bbox;if(u>=o[0]&&u<=o[2]&&l>=o[1]&&l<=o[3]){if(a.leaf){if(r){i=a.objects}var h=a.objects;for(var d=0,v=h.length;d<v;d++){s=h[d];o=f(s);if(u>=o[0]&&u<=o[2]&&l>=o[1]&&l<=o[3]){i.push(s)}}break}else{n.push.apply(n,a.children)}}}return i};$o.prototype.neigbours=function e(t){var r=[];var i=[this._root],n,a;var o=t[0];var s=t[1];while(n=i.pop()){a=n.bbox;if(o>=a[0]&&o<=a[2]&&s>=a[1]&&s<=a[3]){if(n.leaf){r=n.objects;break}else{i.push.apply(i,n.children)}}}return r};$o.prototype.query=function e(t){var r=[];var i=[this._root],n,a,o;var s=this._getBBox;var u={};while(n=i.pop()){if(Go(t,n.bbox)){if(n.leaf){var l=n.objects;for(var f=0,h=l.length;f<h;f++){o=l[f];if(!u[o]){a=s(o);if(Go(t,a)){r.push(o)}u[o]=true}}}else{i.push.apply(i,n.children)}}}return r};$o.prototype.getOverlaps=function e(){var t=[this._root],r,i,n;var a=[];var o=this._getBBox;var s={},u=this._objects;while(r=t.pop()){if(r.leaf){var l=r.objects,f=l.length;for(var h=0;h<f;h++){for(var d=0;d<f;d++){i=l[h];n=l[d];if(h!==d&&!s[i+":"+n]&&!s[n+":"+i]){var v=u[i],c=u[n];s[i+":"+n]=true;if(Go(o(v),o(c))){a.push(v,c)}}}}}else{t.push.apply(t,r.children)}}return a};$o.prototype.getAll=function e(){return Object.keys(this._objects)};$o.prototype.forEach=function e(t,r){var i=[],n;while(n=i.pop()){if(n.leaf){for(var a=0,o=n.objects.length;a<o;a++){t.call(r,n.objects[a])}}else{i.push.apply(i,n.children)}}return this};$o.prototype.getLeafs=function e(){var t=[this._root],r,i=[];while(r=t.pop()){if(r.leaf){i.push(r)}else{t.push.apply(t,r.children)}}return i};$o.prototype.traverse=function e(t,r){var i=[this._root],n;while(n=i.pop()){if(!t.call(r,n,n.objects)&&!n.leaf){i.push.apply(i,n.children)}}return this};$o.prototype.update=function e(t){this.remove(t);this.insert(t);return this};Object.defineProperties($o.prototype,Ko);$o.flatAccessor=function(e,t){return function(r){var i=t*r;return e.slice(i,i+t)}};$o.inside=jo;$o.intersects=Uo;$o.overlaps=Go;var Jo=Object.freeze({minHeap:minHeap,bellmanFord:bellmanFord,dijkstra:dijkstra,johnson:johnson,largestEmptyCircle:Io,minDisk:minDisk,removeRadialOverlap:removeRadialOverlap,convexhull:No,circlePack:circlePack,GridIndex:Po,Grid:Oo,Quadtree:$o,weightedStress:weightedStress,distanceStress:distanceStress,constrainedStress:constrainedStress,stressMinimizationStep:stressMinimizationStep,stressMinimizationStepGeneral:stressMinimizationStepGeneral});b.extend(function(e){var t=new Qo;e.modules.events=t;e.events.removeListener=function(e){t.removeListener(e)}});var Qo=function e(){this._events={};this._onAnyEvents=[]};Qo.prototype.register=function e(t,r){var i=this;if(r===void 0)r=[];t.forEach(function(e){if(i._events[e]){throw new Error('event "'+e+'" already exists')}i._events[e]=new es(false,e)});r.forEach(function(e){if(i._events[e]){throw new Error('event "'+e+'" already exists')}i._events[e]=new es(true,e)})};Qo.prototype.onAnyEvent=function e(t){this._onAnyEvents.push(t)};Qo.prototype.on=function e(t,r,i){var n=this;if(tt(t)){ut(t,function(e,t){return n.on(t,e,i)})}else{var a=t.split(" ").filter(function(e){return!!e});a.forEach(function(e){return pt(n._events,e,"event").on(r,i)})}return r};Qo.prototype.removeListener=function e(t){ut(this._events,function(e){e.off(t)})};Qo.prototype.fire=function e(t,r){var i=pt(this._events,t,"event");this._onAnyEvents.forEach(function(e){return e(t,r)});i.trigger(r)};Qo.prototype.once=function e(t,r){var i=this;var n=function(){r.apply(null,arguments);i.removeListener(n)};return this.on(t,n)};var es=function e(t,r){this._name=r;this._reverseOrder=t;this._subscribers=[];this._triggers=[]};es.prototype.trigger=function e(t){var r=this;for(var i=0;i<this._triggers.length;++i){r._triggers[i](t,r._name)}};es.prototype.on=function e(t,r){if(r===void 0)r={};var i=r.delay;if(i===void 0)i=false;if(typeof t!=="function"){throw new Error("handler is not a function")}var n=i?function(e,r){return setTimeout(function(){return t(e,r)},0)}:t,a=this._reverseOrder?0:this._subscribers.length;this._triggers.splice(a,0,n);this._subscribers.splice(a,0,t)};es.prototype.off=function e(t){var r=this;var i;while((i=this._subscribers.indexOf(t))!==-1){r._subscribers.splice(i,1);r._triggers.splice(i,1)}};b.atInit(function(e,t){if(t.options){e.setOptions(t.options)}});b.extend(function(e){var t=new ts(e);e.modules.settings=t;e.setOptions=function(e){return t.update(e)}});var ts=function e(){this._currentValue={};this._onChange={};this._defaultValues={};this._keys=[]};ts.prototype.register=function e(t,r,i,n){if(n===void 0)n=true;this._keys.push(t);this._currentValue[t]=r;this._defaultValues[t]=r;this._onChange[t]=i||function(){};if(i&&n){i(r)}};ts.prototype.update=function e(t){var r=this;t=Wt(t);var i=this._keys,n={};for(var a=0;a<i.length;++a){var o=i[a];if(o in t){var value=t[o];if(value===undefined){value=r._defaultValues[o]}n[o]=r._currentValue[o];r._currentValue[o]=value}}var s=Object.keys(n);for(var u=0;u<s.length;++u){var l=s[u],f=r._currentValue[l],h=n[l];if(f!==h){r._onChange[l](f,h)}}return Yt(n)};ts.prototype.get=function e(t){if(t===undefined){return Yt(this._currentValue)}else{return this._currentValue[t]}};ts.prototype.set=function e(t,value){var r=this._currentValue[t];var i=this._onChange[t];this._currentValue[t]=value;if(i){i(value,r)}};var rs=["geo","graphics","legend","brand","tooltip"];var is=300;var ns=300;b.atInit(function(e,t){if(t.container){e.setContainer(t.container)}});b.extend(function(e,t){var r=new as(e,t.dimensions);e.modules.dom=r;e.setContainer=function(e){return r.setContainer(e)};e.getContainer=function(){return r.getContainer()};e.view.beforeNextFrame=function(){return r.beforeNextFrame()};e.view.afterNextFrame=function(){return r.afterNextFrame()};e.view.setFullScreen=function(value){return r.setFullScreen(value)};e.view.isFullScreen=function(){return r.isFullScreen()};e.view.forceResize=function(){return r.forceResize()};e.view.getSize=function(){return r.getDimensions()};e.view.setSize=function(e){return r.setDimensions(e)}});b.onDestroy(function(e){e.modules.dom._detachFromDom()});var as=function e(t,r){var i=this;if(r===void 0)r={};var n=r.width;if(n===void 0)n=80;var a=r.height;if(a===void 0)a=60;this._events=t.modules.events;this._settings=t.modules.settings;this._width=n;this._height=a;this._layers={};this._container=null;this._isFullScreen=false;this._beforeNextFrameCallbacks=[];this._afterNextFrameCallbacks=[];this._refreshUntil=0;this._currentTime=oe();this._settings.register("minimumWidth",is,function(){return i._resize()},false);this._settings.register("minimumHeight",ns,function(){return i._resize()},false);this._events.register(["beforeNewFrame","newFrame","setContainer","resize"]);this._listeners=[];this._onWindowResize=function(){return i._resize()};this._onWindowFocus=function(){return i.refresh()};this.addWindowEventListener("resize",this._onWindowResize);this.addWindowEventListener("focus",this._onWindowFocus)};as.prototype.addWindowEventListener=function e(t,r,i){if(typeof window!=="undefined"){this.addElementEventListener(window,t,r,i)}};as.prototype.addDocumentEventListener=function e(t,r,i){if(typeof document!=="undefined"){this.addElementEventListener(document,t,r,i)}};as.prototype.addElementEventListener=function e(t,r,i,n){this._listeners.push({elt:t,name:r,listener:i,options:n});t.addEventListener(r,i,n)};as.prototype._detachFromDom=function e(){this._listeners.forEach(function(e){var t=e.elt;var r=e.name;var i=e.listener;var n=e.options;t.removeEventListener(r,i,n)});this._emptyContainer()};as.prototype.getDimensions=function e(){return{width:this._width,height:this._height}};as.prototype.setDimensions=function e(t){this._resize(t)};as.prototype.setLayer=function e(t,r,i){if(i===void 0)i={};var n=i.automaticResize;if(n===void 0)n=false;if(r){r._ogmaLayer=t;if(n){r.style.position="absolute";r.style.top="0px";r.style.left="0px";zr(r,this._width,this._height,Tr())}}this._layers[t]={element:r,automaticResize:n};this._updateContainerContent()};as.prototype.setContainer=function e(t){if(typeof t==="string"){var r=t;t=document.getElementById(r);if(!t){throw new Error('unable to find DOM element with id "'+r+'"')}}if(t===this._container){return}var i=this._container;this._isFullScreen=false;this._container=t;this._resize();this._updateContainerContent();this._events.fire("setContainer",{element:t,prevElement:i})};as.prototype.getContainer=function e(){return this._container};as.prototype.forceResize=function e(){this._resize()};as.prototype.beforeNextFrame=function e(){var t=this;return new Promise(function(e){t._beforeNextFrameCallbacks.push(e);t._refresh()})};as.prototype.afterNextFrame=function e(){var t=this;return new Promise(function(e){t._afterNextFrameCallbacks.push(e);t._refresh()})};as.prototype.refresh=function e(t){if(t){this._refreshUntil=Math.max(this._refreshUntil,t)}this._refresh()};as.prototype._emptyContainer=function e(){var t=this;if(this._container){var r=[];for(var i=0;i<this._container.childNodes.length;++i){var n=t._container.childNodes[i];if(n._ogmaLayer){r.push(n)}}for(var a=0;a<r.length;++a){t._container.removeChild(r[a])}}};as.prototype._fillContainer=function e(){var t=this;if(this._container){var r=fr(this._container,"position");if(r!=="absolute"&&r!=="relative"&&r!=="fixed"){this._container.style.position="relative"}var i=this._container.firstChild;rs.forEach(function(e){var r=t._layers[e];if(r&&r.element){t._container.insertBefore(r.element,i)}})}};as.prototype._updateContainerContent=function e(){this._emptyContainer();this._fillContainer()};as.prototype._resize=function e(t){if(!this._container&&!t){return}var r=this._width;var i=this._height;var n;var a;if(this._container){var o=this._settings.get("minimumWidth");var s=this._settings.get("minimumHeight");var u=this._container.clientWidth||1;var l=this._container.clientHeight||1;n=Math.max(o,u);a=Math.max(s,l)}else{n=t.width;a=t.height}if(n!==r||a!==i){this._width=n;this._height=a;ut(this._layers,function(e){var t=e.element;var r=e.automaticResize;if(r){zr(t,n,a)}});this._events.fire("resize",{prevWidth:r,prevHeight:i,width:n,height:a,difWidth:n-r,difHeight:a-i})}};as.prototype._refresh=function e(){var t=this;if(this._inFrame){this._mustRefresh=true}else if(!this._nextFrame){this._nextFrame=W(function(){return t._playFrame()})}};as.prototype._playFrame=function e(){var t=oe();var r=t-this._currentTime;var i=this._beforeNextFrameCallbacks;var n=this._afterNextFrameCallbacks;this._inFrame=true;this._nextFrame=null;this._mustRefresh=false;this._currentTime=t;this._beforeNextFrameCallbacks=[];this._afterNextFrameCallbacks=[];i.forEach(function(e){return e()});this._events.fire("beforeNewFrame",{elapsed:r});this._events.fire("newFrame",{elapsed:r});n.forEach(function(e){return e()});this._inFrame=false;if(this._mustRefresh||t<this._refreshUntil+17){this._mustRefresh=false;this._refresh()}};as.prototype.isPlayingFrame=function e(){return this._inFrame||!!this._nextFrame};as.prototype.setFullScreen=function e(value){if(this._container){if(value&&!this._isFullScreen){os(this._container)}else if(!value&&this._isFullScreen){ss()}}this._isFullScreen=value};as.prototype.isFullScreen=function e(){return this._isFullScreen};as.prototype.debounceBeforeFrame=function e(t){var r=this;var i=false;var n=[];var a=function(){var e=n;i=false;n=[];t();e.forEach(function(e){return e()})};return function(){return new Promise(function(e){n.push(e);if(!i){i=true;r.beforeNextFrame().then(a)}})}};function os(e){if(e.requestFullScreen){e.requestFullScreen()}else if(e.webkitRequestFullScreen){e.webkitRequestFullScreen()}else if(e.mozRequestFullScreen){e.mozRequestFullScreen()}else if(e.msRequestFullscreen){e.msRequestFullscreen()}}function ss(){if(typeof document==="undefined"){return}if(document.cancelFullScreen){document.cancelFullScreen()}else if(document.webkitCancelFullScreen){document.webkitCancelFullScreen()}else if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else if(document.msExitFullscreen){document.msExitFullscreen()}}var us=function e(t,r,i){this._ogma=t;this._graph=r;this._isNode=i;this._name=i?"node":"edge";this._filters=[];this._excluded=this._graph.createAttribute(this._isNode,{name:"excluded",storage:1,default:1});this._objects=this._graph.getAttribute(this._isNode,"object");this._list=[];this._rules=[];this._nextRuleId=1;this._sourceList=this._graph.getAttribute(false,"source");this._targetList=this._graph.getAttribute(false,"target");this._nodeExcluded=this._graph.getAttribute(true,"excluded")};us.prototype.getNonExcludedList=function e(t){var r=this;if(!t){t=this._graph.allIndexes(this._isNode)}var i=[];for(var n=0;n<t.length;++n){var a=t[n];if(r._excluded.get(a)===0){i.push(a)}}return i};us.prototype.isExcluded=function e(t){return this._excluded.get(t)};us.prototype.areExcluded=function e(t){return this._excluded.getMultiple(t)};us.prototype.addFilter=function e(){var t=this._graph.createAttribute(this._isNode,{storage:1});this._filters.push(t);return t};us.prototype.removeFilter=function e(t){this._graph._removeAttribute(this._isNode,t);var r=this._filters.indexOf(t);if(r!==-1){this._filters.splice(r,1)}};us.prototype.refreshFilters=function e(t){var r=this;var i=this._filters,n=i.length,a=this._excluded,o=[],s=[],u=[];for(var l=0,f=t.length;l<f;++l){var h=t[l],d=0;if(!r._isNode){var v=r._sourceList.get(h),c=r._targetList.get(h),_=r._nodeExcluded.get(v),g=r._nodeExcluded.get(c);d=_||g}if(!d){for(var p=0;p<n;++p){var y=r._filters[p];if(y.get(h)){d=1;break}}}if(a.get(h)!==d){(d?s:u).push(h);a.set(h,d)}if(d){o.push(h)}}this._list=o;return{newlyExcluded:s,newlyIncluded:u}};us.prototype.refreshRules=function e(t){var r=this;for(var i=0;i<this._rules.length;++i){r._refreshRule(r._rules[i],t)}};us.prototype.enableRule=function e(t){this._toggleRule(t,true)};us.prototype.disableRule=function e(t){this._toggleRule(t,false)};us.prototype._toggleRule=function e(t,r){var i=this._getRuleIndex(t),n=this._rules[i];if(r!==n.enabled){n.enabled=r;if(r){this._filters.push(n.array)}else{this._filters.splice(this._filters.indexOf(n.array),1)}}};us.prototype._refreshRule=function e(t,r){var i=this;if(!r){r=this._graph._allIndexes(this._isNode)}if(t.enabled){var n=t.array,a=t.func;for(var o=0;o<r.length;++o){var s=r[o],u=i._objects.get(s);n.set(s,!a(u))}}};us.prototype.addRule=function e(t){var r=this.addFilter(),i={id:this._nextRuleId,func:t,array:r,enabled:true};this._rules.push(i);this._refreshRule(i);return this._nextRuleId++};us.prototype.removeRule=function e(t){var r=this._getRuleIndex(t),i=this._rules[r];this.removeFilter(i.array);this._rules.splice(r,1)};us.prototype.clearRules=function e(){var t=this;if(!this._rules.length){return}for(var r=0;r<this._rules.length;++r){t.removeFilter(t._rules[r].array)}this._rules=[]};us.prototype._getRuleIndex=function e(t){var r=this;for(var i=0;i<this._rules.length;++i){if(r._rules[i].id===t){return i}}throw new Error(this._name+" filter "+t+" does not exist")};var ls=function e(t,r){this._isNode=r;this._graph=t;this._array=this._graph.createAttribute(r,{storage:1});this._list=[]};var fs={list:{configurable:true},size:{configurable:true}};ls.prototype.alter=function e(t,value){return value?this.add(t):this.remove(t)};ls.prototype.add=function e(t){if(!this._array.get(t)){this._array.set(t,1);this._list.push(t);return true}return false};ls.prototype.addMultiple=function e(t){var r=this;for(var i=0;i<t.length;++i){var n=t[i];if(!r._array.get(n)){r._array.set(n,1);r._list.push(n)}}};ls.prototype.addMultipleAndRetrieveDifference=function e(t){var r=this;var i=[];for(var n=0;n<t.length;++n){var a=t[n];if(!r._array.get(a)){r._array.set(a,1);r._list.push(a);i.push(a)}}return i};ls.prototype.has=function e(t){return!!this._array.get(t)};ls.prototype.hasMultiple=function e(t){var r=this;var i=new Array(t.length);for(var n=0;n<t.length;++n){i[n]=!!r._array.get(t[n])}return i};ls.prototype.getList=function e(){return this._list.slice()};ls.prototype.getInvertedList=function e(){var t=this;var r=[],i=this._graph._allIndexes(this._isNode);for(var n=0;n<i.length;++n){var a=i[n];if(!t.has(a)){r.push(a)}}return r};ls.prototype.remove=function e(t){if(this._array.get(t)){this._array.set(t,0);this._list.splice(this._list.indexOf(t),1);return true}return false};ls.prototype.removeMultiple=function e(t){var r=this;for(var i=0;i<t.length;++i){var n=t[i];if(r._array.get(n)){r._array.set(n,0)}}this._list=hs(this)};ls.prototype.removeMultipleAndRetrieveDifference=function e(t){var r=this;var i=[];for(var n=0;n<t.length;++n){var a=t[n];if(r._array.get(a)){r._array.set(a,0);i.push(a)}}this._list=hs(this);return i};ls.prototype.clear=function e(){var t=this._list;if(t.length!==0){this._array.reset()}this._list=[];return t};fs.list.get=function(){return this._list};fs.size.get=function(){return this._list.length};Object.defineProperties(ls.prototype,fs);function hs(e){var t=[],r=e._graph._allIndexes(e._isNode);for(var i=0;i<r.length;++i){var n=r[i];if(e._array.get(n)){t.push(n)}}return t}var ds=function e(t){this._NodeList=t.NodeList;this._EdgeList=t.EdgeList;this._nodeSet=t.modules.graph._createIndexSet(true);this._edgeSet=t.modules.graph._createIndexSet(false)};ds.prototype.addElements=function e(t){var r=t.isNode;var i=t._indexes;var n=r?this._NodeList:this._EdgeList;var a=this[r?"_nodeSet":"_edgeSet"];return new n(a.addMultipleAndRetrieveDifference(i))};ds.prototype.removeElements=function e(t){var r=t.isNode;var i=t._indexes;var n=r?this._NodeList:this._EdgeList;var a=this[r?"_nodeSet":"_edgeSet"];return new n(a.removeMultipleAndRetrieveDifference(i))};ds.prototype.getNodes=function e(){return new this._NodeList(this._nodeSet.getList())};ds.prototype.getEdges=function e(){return new this._EdgeList(this._edgeSet.getList())};ds.prototype.clearNodes=function e(){return new this._NodeList(this._nodeSet.clear())};ds.prototype.clearEdges=function e(){return new this._EdgeList(this._edgeSet.clear())};ds.prototype.hasNodes=function e(t){return this._nodeSet.hasMultiple(t._indexes)};ds.prototype.hasEdges=function e(t){return this._edgeSet.hasMultiple(t._indexes)};var vs=function e(t,r,i,n){this._graph=t;this._isNode=r;this._id=i;this._deleted=false;this._whenApplied=n};vs.prototype._checkDeleted=function e(){if(this._deleted){throw new Error("the filter is deleted")}};vs.prototype.enable=function e(){this._toggle(true)};vs.prototype.disable=function e(){this._toggle(false)};vs.prototype._toggle=function e(t){var r=this._graph._filters.fetch(this._isNode);r[t?"enableRule":"disableRule"](this._id)};vs.prototype.whenApplied=function e(t){this._checkDeleted();var r=this._whenApplied;if(t){r=r.then(t)}return r};vs.prototype.destroy=function e(){this._checkDeleted();return this._graph._removeFilterRule(this._isNode,this._id)};vs.prototype.delete=function e(){return this.destroy()};vs.prototype.refresh=function e(){this._checkDeleted();return this._graph._refreshFilterRules(this._isNode)};b.atInit(function(e,t){if(t.graph){var r=t.graph;var i=r.nodes;var n=r.edges;if(i){e.addNodes(i)}if(n){e.addEdges(n)}}});b.extend(function(e){var t=new cs(e);var r=t.Node;var i=t.Edge;var n=t.NodeList;var a=t.EdgeList;e.modules.graph=t;e.Node=r;e.Edge=i;e.NodeList=n;e.EdgeList=a;e.events.onNodesAdded=function(t){e.modules.events.on("addNodes",t);return e.events};e.events.onBeforeNodesRemoved=function(t){e.modules.events.on("beforeRemoveNodes",t);return e};e.events.onNodesRemoved=function(t){e.modules.events.on("removeNodes",t);return e.events};e.events.onEdgesAdded=function(t){e.modules.events.on("addEdges",t);return e.events};e.events.onBeforeEdgesRemoved=function(t){e.modules.events.on("beforeRemoveEdges",t);return e};e.events.onEdgesRemoved=function(t){e.modules.events.on("removeEdges",t);return e.events};e.addNodes=function(e,r){return t.addNodes(e,r)};e.addEdges=function(e,r){if(r===void 0)r={};return t.addEdges(e,r)};e.addNode=function(e){return t.addNode(e)};e.addEdge=function(e){return t.addEdge(e)};e.removeNodes=function(e){return t.removeNodes(e)};e.removeEdges=function(e){return t.removeEdges(e)};e.removeNode=function(e){return t.removeNodes(e)};e.removeEdge=function(e){return t.removeEdges(e)};e.getNodes=function(e){return t.getNodes(e)};e.getEdges=function(e){return t.getEdges(e)};e.getNode=function(e){return t.getNode(e)};e.getEdge=function(e){return t.getEdge(e)};e.clearGraph=function(){return t.clear()};e.setGraph=function(r,i){t.clear();return e.addGraph(r,i)};e.addGraph=function(e,r){return t.addGraph(e,r)};e.createNodeList=function(){return t.getNodes([])};e.createEdgeList=function(){return t.getEdges([])};r.prototype.getAdjacentNodes=function(e){return t.getAdjacentNodes(this,e)};n.prototype.getAdjacentNodes=function(e){return t.getAdjacentNodes(this,e)};r.prototype.getAdjacentEdges=function(e){return t.getAdjacentEdges(this,e)};n.prototype.getAdjacentEdges=function(e){return t.getAdjacentEdges(this,e)};r.prototype.getDegree=function(e){return t.degree(this,e)};n.prototype.getDegree=function(e){var r=this;var i=new Array(this._indexes.length);for(var n=0;n<this._indexes.length;++n){i[n]=t._degree(r._indexes[n],e)}return i};e.addNodeFilter=function(e){return t.addNodeFilterRule(e)};e.addEdgeFilter=function(e){return t.addEdgeFilterRule(e)};e.getNodeFilters=function(){return t.getNodeFilters()};e.getEdgeFilters=function(){return t.getEdgeFilters()};e.clearNodeFilters=function(){return Promise.all(t.getNodeFilters().map(function(e){return e.delete()}))};e.clearEdgeFilters=function(){return Promise.all(t.getEdgeFilters().map(function(e){return e.delete()}))};e.getConnectedComponents=function(){var e=t.getConnectedComponents(true,true);return e.map(function(e){return t._getElements(true,e)})};e.getConnectedComponentByNode=function(e){return t._getElements(true,t.getConnectedComponentByNode(e,true,true))};r.prototype.getConnectedComponent=function(){return t._getElements(true,t.getConnectedComponentByNode(this,true,true))};r.prototype.isVisible=function(){return t.isVisible(this)};n.prototype.isVisible=function(){return t.areVisible(this)};i.prototype.isVisible=function(){return t.isVisible(this)};a.prototype.isVisible=function(){return t.areVisible(this)}});var cs=function e(t){var r=this;this._ogma=t;this._events=t.modules.events;this._dom=t.modules.dom;this._elts=ht(new An(true),new An(false));this._sets=ht([],[]);this._buffer=[];this._events.register(["addNodes","addEdges","updateDirections","refreshNodeFilters","refreshEdgeFilters"],["clear","beforeRemoveNodes","removeNodes","beforeRemoveEdges","removeEdges"]);this._promisesToResolve=[];this._init_();this._sourceList=this.createEdgeAttribute({name:"source",storage:32});this._targetList=this.createEdgeAttribute({name:"target",storage:32});this._nodeDeduper=this.createNodeAttribute({storage:1});this._edgeDeduper=this.createEdgeAttribute({storage:1});this._directionUpdated=[];this.Node=function e(t){this._index=t};Object.defineProperty(this.Node.prototype,"_ogma",{value:t});Object.defineProperty(this.Node.prototype,"isNode",{value:true});Object.defineProperty(this.Node.prototype,"size",{value:1});Object.defineProperty(this.Node.prototype,"__indexes",{value:[0]});Object.defineProperty(this.Node.prototype,"_indexes",{get:function(){this.__indexes[0]=this._index;return this.__indexes}});this.Edge=function e(t){this._index=t};Object.defineProperty(this.Edge.prototype,"_ogma",{value:t});Object.defineProperty(this.Edge.prototype,"isNode",{value:false});Object.defineProperty(this.Edge.prototype,"size",{value:1});Object.defineProperty(this.Edge.prototype,"__indexes",{value:[0]});Object.defineProperty(this.Edge.prototype,"_indexes",{get:function(){this.__indexes[0]=this._index;return this.__indexes}});this.NodeList=function e(t){this._indexes=t||[]};Object.defineProperty(this.NodeList.prototype,"_ogma",{value:t});Object.defineProperty(this.NodeList.prototype,"size",{get:function(){return this._indexes.length}});Object.defineProperty(this.NodeList.prototype,"isNode",{value:true});this.EdgeList=function e(t){this._indexes=t||[]};Object.defineProperty(this.EdgeList.prototype,"_ogma",{value:t});Object.defineProperty(this.EdgeList.prototype,"size",{get:function(){return this._indexes.length}});Object.defineProperty(this.EdgeList.prototype,"isNode",{value:false});this._nodeFilterRules=[];this._edgeFilterRules=[];this._nodes=this.createAttribute(true,{name:"object",storage:"any"});this._edges=this.createAttribute(false,{name:"object",storage:"any"});this._dummyList={get:function(){return 0}};this._filters=ht(new us(t,this,true),new us(t,this,false));this._promisesToResolve=[];this._filterUpdater=new Cn(this,function(e){var t=e.nodes;var i=e.edges;var n=r._filters.nodes.refreshFilters(t),a=r._filters.edges.refreshFilters(i);if(n.newlyIncluded.length||n.newlyExcluded.length){r._events.fire("refreshNodeFilters",{isNode:true,newlyIncluded:new r.NodeList(n.newlyIncluded),newlyExcluded:new r.NodeList(n.newlyExcluded)})}if(a.newlyIncluded.length||a.newlyExcluded.length){r._events.fire("refreshEdgeFilters",{isNode:false,newlyIncluded:new r.EdgeList(a.newlyIncluded),newlyExcluded:new r.EdgeList(a.newlyExcluded)})}r._resolvePromises()})};cs.prototype._resolvePromises=function e(){var t=this._promisesToResolve;this._promisesToResolve=[];t.forEach(function(e){return e()})};cs.prototype._init_=function e(){this._nodeList=[];this._edgeList=[];this._neighborTable=new Tn;this._parallelTable=new Tn;this._parallelEdgesIndex=[];this._resolvePromises()};cs.prototype._triggerDirectionUpdate_=function e(){this._events.fire("updateDirections",{directions:this._directionUpdated});this._directionUpdated=[]};cs.prototype.getNodeMaxIndex=function e(){return this._elts.nodes.getMaxIndex()};cs.prototype.getEdgeMaxIndex=function e(){return this._elts.edges.getMaxIndex()};cs.prototype.isVisible=function e(t){return!this._filters.fetch(t.isNode).isExcluded(t._index)};cs.prototype.areVisible=function e(t){var r=this._filters.fetch(t.isNode).areExcluded(t._indexes);for(var i=0;i<r.length;++i){r[i]=!r[i]}return r};cs.prototype._addFilter=function e(t){return this._filters.fetch(t).addFilter()};cs.prototype._removeFilter=function e(t,r){return this._filters.fetch(t).removeFilter(r)};cs.prototype.addNodeFilterRule=function e(t){return this._addFilterRule(true,t)};cs.prototype.addEdgeFilterRule=function e(t){return this._addFilterRule(false,t)};cs.prototype._addFilterRule=function e(t,r){var i=this;var n=this._filters.fetch(t).addRule(r),a=new Promise(function(e){return i._promisesToResolve.push(e)}),o=new vs(this,t,n,a);this[t?"_nodeFilterRules":"_edgeFilterRules"].push(o);this._filterUpdater.updateAll();return o};cs.prototype._removeFilterRule=function e(t,r){var i=this;this._filters.fetch(t).removeRule(r);this._filterUpdater.updateAll();var n=this[t?"_nodeFilterRules":"_edgeFilterRules"];for(var a=0;a<n.length;++a){if(n[a]._id===r){n.splice(a,1)}}return new Promise(function(e){i._promisesToResolve.push(e)})};cs.prototype.getNodeFilters=function e(){return this._nodeFilterRules.slice()};cs.prototype.getEdgeFilters=function e(){return this._edgeFilterRules.slice()};cs.prototype.clearNodeFilterRules=function e(){return this._clearFilterRules(true)};cs.prototype.clearEdgeFilterRules=function e(){return this._clearFilterRules(false)};cs.prototype._clearFilterRules=function e(t){var r=this;this._filters.fetch(t).clearRules();this._filterUpdater.updateAll();return new Promise(function(e){r._promisesToResolve.push(e)})};cs.prototype._refreshFilterRules=function e(t,r){var i=this;this._filters.fetch(t).refreshRules(r);this._filterUpdater.updateAll();return new Promise(function(e){i._promisesToResolve.push(e)})};cs.prototype._refreshFilters=function e(t,r){var i=this;if(!r){this._filterUpdater.updateAll()}else if(t){this._filterUpdater.updateNodes(r)}else{this._filterUpdater.updateEdges(r)}return new Promise(function(e){i._promisesToResolve.push(e)})};cs.prototype.addNode=function e(t){if(t===void 0)t={};return this._addElementsSync(true,[t]).get(0)};cs.prototype.addEdge=function e(t){return this._addElementsSync(false,[t]).get(0)};cs.prototype.addNodes=function e(t,r){if(r===void 0)r={};var i=r.batchSize;return this._addElements(true,t,i)};cs.prototype.addEdges=function e(t,r){if(r===void 0)r={};var i=r.batchSize;return this._addElements(false,t,i)};cs.prototype.addGraph=function e(t,r){var i=this;var n=t.nodes;if(n===void 0)n=[];var a=t.edges;if(a===void 0)a=[];if(r===void 0)r={};var o=r.batchSize;if(!o){return Promise.resolve({nodes:this._addElementsSync(true,n),edges:this._addElementsSync(false,a)})}else{var s;return this._addElements(true,n,o).then(function(e){s=e;return i._addElements(false,a,o)}).then(function(e){return{nodes:s,edges:e}})}};cs.prototype._addElements=function e(t,r,i){var n=this;if(!i){return Promise.resolve(this._addElementsSync(t,r))}else{return new Promise(function(e){var a=0,o=i,s=r.length,u=[];var l=function(){if(a<s){u.push.apply(u,ms(n,t,r.slice(a,o)));a=o;o+=i;n._dom.beforeNextFrame().then(l)}else{e(n._getElements(t,u))}};l()})}};cs.prototype._addElementsSync=function e(t,r){return this._getElements(t,ms(this,t,r))};cs.prototype.removeNodes=function e(t){if(t===undefined){throw new Error(t+" is not a valid argument")}this._removeElements(true,this.filterIndexes(true,this._getIndexes(true,t)))};cs.prototype.removeEdges=function e(t){if(t===undefined){throw new Error(t+" is not a valid argument")}this._removeElements(false,this.filterIndexes(false,this._getIndexes(false,t)))};cs.prototype._removeElements=function e(t,r){xs(this,t,r)};cs.prototype.getNodes=function e(t){var r=_s(t);var i=r.ids;var n=r.filter;var a=this._getIndexes(true,i);this._filter(true,a,n);return this._getElements(true,a)};cs.prototype.getEdges=function e(t){var r=_s(t);var i=r.ids;var n=r.filter;var a=this._getIndexes(false,i);this._filter(false,a,n);return this._getElements(false,a)};cs.prototype._getElements=function e(t,r){if(arguments.length<2){throw new Error("_getElement: invalid number of parameters")}return new this[t?"NodeList":"EdgeList"](r)};cs.prototype.getNode=function e(t){return this._getElement(true,this._getIndex(true,t))};cs.prototype.getEdge=function e(t){return this._getElement(false,this._getIndex(false,t))};cs.prototype._getElement=function e(t,r){if(arguments.length<2){throw new Error("_getElement: invalid number of parameters")}if(!r){return undefined}return this[t?"_nodes":"_edges"].get(r)};cs.prototype.getRaw=function e(){var t="raw";return{nodes:this.getNodes(t).toArray(),edges:this.getEdges(t).toArray()}};cs.prototype.getVisible=function e(){var t="visible";return{nodes:this.getNodes(t).toArray(),edges:this.getEdges(t).toArray()}};cs.prototype.clear=function e(){this._events.fire("clear");this._sets.nodes.forEach(function(e){return e.clear()});this._sets.edges.forEach(function(e){return e.clear()});this._elts.nodes.clear();this._elts.edges.clear();this._init_()};cs.prototype.forEachNode=function e(t,r){this._forEachElements(true,t._indexes,r)};cs.prototype.forEachEdge=function e(t,r){this._forEachElements(false,t._indexes,r)};cs.prototype._forEachElements=function e(t,r,i){var n=this;for(var a=0;a<r.length;++a){i(n._getElement(t,r[a]),a)}};cs.prototype.mapNodes=function e(t,r){return this._mapElements(true,t._indexes,r)};cs.prototype.mapEdges=function e(t,r){return this._mapElements(false,t._indexes,r)};cs.prototype._mapElements=function e(t,r,i){var n=this;var a=new Array(r.length);for(var o=0;o<r.length;++o){a[o]=i(n._getElement(t,r[o]),o)}return a};cs.prototype.filterNodes=function e(t,r){return this._filterElements(true,t._indexes,r)};cs.prototype.filterEdges=function e(t,r){return this._filterElements(false,t._indexes,r)};cs.prototype._filterElements=function e(t,r,i){var n=this;var a=[];for(var o=0;o<r.length;++o){var s=r[o];if(i(n._getElement(t,s),o)){a.push(s)}}return this._getElements(t,a)};cs.prototype.reduceNodes=function e(t,r,i){return this._reduceElements(true,t._indexes,r,i)};cs.prototype.reduceEdges=function e(t,r,i){return this._reduceElements(false,t._indexes,r,i)};cs.prototype._reduceElements=function e(t,r,i,n){var a=this;var o=n;for(var s=0;s<r.length;++s){var u=r[s],l=a._getElement(t,u);o=i(o,l,s)}return o};cs.prototype.dedupeNodes=function e(t){return this._getElements(true,this._dedupe(true,t._indexes.slice()))};cs.prototype.dedupeEdges=function e(t){return this._getElements(false,this._dedupe(false,t._indexes.slice()))};cs.prototype._dedupe=function e(t,r){if(!r.length){return r}var i=this[t?"_nodeDeduper":"_edgeDeduper"],n=0;i.reset();for(var a=0;a<r.length;++a){var o=r[a];if(i.get(o)===0){i.set(o,1);r[n]=o;n+=1}}r.length=n;return r};cs.prototype.inverse=function e(t){var r=t.isNode,i=t._indexes,n=this[r?"_nodeDeduper":"_edgeDeduper"],a=this._elts.fetch(r).getFlexArray("excluded"),o=this._allIndexes(r),s=[];n.reset();for(var u=0,l=i.length;u<l;++u){var f=i[u];n.set(f,1)}for(var h=0,d=o.length;h<d;++h){var v=o[h];if(n.get(v)===0&&a.get(v)===0){s.push(v)}}return this._getElements(r,s)};cs.prototype.partitionNodes=function e(t,r){return this._partition(true,t._indexes,r)};cs.prototype.partitionEdges=function e(t,r){return this._partition(false,t._indexes,r)};cs.prototype._partition=function e(t,r,i){var n=this;var a={};for(var o=0;o<r.length;++o){var s=r[o],u=n._getElement(t,s),l=i(u,o),f=a[l];if(!f){f=new n.NodeList;a[l]=f}f._indexes.push(s)}return a};cs.prototype.concatNodes=function e(t,r){return this._getElements(true,t._indexes.concat(r._indexes))};cs.prototype.concatEdges=function e(t,r){return this._getElements(false,t._indexes.concat(r._indexes))};cs.prototype.createAttribute=function e(t,r){return this._elts.fetch(t).createFlexArray(r)};cs.prototype.createNodeAttribute=function e(t){return this.createAttribute(true,t)};cs.prototype.createEdgeAttribute=function e(t){return this.createAttribute(false,t)};cs.prototype.createAttributes=function e(t){var r=this;t.forEach(function(e){if(e.for==="nodes"||e.for==="both"){r.createNodeAttribute(e)}if(e.for==="edges"||e.for==="both"){r.createEdgeAttribute(e)}})};cs.prototype._removeAttribute=function e(t,r){this._elts.fetch(t).removeFlexArray(r)};cs.prototype.getAllAttributes=function e(){return this._elts.nodes.getAllFlexArrays().concat(this._elts.nodes.getAllFlexArrays())};cs.prototype.getAttribute=function e(t,r){return this._elts.fetch(t).getFlexArray(r)};cs.prototype.getAttributes=function e(t,r){var i=this;return r.map(function(e){return i.getAttribute(t,e)})};cs.prototype.getNodeAttribute=function e(t){return this.getAttribute(true,t)};cs.prototype.getEdgeAttribute=function e(t){return this.getAttribute(false,t)};cs.prototype._getIndexes=function e(t,r,i){if(i===void 0)i=false;if(typeof t!=="boolean"){throw new TypeError('"isNode" should be a boolean')}var n=this[t?"Node":"Edge"],a=this[t?"NodeList":"EdgeList"],o=this[t?"_nodes":"_edges"],s=this._elts.fetch(t),u;if(r===undefined){u=s.allIndexes().slice()}else if(r instanceof a||r instanceof n){u=r._indexes.filter(function(e){return o.get(e)})}else{u=[];if(bt(r)){for(var l=0;l<r.length;++l){var f=r[l];if(f instanceof n){if(o.get(f._index)){u.push(f._index)}}else{var h=s.getIndex(f,i);if(h){u.push(h)}}}}else{var d=s.getIndex(r,i);if(d){u.push(d)}}}return u};cs.prototype._allIndexes=function e(t){return this._elts.fetch(t).allIndexes()};cs.prototype._getIndex=function e(t,r,i){var n=this[t?"Node":"Edge"];if(r instanceof n){return r._index}else{return this._elts.fetch(t).getIndex(r,i)}};cs.prototype.getNodeIndex=function e(t){return this._elts.nodes.getIndex(t)};cs.prototype.getEdgeIndex=function e(t){return this._elts.edges.getIndex(t)};cs.prototype.nodeIndexList=function e(t){return this._getIndexes(true,t)};cs.prototype.edgeIndexList=function e(t){return this._getIndexes(false,t)};cs.prototype.getAttributesArrays=function e(t,r,i){if(i===void 0)i={};var n=i.destArrays;var a=i.ids;if(!r){throw new Error("You must provide array of attributes to retrieve the values")}if(!a){a=this._elts[t?"nodes":"edges"].getAllIndexes()}return this.getAttributes(t,r).map(function(e,t){return e.getMultiple(a,n?n[t]:undefined)})};cs.prototype.getNodeAttributesArrays=function e(t,r){return this.getAttributesArrays(true,t,r)};cs.prototype.getEdgeAttributesArrays=function e(t,r){return this.getAttributesArrays(false,t,r)};cs.prototype._getId=function e(t,r){return this._elts.fetch(t).getId(r)};cs.prototype._getIds=function e(t,r,i){return this._elts.fetch(t).getIdList(r,i)};cs.prototype._getSource=function e(t){return this._sourceList.get(t)};cs.prototype._getSources=function e(t,r){return this._sourceList.getMultiple(t,r)};cs.prototype._getTarget=function e(t){return this._targetList.get(t)};cs.prototype._getTargets=function e(t,r){return this._targetList.getMultiple(t,r)};cs.prototype._setExtremities=function e(t,r,i){var n=this;for(var a=0;a<t.length;++a){As(n,t[a])}if(r){this._sourceList.setMultiple(t,r)}if(i){this._targetList.setMultiple(t,i)}for(var o=0;o<t.length;++o){bs(n,t[o])}this._triggerDirectionUpdate_()};cs.prototype.setSource=function e(t,r){var i=this._getIndexes(false,t),n=Array.isArray(r)?this._getIndexes(true,r):this._getIndex(true,r);this._setExtremities(i,n,undefined)};cs.prototype.setTarget=function e(t,r){var i=this._getIndexes(false,t),n=Array.isArray(r)?this._getIndexes(true,r):this._getIndex(true,r);this._setExtremities(i,undefined,n)};cs.prototype.getParallelIndexes=function e(t,r){var i=this._parallelTable.get(+t);if(!r){r=new Array(i.length)}for(var n=0;n<i.length;++n){r[n]=i[n]}return r};cs.prototype.getEdgeDirection=function e(t){var r=Ss(this._sourceList.get(t),this._targetList.get(t));return this._parallelEdgesIndex[r]};cs.prototype._getAllEdgeDirections=function e(){var t=this;var r=[],i=Object.keys(this._parallelEdgesIndex);for(var n=0;n<i.length;++n){r.push(t._parallelEdgesIndex[i[n]])}return r};cs.prototype._filter=function e(t,r,i){var n=undefined,a=0;if(i==="raw"){n=this._elts.fetch(t).getFlexArray("virtual")}else if(i==="all"){n=this._dummyList}else{n=this._elts.fetch(t).getFlexArray("excluded")}for(var o=0;o<r.length;++o){var s=r[o];if(n.get(s)===0){r[a]=s;a+=1}}r.length=a;return r};cs.prototype._filterWithCriteria=function e(t,r,i){var n=this;var a=0;for(var o=0;o<r.length;++o){var s=r[o];if(i(n._getElement(t,s))){r[a]=s;a+=1}}r.length=a;return r};cs.prototype._collectAdjacentEdges=function e(t,r){var i=this;var n=r==="out",a=r==="in",o=!(n||a),s=[];for(var u=0;u<t.length;++u){var l=t[u],f=i._neighborTable.get(l);for(var h=0;h<f.length;++h){var d=i._parallelTable.get(f[h]);if(o){s.push.apply(s,d)}else{for(var v=0;v<d.length;++v){var c=d[v],_=i._sourceList.get(c),g=i._targetList.get(c),p=g===l;if(a===p||_===g){s.push(c)}}}}}return s};cs.prototype._collectAdjacentNodes=function e(t,r,i){var n=this;var a=r==="out";var o=r==="in";var s=!(a||o);var u=[];var l=null;if(i==="all"){l=this._dummyList}else if(i==="raw"){l=this._elts.edges.getFlexArray("virtual")}else{l=this._elts.edges.getFlexArray("excluded")}for(var f=0;f<t.length;++f){var h=t[f],d=n._neighborTable.get(h);for(var v=0;v<d.length;++v){var c=n._parallelTable.get(d[v]);for(var _=0;_<c.length;++_){var g=c[_];if(!l.get(g)){var p=n._sourceList.get(g);var y=n._targetList.get(g);if(s||o&&h===y||a&&h===p){u.push(p+y-h);break}}}}}return u};cs.prototype.getAdjacentNodes=function e(t,r){return this._getElements(true,this._getAdjacentElements(true,t._indexes,r))};cs.prototype.getAdjacentEdges=function e(t,r){return this._getElements(false,this._getAdjacentElements(false,t._indexes,r))};cs.prototype._getAdjacentElements=function e(t,r,i){if(i===void 0)i={};var n=i.direction;if(n===void 0)n="both";var a=i.filter;if(a===void 0)a="visible";var o=i.policy;if(o===void 0)o="union";var s=i.includeSources;if(s===true){o="include-sources"}else if(s===false){o="exclude-sources"}if(!t){var u=this._collectAdjacentEdges(r,n);this._filter(false,u,a);this._dedupe(false,u);return u}else{var l=this._collectAdjacentNodes(r,n,a);this._dedupe(true,l);if(o==="include-sources"){for(var f=0;f<r.length;++f){var h=r[f];if(!l.includes(h)){l.push(h)}}}else if(o==="exclude-sources"){for(var d=0;d<r.length;++d){var v=r[d];var c=l.indexOf(v);if(c!==-1){l.splice(c,1)}}}return l}};cs.prototype.degree=function e(t,r){return this._degree(this._getIndex(true,t),r)};cs.prototype._degree=function e(t,r){if(r!=="in"&&r!=="out"){return this._neighborTable.size(t)}else{return ws(this,t,r==="in")}};cs.prototype._degrees=function e(t,r){var i=this;if(r!=="in"&&r!=="out"){return this._neighborTable.sizes(t)}else{var n=new Array(t.length);var a=r==="in";for(var o=0,s=t.length;o<s;o++){n[o]=ws(i,t[o],a)}return n}};cs.prototype._createIndexSet=function e(t){var r=new ls(this,t);this._sets.fetch(t).push(r);return r};cs.prototype.createSet=function e(){return new ds(this._ogma)};cs.prototype.getAdjacencyTable=function e(t,r,i,n){return this._getAdjacencyTable(t,r,i,this._getIndexes(true,n))};cs.prototype._getAdjacencyTable=function e(t,r,i,n){return Ts(this,!t,!r,i,n)};cs.prototype.getConnectedComponents=function e(t,r){return Es(this,t,-1,!r)};cs.prototype.getComponentByNode=function e(t,r,i){if(t===undefined){throw new Error("topology.getComponentByNode: Node has to be defined")}var n=t.id===undefined?t:t.id;t=this.getNode(n);if(!t){throw new Error('topology.getComponentByNode: Cannot find node "'+n+'"')}return Es(this,r,t.__index,!i)};cs.prototype.getConnectedComponentByNode=function e(t,r,i){if(t===undefined){throw new Error("topology.getConnectedComponentByNode: Node has to be defined")}var n=t.id===undefined?t:t.id;t=this.getNode(n);if(!t){throw new Error('topology.getConnectedComponentByNode: Cannot find node "'+n+'"')}return Es(this,r,t._index,!i)};cs.prototype.filterIndexes=function e(t,r){var i=this._elts.fetch(t),n=this._buffer,a=null;for(var o=0;o<r.length;++o){var s=r[o];if(i.has(s)&&!n[s]){n[s]=1;if(a){a.push(s)}}else{if(!a){a=r.slice(0,o)}}}n.length=0;return a||r};cs.prototype.generateUnusedNodeId=function e(){return gs(this,true)};cs.prototype.generateUnusedEdgeId=function e(){return gs(this,false)};cs.prototype._generateUnusedId=function e(t){return gs(this,t)};function _s(e){if(e===null||e===undefined){return{}}else if(bt(e)){return{ids:e,filter:"all"}}else if(typeof e==="string"){return{filter:e}}else if(typeof e==="function"){throw new TypeError(e+" is not a valid selector")}else{return e}}function gs(e,t){var r=e._elts.fetch(t),i=null;do{i=Math.random().toString().slice(2)}while(r.hasId(i));return i}function ps(e){if(e===undefined){return"gen_"+Math.random().toString().slice(2)+"_"}else if(typeof e!=="string"&&(typeof e!=="number"||!isFinite(e))){throw new Error(e+" is not a valid id, expected string or number")}return e}function ys(e,t){if(t instanceof e.Node){return t._index}else{return e._elts.nodes.getIndex(t,true)}}function ms(e,t,r){if(!bt(r)){throw new TypeError(r+" is not an array")}else if(!r.length){return[]}var i=e._elts.fetch(t),n=[],a=[],o=r.length,s=[],u=[],l={};for(var f=0;f<o;++f){var h=r[f];if(typeof h!=="object"||h===null){throw new Error(h+" is not a valid "+(t?"node":"edge"))}var d=ps(h.id);if(!i.getIndex(d,false)&&!(d in l)){a.push(d);n.push(h);l[d]=1;if(!t){s.push(ys(e,h.source));u.push(ys(e,h.target))}}}var v=i.addElements(a),c=v.length;if(t){e._neighborTable.reserve(v.length);for(var _=0;_<c;++_){e._neighborTable.addEntry(v[_])}}else{e._parallelTable.reserve(v.length/2|0);for(var g=0;g<c;++g){var p=v[g],y=s[g],m=u[g];e._sourceList.set(p,y);e._targetList.set(p,m);bs(e,p)}e._triggerDirectionUpdate_()}var b=e[t?"_nodes":"_edges"],x=e.getAttribute(t,"excluded"),A=e[t?"Node":"Edge"];for(var w=0;w<c;++w){var S=v[w];b.set(S,new A(S))}x.setMultiple(v,0);var E={objects:n};E[t?"nodes":"edges"]=e._getElements(t,v);e._events.fire(t?"addNodes":"addEdges",E);e._filters.fetch(t).refreshRules(v);e._filters.fetch(t).refreshFilters(v);return v}function bs(e,t){var r=e._sourceList.get(t),i=e._targetList.get(t),n=Ss(r,i),a=e._parallelEdgesIndex[n];if(a===undefined){a=e._parallelTable.addEntry();e._parallelEdgesIndex[n]=a;e._neighborTable.addTo(r,a);if(r!==i){e._neighborTable.addTo(i,a)}}e._parallelTable.addTo(a,t);e._directionUpdated.push(a)}function xs(e,t,r){var i;if(!r.length){return}if(t){var n=e._collectAdjacentEdges(r);e._dedupe(false,n);xs(e,false,n)}var a=e._elts.fetch(t),o=e._sets.fetch(t),s=(i={},i[t?"nodes":"edges"]=e._getElements(t,r),i);e._events.fire(t?"beforeRemoveNodes":"beforeRemoveEdges",s);for(var u=0;u<o.length;++u){o[u].removeMultiple(r)}if(!t){for(var l=0,f=r.length;l<f;++l){As(e,r[l])}e._triggerDirectionUpdate_()}a.removeElements(r);e._events.fire(t?"removeNodes":"removeEdges",s);return r}function As(e,t){var r=e._sourceList.get(t),i=e._targetList.get(t),n=Ss(r,i),a=e._parallelEdgesIndex[n];if(e._parallelTable.removeFromAndGetSize(a,t)===0){e._neighborTable.removeFrom(r,a);if(r!==i){e._neighborTable.removeFrom(i,a)}e._parallelEdgesIndex[n]=undefined}e._directionUpdated.push(a)}function ws(e,t,r){var i=e._neighborTable.get(t),n=0;for(var a=0;a<i.length;++a){var o=e._parallelTable.get(i[a]);for(var s=0;s<o.length;++s){var u=o[s],l=e._sourceList.get(u),f=e._targetList.get(u);if(r&&f===t||!r&&l===t){n+=1;break}}}return n}function Ss(e,t){var r=e<t?e:t,i=e+t-r;return r*67108864+i}function Es(e,t,r,i){var n=e.getAdjacencyTable(true,true,null);var a=e;var o=a._getIndexes(true);var s=o.length;var u={},l={};var f=[],h;for(h=0;h<s;h++){l[o[h]]=h}for(h=0;h<s;h++){var d=o[h];if(!u[d]){var v=d;var c=[d];var _=[];var g=false;while(c.length!==0){v=c.pop();if(!u[v]){c.push.apply(c,n[l[v]].nodes);u[v]=1;_.push(v);if(v===r){g=true}}}if(_.length>0){if(t){if(i){_=_.map(function(e){return a._getId(true,e)})}}else{_=_.map(function(e){return a._getElement(true,e)})}if(g){return _}f.push(_)}}}return f}function Ts(e,t,r,i,n){var a=t?"out":"both";var o=n||e._getIndexes(true);var s=o.map(function(t){return e._collectAdjacentEdges([t],a)});var u=e._nodeIdList;var l=e.getAttributes(false,["source","target","width"]);var f=l[0];var h=l[1];var d=l[2];var v=new Array,c;var _=1,g=false,p=false;if(typeof i==="number"){g=true;_=i}else if(typeof i==="function"){p=true}else if(typeof i!=="string"){i=i?"size":null}for(var y=0,m=s.length;y<m;y++){var b=s[y],x=o[y];var A=void 0,w=void 0,S=void 0,E=void 0;var T=b.length;var M=r?new Array(T):new Uint32Array(T);var C=new Array(T);for(var k=0;k<T;k++){A=b[k];w=f.get(A);S=h.get(A);E=t?S:x===w?S:w;if(r){E=e._getId(true,E)}M[k]=E;if(i){if(g){C[k]=_}else if(p){C[k]=i(u.get(w),u.get(S))}else{C[k]=d.get(A)||_}}}c=Object.create(null);c.nodes=M;c.id=r?e._getId(true,x):x;if(i){c.weights=C}v.push(c)}return v}b.extend(function(e){var t=e.modules.graph;var r=e.Node;var i=e.Edge;var n=e.NodeList;var a=e.EdgeList;r.prototype.toList=function(){return new n([this._index])};i.prototype.toList=function(){return new a([this._index])};n.prototype.toList=function(){return this};a.prototype.toList=function(){return this};n.prototype.toArray=function(){var e=this;var r=this.size,i=new Array(r);for(var n=0;n<r;++n){i[n]=t._getElement(true,e._indexes[n])}return i};n.prototype.clone=function(){return new n(this._indexes.slice())};a.prototype.toArray=function(){var e=this;var r=this.size,i=new Array(r);for(var n=0;n<r;++n){i[n]=t._getElement(false,e._indexes[n])}return i};a.prototype.clone=function(){return new a(this._indexes.slice())};r.prototype.getId=function(){return t._getId(true,this._index)};n.prototype.getId=function(){return t._getIds(true,this._indexes)};i.prototype.getId=function(){return t._getId(false,this._index)};a.prototype.getId=function(){return t._getIds(false,this._indexes)};i.prototype.getSource=function(){return t._getElement(true,t._getSource(this._index))};a.prototype.getSource=function(){return t._getElements(true,t._getSources(this._indexes))};i.prototype.getTarget=function(){return t._getElement(true,t._getTarget(this._index))};a.prototype.getTarget=function(){return t._getElements(true,t._getTargets(this._indexes))};i.prototype.getExtremities=function(){return t._getElements(true,[t._getSource(this._index),t._getTarget(this._index)])};a.prototype.getExtremities=function(){return t._getElements(true,t._getSources(this._indexes).concat(t._getTargets(this._indexes)))};i.prototype.setSource=function(e){t.setSource(this,e)};i.prototype.setTarget=function(e){t.setTarget(this,e)};n.prototype.get=function(e){return t._getElement(true,this._indexes[e])};n.prototype.forEach=function(e){t.forEachNode(this,e)};n.prototype.map=function(e){return t.mapNodes(this,e)};n.prototype.filter=function(e){return t.filterNodes(this,e)};n.prototype.reduce=function(e,r){return t.reduceNodes(this,e,r)};n.prototype.concat=function(e){return t.concatNodes(this,e)};n.prototype.dedupe=function(){return t.dedupeNodes(this)};n.prototype.slice=function(e,t){return new n(this._indexes.slice(e,t))};a.prototype.get=function(e){return t._getElement(false,this._indexes[e])};a.prototype.forEach=function(e){t.forEachEdge(this,e)};a.prototype.map=function(e){return t.mapEdges(this,e)};a.prototype.filter=function(e){return t.filterEdges(this,e)};a.prototype.reduce=function(e,r){return t.reduceEdges(this,e,r)};a.prototype.concat=function(e){return t.concatEdges(this,e)};a.prototype.dedupe=function(){return t.dedupeEdges(this)};n.prototype.partition=function(e){return t.partitionNodes(this,e)};a.prototype.partition=function(e){return t.partitionEdges(this,e)};a.prototype.slice=function(e,t){return new a(this._indexes.slice(e,t))};n.prototype.includes=function(e){if(e.isNode!==true){return false}var r=this._indexes.indexOf(e._index);return r===-1?false:t._getElement(true,e._index)===e};a.prototype.includes=function(e){if(e.isNode!==false){return false}var r=this._indexes.indexOf(e._index);return r===-1?false:t._getElement(false,e._index)===e};n.prototype.sort=function(e){return new n(this._indexes.slice().sort(function(r,i){return e(t._getElement(true,r),t._getElement(true,i))}))};n.prototype.inverse=function(){return t.inverse(this)};a.prototype.inverse=function(){return t.inverse(this)};function o(e){if(typeof e!=="object"||e===null){e={}}var t=typeof e.data==="function"?e.data:function(e){return e},r=Array.isArray(e.attributes)?e.attributes:undefined;return{attributes:r,data:t}}r.prototype.toJSON=function(e){var t=o(e);var r=t.attributes;var i=t.data;return{id:this.getId(),attributes:this.getAttributes(r),data:i(kt(this.getData()))}};n.prototype.toJSON=function(e){if(e===void 0)e={};return this.map(function(t){return t.toJSON(e)})};i.prototype.toJSON=function(e){if(e===void 0)e={};var t=o(e);var r=t.attributes;var i=t.data;return{id:this.getId(),source:this.getSource().getId(),target:this.getTarget().getId(),attributes:this.getAttributes(r),data:i(kt(this.getData()))}};a.prototype.toJSON=function(e){if(e===void 0)e={};return this.map(function(t){return t.toJSON(e)})}});b.extend(function(e){var t=e.Node;var r=e.Edge;var i=e.NodeList;var n=e.EdgeList;var a=new Cs(e);e.modules.data=a;e.events.onNodeDataChange=function(t){e.modules.events.on("updateNodeData",t);return e.events};e.events.onEdgeDataChange=function(t){e.modules.events.on("updateEdgeData",t);return e.events};t.prototype.setData=function(e,value){if(arguments.length<2){value=e;e=null}a.setProperty(this,e,value);return this};t.prototype.getData=function(e){Ms(arguments.length);return a.getProperty(this,e)[0]};r.prototype.setData=function(e,value){if(arguments.length<2){value=e;e=null}a.setProperty(this,e,value);return this};r.prototype.getData=function(e){Ms(arguments.length);return a.getProperty(this,e)[0]};i.prototype.setData=function(e,t){if(arguments.length<2){t=e;e=null}a.setProperty(this,e,t,{dispatch:true});return this};i.prototype.fillData=function(e,value){if(arguments.length<2){value=e;e=null}a.setProperty(this,e,value,{dispatch:false});return this};i.prototype.getData=function(e){Ms(arguments.length);return a.getProperty(this,e)};n.prototype.setData=function(e,t){if(arguments.length<2){t=e;e=null}a.setProperty(this,e,t,{dispatch:true});return this};n.prototype.fillData=function(e,value){if(arguments.length<2){value=e;e=null}a.setProperty(this,e,value,{dispatch:false});return this};n.prototype.getData=function(e){Ms(arguments.length);return a.getProperty(this,e)}});function Ms(e){if(e>1){at("getData: more than one argument were specified, you probably want to "+"use a single array argument instead of multiple arguments")}}var Cs=function e(t){var r=this;this._graph=t.modules.graph;this._events=t.modules.events;this._nodeChanges=[];this._edgeChanges=[];this._timeout=null;this._nodeDataList=this._graph.createAttribute(true,{name:"data",storage:"any"});this._edgeDataList=this._graph.createAttribute(false,{name:"data",storage:"any"});this._nodeList=this._graph.getAttribute(true,"object");this._edgeList=this._graph.getAttribute(false,"object");this._events.register(["updateNodeData","updateEdgeData"]);this._tmp=new Array(2);this._events.on({"addNodes addEdges":function(e){var t=e.nodes;var i=e.edges;var n=e.objects;var a=t||i;var o=a.isNode;var s=a.size;var u=a._indexes;var l=r[o?"_nodeDataList":"_edgeDataList"];for(var f=0;f<s;++f){l.set(u[f],n[f].data)}}})};Cs.prototype.setProperty=function e(t,r,value,i){if(i===void 0)i={};var n=i.dispatch;if(n===void 0)n=false;return Rs(this,t.isNode,t._indexes,r,value,n)};Cs.prototype.getProperty=function e(t,r){return Fs(this,t.isNode,t._indexes,r)};function ks(e){if(!e._timeout){e._timeout=setTimeout(function(){Ns(e);e._timeout=null},0)}}function Ns(e){var t=Is(e,true),r=Is(e,false);e._events.fire("updateNodeData",t);e._events.fire("updateEdgeData",r)}function Is(e,t){var r;var i=t?"_nodeChanges":"_edgeChanges",n=[],a=e[i];e[i]=[];for(var o=0;o<a.length;++o){var s=a[o];n.push.apply(n,s.indexes);s[t?"nodes":"edges"]=e._graph._getElements(t,s.indexes);delete s.indexes}return r={},r[t?"nodes":"edges"]=e._graph._getElements(t,n).dedupe(),r.isNode=t,r.changes=a,r}function zs(e,t){for(var r=0;r<e.length;++r){var i=e[r],n=i.property;if(t===null&&n===null){return i}else if(t&&n&&n.length===t.length){var a=true;for(var o=0;o<n.length;++o){if(n[o]!==t[o]){a=false;break}}if(a){return i}}}var s={property:t&&t.slice(),indexes:[],previousValues:[],newValues:[]};e.push(s);return s}function Ls(e){if(typeof e==="string"){return e.split(".")}else if(Array.isArray(e)){return e}else if(e===undefined||e===null){return null}else{return[e.toString()]}}function Rs(e,t,r,i,value,n){if(n&&typeof value==="function"){n=false}i=Ls(i);var a=typeof value==="function",o=t?e._nodeList:e._edgeList,s=t?e._nodeDataList:e._edgeDataList,u=t?e._nodeChanges:e._edgeChanges,l=zs(u,i);for(var f=0;f<r.length;++f){var h=r[f],d=s.get(h),v=o.get(h),c=n?value[f]:value,_=void 0,g=void 0;if(i===null){_=d;g=a?c(v):c;s.set(h,g)}else{if(d===null||d===undefined){d={};s.set(h,d)}Ds(d,i,c,a,v,e._tmp);_=e._tmp[0];g=e._tmp[1]}l.indexes.push(h);l.previousValues.push(_);l.newValues.push(g)}ks(e)}function Ds(e,t,value,r,i,n){var a=t.length-1;for(var o=0;o<a;++o){var s=t[o],u=e[s];if(u===null||u===undefined){u={};e[s]=u}e=u}var l=t[a],f=e[l],h=r?value(i):value;e[l]=h;n[0]=f;n[1]=h}function Fs(e,t,r,i,n){i=Ls(i);if(!n){n=new Array(r.length)}var a=t?e._nodeDataList:e._edgeDataList;for(var o=0;o<r.length;++o){var s=r[o],u=a.get(s);n[o]=Ps(u,i)}return n}function Ps(e,t){if(t===null||!t.length){return e}else if(e===undefined||e===null){return undefined}var r=t.length-1;for(var i=0;i<r;++i){var n=t[i];e=e[n];if(e===null||e===undefined){return undefined}}return e[t[r]]}var Bs={linear:function(e){return e},quadraticIn:function(e){return e*e},quadraticOut:function(e){return e*(2-e)},quadraticInOut:function(e){if((e*=2)<1){return.5*e*e}return-.5*(--e*(e-2)-1)},cubicIn:function(e){return e*e*e},cubicOut:function(e){return--e*e*e+1},cubicInOut:function(e){if((e*=2)<1){return.5*e*e*e}return.5*((e-=2)*e*e+2)}};var Os={duration:0,easing:"linear",callback:function(){},startAfter:0};b.extend(function(e){return e.modules.animations=new Vs(e)});var Vs=function e(t){var r=this;this._dom=t.modules.dom;this._events=t.modules.events;this._animationList=[];this._events.on("beforeNewFrame",function(){return r._updateAnimations()})};Vs.prototype._updateAnimations=function e(){var t=this;if(this._animationList.length===0){return true}var r=oe();var i=[];for(var n=0;n<this._animationList.length;++n){var a=t._animationList[n],o=(r-a.creationDate)/a.duration,s=a.startAfter,u=a.easing(o);if(o>=1){a.func(1);a.done=true;t._animationList.splice(n,1);n-=1;i.push(a.callback)}else if(u>=s){var l=1/(1-s);u=(u-s)*l;a.func(u)}}for(var f=0;f<i.length;++f){i[f](false)}this._dom.refresh()};Vs.prototype.play=function e(t,r){var i=ct(r,Os);var n=i.duration;var a=i.easing;var o=i.callback;var s=i.startAfter;var u=null;if(n<=0){t(1);o()}else{u={func:t,easing:typeof a==="function"?a:Bs[a],duration:n,callback:o,startAfter:s,creationDate:oe(),done:false};this._animationList.push(u);this._dom.refresh()}return u};Vs.prototype.end=function e(t,r){if(r===void 0)r=true;var i=this._animationList.indexOf(t);if(i!==-1){t.func(1);this._animationList.splice(i,1);t.done=true;if(r){t.callback(true)}}};var js=1e-8;var Us=1e8;var Gs={duration:0,easing:"linear",startAfter:0};function Xs(e){return Math.abs(e)<1e-9}b.extend(function(e){var t=new Hs(e),r=e.modules,i=e.view;r.camera=t;i.setZoom=function(e,r){return t.setZoom(e,r)};i.zoomIn=function(e,r){return t.zoomIn(e,r)};i.zoomOut=function(e,r){return t.zoomOut(e,r)};i.getZoom=function(){return t.getZoom()};i.setCenter=function(e,r){return t.setCenter(e,r)};i.move=function(e,r){return t.move(e,r)};i.getCenter=function(){return t.getCenter()};i.setAngle=function(e,r){return t.setAngle(e,r)};i.rotate=function(e,r){return t.rotate(e,r)};i.getAngle=function(){return t.getAngle()};i.set=function(e,r){return t.setView(e,r)};i.get=function(){return t.getView()};i.graphToScreenCoordinates=function(e){return t.graphToScreenCoordinates(e)};i.screenToGraphCoordinates=function(e){return t.screenToGraphCoordinates(e)};i.getSize=function(){return{width:t.width,height:t.height}};e.events.onZoomProgress=function(t){r.events.on("cameraZoom",t);return e.events};e.events.onViewChanged=function(t){r.events.on("viewChanged",t);return e.events}});var Ws=100;var Hs=function e(t){var r=this;this._ogma=t;this._events=t.modules.events;this._dom=t.modules.dom;this._animations=t.modules.animations;this._settings=t.modules.settings;this._zoomAnimation=null;this._moveAnimation=null;qs(this);this._minZoom=js;this._maxZoom=Us;this._events.register(["cameraMove","cameraPan","cameraZoom","cameraRotate","viewChanged"]);this._settings.register("minZoom",js,function(e){r._minZoom=e;if(r._zoom<e){r._zoom=e;r._events.fire("cameraMove")}});this._settings.register("maxZoom",Us,function(e){r._maxZoom=e;if(r._zoom>e){r._zoom=e;r._events.fire("cameraMove")}});this._timeout=null;this._moveEnd=function(e){if(r._timeout){clearTimeout(r._timeout)}r._timeout=setTimeout(function(){r._timeout=null;r._events.fire("viewChanged",{type:e})},Ws)};this._events.on({setContainer:function(){qs(r);r._events.fire("cameraMove")},resize:function(){r.reloadDimensions();r._events.fire("cameraMove")}})};var Ys={x:{configurable:true},y:{configurable:true},zoom:{configurable:true},angle:{configurable:true},width:{configurable:true},height:{configurable:true}};Ys.x.get=function(){return this._x};Ys.y.get=function(){return this._y};Ys.zoom.get=function(){return this._zoom};Ys.angle.get=function(){return this._angle};Ys.width.get=function(){return this._dimensions.width};Ys.height.get=function(){return this._dimensions.height};Hs.prototype.getCenter=function e(){return{x:this._x,y:this._y}};Hs.prototype.setCenter=function e(t,r){var i=this;var n=t.x;var a=t.y;r=ct(r,Gs);var o=this._x,s=this._y,u=n-this._x,l=a-this._y;if(Xs(u)&&Xs(l)){return Promise.resolve()}return new Promise(function(e){var t=function(e){i._x=o+u*e;i._y=s+l*e;i._events.fire("cameraMove");i._events.fire("cameraPan")};r.callback=Zs(i,e,"pan");if(i._moveAnimation){i._animations.end(i._moveAnimation)}i._moveAnimation=i._animations.play(t,r)})};Hs.prototype.move=function e(t,r){var i=t.x;var n=t.y;var a=$s(this,{x:i,y:n});return this.setCenter({x:this._x+a.x,y:this._y+a.y},r)};Hs.prototype.getZoom=function e(){return this._zoom};Hs.prototype.setZoom=function e(t,r,i){var n=this;if(i===void 0)i={};var a=i.refX;var o=i.refY;r=ct(r,Gs);var s=this._minZoom;var u=this._maxZoom;var l=be(t,s,u);if(Xs(this._zoom-l)){return Promise.resolve()}return new Promise(function(e){var t=n._dimensions.width/2;var i=n._dimensions.height/2;var s=n._zoom;var u=t/s-t/l;var f=function(e){n._zoom=t/(t/s-u*e);n._events.fire("cameraMove");n._events.fire("cameraZoom")};r.callback=Zs(n,e,"zoom");if(a!==undefined&&o!==undefined){var h=(a-t)/s-(a-t)/l;var d=(o-i)/s-(o-i)/l;var v=Math.cos(n._angle);var c=Math.sin(n._angle);var _=v*h-c*d;var g=c*h+v*d;n.setCenter({x:n._x+_,y:n._y+g},r)}if(n._zoomAnimation){n._animations.end(n._zoomAnimation)}n._zoomAnimation=n._animations.play(f,r)})};Hs.prototype.zoomIn=function e(t,r,i){if(typeof t!=="number"){i=r;r=t;t=this._settings.get("interactions.zoom.modifier")}return this.setZoom(this._zoom*t,r,i)};Hs.prototype.zoomOut=function e(t,r,i){if(typeof t!=="number"){i=r;r=t;t=this._settings.get("interactions.zoom.modifier")}return this.setZoom(this._zoom/t,r,i)};Hs.prototype.getAngle=function e(){return this._angle};Hs.prototype.setAngle=function e(t,r){var i=this;r=ct(r,Gs);var n=this._angle;var a=t-n;if(Xs(a)){return Promise.resolve()}return new Promise(function(e){var t=function(e){i._angle=n+a*e;while(i._angle>Math.PI){i._angle-=2*Math.PI}while(i._angle<-Math.PI){i._angle+=2*Math.PI}i._events.fire("cameraMove");i._events.fire("cameraRotate")};r.callback=Zs(i,e,"rotate");if(i._rotateAnimation){i._animations.end(i._rotateAnimation)}i._rotateAnimation=i._animations.play(t,r)})};Hs.prototype.rotate=function e(t,r){return this.setAngle(this._angle+t,r)};Hs.prototype.getScreenCenter=function e(){return{x:this._dimensions.width/2,y:this._dimensions.height/2}};Hs.prototype.graphToScreenCoordinates=function e(t,r){var i=t.x;var n=t.y;if(r===void 0)r={};var a=this._dimensions.width/2;var o=this._dimensions.height/2;var s=(i-this._x)*this._zoom+a;var u=(n-this._y)*this._zoom+o;return Ri(s,u,a,o,-this._angle,r)};Hs.prototype.screenToGraphCoordinates=function e(t,r){var i=t.x;var n=t.y;if(r===void 0)r={};var a=this._x+(i-this._dimensions.width/2)/this._zoom;var o=this._y+(n-this._dimensions.height/2)/this._zoom;return Ri(a,o,this._x,this._y,this._angle,r)};Hs.prototype.screenToGraphVector=function e(t){var r=t.x;var i=t.y;return $s(this,{x:r,y:i})};Hs.prototype.getView=function e(){return{x:this._x,y:this._y,zoom:this._zoom,angle:this._angle,width:this._dimensions.width,height:this._dimensions.height}};Hs.prototype.setView=function e(t,r){var i=ct(t,{x:this._x,y:this._y,zoom:this._zoom,angle:this._angle});var n=i.x;var a=i.y;var o=i.zoom;var s=i.angle;this.setCenter({x:n,y:a},r);this.setZoom(o,r);return this.setAngle(s,r)};Hs.prototype.reloadDimensions=function e(){this._dimensions=this._dom.getDimensions()};Hs.prototype.animationInProgress=function e(){var t=this._moveAnimation;var r=this._zoomAnimation;return t&&!t.done||r&&!r.done};Hs.prototype.getProjectedScreenBounds=function e(t){if(t===void 0)t=0;var r=this._dimensions;var i=r.width;var n=r.height;var a=Math.max(i,n)*t;return[this.screenToGraphCoordinates({x:0-a,y:0-a}),this.screenToGraphCoordinates({x:i+a,y:n+a}),this.screenToGraphCoordinates({x:i+a,y:0-a}),this.screenToGraphCoordinates({x:0-a,y:n+a})].reduce(function(e,t){e[0]=Math.min(e[0],t.x);e[1]=Math.min(e[1],t.y);e[2]=Math.max(e[2],t.x);e[3]=Math.max(e[3],t.y);return e},[Infinity,Infinity,-Infinity,-Infinity])};Object.defineProperties(Hs.prototype,Ys);function qs(e){e._zoom=1;e._x=0;e._y=0;e._angle=0;e._dimensions=e._dom.getDimensions()}function Zs(e,t,r){return function(){e._moveEnd(r);t(r)}}function $s(e,t){var r=t.x;var i=t.y;r/=e._zoom;i/=e._zoom;var n=Math.cos(e._angle);var a=Math.sin(e._angle);return{x:n*r-a*i,y:a*r+n*i}}var Ks=0;var Js=2;var Qs=10;var eu=11;var tu=12;var ru=13;var iu=14;var nu=15;var au={};au[eu]="image";au[ru]="pieChart";au[tu]="text";au[iu]="icon";var ou=function e(){this._version=0;this._mustUpdate=true;this._nextPatternId=1;this._patterns=[null];this._patternsByHash={};this._nullPattern={type:Qs,attributes:{}}};ou.prototype._increaseNextId=function e(){var t=this._nextPatternId++;if(t%256===255){t=this._nextPatternId++}return t};ou.prototype._createPattern=function e(t){var r=t.type;var i=t.attributes;var n={id:this._increaseNextId(),type:r,attributes:this._cloneAttributes(r,i)};this._patterns.push(n);this._mustUpdate=true;return n};ou.prototype._cloneAttributes=function e(t,r){if(t===eu){return{image:r.image,scaled:r.scaled,duplicated:r.duplicated}}else if(t===tu||t===iu){return{font:r.font,size:r.size,style:r.style,text:r.text,align:r.align||"center",pixelRatio:r.pixelRatio||1,offset:r.offset||0}}else if(t===ru){return{colors:r.colors,colorArray:r.colors.split(";").map(function(e){return e.trim()})}}};ou.prototype.getPatternList=function e(){return this._patterns.slice(1)};ou.prototype.update=function e(){if(this._mustUpdate){this._version+=1;this._mustUpdate=false}};ou.prototype.notifyUpdate=function e(){this._mustUpdate=true};ou.prototype.getIdFromDefinition=function e(t){var r=0;var i=t&&(t.type&&t.type!==Qs)&&t.type!==nu&&(t.type!==eu||t.attributes.image)&&(t.type!==tu||t.attributes.text);if(i){var n=this._getPatternHash(t);r=this._patternsByHash[n];if(!r){if(this._nextPatternId>65535){at("maximum number of pattern exceeded")}else{r=this._createPattern(t).id;this._patternsByHash[n]=r}}}return r};ou.prototype._getPatternHash=function e(t){var r=t.type;var i=t.attributes;var n=[au[r]];if(r===eu){n.push(i.scaled?"scaled":"non-scaled",i.duplicated?"duplicated":"non-duplicated",i.image.src||i.image.toDataURL())}else if(r===tu){n.push(i.text,i.font,i.style,i.size,i.align||"center",i.pixelRatio||1,i.offset||0)}else if(r===iu){n.push(i.text,i.font,i.style,i.size,i.pixelRatio||1)}else{n.push(i.colors)}return n.join("+")};ou.prototype.getDefinitionFromId=function e(t){return t?this._patterns[t]:this._nullPattern};ou.prototype.getVersion=function e(){return this._version};function su(e,t){return Math.sqrt(e*e+t*t)}var uu=1e-5;function lu(e,t,r){var i=Infinity,n=0,a=0;for(var o=0;o<r.length;++o){var s=r[o],u=r[(o+1)%r.length],l=s.x,f=s.y,h=u.x,d=u.y,v=h-l,c=d-f,_=l,g=f;if(v===0){g=t}else if(c===0){_=e}else{var p=c/v,y=-(v/c);_=(l*p-e*y+t-f)/(p-y);g=p*_+f-l*p}var m=su(_-e,g-t),b=su(l-h,f-d),x=su(l-_,f-g),A=su(h-_,d-g),w=x+A<=b+uu;if(!w){if(x<A){m=su(l-e,f-t);_=l;g=f}else{m=su(h-e,d-t);_=h;g=d}}if(m<i){i=m;n=_;a=g}}var S=su(e,t);var E=su(n,a);return i*(S<=E?1:-1)}function fu(e,t){if(t===void 0)t=1;var r=-Math.PI/2+uu;var i=[],n=Math.PI*2/e,a=r;for(var o=0;o<e;++o){var s=o%2===1?t:1;i.push({x:Math.cos(a)*s,y:Math.sin(a)*s});a+=n}return i}var hu=fu(4);var du=fu(5);var vu=fu(10,.4);function cu(e){return{getDistanceFromStrokeVertically:function(){return 1},getDistanceFromStrokeHorizontally:function(t,r){return lu(t,r,e)},points:e}}var _u={circle:{getDistanceFromStrokeVertically:function(e,t){return 1},getDistanceFromStrokeHorizontally:function(e,t){return 1-Math.sqrt(e*e+t*t)},points:[{x:0,y:0}]},square:{getDistanceFromStrokeVertically:function(e,t){return 1-Math.abs(t)},getDistanceFromStrokeHorizontally:function(e,t){return 1-Math.abs(e)},points:[{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}]},line:{getDistanceFromStrokeVertically:function(e,t){return 1-Math.abs(t)},getDistanceFromStrokeHorizontally:function(e,t){return 1},points:[{x:-1,y:0},{x:1,y:0}]},triangle:{getDistanceFromStrokeVertically:function(e,t){return(1-e)/2-Math.abs(t)},getDistanceFromStrokeHorizontally:function(e,t){return 1-Math.abs(e)},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}]},arrow:{getDistanceFromStrokeVertically:function(e,t){return(1-e)/2-Math.abs(t)},getDistanceFromStrokeHorizontally:function(e,t){return 1-Math.abs(e)},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}]},cross:{getDistanceFromStrokeVertically:function(e,t){return 1},getDistanceFromStrokeHorizontally:function(e,t){var r=Math.abs(e);var i=Math.abs(t);var n=.31-Math.min(r,i);var a=1-Math.max(Math.abs(e),Math.abs(t));return Math.min(n,a)},points:[{x:-1,y:.31},{x:-1,y:-.31},{x:-.31,y:-.31},{x:-.31,y:-1},{x:.31,y:-1},{x:.31,y:-.31},{x:1,y:-.31},{x:1,y:.31},{x:.31,y:.31},{x:.31,y:1},{x:-.31,y:1},{x:-.31,y:.31}]},diamond:cu(hu),pentagon:cu(du),star:cu(vu)};var gu=function e(){var t=this;this._version=0;this._mustUpdate=true;this._byName={};this._byId=[null];Object.keys(_u).forEach(function(e){t.register(e,_u[e])})};gu.prototype.register=function e(t,r){var i=r.getDistanceFromStrokeVertically;var n=r.getDistanceFromStrokeHorizontally;var a=r.points;var o={id:this._byId.length,name:t,getDistanceFromStrokeVertically:i,getDistanceFromStrokeHorizontally:n,points:a.slice()};this._mustUpdate=true;this._byId.push(o);this._byName[t]=o;return o};gu.prototype.getIdFromName=function e(t){return this._byName[t].id};gu.prototype.getNameFromId=function e(t){return t?this._byId[t].name:null};gu.prototype.getDefinitionFromName=function e(t){return this._byName[t]||null};gu.prototype.update=function e(){if(this._mustUpdate){this._version+=1;this._mustUpdate=false}};gu.prototype.getVersion=function e(){return this._version};gu.prototype.getShapeList=function e(){return this._byId};var pu=2048;var yu=128;var mu=Math.log2(pu);var bu=Math.log2(yu);var xu=mu+bu;var Au=127;var wu=255;var Su=32767;var Eu=65535;var Tu=15;var Mu=3;var Cu=256;var ku=1/16;var Nu=16;var Iu=1;var zu=256;var Lu=128;var Ru=128;var Du=1.2;var Fu=1.1;var Pu=44;var Bu=16;var Ou=Pu*2+Bu;var Vu=4;var ju=function e(t){var r=t.elementSize;var i=t.sideElementSize;var n=t.nbSideElementsPerMainElement;var a=t.id;var o=t.depth;var s=t.elementType;var u=t.animated;this._id=a;this._depth=o;this._elementType=s;this._animated=u;this._version=0;this._elementSize=r;this._sideElementSize=i;this._nbSideElementsPerMainElement=n;this._totalSideElementsSize=n*i;this._capacity=pu;this._byteCapacity=this._capacity*this._elementSize;this._byteArray=new Uint8Array(this._byteCapacity);this._dataView=new DataView(this._byteArray.buffer);this._sideByteCapacity=this._capacity*this._totalSideElementsSize;this._sideByteArray=new Uint8Array(this._sideByteCapacity);this._sideDataView=new DataView(this._sideByteArray.buffer);this._nbCellsAllocated=0;this._nbCellsFreed=0;this._isFullyAllocated=false;this._isFullyFreed=false;this._mustUpdate=true};ju.prototype.update=function e(){if(this._mustUpdate){this._version+=1;this._mustUpdate=false;if(this._isFullyAllocated&&this._nbCellsFreed===this._nbCellsAllocated){this._isFullyFreed=true}}};ju.prototype.allocate=function e(t){var r=-1;if(!this._isFullyAllocated&&this._nbCellsAllocated+t<=this._capacity){r=this._nbCellsAllocated;this._nbCellsAllocated+=t;this._mustUpdate=true}else{this._isFullyAllocated=true}return r};ju.prototype.free=function e(t,r){var i=this;for(var n=0;n<r;++n){var a=(t+n)*i._elementSize;if(!i._byteArray[a]){throw new Error('"free": invalid address provided')}i._byteArray[a]=0}this._mustUpdate=true;this._nbCellsFreed+=r};ju.prototype.triggerUpdate=function e(){this._mustUpdate=true};ju.prototype.isEmpty=function e(){return this._nbCellsFreed===this._nbCellsAllocated};ju.prototype.isFullyFreed=function e(){return this._isFullyFreed};ju.prototype.getId=function e(){return this._id};ju.prototype.getDepth=function e(){return this._depth};ju.prototype.getElementType=function e(){return this._elementType};ju.prototype.getDataView=function e(){return this._dataView};ju.prototype.getByteArray=function e(){return this._byteArray};ju.prototype.getElementSize=function e(){return this._elementSize};ju.prototype.isAnimated=function e(){return this._animated};ju.prototype.getCapacity=function e(){return this._capacity};ju.prototype.getSize=function e(){return this._nbCellsAllocated};ju.prototype.getNbSideElementsPerMainElement=function e(){return this._nbSideElementsPerMainElement};ju.prototype.hasSideData=function e(){return this._nbSideElementsPerMainElement>0};ju.prototype.getSideDataView=function e(){return this._sideDataView};ju.prototype.getSideByteArray=function e(){return this._sideByteArray};ju.prototype.getTotalSideElementsSize=function e(){return this._totalSideElementsSize};ju.prototype.getVersion=function e(){return this._version};var Uu=8;var Gu=function e(){this._buffersByDepth=new Array(100);this._buffersById=[];this._buffersByAscendingDepth=[];this._buffersByDescendingDepth=[];this._version=0;this._mustUpdate=true;this._blockInfo={buffer:null,offset:0,size:0,address:0}};Gu.prototype._fillBlockInfo=function e(t,r,i,n){this._blockInfo.buffer=t;this._blockInfo.offset=r;this._blockInfo.size=i;this._blockInfo.address=n;return this._blockInfo};Gu.prototype._createBuffer=function e(t,r,i,n){var a=r?Ou:Pu,o=this._buffersById.length,s=new ju({elementSize:a,sideElementSize:Vu,nbSideElementsPerMainElement:n,id:o,depth:i,elementType:t,animated:r});this._buffersById.push(s);return s};Gu.prototype.getBlockInfo=function e(t){return this._getBlockInfo(t)};Gu.prototype._getBlockInfo=function e(t){return this._fillBlockInfo(this._buffersById[t>>xu],(t>>bu)%pu,t%yu,t)};Gu.prototype.allocateBlock=function e(t,r,i,n,a,o){var s=Wu(o,Uu);this._mustUpdate=true;var u=null;var l=-1;if(t){var f=this._getBlockInfo(t),h=f.buffer,d=f.offset,v=f.size,c=f.size===a,_=h.getDepth()===n,g=h.getElementType()===r,p=h.isAnimated()===i,y=h.getNbSideElementsPerMainElement()===s;if(c&&_&&g&&p&&y){h.triggerUpdate();u=h;l=d}else{h.free(d,v)}}if(l===-1){var m=s/Uu;var b=this._buffersByDepth[n]||(this._buffersByDepth[n]=new Array(2));var x=b[+i]||(b[+i]=[]);var A=x[r]||(x[r]=new Array(16));var w=A[m]||(A[m]=[]);var S=w[w.length-1];if(S){u=S;l=S.allocate(a)}if(l===-1){u=this._createBuffer(r,i,n,s);l=u.allocate(a);w.push(u)}}var E=Xu(u.getId(),l,a);return this._fillBlockInfo(u,l,a,E)};Gu.prototype.freeBlock=function e(t){if(t){this._mustUpdate=true;var r=this._getBlockInfo(t);r.buffer.free(r.offset,r.size)}return 0};Gu.prototype._sortBuffersByDepth=function e(){var t=this;var r=[];for(var i=0;i<this._buffersByDepth.length;++i){var n=t._buffersByDepth[i];if(!n){continue}for(var a=0;a<n.length;++a){var o=n[a];if(!o){continue}for(var s=0;s<o.length;++s){var u=o[s];if(!u){continue}for(var l=0;l<u.length;++l){var f=u[l];if(!f){continue}for(var h=0;h<f.length;++h){var d=f[h];d.update();if(d.isFullyFreed()){t._buffersById[d.getId()]=undefined;f.splice(h,1);h-=1}else{r.push(d)}}}}}}this._buffersByAscendingDepth=r;this._buffersByDescendingDepth=r.slice().reverse()};Gu.prototype.update=function e(){if(this._mustUpdate){this._sortBuffersByDepth();this._version+=1;this._mustUpdate=false}};Gu.prototype.getBuffers=function e(){return this._buffersById};Gu.prototype.getBuffersByAscendingDepth=function e(){return this._buffersByAscendingDepth};Gu.prototype.getBuffersByDescendingDepth=function e(){return this._buffersByDescendingDepth};Gu.prototype.getVersion=function e(){return this._version};function Xu(e,t,r){return((e<<mu)+t<<bu)+r}function Wu(e,t){var value=0;while(value<e){value+=t}return value}function Hu(){return{opacity:1,minVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,shape:"circle",dashLength:0,gapLength:0,angleAffectedByView:false,offsetAffectedByAngle:false,adjustAngle:false,isSelfLoop:false,patternSdf:false,offsetAngle:0,patternScale:0,pattern:{type:0,attributes:{}},fillColor:null,strokeColor:null,shapeStart:0,shapeEnd:1,x:0,y:0,angle:0,lengthScaled:0,thicknessScaled:0,strokeWidthScaled:0,offsetScaled:0,lengthAbsolute:0,thicknessAbsolute:0,strokeWidthAbsolute:0,offsetAbsolute:0,dashOffset:0,patternMask:"black",symbolicSize:-1,curvature:0}}function Yu(e){e.opacity=1;e.minVisibleSize=0;e.strokeMinVisibleSize=0;e.patternMinVisibleSize=0;e.shape="circle";e.dashLength=0;e.gapLength=0;e.angleAffectedByView=false;e.offsetAffectedByAngle=false;e.adjustAngle=false;e.isSelfLoop=false;e.patternSdf=false;e.offsetAngle=0;e.patternScale=0;e.pattern.type=0;e.fillColor=null;e.strokeColor=null;e.shapeStart=0;e.shapeEnd=1;e.x=0;e.y=0;e.angle=0;e.lengthScaled=0;e.thicknessScaled=0;e.strokeWidthScaled=0;e.offsetScaled=0;e.lengthAbsolute=0;e.thicknessAbsolute=0;e.strokeWidthAbsolute=0;e.offsetAbsolute=0;e.dashOffset=0;e.patternMask="black";e.symbolicSize=-1;e.curvature=0;return e}function qu(e){e.beginTime=-1;e.duration=0;e.easing="linear"}function Zu(){return{end:Hu(),start:Hu(),animation:{beginTime:-1,duration:0,easing:"linear"}}}function $u(e,t,r,i){e.width=t*i;e.height=r*i;e.style.width=t+"px";e.style.height=r+"px"}var Ku=function e(t){var r=t.bufferList;var i=t.shapeManager;var n=t.patternManager;var a=t.boundariesManager;var o=t.textManager;var s=t.colorManager;var u=t.easingManager;this._bufferList=r;this._shapeManager=i;this._patternManager=n;this._boundariesManager=a;this._textManager=o;this._colorManager=s;this._easingManager=u;this._width=0;this._height=0;this._pixelRatio=0;this._viewX=0;this._viewY=0;this._viewZoom=0;this._viewAngle=0;this._viewAngleCos=0;this._viewAngleSin=0;this._currentTime=0;this._bytesToActualCoord=0;this._bytesToActualScaledSize=0;this._bytesToActualPixelSize=0;this._bytesToActualMinVisibleSize=0;this._bytesToActualSymbolicSize=0;this._bytesToActualDashOffset=0;this._bytesToActualDashLength=0;this._bytesToActualGapLength=0;this._shapesVersion=0;this._patternsVersion=0;this._boundariesVersion=0;this._textsVersion=0;this._backgroundColor=null;this._backgroundRgba=[0,0,0,0];this._isBufferDisplayable=null;this._hideImages=false;this._rgbaToString=new Array(65535);this._genericObject=Zu();this._littleEndian=Le()};Ku.getName=function e(){return null};Ku.prototype.getDomElement=function e(){return null};Ku.prototype.export=function e(){return Promise.resolve()};Ku.prototype._colorToString=function e(t){var r=this._rgbaToString[t];if(!r){var i=(t>>12)/15,n=(t>>8)%16/15,a=(t>>4)%16/15,o=t%16/15;r="rgba("+(i*255|0)+", "+(n*255|0)+", "+(a*255|0)+", "+o+")";if(i+n+a+o===0){r=null}this._rgbaToString[t]=r}return r};Ku.prototype._getBytesToActualSize=function e(t){return t?this._bytesToActualScaledSize:this._bytesToActualPixelSize};Ku.prototype._unsignedToSignedByte=function e(value){return value-128};Ku.prototype._adjustAngleValue=function e(t){return t<Math.PI?t:t-Math.PI*2};Ku.prototype._extractGenericObject=function e(t,r,i){var n=r,a=i,o=this._littleEndian;var s=n.getUint8(a),u=s>>4,l=s%16>>2,f=s%4,h=n.getUint8(a+1),d=h>>4,v=h%16,c=n.getUint8(a+2),_=c>>4,g=c%16,p=n.getUint8(a+3),y=(p>>7)%2,m=(p>>6)%2,b=(p>>5)%2,x=(p>>4)%2,A=(p>>3)%2,w=p%8,S=n.getUint16(a+4,o),E=n.getUint16(a+6,o),T=n.getUint16(a+8,o),M=n.getUint16(a+10,o),C=M>>8,k=M%256,N=n.getFloat32(a+12,o),I=n.getFloat32(a+16,o),z=n.getFloat32(a+20,o),L=n.getFloat32(a+24,o),R=n.getUint16(a+28,o),D=n.getUint16(a+30,o),F=n.getUint16(a+32,o),P=n.getUint16(a+34,o),B=n.getUint16(a+36,o),O=P>>8,V=P%256,j=B>>8,U=B%256,G=n.getUint16(a+38,o),X=n.getUint16(a+40,o),W=X>>8,H=X%256,Y=n.getUint16(a+42,o),q=Y>>8,Z=Y%256;t.shape=this._shapeManager.getNameFromId(u);t.dashLength=l*this._bytesToActualDashLength;t.gapLength=f*this._bytesToActualGapLength;t.opacity=d/15;t.minVisibleSize=v*this._bytesToActualMinVisibleSize;t.strokeMinVisibleSize=_*this._bytesToActualMinVisibleSize;t.patternMinVisibleSize=g*this._bytesToActualMinVisibleSize;t.offsetAffectedByAngle=!!m;t.adjustAngle=!!b;t.patternSdf=!!x;t.isSelfLoop=!!A;t.offsetAngle=w*(Math.PI*2/8);t.pattern=this._patternManager.getDefinitionFromId(S);t.fillColor=this._colorToString(E);t.strokeColor=this._colorToString(T);t.shapeStart=C/255;t.shapeEnd=k/255;t.x=N;t.y=I;t.angle=this._adjustAngleValue(z);t.angleAffectedByView=!!y;t.lengthScaled=L;t.thicknessScaled=R*this._bytesToActualScaledSize;t.strokeWidthScaled=D*this._bytesToActualScaledSize;t.offsetScaled=F*this._bytesToActualScaledSize;t.lengthAbsolute=O*this._bytesToActualPixelSize;t.thicknessAbsolute=V*this._bytesToActualPixelSize;t.strokeWidthAbsolute=j*this._bytesToActualPixelSize;t.offsetAbsolute=U*this._bytesToActualPixelSize;t.patternScale=W/127;t.dashOffset=H*this._bytesToActualDashOffset;t.patternMask=this._colorToString(G);t.symbolicSize=q*this._bytesToActualSymbolicSize;t.curvature=this._unsignedToSignedByte(Z)};Ku.prototype._extractAnimationInformation=function e(t,r,i){var n=r,a=i,o=this._littleEndian;var s=n.getFloat32(a,o),u=n.getFloat32(a+4,o),l=n.getUint16(a+8,o),f=n.getUint16(a+10,o),h=n.getUint16(a+12,o),d=n.getUint16(a+14,o),v=(l>>8)-128,c=(f>>8)-128,_=(h>>8)-128,g=(d>>8)-128,p=l%256-128,y=f%256-128,m=h%256-128,b=d%256-128;t.beginTime=s;t.duration=u;t.easing=this._easingManager.getNameFromPolygon(v,c,_,g,p,y,m,b)};Ku.prototype._extractTextCharacters=function e(t,r,i,n){t.pattern=this._textManager.extractTextFromDataView(r,i,n)};Ku.prototype.extractElement=function e(t,r){var i=t.getElementType(),n=t.isAnimated(),a=t.getDataView(),o=t.getElementSize(),s=r*o,u=this._genericObject;u.valid=false;if(a.getUint8(s)){u.valid=true;this._extractGenericObject(u.end,a,s);if(n){this._extractGenericObject(u.start,a,s+Pu);this._extractAnimationInformation(u.animation,a,s+Pu*2)}if(i===Js){var l=t.getSideDataView(),f=r*t.getTotalSideElementsSize(),h=f+t.getTotalSideElementsSize(),d=u.end;this._extractTextCharacters(d,l,f,h)}}return u};Ku.prototype._compareDimensions=function e(t,r,i){if(t!==this._width||r!==this._height||i!==this._pixelRatio){this._width=t;this._height=r;this._pixelRatio=i;return true}return false};Ku.prototype._compareView=function e(t,r,i,n){if(t!==this._viewX||r!==this._viewY||i!==this._viewZoom||n!==this._viewAngle){this._viewX=t;this._viewY=r;this._viewZoom=i;this._viewAngle=n;this._viewAngleCos=Math.cos(n);this._viewAngleSin=Math.sin(n);return true}return false};Ku.prototype._compareCurrentTime=function e(t){if(t!==this._currentTime){this._currentTime=t;return true}return false};Ku.prototype._compareBackgroundColor=function e(t){if(t!==this._backgroundColor){this._backgroundColor=t;this._backgroundRgba=this._colorManager.parseColor(this._backgroundColor);return true}return false};Ku.prototype._compareShapes=function e(){if(this._shapesVersion!==this._shapeManager.getVersion()){this._shapesVersion=this._shapeManager.getVersion();return true}return false};Ku.prototype._comparePatterns=function e(){if(this._patternsVersion!==this._patternManager.getVersion()){this._patternsVersion=this._patternManager.getVersion();return true}return false};Ku.prototype._compareBoundaries=function e(){if(this._boundariesVersion!==this._boundariesManager.getVersion()){this._boundariesVersion=this._boundariesManager.getVersion();return true}return false};Ku.prototype._compareTexts=function e(){if(this._textsVersion!==this._textManager.getVersion()){this._textsVersion=this._textManager.getVersion();return true}return false};Ku.prototype._compareIsDisplayableBuffer=function e(t){if(this._isBufferDisplayable!==t){this._isBufferDisplayable=t;return true}return false};Ku.prototype._compareHideImages=function e(t){if(this._hideImages!==t){this._hideImages=t;return true}return false};Ku.prototype.renderFrame=function e(t){var r=t.x;var i=t.y;var n=t.zoom;var a=t.angle;var o=t.width;var s=t.height;var u=t.pixelRatio;var l=t.backgroundColor;var f=t.currentTime;var h=t.isBufferDisplayable;var d=t.hideImages;var v=this._compareShapes(),c=this._comparePatterns(),_=this._compareBoundaries(),g=this._compareTexts(),p=this._compareDimensions(o,s,u),y=this._compareView(r,i,n,a),m=this._compareCurrentTime(f),b=this._compareBackgroundColor(l),x=this._compareIsDisplayableBuffer(h),A=this._compareHideImages(d);if(_){var w=this._boundariesManager;this._bytesToActualCoord=w.maxCoord/Su;this._bytesToActualScaledSize=w.maxScaledSize/Eu;this._bytesToActualPixelSize=w.maxPixelSize/wu;this._bytesToActualMinVisibleSize=w.maxMinVisibleSize/Tu;this._bytesToActualSymbolicSize=w.maxSymbolicSize/wu;this._bytesToActualDashOffset=w.maxDashOffset/wu;this._bytesToActualDashLength=w.maxDashLength/Mu;this._bytesToActualGapLength=w.maxGapLength/Mu}this._render({shapesChanged:v,patternsChanged:c,boundariesChanged:_,textsChanged:g,dimensionsChanged:p,viewChanged:y,currentTimeChanged:m,backgroundColorChanged:b,isBufferDisplayableChanged:x,isHideImagesChanged:A})};Ku.prototype._render=function e(){};Ku.prototype._unsignedToSignedShort=function e(value){return value-32768};Ku.prototype.destroy=function e(){};Ku.prototype.getImageData=function e(){return null};var Ju="#define ANIMATED 0\n#define TEXT 0\n#define D3D9_FIX 0\nprecision highp float;\nprecision mediump int;\nattribute /*ubyte*/ vec4 _v1; \nattribute /*ushort*/ vec4 _v2; \nattribute /*float*/ vec4 _v3; \nattribute /*ushort*/ vec4 _v4; \nattribute /*ushort*/ vec4 _v5; \n#if ANIMATED\nattribute /*ubyte*/ vec4 _v6; \nattribute /*ushort*/ vec4 _v7; \nattribute /*float*/ vec4 _v8; \nattribute /*ushort*/ vec4 _v9; \nattribute /*ushort*/ vec4 _v10; \nattribute /*float*/ vec2 _v11; \nattribute /*ushort*/ vec4 _v12; \n#endif\n#if TEXT\nattribute /*ushort*/ vec2 _v13; \n#endif\nattribute vec2 a_vertexPos;\nuniform /*$viewWidth*/ float _v15;\nuniform /*$viewHeight*/ float _v16;\nuniform /*$viewX*/ float _v17;\nuniform /*$viewY*/ float _v18;\nuniform /*$viewAngle*/ float _v19;\nuniform /*$viewZoom*/ float _v20;\nuniform /*$currentTime*/ float _v21;\nuniform /*$pixelRatio*/ float _v22;\nuniform /*$patternInfoTexture*/ sampler2D _v23;\nvarying vec4 _v24;\nvarying vec4 _v25;\nvarying vec4 _v26;\nvarying vec2 _v27;\nvarying vec2 _v28;\n#if D3D9_FIX\nvarying vec4 _v29;\nvarying vec3 _v30;\nvarying vec3 _v31;\nvarying vec4 _v32;\n#else\nvarying float _v33;\nvarying vec2 _v34;\nvarying vec2 _v35;\nvarying vec2 _v36;\nvarying float _v37;\nvarying float _v38;\nvarying float _v39;\nvarying vec2 _v40;\nvarying float _v41;\nvarying float _v42;\n#endif\nconst float _v43 = 0.000001;\nconst float _v44 = 10000000.0;\nconst float _v45 = 3.14159265359;\nconst float _v46 = 4096.0;\nconst float _v47 = 256.0;\nconst float _v48 = 128.0;\nconst float _v49 = 64.0;\nconst float _v50 = 32.0;\nconst float _v51 = 16.0;\nconst float _v52 = 8.0;\nconst float _v53 = 4.0;\nconst float _v54 = 2.0;\nuniform /*$BYTES_TO_COORD*/ float _v55;\nuniform /*$BYTES_TO_SCALED_SIZE*/ float _v56;\nuniform /*$BYTES_TO_PIXEL_SIZE*/ float _v57;\nuniform /*$BYTES_TO_MIN_VISIBLE_SIZE*/ float _v58;\nuniform /*$BYTES_TO_SYMBOLIC_SIZE*/ float _v59;\nuniform /*$BYTES_TO_CURVATURE*/ float _v60;\nuniform /*$BYTES_TO_PATTERN_OFFSET*/ float _v61;\nuniform /*$BYTES_TO_DASH_LENGTH*/ float _v62;\nuniform /*$BYTES_TO_GAP_LENGTH*/ float _v63;\nuniform /*$SHAPE_TEXTURE_SIZE*/ float _v64;\nuniform /*$SHAPE_SAMPLING_SIZE*/ float _v65;\nuniform /*$SHAPE_SAMPLING_BUFFER_RATIO*/ float _v66;\nuniform /*$PATTERN_POSITION_GRANULARITY*/ float _v67;\nuniform /*$PATTERN_INFO_TEXTURE_SIZE*/ float _v68;\nuniform /*$PATTERN_NEAREST_TEXTURE_SIZE*/ float _v69;\nuniform /*$PATTERN_LINEAR_TEXTURE_SIZE*/ float _v70;\nuniform /*$PATTERN_MIPMAP_TEXTURE_SIZE*/ float _v71;\nuniform /*$SHAPE_LINE_ID*/ float _v72;\nuniform /*$SHAPE_TRIANGLE_ID*/ float _v73;\nuniform /*$NB_SHAPES_BY_SIDE*/ float _v74;\nuniform /*$SHAPE_DIMENSIONS*/ float _v75;\nuniform /*$SHAPE_ACTUAL_RATIO*/ float _v76;\nconst float _v77 = (_v45 * 2.0 / 65535.0);\nconst float _v78 = (_v45 * 2.0 / 8.0);\nconst float _v79 = 1.0 / 15.0;\nconst float _v80 = 24.0;\nconst float _v81 = 10.0;\nconst float _v82 = 1.0;\nconst float _v83 = 1.2;\nconst float _v84 = 7.0;\n#if TEXT\nconst float _v85 = 100.0;\nconst float _v86 = _v85 / 2047.0;\n#endif\nstruct _v87 {\nbool valid;\nfloat _v88;\nfloat _v89;\nfloat _v90;\nvec2 _v91;\nvec4 _v92;\nvec4 _v93;\nfloat _v94;\nfloat _v95;\nfloat _v96;\nfloat _v97;\nvec2 _v98;\nfloat _v99;\nvec2 _v100;\nvec2 _v101;\nvec2 _v102;\nfloat _v103;\nfloat _v104;\nvec4 _v105;\nvec2 _v106;\nvec2 _v107;\n};\nstruct _v108 {\nvec4 _v109;\nvec4 _v110;\nvec4 _v111;\nvec4 _v112;\nvec4 _v113;\n#if TEXT\nvec2 _v114;\n#endif\n};\nstruct _v115 {\nfloat _v116;\nfloat _v117;\nfloat _v118;\nfloat _v119;\nfloat _v120;\nfloat _v121;\n};\n_v115 decodeFlagsAndOffsetAngle(float _v122) {\n_v115 r;\nfloat _v116 = floor(_v122 / _v48);\nfloat _v123 = _v122 - (_v116 * _v48);\nfloat _v117 = floor(_v123 / _v49);\nfloat _v124 = _v123 - (_v117 * _v49);\nfloat _v118 = floor(_v124 / _v50);\nfloat _v125 = _v124 - (_v118 * _v50);\nfloat _v119 = floor(_v125 / _v51);\nfloat _v126 = _v125 - (_v119 * _v51);\nfloat _v120 = floor(_v125 / _v52);\nfloat _v127 = _v126 - (_v120 * _v52);\nr._v116 = _v116;\nr._v117 = _v117;\nr._v118 = _v118;\nr._v119 = _v119;\nr._v120 = _v120;\nr._v121 = _v127;\nreturn r;\n}\nvec2 _v128(in float _v122) {\nfloat _v129 = floor(_v122 / 16.0);\nfloat _v126 = _v122 - (_v129 * 16.0);\nreturn vec2(_v129, _v126);\n}\nvec3 _v130(in float _v122) {\nfloat _v129 = floor(_v122 / _v51);\nfloat _v126 = _v122 - (_v129 * _v51);\nfloat _v131 = floor(_v126 / _v53);\nfloat _v132 = _v126 - _v131 * _v53;\nreturn vec3(_v129, _v131, _v132);\n}\nvec4 _v133(in float _v122) {\nfloat _v129 = floor(_v122 / _v46);\nfloat _v134 = _v122 - (_v129 * _v46);\nfloat _v135 = floor(_v134 / _v47);\nfloat _v136 = _v134 - _v135 * _v47;\nfloat _v137 = floor(_v136 / _v51);\nfloat _v126 = _v136 - _v137 * _v51;\nreturn vec4(_v129, _v135, _v137, _v126);\n}\nvec2 _v138(in float _v122) {\nreturn vec2(floor(_v122 / 256.0), mod(_v122, 256.0));\n}\nvec2 _v139(in float _v122) {\nfloat _v140 = floor(_v122 / _v51);\nfloat _v126 = _v122 - (_v140 * _v51);\nreturn vec2(_v140, _v126);\n}\nvec3 _v141(in float _v122) {\nfloat _v129 = floor(_v122 / _v51);\nfloat _v126 = _v122 - (_v129 * _v51);\nfloat _v142 = floor(_v126 / _v54);\nfloat _v143 = _v126 - (_v142 * _v54);\nreturn vec3(_v129, _v142, _v143);\n}\nvec4 _v144(in float _v122) {\nfloat _v145 = floor(_v122 / _v50);\nfloat _v125 = _v122 - (_v145 * _v50);\nfloat _v146 = floor(_v125 / _v51);\nfloat _v126 = _v125 - (_v146 * _v51);\nfloat _v147 = floor(_v126 / _v54);\nfloat _v143 = _v126 - (_v147 * _v54);\nreturn vec4(_v145, _v146, _v147, _v143);\n}\nvec2 _v148(in float _v122) {\nfloat _v149 = floor(_v122 / _v48);\nfloat _v123 = _v122 - (_v149 * _v48);\nreturn vec2(_v149, _v123);\n}\nvec2 _v150(in vec2 _v151, in float _v152) {\nfloat _v153 = cos(_v152);\nfloat _v154 = sin(_v152);\nreturn vec2(_v153 * _v151.x + _v154 * _v151.y, -_v154 * _v151.x + _v153 * _v151.y);\n}\nvec4 _v155(in vec4 _v156) {\nreturn floor(_v156 / 256.0) - 128.0;\n}\nvec4 _v157(in vec4 _v156) {\nreturn mod(_v156, 256.0) - 128.0;\n}\nfloat _v158(float _v122) {\nreturn _v122 - 128.0;\n}\nvec2 _v158(vec2 _v122) {\nreturn _v122 - 128.0;\n}\nvec2 _v159(vec2 _v160) {\nreturn vec2(_v160.y, -_v160.x);\n}\nvec2 _v161(float t, vec2 _v163, vec2 _v164, vec2 _v165) {\nfloat _v166 = 1.0 - t;\nreturn (_v166 * _v166 * _v163) + (2.0 * _v166 * t * _v165) + (t * t * _v164);\n}\nvec2 _v167(float t, vec2 _v163, vec2 _v164, vec2 _v165) {\nfloat _v166 = (1.0 - t);\nvec2 _v151 = (_v166 * _v165 + t * _v164) - (_v166 * _v163 + t * _v165);\nreturn normalize(_v151);\n}\nvec2 _v168(float t, vec2 _v163, vec2 _v164, vec2 _v169, vec2 _v170) {\nfloat _v166 = 1.0 - t;\nfloat _v171 = _v166 * _v166;\nfloat _v172 = _v171 * _v166;\nfloat _v173 = t * t;\nfloat _v174 = _v173 * t;\nreturn (_v172 * _v163) + (3.0 * _v171 * t * _v169) + (3.0 * _v166 * _v173 * _v170) + (_v174 * _v164);\n}\nvec2 _v175(float t, vec2 _v163, vec2 _v164, vec2 _v169, vec2 _v170) {\nfloat _v166 = 1.0 - t;\nfloat _v171 = _v166 * _v166;\nfloat _v173 = t * t;\nvec2 _v151 = _v171 * (_v169 - _v163) + 2.0 * _v166 * t * (_v170 - _v169) + _v173 * (_v164 - _v170);\nreturn normalize(_v151);\n}\nfloat _v176(float _v122) {\nreturn _v122 - 8.0;\n}\nfloat _v177(float _v122) {\nreturn _v122 - 2048.0;\n}\nfloat _v178(float _v122) {\nreturn _v122 - 32768.0;\n}\nvoid _v179() {\ngl_Position = vec4(-10.0, -10.0, 1.0, 1.0);\n}\nvec4 _v180(vec2 _v106) {\nreturn vec4(((vec2(_v106.x, _v16 - _v106.y) / vec2(_v15, _v16)) * 2.0 - 1.0), 0.5, 1.0);\n}\nfloat _v181(float _v182, float _v183) {\nreturn step(_v182 - _v43, _v183) * step(_v183, _v182 + _v43);\n}\n_v87 computeVertexPosition(in _v108 attributes) {\n_v87 result;\nresult.valid = true;\nvec3 _v184 = _v130(attributes._v109.x);\nfloat _v185 = _v184.x;\nfloat _v186 = _v184.y;\nfloat _v187 = _v184.z;\nvec2 _v188 = _v128(attributes._v109.y);\nfloat _v189 = _v188.x;\nfloat _v190 = _v188.y;\nvec2 _v191 = _v128(attributes._v109.z);\nfloat _v192 = _v191.x;\nfloat _v193 = _v191.y;\n_v115 _flagsAndOffsetAngle = decodeFlagsAndOffsetAngle(attributes._v109.w);\nfloat _v194 = _flagsAndOffsetAngle._v116;\nfloat _v195 = _flagsAndOffsetAngle._v117;\nfloat _v196 = _flagsAndOffsetAngle._v118;\nfloat _v197 = _flagsAndOffsetAngle._v119;\nfloat _v198 = _flagsAndOffsetAngle._v120;\nfloat _v199 = _flagsAndOffsetAngle._v121;\nfloat _v200 = attributes._v110.x;\nvec4 _v201 = _v133(attributes._v110.y);\nvec4 _v202 = _v133(attributes._v110.z);\nvec2 _v203 = _v138(attributes._v110.w);\nfloat _v204 = _v203.x;\nfloat _v205 = _v203.y;\nfloat _v206 = attributes._v111.x;\nfloat _v207 = attributes._v111.y;\nfloat _v208 = attributes._v111.z;\nfloat _v209 = attributes._v111.w;\nfloat _v210 = attributes._v112.x;\nfloat _v211 = attributes._v112.y;\nfloat _v212 = attributes._v112.z;\nvec2 _v213 = _v138(attributes._v112.w);\nfloat _v214 = _v213.x;\nfloat _v215 = _v213.y;\nvec2 _v216 = _v138(attributes._v113.x);\nfloat _v217 = _v216.x;\nfloat _v218 = _v216.y;\nvec4 _v219 = _v133(attributes._v113.y);\nvec2 _v220 = _v138(attributes._v113.z);\nfloat _v221 = _v220.x;\nfloat _v222 = _v220.y;\nvec2 _v223 = _v138(attributes._v113.w);\nfloat _v224 = _v223.x;\nfloat _v225 = _v158(_v223.y);\n#if TEXT\nfloat _v226 = attributes._v114.x;\nvec2 _v227 = _v139(attributes._v114.y);\nfloat _v228 = _v177(_v227.x);\nfloat _v229 = _v176(_v227.y);\n#endif\nfloat _v230 = _v185;\nfloat _v97 = _v186 * _v62;\nfloat _v231 = _v187 * _v63;\nfloat _v94 = _v189 * _v79;\nfloat _v232 = _v190 * _v58 - _v43;\nfloat _v233 = _v192 * _v58 - _v43;\nfloat _v234 = _v193 * _v58 - _v43;\nfloat _v117 = _v195;\nfloat _v118 = _v196;\nfloat _v119 = _v197;\nfloat _v120 = _v198;\nfloat _v121 = _v199 * _v78;\nfloat _v235 = _v200;\nvec4 _v92 = _v201 * _v79;\nvec4 _v93 = _v202 * _v79;\nfloat _v236 = _v204 / 255.0;\nfloat _v237 = _v205 / 255.0;\nfloat x = _v206;\nfloat y = _v207;\nfloat _v152 = _v208 + (_v194 * _v19);\nfloat _v90 = (_v209 * _v20) + (_v214 * _v57);\nfloat _v89 = (_v210 * _v56 * _v20) + (_v215 * _v57);\nfloat _v88 = (_v211 * _v56 * _v20) + (_v217 * _v57);\nfloat _v240 = (_v212 * _v56 * _v20) + (_v218 * _v57);\nfloat _v241 = _v221 / 127.0;\nfloat _v242 = _v222 * _v61;\nvec4 _v105 = _v219 * _v79;\nfloat _v243 = _v224 * _v59 * _v20 + step(_v224, _v43) * _v44;\nfloat _v244 = _v225;\nvec2 _v245 = vec2(0.0, 0.0);\n#if TEXT\nfloat _v246 = _v226;\nif (_v246 < 0.5) {\nresult.valid = false;\nreturn result;\n}\nfloat _v247 = _v89;\nfloat _v248 = _v247 / 2.0;\n_v235 = _v246;\n_v245.y = _v229 * _v248;\nif (_v119 > _v43) {\n_v245.x = _v228 * _v86 * _v247;\n} else {\n_v245.x = floor(_v228);\n}\n_v89 = _v247 * _v83;\n_v90 = _v247 * _v83;\n#endif\nif (_v230 < _v43 || _v243 < _v232) {\nresult.valid = false;\nreturn result;\n}\nif (_v118 > _v43 && _v211 > _v43) {\nfloat _v249 = _v211 * _v56;\nif (_v249 > _v20) {\n_v152 = 0.0;\n_v240 = 0.0;\n}\n_v88 = 0.0;\n}\n_v88 *= step(_v233, _v243);\n_v97 *= _v89;\n_v231 *= _v89;\n_v242 *= _v89;\n_v121 -= _v117 * _v152;\n_v152 = mod(_v152 + _v45 * 2.0, _v45 * 2.0);\nif (_v118 > _v43 && (_v152 > _v45 / 2.0 && _v152 < 3.0 * _v45 / 2.0)) {\n_v152 += _v45;\n_v121 += _v45;\n}\nfloat _v96 = _v97 + _v231;\nvec2 _v250 = (vec2(mod(_v230, _v74), floor(_v230 / _v74)) + vec2(_v236, 0.0) * _v76 + vec2(_v66 / 2.0)) / _v74;\nvec2 _v251 = vec2(_v237 - _v236, 1.0) * _v76 / _v74;\nvec2 _v91 = _v250 + (a_vertexPos / 2.0 + 0.5) * _v251;\nfloat _v252 = _v181(_v230, _v72);\nfloat _v253 = _v181(_v230, _v73);\nfloat _v254 = 1.0 - _v252;\nvec2 _v255 = vec2(_v15, _v16) / 2.0;\nvec2 _v256 = _v150((vec2(x, y) - vec2(_v17, _v18)) * _v20, _v19) + _v255;\nvec2 _v257 = _v150(vec2(_v240, 0.0), -_v121);\n#if TEXT\n_v256 = ceil(_v256);\n#else\n_v89 += 1.0;\n_v90 += 1.0;\n#endif\nvec2 _v106 = _v256 + _v257;\nvec2 _v107;\nfloat _v258;\nif (abs(_v244) > _v43) {\nfloat _v259 = _v236;\nfloat _v173 = _v237;\nfloat _v260 = (_v173 - _v259);\nfloat _v261 = (a_vertexPos.x / 2.0 + 0.5);\nfloat t = _v259 + _v260 * _v261;\nvec2 _v262, pc2;\nif (_v120 > _v43) {\nfloat _v263 = _v244 * _v84 * _v20;\nvec2 _v264 = _v106;\nvec2 _v265 = _v106 + _v150(vec2(0.0, _v90), _v19);\nvec2 _v266 = _v106 + _v150(vec2(-_v263, 0.0), _v19);\nvec2 _v267 = _v106 + _v150(vec2(0.0, _v263), _v19);\n_v262 = _v168(_v259, _v264, _v265, _v266, _v267);\npc2 = _v168(_v173, _v264, _v265, _v266, _v267);\n_v107 = _v159(_v175(t, _v264, _v265, _v266, _v267));\n} else {\nvec2 _v268 = vec2(cos(_v152), -sin(_v152));\nvec2 _v151 = _v268 * _v90 / 2.0;\nvec2 _v264 = _v106 - _v151;\nvec2 _v265 = _v106 + _v151;\nvec2 _v269 = _v159(_v268);\nvec2 _v270 = _v106 + _v269 * _v244 * (_v90 / _v81 * 2.0);\n_v262 = _v161(_v259, _v264, _v265, _v270);\npc2 = _v161(_v173, _v264, _v265, _v270);\n_v107 = _v159(_v167(t, _v264, _v265, _v270));\n}\nfloat _v271 = distance(_v262, pc2);\n_v106 = _v262 * (1.0 - _v261) + pc2 * _v261;\n_v258 = _v271;\n} else {\n_v245 = _v150(_v245, _v152);\n_v106 += _v245;\nvec2 _v272 = vec2((_v90 / 2.0 + _v88 * _v254 + _v252), 0.0);\n_v272 = _v150(_v272, _v152);\n_v107 = -normalize(_v159(_v272));\n_v106 += _v272 * a_vertexPos.x;\n_v258 = _v90;\n}\nvec2 _v100 = vec2(0.0, 0.0);\nvec2 _v101 = vec2(_v43, _v43);\nvec2 _v102 = vec2(-_v43, -_v43);\nfloat _v103 = 0.0;\nfloat _v104 = 0.0;\nif (_v235 > 0.1 && _v243 > _v234) {\nfloat _v273 = floor(_v235 / _v68);\nfloat _v274 = _v235 - (_v273 * _v68);\nvec4 _v275 = texture2D(_v23, vec2(_v274, _v273) / 255.0) * 255.0;\nvec2 _v276 = _v148(_v275.z);\nvec2 _v277 = _v148(_v275.w);\nfloat _v278 = _v276.x * 2.0 + _v277.x;\nfloat _v279;\nif (_v278 < 0.5) {\n_v279 = _v69;\n} else if (_v278 < 1.5) {\n_v279 = _v70;\n} else {\n_v279 = _v71;\n}\nfloat _v280 = 1.0 / _v279;\nvec2 _v281 = (vec2(_v276.y, _v277.y) * _v67) * _v280 / 2.0;\nvec2 _v282 = (_v275.xy * _v67 * _v280) + _v281;\n_v282 += _v82 * _v280;\n_v281 -= _v82 * _v280;\nvec2 _v283 = vec2(_v90, _v89) / 2.0 * _v280;\nvec2 _v284 = vec2(_v88, _v88) * _v280;\nfloat _v285 = 1.0 * _v22;\nif (_v241 > _v43) {\n#if TEXT\nif (_v119 > _v43) {\n_v104 = 2.0 / _v247;\n_v285 = (_v80 / _v247);\n} else {\n_v285 = (_v281.y / _v283.y) / _v241;\n}\n#else\n_v285 = (_v281.y / _v283.y) / _v241;\n#endif\n}\nvec2 _v286 = (_v283 + _v284) * _v285;\n_v100 = _v282 + _v286 * a_vertexPos;\n_v101 = _v282 - _v281;\n_v102 = _v282 + _v281;\n_v103 = 1.0 + _v278;\n}\nfloat _v287 = _v237 - _v236;\nfloat _v288 = step(0.0, a_vertexPos.x);\nresult._v88 = _v88;\nresult._v89 = _v89;\nresult._v90 = _v90;\nresult._v91 = _v91;\nresult._v92 = _v92;\nresult._v93 = _v93;\nresult._v94 = _v94;\nresult._v95 = (_v242 + _v258 * _v288) / _v96;\nresult._v96 = _v96;\nresult._v97 = _v97;\nresult._v98 = (vec2(_v90, _v89) / 2.0 + vec2(_v88)) / vec2(_v287, 1.0);\nresult._v99 = _v253 * 0.5 * (_v236 + _v288 * _v287);\nresult._v100 = _v100;\nresult._v101 = _v101;\nresult._v102 = _v102;\nresult._v103 = _v103;\nresult._v104 = _v104;\nresult._v105 = _v105;\nresult._v106 = _v106;\nresult._v107 = _v107;\nreturn result;\n}\nvoid main() {\n_v87 result;\n_v108 final_input;\nfinal_input._v109 = _v1;\nfinal_input._v110 = _v2;\nfinal_input._v111 = _v3;\nfinal_input._v112 = _v4;\nfinal_input._v113 = _v5;\n#if TEXT\nfinal_input._v114 = _v13;\n#endif\n_v87 final_result = computeVertexPosition(final_input);\n#if ANIMATED\n_v108 prev_input;\nprev_input._v109 = _v6;\nprev_input._v110 = _v7;\nprev_input._v111 = _v8;\nprev_input._v112 = _v9;\nprev_input._v113 = _v10;\n#if TEXT\nprev_input._v114 = _v13;\n#endif\n_v87 prev_result = computeVertexPosition(prev_input);\nfloat _v290 = _v11.x;\nfloat _v291 = _v11.y;\nfloat _v292 = clamp(((_v21 - _v290) / _v291), 0.0, 1.0);\nfloat r = _v292;\nfloat _v294 = r * r;\nfloat _v295 = _v294 * r;\nvec4 _v296 = _v292 < 0.5 ? _v155(_v12) : _v157(_v12);\nfloat _v297 = _v296.x;\nfloat _v298 = _v296.y;\nfloat _v299 = _v296.z;\nfloat _v300 = _v296.w;\nfloat _v301 = _v297 + _v298 * r + _v299 * _v294 + _v300 * _v295;\nresult.valid = final_result.valid && prev_result.valid;\nresult._v88 = mix(prev_result._v88, final_result._v88, _v301);\nresult._v89 = mix(prev_result._v89, final_result._v89, _v301);\nresult._v92 = mix(prev_result._v92, final_result._v92, _v301);\nresult._v93 = mix(prev_result._v93, final_result._v93, _v301);\nresult._v94 = mix(prev_result._v94, final_result._v94, _v301);\nresult._v95 = mix(prev_result._v95, final_result._v95, _v301);\nresult._v96 = mix(prev_result._v96, final_result._v96, _v301);\nresult._v97 = mix(prev_result._v97, final_result._v97, _v301);\nresult._v98 = mix(prev_result._v98, final_result._v98, _v301);\nresult._v99 = mix(prev_result._v99, final_result._v99, _v301);\nresult._v105 = mix(prev_result._v105, final_result._v105, _v301);\nresult._v91 = final_result._v91;\nresult._v100 = final_result._v100;\nresult._v101 = final_result._v101;\nresult._v102 = final_result._v102;\nresult._v103 = final_result._v103;\nresult._v104 = final_result._v104;\nresult._v106 = mix(prev_result._v106, final_result._v106, _v301);\nfloat _v302 = (final_result._v90 + _v43) / (prev_result._v90 + final_result._v90 + 2.0 * _v43) * 2.0;\nvec2 _v303 = prev_result._v107 * (2.0 - _v302);\nvec2 _v304 = final_result._v107 * _v302;\nresult._v107 = normalize(mix(_v303, _v304, _v301));\n#else\nresult = final_result;\n#endif\nif (!result.valid) {\n_v179();\nreturn;\n}\nfloat _v305 = result._v88;\nvec2 _v306 = result._v91;\nvec4 _v201 = result._v92;\nvec4 _v202 = result._v93;\nfloat _v189 = result._v94;\nfloat _v307 = result._v95;\nfloat _v308 = result._v96;\nfloat _v186 = result._v97;\nvec2 _v309 = result._v98;\nfloat _v310 = result._v99;\nvec2 _v311 = result._v100;\nvec2 _v312 = result._v101;\nvec2 _v313 = result._v102;\nfloat _v314 = result._v103;\nfloat _v315 = result._v104;\nvec4 _v219 = result._v105;\n_v24 = _v201;\n_v25 = _v202;\n_v26 = _v219;\n_v27 = _v306;\n_v28 = _v311;\n#if D3D9_FIX\n_v29 = vec4(_v312, _v313);\n_v30 = vec3(_v305, _v189, _v310);\n_v31 = vec3(_v307, _v308, _v186);\n_v32 = vec4(_v309, _v315, _v314);\n#else\n_v33 = _v305;\n_v34 = _v312;\n_v35 = _v313;\n_v36 = vec2(_v189, _v310);\n_v37 = _v307;\n_v38 = _v308;\n_v39 = _v186;\n_v40 = _v309;\n_v41 = _v315;\n_v42 = _v314;\n#endif\nvec2 _v106 = result._v106 + result._v107 * (result._v89 / 2.0 + result._v88) * a_vertexPos.y;\ngl_Position = _v180(_v106);\n}\n";var Qu="#define TEXT 0\n#define ANIMATED 0\n#define D3D9_FIX 0\nprecision highp float;\nprecision mediump int;\nuniform /*$backgroundColor*/ vec3 _v316;\nuniform /*$patternNearestTexture*/ sampler2D _v317;\nuniform /*$patternLinearTexture*/ sampler2D _v318;\nuniform /*$patternMipmapTexture*/ sampler2D _v319;\nuniform /*$shapeTexture*/ sampler2D _v320;\nvarying vec4 _v24;\nvarying vec4 _v25;\nvarying vec4 _v26;\nvarying vec2 _v27;\nvarying vec2 _v28;\n#if D3D9_FIX\nvarying vec4 _v29;\nvarying vec3 _v30;\nvarying vec3 _v31;\nvarying vec4 _v32;\n#else\nvarying float _v33;\nvarying vec2 _v34;\nvarying vec2 _v35;\nvarying vec2 _v36;\nvarying float _v37;\nvarying float _v38;\nvarying float _v39;\nvarying vec2 _v40;\nvarying float _v41;\nvarying float _v42;\n#endif\nconst float _v43 = 0.000000001;\nconst float _v321 = (256.0 - 64.0) / 256.0; \nvec4 _v322(in vec4 _v323, in vec4 _v324) {\nfloat _v325 = _v324.a;\nfloat _v326 = _v323.a + _v43;\nfloat _v327 = min(_v325 + _v326, 1.0);\nfloat r = _v325 / _v327;\nreturn vec4(mix(_v323.rgb, _v324.rgb, r), _v327);\n}\nfloat _v328(in float _v329, in float _v330) {\nfloat _v331 = (_v329 * 256.0 + _v330) * 256.0;\nfloat _v332 = _v331 / 60000.0;\nreturn _v332 * 2.0 - 1.0;\n}\nvoid main() {\n#if D3D9_FIX\nfloat _v33 = _v30.x;\nfloat _v333 = _v30.y;\nfloat _v334 = _v30.z;\nvec2 _v34 = _v29.xy;\nvec2 _v35 = _v29.zw;\nfloat _v37 = _v31.x;\nfloat _v38 = _v31.y;\nfloat _v39 = _v31.z;\nvec2 _v40 = _v32.xy;\nfloat _v41 = _v32.z;\nfloat _v42 = _v32.w;\n#else\nfloat _v333 = _v36.x;\nfloat _v334 = _v36.y;\n#endif\nvec4 _v335 = texture2D(_v320, _v27);\nfloat _v336 = _v328(_v335.b, _v335.a) * _v40.x;\nfloat _v337 = _v328(_v335.r, _v335.g) * _v40.y;\n_v337 += _v334;\nfloat _v338 = min(_v336, _v337);\nvec4 _v92 = _v24;\nvec4 _v93 = _v25;\nif (_v42 > 0.5) {\nvec2 _v100 = _v28;\nfloat _v339 =\nstep(_v34.x, _v100.x) *\nstep(_v100.x, _v35.x) *\nstep(_v34.y, _v100.y) *\nstep(_v100.y, _v35.y);\nfloat _v340 = _v339;\nvec4 _v341;\nif (_v42 < 1.5) { \n_v341 = texture2D(_v317, _v100);\n} else if (_v42 < 2.5) { \n_v341 = texture2D(_v318, _v100);\nif (_v41 > _v43) {\n_v341.a = smoothstep(_v321 - _v41, _v321 + _v41, _v341.a);\n}\n} else {\n_v341 = texture2D(_v319, _v100);\n}\n_v341.rgb += _v26.rgb;\n_v341.a *= _v340;\n_v92 = _v322(_v92, _v341);\n}\nfloat _v342 = clamp(_v338, 0.0, 1.0);\nfloat _v343 = clamp(_v338 - _v33, 0.0, 1.0);\nfloat _v344 = _v342 - _v343;\n_v344 = 1.0 - clamp(_v338 - _v33, 0.0, 1.0);\n_v92.a *= _v343;\n_v93.a *= _v344;\nvec4 _v345 = _v322(_v92, _v93);\nfloat _v346 = _v342;\n_v346 *= _v333;\nif (_v38 > _v43) {\nfloat _v347 = fract(_v37) * _v38;\nfloat _v348 = clamp(min(_v347, _v39 - _v347), 0.0, 1.0);\n_v346 *= _v348;\n}\n_v345.a *= _v346;\ngl_FragColor = _v345;\n}\n";var el=Cu*(1-ku)/2;var tl=(Cu-1)/2;var rl=function e(t,r){this._gl=t;this._glTextureUnit=r;this._canvas=Er();this._textureSize=-1};rl.prototype.refresh=function e(t){var r=this;var i=this._gl;var n=t.getShapeList();var a=me(Math.sqrt(n.length));var o=a*Cu;var s=new Uint8Array(o*o*4);var u=i.createTexture();for(var l=0;l<n.length;++l){var f=n[l];if(f){var h=f.getDistanceFromStrokeVertically;var d=f.getDistanceFromStrokeHorizontally;var v=l%a*Cu;var c=Math.floor(l/a)*Cu;for(var _=0;_<Cu;++_){for(var g=0;g<Cu;++g){var p=_+v;var y=g+c;var m=(y*o+p)*4;var b=(_-tl)/el;var x=(g-tl)/el;var A=h(b,x);var w=d(b,x);var S=r._formatShapeDistance(A);var E=r._formatShapeDistance(w);r._writeDistanceToPixel(s,m,S,E)}}}}i.activeTexture(i.TEXTURE0+this._glTextureUnit);i.bindTexture(i.TEXTURE_2D,u);i.texImage2D(i.TEXTURE_2D,0,i.RGBA,o,o,0,i.RGBA,i.UNSIGNED_BYTE,s);i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR);i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR);this._textureSize=o};rl.prototype._writeDistanceToPixel=function e(t,r,i,n){t[r]=i>>8;t[r+1]=i%256;t[r+2]=n>>8;t[r+3]=n%256};rl.prototype._formatShapeDistance=function e(value){var t=(value+1)/2;return t*6e4};rl.prototype.getTextureSize=function e(){return this._textureSize};rl.prototype.getSamplingSize=function e(){return Cu};rl.prototype.getBufferRatio=function e(){return ku};rl.prototype.getTextureUnit=function e(){return this._glTextureUnit};var il=1e20;var nl=24;var al=6;var ol=8;var sl=.25;var ul=(nl+2*al)/nl;var ll=function e(){this._fontSize=nl;this._buffer=al;this._radius=ol;this._cutoff=sl;this._height=Math.ceil(this._fontSize+this._buffer*2*Du);this._maxDimension=1;this._gridSize=1;this._canvas=Er();this._canvas.height=this._height;this._canvas.width=1;this._ctx=this._canvas.getContext("2d");this._ctx.textBaseline="middle";this._ctx.textAlign="center";this._ctx.fillStyle="black";this._gridOuter=null;this._gridInner=null;this._f=null;this._d=null;this._z=null;this._v=null};var fl={SDF_DIV:{configurable:true}};fl.SDF_DIV.get=function(){return ul};ll.prototype.getFontToImageSizeRatio=function e(){return 1+this._buffer*2/this._fontSize};ll.prototype.draw=function e(t,r,i){var n=this;this._ctx.font=i+" "+this._fontSize+'px "'+r+'"';var a=this._ctx.measureText(t).width+this._buffer*2,o=vl(a)-Iu*2,s=o,u=this._height,l=s*u,f=Math.max(s,u);if(this._canvas.width<s){this._canvas.width=s;this._ctx.font=i+" "+this._fontSize+'px "'+r+'"';this._ctx.textAlign="center";this._ctx.textBaseline="middle";this._ctx.fillStyle="black"}if(l>this._gridSize){this._gridOuter=new Float64Array(l);this._gridInner=new Float64Array(l);this._gridSize=l}if(f>this._maxDimension){this._f=new Float64Array(f);this._d=new Float64Array(f);this._z=new Float64Array(f+1);this._v=new Int16Array(f);this._maxDimension=f}this._ctx.clearRect(0,0,s,u);this._ctx.fillText(t,s/2,u/2);var h=this._ctx.getImageData(0,0,s,u),d=new Uint8ClampedArray(l);for(var v=0;v<l;v++){var c=h.data[v*4+3]/255;n._gridOuter[v]=c===1?0:c===0?il:Math.pow(Math.max(0,.5-c),2);n._gridInner[v]=c===1?il:c===0?0:Math.pow(Math.max(0,c-.5),2)}hl(this._gridOuter,s,u,this._f,this._d,this._v,this._z);hl(this._gridInner,s,u,this._f,this._d,this._v,this._z);for(var _=0;_<l;_++){var g=n._gridOuter[_]-n._gridInner[_];d[_]=Math.max(0,Math.min(255,Math.round(255-255*(g/n._radius+n._cutoff))))}return{height:u,width:s,distance:d}};Object.defineProperties(ll,fl);function hl(e,t,r,i,n,a,o){for(var s=0;s<t;s++){for(var u=0;u<r;u++){i[u]=e[u*t+s]}dl(i,n,a,o,r);for(var l=0;l<r;l++){e[l*t+s]=n[l]}}for(var f=0;f<r;f++){for(var h=0;h<t;h++){i[h]=e[f*t+h]}dl(i,n,a,o,t);for(var d=0;d<t;d++){e[f*t+d]=Math.sqrt(n[d])}}}function dl(e,t,r,i,n){r[0]=0;i[0]=-il;i[1]=+il;for(var a=1,o=0;a<n;a++){var s=(e[a]+a*a-(e[r[o]]+r[o]*r[o]))/(2*a-2*r[o]);while(s<=i[o]){o--;s=(e[a]+a*a-(e[r[o]]+r[o]*r[o]))/(2*a-2*r[o])}o++;r[o]=a;i[o]=s;i[o+1]=+il}for(var u=0,l=0;u<n;u++){while(i[l+1]<u){l++}t[u]=(u-r[l])*(u-r[l])+e[r[l]]}}function vl(value){return Math.ceil((value+Iu*2)/Nu)*Nu}var cl=256;var _l=0;var gl=1;var pl=2;var yl=3;var ml=0;var bl=1;var xl={};xl[_l]={min:"NEAREST",mag:"NEAREST",mipmap:false};xl[gl]={min:"LINEAR",mag:"LINEAR",mipmap:false};xl[pl]={min:"LINEAR_MIPMAP_LINEAR",mag:"LINEAR",mipmap:true};var Al={};Al[ml]="ALPHA";Al[bl]="RGBA";var wl=Ru-Iu*2;var Sl=Lu-Iu*2;var El=function e(t,r){this._gl=t;this._glUnit=r;this._colorManager=new U;this._patternIdToInfoTexture=new Uint8Array(cl*cl*4);this._glTextureInfo=null;this._glTextures=[];this._textureSizes=[];this._imageCanvas=Er();this._imageCanvas.width=zu;this._imageCanvas.height=zu;this._imageCanvasContext=this._imageCanvas.getContext("2d");this._canvasForDuplicatedImage=null;this._sdfGenerator=new ll};El.prototype.refresh=function e(t){var r=this;var i=this._gl;var n=this._getPatternsByFilter(t.getPatternList());for(var a=0;a<n.length;++a){var o=a;var s=n[a];var u=r._getApproximateRequestedTextureSize(s);var l=r._fillAtlas(s,u);var f=l.texture;var h=l.size;var d=r._glTextures[o]||(r._glTextures[o]=i.createTexture());var v=o===_l?ml:bl;r._setupTexture(d,r._glUnit+1+o,f,h,o,v);r._textureSizes[o]=h}var c=this._glTextureInfo||(this._glTextureInfo=i.createTexture());var _=this._patternIdToInfoTexture;this._setupTexture(c,this._glUnit,_,cl,_l,bl)};El.prototype._setupTexture=function e(t,r,i,n,a,o){var s=this._gl;var u=xl[a];var l=u.min;var f=u.mag;var h=u.mipmap;var d=s[Al[o]];if(o===ml){var v=new Uint8Array(n*n);for(var c=0;c<v.length;++c){v[c]=i[c*4+3]}i=v}s.activeTexture(s.TEXTURE0+r);s.bindTexture(s.TEXTURE_2D,t);s.texImage2D(s.TEXTURE_2D,0,d,n,n,0,d,s.UNSIGNED_BYTE,i);s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s[f]);s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s[l]);if(h){s.generateMipmap(s.TEXTURE_2D)}};El.prototype.getGranularity=function e(){return Nu};El.prototype.getInfoTextureUnit=function e(){return this._glUnit};El.prototype.getNearestTextureUnit=function e(){return this._glUnit+1+_l};El.prototype.getLinearTextureUnit=function e(){return this._glUnit+1+gl};El.prototype.getMipmapTextureUnit=function e(){return this._glUnit+1+pl};El.prototype.getInfoTextureSize=function e(){return cl};El.prototype.getNearestTextureSize=function e(){return this._textureSizes[_l]};El.prototype.getLinearTextureSize=function e(){return this._textureSizes[gl]};El.prototype.getMipmapTextureSize=function e(){return this._textureSizes[pl]};El.prototype._getPatternsByFilter=function e(t){var r=this;var i=new Array(yl);for(var n=0;n<yl;++n){i[n]=[]}for(var a=0;a<t.length;++a){var o=r._getPatternPixels(t[a]);i[o.filter].push(o)}return i};El.prototype._getApproximateRequestedTextureSize=function e(t){var r=0;var i=4;for(var n=0;n<t.length;++n){var a=t[n];var o=a.width;var s=a.height;var u=Tl(o);var l=Tl(s);r+=u+l;i=Math.max(i,Math.max(u,l))}return me(Math.max(i,Math.sqrt(r)))};El.prototype._adjustDimension=function e(t,r){return Math.floor((r-t)/2)};El.prototype._fillAtlas=function e(t,r){var i=this;var n=new Uint8Array(r*r*4);var a=Math.ceil(r/Nu);var o=new Uint8Array(a*a);var s=[{x:0,y:0}];for(var u=0;u<t.length;++u){var l=t[u];var f=l.id;var h=l.filter;var d=Tl(l.width)/Nu;var v=Tl(l.height)/Nu;var c=i._setPositionOnCanvas(s,o,a,d,v);if(c){var _=l.width;var g=l.height;var p=l.pixels;var y=d*Nu;var m=v*Nu;var b=c.x*Nu+i._adjustDimension(_,y);var x=c.y*Nu+i._adjustDimension(g,m);i._copyPixelsOnTexture(n,r,p,b,x,_,g);i._writePatternMetaData(f,h,b,x,y,m)}else if(r<4096){return i._fillAtlas(t,r*2)}else{at("exceeded max WebGL texture size of 4096; won't be able to store some images/texts in memory");i._writePatternMetaData(f,h,0,0,0,0)}}return{texture:n,size:r}};El.prototype._copyPixelsOnTexture=function e(t,r,i,n,a,o,s){for(var u=0;u<o;++u){for(var l=0;l<s;++l){var f=(n+u+(a+l)*r)*4;var h=(u+l*o)*4;t[f]=i[h];t[f+1]=i[h+1];t[f+2]=i[h+2];t[f+3]=i[h+3]}}};El.prototype._writePatternMetaData=function e(t,r,i,n,a,o){var s=t*4;var u=r>>1<<7;var l=r%2<<7;this._patternIdToInfoTexture[s]=i/Nu;this._patternIdToInfoTexture[s+1]=n/Nu;this._patternIdToInfoTexture[s+2]=u+a/Nu;this._patternIdToInfoTexture[s+3]=l+o/Nu};El.prototype._setPositionOnCanvas=function e(t,r,i,n,a){for(var o=0,s=t.length;o<s;++o){var u=t[o];var l=u.x;var f=u.y;var h=u.x+n;var d=u.y+a;var v=h<i&&d<i;if(v){for(var c=l;c<h;++c){if(r[c+f*i]===1){v=false;break}}}if(v){for(var _=f;_<d;++_){if(r[l+_*i]===1){v=false;break}}}if(v){for(var g=l;g<h;++g){for(var p=f;p<d;++p){r[g+p*i]=1}}t.splice(o,1);t.push({x:l,y:d},{x:h,y:f});return u}}return null};El.prototype._getPatternPixels=function e(t){var r=t.id;var i=t.type;var n=t.attributes;var a=null;if(i===eu){if(n.duplicated){a=this._getDuplicatedImagePixels(n.image)}else if(n.scaled){a=this._getScaledImagePixels(n.image)}else{a=this._getNonScaledImagePixels(n.image)}}else if(i===tu){var o=n.text;var s=n.font;var u=n.style;var l=n.size;var f=n.pixelRatio;var h=n.offset;if(n.size==="sdf"){a=this._getSdfTextPixels(o,s,u,f)}else{a=this._getRegularTextPixels(o,s,u,l,f,h)}}else if(i===iu){a=this._getIconPixels(n.text,n.font,n.style,n.pixelRatio)}else if(i===ru){a=this._getPieChartPixels(n.colorArray)}else{throw new Error('pattern type "'+i+'" does not exist')}a.id=r;return a};El.prototype._getScaledImagePixels=function e(t){var r=t.width;var i=t.height;if(r>zu||i>zu){var n=zu/Math.max(t.width,t.height);r*=n;i*=n}if(r&&i){r=Tl(r);i=Tl(i)}r-=Iu*2;i-=Iu*2;return this._getImagePixels(t,r,i)};El.prototype._getNonScaledImagePixels=function e(t){return this._getImagePixels(t,t.width,t.height)};El.prototype._getDuplicatedImagePixels=function e(t){if(t.width===0||t.height===0){return this._getImagePixels(t,0,0)}if(!this._canvasForDuplicatedImage){this._canvasForDuplicatedImage=Er();this._canvasForDuplicatedImage.width=zu;this._canvasForDuplicatedImage.height=zu}var r=this._canvasForDuplicatedImage,i=r.getContext("2d"),n=t.width,a=t.height,o=(zu-n)/2,s=(zu-a)/2;while(o>0){o-=n}while(s>0){s-=a}for(var u=o;u<zu;u+=n){for(var l=s;l<zu;l+=a){i.drawImage(t,u,l)}}return this._getImagePixels(r,zu,zu)};El.prototype._getImagePixels=function e(t,r,i){var n;if(r===0||i===0){n=new Uint8Array(0)}else{if(this._imageCanvas.width<r||this._imageCanvas.height<i){this._imageCanvas.width=r;this._imageCanvas.height=i}var a=this._imageCanvasContext;Ml(a,0,0,r,i);try{a.drawImage(t,0,0,r,i)}catch(e){}n=a.getImageData(0,0,r,i).data}return{width:r,height:i,pixels:n,filter:pl}};El.prototype._getPieChartPixels=function e(t){var r=Sl;var i=this._imageCanvasContext;var n=r/2;var a=r/2;var o=0;var s=Math.PI*2/t.length;Ml(i,0,0,r,r);i.save();i.rect(0,0,r,r);i.clip();for(var u=0;u<t.length;++u){var l=o+s;i.beginPath();i.moveTo(n,a);i.arc(n,a,r,o,l);i.fillStyle=t[u];i.fill();o=l}i.restore();return{width:r,height:r,pixels:i.getImageData(0,0,r,r).data,filter:gl}};El.prototype._getTextPixels=function e(t,r,i,n,a,o,s){var u=this._imageCanvasContext;var l=a*o;u.font=n+" "+l+'px "'+i+'"';var f=u.measureText(r).width;if(f===0){f=l}var h=0;var d=0;var v=t===pl;if(!v){h=l*Du;d=Math.ceil(f*Fu/2)*2}var c=Math.ceil(f+d);var _=Math.ceil(l+h);if(this._imageCanvas.width<c){this._imageCanvas.width=c;u.font=n+" "+l+'px "'+i+'"'}u.clearRect(0,0,c,_);u.fillStyle="black";u.textBaseline="top";u.textAlign="left";u.fillText(r,s+d/2,h/2);return{width:c,height:_,pixels:u.getImageData(0,0,c,_).data,filter:t}};El.prototype._getRegularTextPixels=function e(t,r,i,n,a,o){return this._getTextPixels(_l,t,r,i,n,a,o)};El.prototype._getIconPixels=function e(t,r,i,n){return this._getTextPixels(pl,t,r,i,wl,n,0)};El.prototype._getSdfTextPixels=function e(t,r,i,n){var a=this._sdfGenerator.draw(t,r,i,n);var o=a.width;var s=a.height;var distance=a.distance;var u=new Uint8Array(o*s*4);for(var l=0;l<distance.length;++l){u[l*4+3]=distance[l]}return{width:o,height:s,pixels:u,filter:gl}};function Tl(value){return Math.ceil((value+Iu*2)/Nu)*Nu}function Ml(e,t,r,i,n){e.clearRect(t,r,i,n)}var Cl=false;var kl={byte:1,ubyte:1,short:2,ushort:2,float:4};var Nl={byte:"BYTE",ubyte:"UNSIGNED_BYTE",short:"SHORT",ushort:"UNSIGNED_SHORT",float:"FLOAT"};var Il=function e(t,r,i){var n=this;var a=i.metaData;var o=i.vertexSource;var s=i.fragmentSource;var u=i.macros;this._gl=t;this._ext=r;this._vertexSource=o;this._fragmentSource=s;this._metaData=a;this._macros=u;this._animated=!!u.ANIMATED;this._isText=!!u.TEXT;this._compiled=false;this._totalAttributesSize=this._metaData.attributes.reduce(function(e,t){var r=t.size;var i=t.type;var a=t.tags;var o=a.includes("TEXT");var s=a.includes("ANIMATED");return e+(!o&&(!s||n._animated)?r*kl[i]:0)},0);this._vertexPosBuffer=null;this._vertexPosAttribLocation=-1;this._uniformLocations={};this._program=null;this._enableAttributes=null;this._disableAttributes=null;this._setupAttributes=null;this._setupSideAttributes=null;this._setupUniforms=null;this._initVertexPosBuffer()};Il.prototype._initVertexPosBuffer=function e(){var t=this._gl,r=new Int8Array(pu*12);for(var i=0;i<pu;++i){var n=i*12;r[n]=-1;r[n+1]=-1;r[n+2]=1;r[n+3]=-1;r[n+4]=1;r[n+5]=1;r[n+6]=-1;r[n+7]=-1;r[n+8]=-1;r[n+9]=1;r[n+10]=1;r[n+11]=1}this._vertexPosBuffer=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,this._vertexPosBuffer);t.bufferData(t.ARRAY_BUFFER,r,t.STATIC_DRAW)};Il.prototype._compile=function e(t){var r=this;if(t===void 0)t={};var i=Object.keys(t),n=this._gl,a=this._vertexSource,o=this._fragmentSource,s=["var gl = this._gl;"],u=["var gl = this._gl;"],l=["var gl = this._gl; var ext = this._ext;"],f=["var gl = this._gl; var ext = this._ext;"],h=["var gl = this._gl;"];Object.keys(this._macros).forEach(function(e){a=a.replace("#define "+e+" 0","#define "+e+" "+r._macros[e]);o=o.replace("#define "+e+" 0","#define "+e+" "+r._macros[e])});for(var d=0;d<i.length;++d){var v=i[d],value=t[v];a=zl(a,v,value);o=zl(o,v,value)}this._program=Ll(n,a,o);n.useProgram(this._program);this._vertexPosAttribLocation=n.getAttribLocation(this._program,this._metaData.vertexPosAttribute);s.push("gl.enableVertexAttribArray("+this._vertexPosAttribLocation+");");u.push("gl.disableVertexAttribArray("+this._vertexPosAttribLocation+");");var c=this._totalAttributesSize,_=0;for(var g=0;g<this._metaData.attributes.length;++g){var p=r._metaData.attributes[g];var y=p.name;var m=p.size;var b=p.type;var x=p.tags;var A=x.includes("ANIMATED"),w=n.getAttribLocation(r._program,y),S=m*kl[b],E=Nl[b];if(w!==-1){s.push("gl.enableVertexAttribArray("+w+");");u.push("gl.disableVertexAttribArray("+w+");");l.push("gl.vertexAttribPointer("+w+", "+m+", gl."+E+", false, "+c+", "+_+");","ext.vertexAttribDivisorANGLE("+w+", divisor);")}else{if(!x.includes("TEXT")&&(r._animated||!A)){at('unused attribute "'+y+'"')}}_+=S}if(this._macros.TEXT){var T=this._metaData.attributes.filter(function(e){var t=e.tags;return t.includes("TEXT")})[0];var M=T.name;var C=T.size;var k=T.type;var N=n.getAttribLocation(this._program,M),I=C*kl[k];if(N!==-1){s.push("gl.enableVertexAttribArray("+N+");");u.push("gl.disableVertexAttribArray("+N+");");f.push("gl.vertexAttribPointer("+N+", "+C+", gl."+Nl[k]+", false, "+I+", 0);","ext.vertexAttribDivisorANGLE("+N+", 1);")}else{at('unused attribute "'+M+'"')}}for(var z=0;z<this._metaData.uniforms.length;++z){var L=r._metaData.uniforms[z];var R=L.id;var D=L.name;var F=L.type;var P=n.getUniformLocation(r._program,D),B="";r._uniformLocations[R]=P;if(F==="int"||F==="sampler2D"){B="gl.uniform1i(this._uniformLocations."+R+", variables."+R+");"}else if(F==="float"){B="gl.uniform1f(this._uniformLocations."+R+", variables."+R+");"}else if(F==="vec2"){B="gl.uniform2f(this._uniformLocations."+R+", variables."+R+"[0], variables."+R+"[1]);"}else if(F==="vec3"){B="gl.uniform3f(this._uniformLocations."+R+", variables."+R+"[0], variables."+R+"[1], variables."+R+"[2]);"}else if(F==="vec4"){B="gl.uniform4f(this._uniformLocations."+R+", variables."+R+"[0], variables."+R+"[1], variables."+R+"[2], variables."+R+"[3]);"}h.push(B)}this._enableAttributes=new Function(s.join("\n"));this._disableAttributes=new Function(u.join("\n"));this._setupAttributes=new Function("divisor",l.join("\n"));this._setupSideAttributes=new Function(f.join("\n"));this._setupUniforms=new Function("variables",h.join("\n"))};Il.prototype.attach=function e(t){if(!this._compiled){this._compile();this._compiled=true}var r=this._gl;r.blendFuncSeparate(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE);r.useProgram(this._program);r.bindBuffer(r.ARRAY_BUFFER,this._vertexPosBuffer);r.vertexAttribPointer(this._vertexPosAttribLocation,2,r.BYTE,false,2,0);this._ext.vertexAttribDivisorANGLE(this._vertexPosAttribLocation,0);this._enableAttributes();this._setupUniforms(t)};Il.prototype.detach=function e(){this._disableAttributes()};Il.prototype.setupAttributes=function e(t){this._setupAttributes(t)};Il.prototype.setupSideAttributes=function e(){this._setupSideAttributes()};function zl(e,t,value){var r=value.toString();if(r.indexOf(".")===-1){r+=".0"}return e.replace("const float "+t+" = 0.0;","const float "+t+" = "+r+";")}function Ll(e,t,r){if(Cl){t=t.replace("#define D3D9_FIX 0","#define D3D9_FIX 1");r=r.replace("#define D3D9_FIX 0","#define D3D9_FIX 1")}var i=e.createProgram(),n=e.createShader(e.VERTEX_SHADER),a=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(n,t);e.shaderSource(a,r);e.compileShader(n);e.compileShader(a);if(!e.getShaderParameter(n,e.COMPILE_STATUS)){throw new Error("Vertex shader compilation error:\n"+e.getShaderInfoLog(n))}if(!e.getShaderParameter(a,e.COMPILE_STATUS)){throw new Error("Fragment shader compilation error:\n"+e.getShaderInfoLog(a))}e.attachShader(i,n);e.attachShader(i,a);e.linkProgram(i);if(!e.getProgramParameter(i,e.LINK_STATUS)){var o=e.getProgramInfoLog(i);if(!Cl&&o.indexOf("D3D9")!==-1){nt("Direct3D 9 detected, will use workaround to compile shaders.");Cl=true;return Ll(e,t,r)}else{throw new Error("Unable to initialize WebGL program:\n"+o)}}return i}var Rl=function e(t,r,i,n){this._gl=t;this._ext=r;this._program=i;this._dataBuffer=n;this._version=0;this._glBuffer=this._gl.createBuffer();this._sideGlBuffer=n.hasSideData()?this._gl.createBuffer():null;this._used=false};Rl.prototype.markAsUnused=function e(){this._used=false;return this};Rl.prototype.markAsUsed=function e(){this._used=true;return this};Rl.prototype.isUsed=function e(){return this._used};Rl.prototype.getProgram=function e(){return this._program};Rl.prototype.draw=function e(){var t=this._gl,r=this._dataBuffer.getNbSideElementsPerMainElement()||1,i=r>1,n=this._dataBuffer.getVersion(),a=this._version!==n;t.bindBuffer(t.ARRAY_BUFFER,this._glBuffer);if(a){this._version=n;t.bufferData(t.ARRAY_BUFFER,this._dataBuffer.getByteArray(),t.STATIC_DRAW)}this._program.setupAttributes(r);if(i){t.bindBuffer(t.ARRAY_BUFFER,this._sideGlBuffer);if(a){t.bufferData(t.ARRAY_BUFFER,this._dataBuffer.getSideByteArray(),t.STATIC_DRAW)}this._program.setupSideAttributes()}this._ext.drawArraysInstancedANGLE(t.TRIANGLES,0,6,this._dataBuffer.getSize()*r)};Rl.prototype.destroy=function e(){this._gl.deleteBuffer(this._glBuffer);if(this._sideGlBuffer){this._gl.deleteBuffer(this._sideGlBuffer)}};var Dl={stencil:false,antialias:false,alpha:true,premultipliedAlpha:true};var Fl=0;var Pl=10;var Bl=Ul(Ks,false);var Ol=Ul(Ks,true);var Vl=Ul(Js,false);var jl=Ul(Js,true);function Ul(e,t){return(e<<1)+t}var Gl={NO_WEBGL:'Unable to create a WebGL context: `canvas.getContext("webgl")` and `canvas.getContext("experimental-webgl")` returned `null`',NO_ANGLE_INSTANCED_ARRAYS:'WebGL extension "ANGLE_instanced_arrays" unavailable: `gl.getExtension("ANGLE_instanced_arrays")` returned `null`'};function Xl(value,e){if(!value){var t=new Error(Gl[e]);t.code=e;throw t}}var Wl=function(e){function t(t){e.call(this,t);this._glCanvas=Er();this._gl=vr(this._glCanvas,Dl);Xl(this._gl,"NO_WEBGL");this._ext=this._gl.getExtension("ANGLE_instanced_arrays");Xl(this._ext,"NO_ANGLE_INSTANCED_ARRAYS");this._shapeTexture=new rl(this._gl,Fl);this._patternTexture=new El(this._gl,Pl);this._2dcanvas=Er();this._ctx=this._2dcanvas.getContext("2d");this._glCanvas.style.imageRendering="pixelated";this._glBuffers=[];this._currentProgram=null;this._programs=null;this._animationFrame=null;this._initPrograms();this._initGl()}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.getName=function e(){return"WebGL"};t.prototype.getDomElement=function e(){return this._glCanvas};t.prototype._initGl=function e(){var t=this._gl;var r=this._colorManager.parseColor(null);t.clearColor(r[0],r[1],r[2],r[3]);t.enable(t.BLEND)};t.prototype._initPrograms=function e(){var t=Hl(Ju,Qu);this._programs=new Array(4);this._programs[Bl]=this._createProgram({metaData:t,vertexSource:Ju,fragmentSource:Qu,macros:{ANIMATED:0,TEXT:0}});this._programs[Ol]=this._createProgram({metaData:t,vertexSource:Ju,fragmentSource:Qu,macros:{ANIMATED:1,TEXT:0}});this._programs[Vl]=this._createProgram({metaData:t,vertexSource:Ju,fragmentSource:Qu,macros:{ANIMATED:0,TEXT:1}});this._programs[jl]=this._createProgram({metaData:t,vertexSource:Ju,fragmentSource:Qu,macros:{ANIMATED:1,TEXT:1}})};t.prototype._createProgram=function e(t){return new Il(this._gl,this._ext,t)};t.prototype._computeUniforms=function e(){return{viewWidth:this._width,viewHeight:this._height,viewX:this._viewX,viewY:this._viewY,viewZoom:this._viewZoom,viewAngle:this._viewAngle,currentTime:this._currentTime,pixelRatio:this._pixelRatio,backgroundColor:this._backgroundRgba,patternInfoTexture:this._patternTexture.getInfoTextureUnit(),patternNearestTexture:this._patternTexture.getNearestTextureUnit(),patternLinearTexture:this._patternTexture.getLinearTextureUnit(),patternMipmapTexture:this._patternTexture.getMipmapTextureUnit(),shapeTexture:this._shapeTexture.getTextureUnit(),BYTES_TO_COORD:this._bytesToActualCoord,BYTES_TO_SCALED_SIZE:this._bytesToActualScaledSize,BYTES_TO_PIXEL_SIZE:this._bytesToActualPixelSize,BYTES_TO_MIN_VISIBLE_SIZE:this._bytesToActualMinVisibleSize,BYTES_TO_SYMBOLIC_SIZE:this._bytesToActualSymbolicSize,BYTES_TO_PATTERN_OFFSET:this._bytesToActualDashOffset,BYTES_TO_DASH_LENGTH:this._bytesToActualDashLength,BYTES_TO_GAP_LENGTH:this._bytesToActualGapLength,PATTERN_INFO_TEXTURE_SIZE:this._patternTexture.getInfoTextureSize(),PATTERN_NEAREST_TEXTURE_SIZE:this._patternTexture.getNearestTextureSize(),PATTERN_LINEAR_TEXTURE_SIZE:this._patternTexture.getLinearTextureSize(),PATTERN_MIPMAP_TEXTURE_SIZE:this._patternTexture.getMipmapTextureSize(),PATTERN_POSITION_GRANULARITY:this._patternTexture.getGranularity(),SHAPE_TEXTURE_SIZE:this._shapeTexture.getTextureSize(),SHAPE_SAMPLING_SIZE:this._shapeTexture.getSamplingSize(),SHAPE_SAMPLING_BUFFER_RATIO:this._shapeTexture.getBufferRatio(),SHAPE_LINE_ID:this._shapeManager.getIdFromName("line"),SHAPE_TRIANGLE_ID:this._shapeManager.getIdFromName("triangle"),NB_SHAPES_BY_SIDE:this._shapeTexture.getTextureSize()/this._shapeTexture.getSamplingSize(),SHAPE_DIMENSIONS:this._shapeTexture.getSamplingSize()/this._shapeTexture.getTextureSize(),SHAPE_ACTUAL_RATIO:1-this._shapeTexture.getBufferRatio()}};t.prototype._render=function e(t){var r=this;var i=t.shapesChanged;var n=t.patternsChanged;var a=t.dimensionsChanged;var o=t.backgroundColorChanged;if(n){this._patternTexture.refresh(this._patternManager)}if(i){this._shapeTexture.refresh(this._shapeManager)}if(a){zr(this._glCanvas,this._width,this._height,this._pixelRatio);this._gl.viewport(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio)}if(o){var s=this._backgroundRgba;var u=s[0];var l=s[1];var f=s[2];var h=s[3];this._gl.clearColor(u,l,f,h)}var d=this._computeUniforms();var v=this._startFrame();this._gl.clear(this._gl.COLOR_BUFFER_BIT);for(var c=0;c<v.length;++c){r._displayBuffer(v[c],d)}this._endFrame()};t.prototype._displayBuffer=function e(t,r){var i=t.getProgram();if(this._currentProgram!==i){if(this._currentProgram){this._currentProgram.detach()}this._currentProgram=i;this._currentProgram.attach(r)}t.markAsUsed();return t.draw()};t.prototype._startFrame=function e(){var t=this;var r=this._bufferList.getBuffersByAscendingDepth(),i=[];for(var n=0;n<this._glBuffers.length;++n){var a=t._glBuffers[n];if(a){a.markAsUnused()}}for(var o=0;o<r.length;++o){var s=r[o],u=t._getAssociatedGlBuffer(s);u.markAsUsed();if(!s.isEmpty()&&t._isBufferDisplayable(s)){i.push(u)}}for(var l=0;l<this._glBuffers.length;++l){var f=t._glBuffers[l];if(f&&!f.isUsed()){f.destroy();t._glBuffers[l]=undefined}}return i};t.prototype._endFrame=function e(){if(this._currentProgram){this._currentProgram.detach();this._currentProgram=null}};t.prototype._getAssociatedGlBuffer=function e(t){var r=this;var i=t.getId(),n=this._glBuffers[i];if(!n){while(this._glBuffers.length<=i){r._glBuffers.push(undefined)}var a=Ul(t.getElementType(),t.isAnimated()),o=this._programs[a];n=new Rl(this._gl,this._ext,o,t);this._glBuffers[i]=n}return n};t.prototype.destroy=function e(){var t=this._gl.getExtension("WEBGL_lose_context");if(t){t.loseContext()}};t.prototype.getImageData=function e(){var t=this._glCanvas.width;var r=this._glCanvas.height;if(this._2dcanvas.width<t||this._2dcanvas.height<r){this._2dcanvas.width=t;this._2dcanvas.height=r}this._ctx.drawImage(this._glCanvas,0,0);return this._ctx.getImageData(0,0,t,r)};t.prototype._getImageDataflippedYAxis=function e(){var t=this._gl;var r=this._glCanvas.width;var i=this._glCanvas.height;var n=this._ctx.createImageData(r,i);var a=new Uint8Array(n.data.buffer);t.readPixels(0,0,r,i,t.RGBA,t.UNSIGNED_BYTE,a);return n};return t}(Ku);function Hl(e,t){var r={vertexPosAttribute:"a_vertexPos",attributes:[],uniforms:[]};ql(r,e);ql(r,t);return r}var Yl={float:1,vec2:2,vec3:3,vec4:4};function ql(e,t){var r=/(?:attribute\s+\/\*\s*(byte|ubyte|short|ushort|float)\s*\*\/\s*(float|vec2|vec3|vec4)\s+(\w+)\s*;)|(?:#if\s*(\w+))|(?:#endif)/g;var i=/uniform\s+\/\*\s*\$(\w+)\s*\*\/\s*(float|vec2|vec3|vec4|sampler2D|int)\s+(\w+)\s*;/g;var n=[];var a=r.exec(t);while(a){var o=a[0];if(o==="#endif"){n.pop()}else if(o.startsWith("#if")){n.push(a[4])}else{e.attributes.push({name:a[3],size:Yl[a[2]],type:a[1],tags:n.slice()})}a=r.exec(t)}a=i.exec(t);while(a){if(!e.uniforms.some(function(e){var t=e.id;return t===a[1]})){e.uniforms.push({id:a[1],name:a[3],type:a[2]})}a=i.exec(t)}}var Zl=Math.PI;var $l=Math.PI*2;var Kl=function(e){function t(t){e.call(this,t);this._tmp={x:0,y:0,length:0,angle:0};this._dummyDimensions={width:1,height:1};this._selfLoopCosCp1=0;this._selfLoopSinCp1=0;this._selfLoopCosCp2=0;this._selfLoopSinCp2=0;this._renderInfo={bounds:[]};this._clipViewport=true}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.setViewportClipping=function e(t){this._clipViewport=t};t.prototype._graphToScreen=function e(t,r){var i=this._width/2,n=this._height/2,a=(t-this._viewX)*this._viewZoom,o=(r-this._viewY)*this._viewZoom,s=this._viewAngleCos,u=this._viewAngleSin;this._tmp.x=s*a+u*o+i;this._tmp.y=-u*a+s*o+n;return this._tmp};t.prototype._graphToScreenSize=function e(t,r){return t*this._viewZoom+r};t.prototype._getShapePoints=function e(t){return this._shapeManager.getDefinitionFromName(t).points};t.prototype._computeAngle=function e(t,r,i){var n=t+(r?this._viewAngle:0);if(i){n=(n+Math.PI*2)%(Math.PI*2);if(n>Math.PI/2&&n<3*Math.PI/2){n+=Math.PI}}return n};t.prototype._computeOffsetAngle=function e(t,r,i){return t-(i?r:i)};t.prototype._computeSymbolicSize=function e(t){return t===0?Infinity:t*this._viewZoom};t.prototype._computeAnimationRatio=function e(t,r,i){var n=(this._currentTime-t)/r,a=n*n,o=a*n,s=this._easingManager.getPolygonFromName(i),u,l,f,h;if(n<.5){u=s[0];l=s[1];f=s[2];h=s[3]}else{u=s[4];l=s[5];f=s[6];h=s[7]}return be(u+l*n+f*a+h*o,0,1)};t.prototype._mix=function e(t,r,i){return t*i+r*(1-i)};t.prototype._mixColor=function e(t,r,i){if(t===r){return t}var n=this._colorManager.parseColor(t),a=this._colorManager.parseColor(r),o=this._mix(n[0],a[0],i)*255|0,s=this._mix(n[1],a[1],i)*255|0,u=this._mix(n[2],a[2],i)*255|0,l=this._mix(n[3],a[3],i);return"rgba("+o+","+s+","+u+","+l+")"};t.prototype._distanceBetweenAngles=function e(t,r){var i=Math.abs(t-r);if(i>Zl){i=Math.abs(i-$l)}return i};t.prototype._mixPosLengthAngle=function e(t,r,i,n,a,o,s,u,l){var f=Math.cos(n);var h=Math.sin(n);var d=Math.cos(u);var v=Math.sin(u);var c=i/2;var _=s/2;var g=t-f*c;var p=r-h*c;var y=t+f*c;var m=r+h*c;var b=a-d*_;var x=o-v*_;var A=a+d*_;var w=o+v*_;var S=this._mix(g,b,l);var E=this._mix(p,x,l);var T=this._mix(y,A,l);var M=this._mix(m,w,l);var C=T-S;var k=M-E;var N=(S+T)/2;var I=(E+M)/2;var z=Math.sqrt(C*C+k*k);var L=Math.atan2(k,C);this._tmp.x=N;this._tmp.y=I;this._tmp.length=z;this._tmp.angle=L;return this._tmp};t.prototype._displayBuffer=function e(t){var r=this;var i=t.getSize(),n=t.isAnimated();for(var a=0;a<i;++a){var o=r.extractElement(t,a);if(!o.valid){continue}r._displayElement(o,n);if(o.end.curvature!==0){a+=Ja-1}}};t.prototype._computeSelfLoopAngles=function e(){var t=Vi(180)-this._viewAngle;var r=Vi(90)-this._viewAngle;this._selfLoopCosCp1=Math.cos(t);this._selfLoopSinCp1=Math.sin(t);this._selfLoopCosCp2=Math.cos(r);this._selfLoopSinCp2=Math.sin(r)};t.prototype._formatEdgeTextData=function e(t){if(t.adjustAngle&&t.strokeWidthScaled){var r=t.strokeWidthScaled;if(r>this._viewZoom){t.angle=0;t.offsetScaled=0;t.offsetAbsolute=0}t.strokeWidthScaled=0}};t.prototype._parseRenderInfo=function e(t,r,i,n){var a=this._renderInfo;var o=t.pattern.type;var s=o===nu;var u=this._computeSymbolicSize(t.symbolicSize);var l=t.minVisibleSize;a.skip=u<l;if(a.skip){return a}this._formatEdgeTextData(t);this._formatEdgeTextData(n);var f=t.strokeMinVisibleSize;var h=t.patternMinVisibleSize;var d=t.opacity;var v=t.fillColor;var c=t.strokeColor;var _=this._graphToScreenSize(t.thicknessScaled,t.thicknessAbsolute);var g=this._graphToScreenSize(t.strokeWidthScaled,t.strokeWidthAbsolute);var p=this._graphToScreenSize(t.offsetScaled,t.offsetAbsolute);var y=this._graphToScreen(t.x,t.y);var m=y.x;var b=y.y;var x,A;var w=this._computeAngle(t.angle,t.angleAffectedByView,t.adjustAngle);var S=this._computeOffsetAngle(t.offsetAngle,w,t.offsetAffectedByAngle);var E=this._graphToScreenSize(t.lengthScaled,t.lengthAbsolute);x=m+Math.cos(S)*p;A=b+Math.sin(S)*p;if(r){var T=this._computeAnimationRatio(i.beginTime,i.duration,i.easing);d=this._mix(d,n.opacity,T);v=this._mixColor(v,n.fillColor,T);c=this._mixColor(c,n.strokeColor,T);var M=this._graphToScreen(n.x,n.y);var C=M.x;var k=M.y;var N=this._graphToScreenSize(n.lengthScaled,n.lengthAbsolute);var I=this._graphToScreenSize(n.thicknessScaled,n.thicknessAbsolute);var z=this._graphToScreenSize(n.strokeWidthScaled,n.strokeWidthAbsolute);var L=this._graphToScreenSize(n.offsetScaled,n.offsetAbsolute);var R=this._computeAngle(n.angle,n.angleAffectedByView,n.adjustAngle);var D=this._computeOffsetAngle(n.offsetAngle,R,n.offsetAffectedByAngle);var F=C+Math.cos(D)*L;var P=k+Math.sin(D)*L;if(x===F&&A===P&&w===R){E=this._mix(E,N,T)}else{var B=this._mixPosLengthAngle(x,A,E,w,F,P,N,R,T);x=B.x;A=B.y;E=B.length;w=B.angle}_=this._mix(_,I,T);g=this._mix(g,z,T)}a.thickness=_;a.length=E;a.angle=w;a.strokeWidth=g;a.strokeColor=c;a.fillColor=v;a.opacity=d;a.centerX=x;a.centerY=A;a.pattern=t.pattern;a.patternType=o;a.patternScale=t.patternScale;a.patternMask=t.patternMask;a.patternSdf=t.patternSdf;a.isPatternTextOpt=s;a.patternDisplayed=o!==0&&o!==Qs&&u>=h;a.strokeDisplayed=!s&&c&&g>0&&u>=f;a.fillDisplayed=!s;a.sinAngle=Math.sin(w);a.cosAngle=Math.cos(w);this._calculateBounds(a,t);if(this._clipViewport){var O=a.bounds;var V=0,j=0,U=this._width,G=this._height;if(O[0]>U||O[2]<V||O[1]>G||O[3]<j){a.skip=true}}return a};t.prototype._calculateBounds=function e(t,r){var i=t.length;var n=t.thickness;var a=t.angle;var o=t.centerX;var s=t.centerY;var u=t.patternType;var l=t.bounds;if(t.strokeDisplayed||t.fillDisplayed){if(r.shape==="line"){if(r.curvature===0){if(a===0){l[0]=o-i/2-n;l[1]=s-n;l[2]=l[0]+i+n*2;l[3]=l[1]+n*2}else{xo(o-i/2-n,s-n,i+n*2,n*2,a,t.sinAngle,t.cosAngle,l)}}else{if(Math.abs(r.curvature)===1){l[0]=o-i/2-n;l[1]=s-i/2-n;l[2]=l[0]+i+n*2;l[3]=l[1]+i+n*2}else{var f=n*r.curvature*4;l[0]=o-f;l[1]=s-f;l[2]=l[0]+f*2;l[3]=l[1]+f*2}}}else{var h=1.25;l[0]=o-i*h/2;l[1]=s-i*h/2;l[2]=l[0]+i*h;l[3]=l[1]+i*h}}if(t.patternDisplayed){switch(u){case tu:case nu:case iu:var d=t.pattern.attributes.text;var v=u===iu||t.pattern.attributes.size==="sdf";var c=v?n*t.patternScale:t.pattern.attributes.size;t.isFontSizeScaled=v;t.fontSize=c;l[0]=o-d.length*c/2;l[1]=s-d.length*c/2;l[2]=l[0]+d.length*c;l[3]=l[1]+d.length*c;break;case eu:var _=i*t.patternScale;var g=n*t.patternScale;l[0]=o-_/2;l[1]=s-g/2;l[2]=l[0]+_;l[3]=l[1]+g;break;case ru:l[0]=o-i;l[1]=s-i;l[2]=o+i;l[3]=s+i;break;default:break}}};return t}(Ku);var Jl=!Er().__dummy;var Ql=function(e){function t(t){e.call(this,t);this._canvas=Er();this._ctx=this._canvas.getContext("2d");this._helper={dashActive:false,isLine:false,lineWidth:0,isCurved:false,isSelfLoop:false,x1:0,y1:0,x2:0,y2:0,cx1:0,cy1:0,cx2:0,cy2:0}}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.getName=function e(){return"Canvas"};t.isAvailable=function e(){return Jl};t.prototype.getDomElement=function e(){return this._canvas};t.prototype._render=function e(t){var r=this;var i=t.dimensionsChanged;var n=t.viewChanged;if(i){$u(this._canvas,this._width,this._height,this._pixelRatio)}if(n){this._computeSelfLoopAngles()}var a=this._ctx,o=this._width*this._pixelRatio,s=this._height*this._pixelRatio;a.clearRect(0,0,o,s);if(this._backgroundColor){a.fillStyle=this._backgroundColor;a.fillRect(0,0,o,s)}var u=this._bufferList.getBuffersByAscendingDepth();for(var l=0;l<u.length;++l){var f=u[l];if(r._isBufferDisplayable(f)){r._displayBuffer(f)}}};t.prototype._displayElement=function e(t,r){var i=t.end,n=t.start;var a=this._parseRenderInfo(i,r,t.animation,n);if(a.skip){return}var o=a.thickness;var s=a.length;var u=a.angle;var l=a.cosAngle;var f=a.sinAngle;var h=a.strokeWidth;var d=a.opacity;var v=a.centerX;var c=a.centerY;var _=a.patternType;var g=a.patternScale;var p=a.patternMask;var y=a.isPatternTextOpt;var m=a.patternDisplayed;var b=a.strokeDisplayed;var x=a.fillColor;var A=a.strokeColor;var w=a.fontSize;var S=this._getShapePoints(i.shape);var E=i.pattern.attributes;var T=i.pattern.dimensions||this._dummyDimensions;var M=S.length===2;var C=i.curvature;var k=i.isSelfLoop;var N=i.dashLength*o;var I=i.gapLength*o;this._setOpacity(d);this._setupDash(S,N,I);if(b){var z=s+(M?0:h);var L=o+h;this._drawShape(S,v,c,z,L,l,f,C,k);this._stroke(A,h)}if(!y){this._drawShape(S,v,c,s,o,l,f,C,k);this._fill(x)}if(m){this._startPatternDrawing(!y);if(_===ru){this._displayPieChart(v,c,s,E.colorArray)}else if(_===eu){var R=s*g,D=o*g,F=E.image,P=E.scaled,B=E.duplicated;this._displayImage(v,c,R,D,F,P,B)}else if(_===tu||_===nu||_===iu){var O=E.text,V=p,j=E.font,U=E.style,G=E.align,X=T.width*w;this._displayText(v,c,u,O,V,j,w,U,G,X)}this._endPatternDrawing()}};t.prototype._displayImage=function e(t,r,i,n,a,o,s){if(this._hideImages||!a.width||!a.height){return}var u=this._ctx,l=t*this._pixelRatio,f=r*this._pixelRatio,h=i*this._pixelRatio,d=n*this._pixelRatio,v=a.width*this._pixelRatio,c=a.height*this._pixelRatio;if(o){u.drawImage(a,l-h/2,f-d/2,h,d)}else if(s){var _=l-h/2,g=f-d/2,p=l+h/2,y=f+d/2,m=l-v/2,b=f-c/2;while(m>_){m-=v}while(b>g){b-=c}while(m<p){while(b<y){u.drawImage(a,m,b,v,c);b+=c}m+=v}}else{u.drawImage(a,l-v/2,f-c/2,v,c)}};t.prototype._displayPieChart=function e(t,r,i,n){var a=this._ctx,o=t*this._pixelRatio,s=r*this._pixelRatio,u=i*this._pixelRatio*2,l=u*2;if(n.length===1){a.fillStyle=n[0];a.fillRect(o-u,s-u,l,l)}else if(n.length===2){a.fillStyle=n[0];a.fillRect(o-u,s,l,u);a.fillStyle=n[1];a.fillRect(o-u,s-u,l,u)}else{var f=Math.PI*2/n.length,h=0;for(var d=0;d<n.length;++d){var v=n[d],c=h+f;a.beginPath();a.moveTo(o,s);a.arc(o,s,u,h,c);a.fillStyle=v;a.fill();h=c}}};t.prototype._displayText=function e(t,r,i,n,a,o,s,u,l,f){var h=this._ctx;var d=t*this._pixelRatio;var v=r*this._pixelRatio;var c=s*this._pixelRatio;var _=l==="center"?0:-f/2;h.translate(d,v);h.rotate(-i);h.textAlign=l;h.textBaseline="middle";h.font=u+" "+c+'px "'+o+'"';h.fillStyle=a;if(n.indexOf("\n")!==-1){var g=n.split("\n"),p=g.length,y=(1-p)/2*c;for(var m=0;m<p;++m){h.fillText(g[m],_,y);y+=c}}else{h.fillText(n,_,0)}};t.prototype._setOpacity=function e(t){this._ctx.globalAlpha=t};t.prototype._drawShape=function e(t,r,i,n,a,o,s,u,l){var f=this;var h=t.length;var d=r*this._pixelRatio;var v=i*this._pixelRatio;var c=n*this._pixelRatio;var _=a*this._pixelRatio;var g=c/2;var p=_/2;this._helper.isLine=false;this._ctx.beginPath();if(h===1){this._ctx.arc(d,v,g,0,Math.PI*2)}else if(h===2||h===3&&u!==0){var y=h===2;var m=o;var b=-s;var x=s;var A=o;var w=d-m*g;var S=v-b*g;var E=d+m*g;var T=v+b*g;var M,C,k,N;if(u!==0){if(l){var I=u*Ka*this._viewZoom*this._pixelRatio;w=d;S=v;E=d+this._selfLoopCosCp2*c;T=v+this._selfLoopSinCp2*c;M=d+this._selfLoopCosCp1*I;C=v+this._selfLoopSinCp1*I;k=d+this._selfLoopCosCp2*I;N=v+this._selfLoopSinCp2*I}else{var z=c/Qa*2*-u;M=(w+E)/2+x*z;C=(S+T)/2+A*z}}if(y){this._helper.isLine=true;this._helper.lineWidth=p*2;this._helper.x1=w;this._helper.y1=S;this._helper.x2=E;this._helper.y2=T;this._helper.vx=m;this._helper.vy=b;this._helper.orthoX=x;this._helper.orthoY=A;this._helper.isCurved=u!==0;this._helper.isSelfLoop=l;this._helper.cx1=M;this._helper.cy1=C;this._helper.cx2=k;this._helper.cy2=N}else if(l){var L=this._selfLoopCosCp1;var R=this._selfLoopSinCp1;var D=this._selfLoopCosCp2;var F=this._selfLoopSinCp2;x=-R;A=L;var P=w+x*p;var B=S+A*p;var O=M+L*p;var V=C+R*p;var j=k+D*p;var U=N+F*p;var G=k-D*p;var X=N-F*p;var W=M-L*p;var H=C-R*p;var Y=w-x*p;var q=S-A*p;this._ctx.moveTo(P,B);this._ctx.bezierCurveTo(O,V,j,U,E,T);this._ctx.bezierCurveTo(G,X,W,H,Y,q);this._ctx.closePath()}else{var Z=w+x*p;var $=S+A*p;var K=w-x*p;var J=S-A*p;var Q=M+x*p;var ee=C+A*p;var te=M-x*p;var re=C-A*p;this._ctx.moveTo(Z,$);this._ctx.quadraticCurveTo(Q,ee,E,T);this._ctx.quadraticCurveTo(te,re,K,J);this._ctx.closePath()}}else{for(var ie=0;ie<h;++ie){var ne=t[ie];var ae=ne.x*g;var oe=ne.y*p;var se=d+o*ae+s*oe;var ue=v+-s*ae+o*oe;if(ie===0){f._ctx.moveTo(se,ue)}else{f._ctx.lineTo(se,ue)}}this._ctx.closePath()}};t.prototype._drawLine=function e(t){var r=this._helper.orthoX*t;var i=this._helper.orthoY*t;var n=this._helper.x1+r;var a=this._helper.y1+i;var o=this._helper.x2+r;var s=this._helper.y2+i;var u=this._helper.cx1+r;var l=this._helper.cy1+i;var f=this._helper.cx2+r;var h=this._helper.cy2+i;this._ctx.beginPath();this._ctx.moveTo(n,a);if(this._helper.isSelfLoop){this._ctx.bezierCurveTo(u,l,f,h,o,s)}else if(this._helper.isCurved){this._ctx.quadraticCurveTo(u,l,o,s)}else{this._ctx.lineTo(o,s)}};t.prototype._fill=function e(t){if(!t){return}if(this._helper.isLine){this._drawLine(0);this._ctx.strokeStyle=t;this._ctx.lineWidth=this._helper.lineWidth;this._ctx.stroke()}else{this._ctx.fillStyle=t;this._ctx.fill()}};t.prototype._stroke=function e(t,r){var i=r*this._pixelRatio;this._ctx.strokeStyle=t;this._ctx.lineWidth=i;if(this._helper.isLine){var n=this._helper.lineWidth/2;this._drawLine(n);this._ctx.stroke();this._drawLine(-n);this._ctx.stroke()}else{this._ctx.stroke()}};t.prototype._startPatternDrawing=function e(t){this._ctx.save();if(t){this._ctx.clip()}};t.prototype._endPatternDrawing=function e(){this._ctx.restore()};t.prototype._setupDash=function e(t,r,i){var n=r&&i&&t.length===2;if(n){this._ctx.setLineDash([r*this._pixelRatio,i*this._pixelRatio])}else if(this._helper.dashActive){this._ctx.setLineDash([])}this._helper.dashActive=n};t.prototype.getImageData=function e(){return this._ctx.getImageData(0,0,this._canvas.width,this._canvas.height)};return t}(Kl);var ef=false;b.beforeFirstInstanceCreated(function(){try{ef=!!Rr("svg")}catch(e){}});var tf="none";var rf=1/3;function nf(e,t,r,i,n,a){var o=Rr("image");o.setAttribute("width",of(i));o.setAttribute("height",of(n));o.setAttribute("x",of(t));o.setAttribute("y",of(r));o.setAttribute("href",e);if(a){a.appendChild(o)}return o}function af(e,t,r,i,n,a,o){if(a===void 0)a=1;var s=Rr("rect");s.setAttribute("x",e);s.setAttribute("y",t);s.setAttribute("width",r);s.setAttribute("height",i);s.setAttribute("fill",n);s.setAttribute("fill-opacity",a);if(o){o.appendChild(s)}return s}function of(e){return parseFloat(e.toFixed(3))}var sf=function(e){function t(t){e.call(this,t);this._svg=Rr("svg");this._defs=Rr("defs");this._container=Rr("g");this._background=Rr("rect",{width:"100%",height:"100%",fill:"none"});this._styles=Rr("g");this._clipPaths=Rr("g");this._defs.appendChild(this._styles);this._defs.appendChild(this._clipPaths);this._svg.setAttribute("pointer-events","none");this._svg.style.userSelect="none";this._svg.appendChild(this._defs);this._svg.appendChild(this._background);this._svg.appendChild(this._container)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.getName=function e(){return"SVG"};t.isAvailable=function e(){return ef};t.prototype.getDomElement=function e(){return this._svg};t.prototype.export=function e(t){if(t===void 0)t={};if(t.embedFonts){return this.importFonts(t.embedFonts)}else{return Promise.resolve()}};t.prototype.importFonts=function e(t){var r=lr();if(typeof r==="undefined"){return Promise.resolve()}var i=Jr(this._container);var n;if(t&&Array.isArray(t)){n=t.map(function(e){return{rule:"@font-face { font-family: "+e.fontFamily+"; src: url() format(); }",format:e.format,base64:e.base64,resolved:true}})}else{n=ei().filter(function(e){var t=e.rule;var r=t.match(/font-family:\s*([^;]+);/);return r&&i[r[1]]===true})}var a=[];if(n.length!==0){var o=Rr("style");o.setAttribute("type","text/css");this._styles.appendChild(o);n.forEach(function(e){var t=e.rule;var i=e.resolved;if(i){qr(e,o,r)}else{var n=Yr(t);n.shift();a.push(Zr(n).then(function(e){return qr(e,o,r)}))}})}return Promise.all(a)};t.prototype._render=function e(t){var r=this;var i=t.dimensionsChanged;var n=t.viewChanged;var a=1;if(i){Lr(this._svg,{width:this._width*a,height:this._height*a})}if(n){this._computeSelfLoopAngles()}if(this._backgroundColor){var o=this._colorManager.rgbaToRgb(this._backgroundColor);this._background.setAttribute("fill",o.color);this._background.setAttribute("fill-opacity",o.opacity)}var s=this._bufferList.getBuffersByAscendingDepth();this._clipPathsCounter=0;this._clear();for(var u=0;u<s.length;++u){r._displayBuffer(s[u])}};t.prototype._clear=function e(){var t=this._container;var r=this._clipPaths;while(t.firstChild){t.removeChild(t.firstChild)}var i=r.firstChild,n;while(i){n=i.nextSibling;r.removeChild(i);i=n}};t.prototype._displayElement=function e(t,r){var i=t.start;var n=t.end;var a=t.animation;var o=this._parseRenderInfo(n,r,a,i);if(o.skip){return}var s=o.thickness;var u=o.length;var l=o.angle;var f=o.cosAngle;var h=o.sinAngle;var d=o.strokeWidth;var v=o.opacity;var c=o.centerX;var _=o.centerY;var g=o.patternType;var p=o.patternDisplayed;var y=o.strokeDisplayed;var m=o.fillDisplayed;var b=o.fontSize;var x,A,w;var S=this._colorManager.rgbaToRgb(o.fillColor);var E=S.opacity;var T=S.color;S=this._colorManager.rgbaToRgb(o.strokeColor);var M=S.opacity;var C=S.color;if(y||m){var k=this._getShapePoints(n.shape);var N=k.length;var I=n.curvature;var z=n.isSelfLoop;var L=I!==0&&N===3;var R=N===2;x=Rr("path");this._setPath(x,k,c,_,u,s,R,L,z,I,h,f);this._setOpacity(x,v*E,R);if(R){this._strokePattern(x,n.dashLength*s,n.gapLength*s)}if(y){A=Rr("path");A.setAttribute("fill","none");this._setPath(A,k,c,_,u,s+d,R,L,z,I,h,f);this._outline(A,d,C,v*M,R,s)}if(m){if(R){this._stroke(x,s,T,E*v)}this._fill(x,R?tf:T||tf)}if(A){this._container.appendChild(A)}this._container.appendChild(x)}if(p){var D="clip-path-"+this._clipPathsCounter++;switch(g){case tu:case nu:case iu:w=Rr("text");var F=n.pattern.attributes;this._text(w,F.text,c,_,l,b,n.patternMask,F.font,F.style);break;case eu:this._addClippingMask(x,D);this._image(D,n.pattern,c,_,u,s,n.patternScale,D);break;case ru:this._addClippingMask(x,D);this._pieChart(D,c,_,u,n.pattern.attributes.colorArray);break;case Qs:default:break}if(w){this._container.appendChild(w)}}};t.prototype._setOpacity=function e(t,r,i){if(i){t.setAttribute("stroke-opacity",r)}else{t.setAttribute("fill-opacity",r)}};t.prototype._addClippingMask=function e(t,r){var i=Rr("clipPath");var n=t.cloneNode(false);i.appendChild(n);this._clipPaths.appendChild(i);i.setAttribute("id",r)};t.prototype._image=function e(t,r,i,n,a,o,s){var u=1;i=i*u;n=n*u;var l=r.attributes;var f=a*s;var h=o*s;var d=l.image;var v=l.scaled;var c=l.duplicated;if(this._hideImages||!d.isDummy&&(!d.width||!d.height)){return}var _=f*u;var g=h*u;var p=d.width*u;var y=d.height*u;var m;if(v){p=_;y=g}if(c){var b=i-_/2;var x=n-g/2;var A=i+_/2;var w=n+g/2;var S=i-p/2;var E=n-y/2;var T=Rr("g");while(S>b){S-=p}while(E>x){E-=y}while(S<A){while(E<w){nf(d.src,S,E,p,y,T);E+=y}S+=p}}else{m=nf(d.src,i-_/2,n-g/2,p,y)}this._container.appendChild(m);m.setAttribute("clip-path","url(#"+t+")")};t.prototype._pieChart=function e(t,r,i,n,a){var o=n*2;var s=o*2;var u;var l=Rr("g");if(a.length===1){u=af(r-o,i-o,s,s,a[0],1,l)}else if(a.length===2){u=af(r-o,i,s,o,a[0],1,l);u=af(r-o,i-o,s,o,a[1],1,l)}else{var f=Math.PI*2/a.length;var h=0;for(var d=0;d<a.length;++d){var v=h+f;var c=r+n*Math.cos(v);var _=i+n*Math.sin(v);var g=r+n*Math.cos(h);var p=i+n*Math.sin(h);var y=v-h<=Math.PI?0:1;var m="M "+c+","+_+" A "+n+","+n+" 0 "+y+" 0 "+g+","+p+" L "+r+","+i+" L "+c+","+_;u=Rr("path");u.setAttribute("d",m);u.setAttribute("fill",a[d]);u.setAttribute("stroke-width",0);h=v;l.appendChild(u)}}l.setAttribute("clip-path","url(#"+t+")");this._container.appendChild(l)};t.prototype._text=function e(t,r,i,n,a,o,s,u,l){var f=1;var h=this._colorManager.rgbaToRgb(s);var d=h.opacity;var v=h.color;i=i*f;n=n*f;l=l||"normal";t.setAttribute("x",of(i));t.setAttribute("y",of(n));t.setAttribute("font-family",u);t.setAttribute("font-size",o*f);if(l==="bold"){t.setAttribute("font-weight",l)}else{t.setAttribute("font-style",l)}t.setAttribute("fill",v);t.setAttribute("fill-opacity",d);t.setAttribute("transform","rotate("+ji(-a)+" "+i+", "+n+")");t.setAttribute("text-anchor","middle");var c=r.split("\n");var _=c.length;var g=((1-_)/2+rf)*o;for(var p=0;p<_;p++){var y=Rr("tspan");y.appendChild(Dr(c[p]));y.setAttribute("dx",0);y.setAttribute("dy",g);g+=o;t.appendChild(y)}};t.prototype._setPath=function e(t,r,i,n,a,o,s,u,l,f,h,d){var v=1;var c=i*v;var _=n*v;var g=a*v;var p=o*v;var y=g/2;var m=p/2;var b="";if(r.length===1){var x=m;b="M "+(c-x)+", "+_+" a "+x+","+x+" 0 1,0 "+2*x+",0 a "+x+","+x+" 0 1,0 -"+2*x+",0"}else if(s||u){var A=d;var w=-h;var S=c-A*y;var E=_-w*y;var T=c+A*y;var M=_+w*y;var C=h,k=d;var N,I,z,L,R;if(f===0){b="M "+S+","+E+" L"+T+","+M}else if(l){R=f*Ka*this._viewZoom*v;N=S+this._selfLoopCosCp1*R;I=E+this._selfLoopSinCp1*R;z=T+this._selfLoopCosCp2*R;L=M+this._selfLoopSinCp2*R;S=i;E=n;T=i+this._selfLoopCosCp2*g;M=n+this._selfLoopSinCp2*g;b="M "+S+","+E+" C"+N+","+I+" "+z+","+L+" "+T+","+M}else{R=g/Qa*2*-f;N=(S+T)/2+C*R;I=(E+M)/2+k*R;b="M "+S+","+E+" Q"+N+","+I+" "+T+","+M}if(u){if(l){var D=this._selfLoopCosCp1;var F=this._selfLoopSinCp1;var P=this._selfLoopCosCp2;var B=this._selfLoopSinCp2;C=-F;k=D;var O=S+C*m;var V=E+k*m;var j=N+D*m;var U=I+F*m;var G=z+P*m;var X=L+B*m;var W=z-P*m;var H=L-B*m;var Y=N-D*m;var q=I-F*m;var Z=S-C*m;var $=E-k*m;b="M"+O+","+V+" C"+j+","+U+" "+G+","+X+", "+T+","+M+" "+"C"+W+","+H+" "+Y+","+q+" "+Z+","+$}else{var K=S+C*m;var J=E+k*m;var Q=S-C*m;var ee=E-k*m;var te=N+C*m;var re=I+k*m;var ie=N-C*m;var ne=I-k*m;b="M "+K+","+J+" Q"+te+","+re+" "+T+","+M+" Q"+ie+","+ne+" "+Q+","+ee+" Z"}}}else{for(var ae=0;ae<r.length;ae++){var oe=r[ae];var se=oe.x*y;var ue=oe.y*m;var le=c+d*se+h*ue;var fe=_-h*se+d*ue;b+=""+(ae===0?"M":"L")+le+","+fe+" "}b+="Z"}t.setAttribute("d",b)};t.prototype._outline=function e(t,r,i,n,a,o){if(a){var s=t.cloneNode(true);s.setAttribute("stroke-opacity",n);s.setAttribute("stroke-width",of(r+o));s.setAttribute("stroke",i);s.setAttribute("fill",tf);this._container.appendChild(s)}else{this._stroke(t,r,i,n)}};t.prototype._stroke=function e(t,r,i,n){if(n===void 0)n=1;var a=1;t.setAttribute("stroke",i);t.setAttribute("stroke-width",of(r*a));t.setAttribute("stroke-opacity",n)};t.prototype._strokePattern=function e(t,r,i){if(r&&i){t.setAttribute("stroke-dasharray",of(r)+","+of(i))}};t.prototype._fill=function e(t,r){t.setAttribute("fill",r)};return t}(Kl);var uf=function e(){this._version=0;this._mustUpdate=true;this.maxCoord=0;this.maxScaledSize=0;this.maxPixelSize=0;this.maxMinVisibleSize=0;this.maxSymbolicSize=0;this.maxDashOffset=0;this.maxDashLength=0;this.maxGapLength=0};uf.prototype._mustUpdateBoundary=function e(t,r){return r>t||t/r>16};uf.prototype.set=function e(t){var r=t.maxCoord;var i=t.maxScaledSize;var n=t.maxPixelSize;var a=t.maxMinVisibleSize;var o=t.maxSymbolicSize;var s=t.maxDashOffset;var u=t.maxDashLength;var l=t.maxGapLength;var f=this._mustUpdateBoundary(this.maxCoord,r)||this._mustUpdateBoundary(this.maxScaledSize,i)||this._mustUpdateBoundary(this.maxPixelSize,n)||this._mustUpdateBoundary(this.maxMinVisibleSize,a)||this._mustUpdateBoundary(this.maxSymbolicSize,o)||this._mustUpdateBoundary(this.maxDashOffset,s)||this._mustUpdateBoundary(this.maxDashLength,u)||this._mustUpdateBoundary(this.maxGapLength,l);if(f){this.maxCoord=r;this.maxScaledSize=i;this.maxPixelSize=n;this.maxMinVisibleSize=a;this.maxSymbolicSize=o;this.maxDashOffset=s;this.maxDashLength=u;this.maxGapLength=l;this._mustUpdate=true}return f};uf.prototype.update=function e(){if(this._mustUpdate){this._version+=1;this._mustUpdate=false}};uf.prototype.getVersion=function e(){return this._version};var lf=Le();var ff="\n".charCodeAt(0);var hf=12;var df=100;var vf=2047/df;var cf=3;var _f=function e(t){this._patternManager=t;this._canvas=Er();this._ctx=this._canvas.getContext("2d");this._mustClear=false;this._byFont={};this._widthAtlases={normal:{},bold:{},italic:{}};this._textPattern={type:nu,attributes:{text:"",font:"",size:0,style:"",align:""},dimensions:{width:0,height:0}};this._textDimensions={width:0,height:0};this._lineWidthList=new Array(64)};_f.prototype.clear=function e(){this._mustClear=true};_f.prototype._measureChar=function e(t,r,i){this._ctx.font=i+" "+hf+"px "+r;return this._ctx.measureText(t).width/hf};_f.prototype._getAtlas=function e(t,r,i){var n=i==="sdf"?0:i;var a=this._byFont[t]||(this._byFont[t]={});var o=a[r]||(a[r]=new Array(50));var s=o[n]||(o[n]=new Array(256));return s};_f.prototype._getMeasurementAtlas=function e(t,r){var i=this._widthAtlases[r];var n=i[t]||(i[t]=new Array(256));return n};_f.prototype.measureText=function e(t,r,i,n){var a=this;if(n===void 0)n=1;var o=this._getMeasurementAtlas(r,i);var s=0,u=0;var l=1;for(var f=0;f<t.length;++f){var h=t.charCodeAt(f);if(h===ff){if(u>s){s=u}u=0;l+=1}else{var d=o[h];if(d===undefined){d=a._measureChar(t[f],r,i);o[h]=d}u+=d}}if(u>s){s=u}this._textDimensions.width=s*n;this._textDimensions.height=l*n;return this._textDimensions};_f.prototype._getCharInfo=function e(t,r,i,n,a,o,s){var u=this;var l=t[r];if(!l){var f=String.fromCharCode(r);var h=a==="sdf"?1:cf;l={ratio:this._measureChar(f,i,n),patternId:new Array(h)};for(var d=0;d<h;++d){var v=d/h;l.patternId[d]=u._patternManager.getIdFromDefinition({type:tu,attributes:{text:f,font:i,style:n,size:a,pixelRatio:s,align:o,offset:v}})}t[r]=l}return l};_f.prototype.storeTextInDataView=function e(t,r,i,n){var a=this;var o=r;if(n&&n.type===nu){var s=n.attributes;var u=s.text;var l=s.font;var f=s.style;var h=s.size;var d=s.pixelRatio;var v=s.align;var c=v==="center";var _=this._getAtlas(l,f,h);var g=0;var p=1;var y=0;var m=0;var b=this._lineWidthList;for(var x=0;x<u.length;++x){var A=u.charCodeAt(x);if(A===ff){if(y>g){g=y}b[m]=y;m+=1;y=0;p+=1}else{var w=a._getCharInfo(_,A,l,f,h,v,d);y+=w.ratio}}b[m]=y;if(y>g){g=y}if(h==="sdf"){var S=0;var E=-(c?b[S]:g)/2;var T=(-p+1)/2;var M=0;for(var C=0;C<u.length;++C){var k=u.charCodeAt(C),N=_[k];if(k===ff){S+=1;E=-(c?b[S]:g)/2;T+=1}else{var I=N.ratio;var z=N.patternId[0];E+=(I+M)/2;M=I;var L=pf(E*vf);var R=gf(T*2);t.setUint16(o,z,lf);t.setUint16(o+2,(L<<4)+R,lf);o+=4}}}else{var D=0;var F=Math.ceil(-(c?b[D]:g)*h/2);var P=(-p+1)/2;for(var B=0;B<u.length;++B){var O=u.charCodeAt(B);var V=_[O];if(O===ff){D+=1;F=Math.ceil(-(c?b[D]:g)*h/2);P+=1}else{var j=V.ratio*h;var U=Math.floor(F);var G=F-U;var X=Math.round(G*cf);if(X===cf){X=0;U+=1}U+=Math.ceil(j/2);F+=j;var W=pf(U);var H=gf(P*2);t.setUint16(o,V.patternId[X],lf);t.setUint16(o+2,(W<<4)+H,lf);o+=4}}}}this._fillWithZeros(t,o,i)};_f.prototype.extractTextFromDataView=function e(t,r,i){var n=this;var a=t;var o=r;var s=i;var u=lf;var l=a.getUint16(o,u);var f=null;if(l){f=this._textPattern;var h=this._patternManager.getDefinitionFromId(l).attributes;var d=h.font;var v=h.style;var c=h.size;var _=h.align;var g=h.pixelRatio;var p=this._getAtlas(d,v,c),y=[],m=0,b=0,x=0,A=yf(a.getUint16(o+2,u)%16);for(var w=o;w<s;w+=4){var S=a.getUint16(w,u);if(!S){break}var E=yf(a.getUint16(w+2,u)%16),T=n._patternManager.getDefinitionFromId(S).attributes.text.charCodeAt(0),M=p[T];if(E>A){if(m>b){b=m}m=0;x+=1;y.push(ff);A=E}y.push(T);if(M){m+=M.ratio}}if(m>b){b=m}f.attributes.style=v;f.attributes.font=d;f.attributes.size=c;f.attributes.align=_;f.attributes.pixelRatio=g;f.attributes.text=String.fromCharCode.apply(null,y);f.dimensions.width=b;f.dimensions.height=x}return f};_f.prototype._fillWithZeros=function e(t,r,i){for(var n=r;n<i;n+=4){t.setUint16(n,0)}};_f.prototype._clear=function e(){this._byFont={};this._widthAtlases={normal:{},bold:{},italic:{}}};_f.prototype.update=function e(){if(this._mustClear){this._clear();this._mustClear=false}};_f.prototype.getVersion=function e(){};function gf(value){return be(value+8,0,15)}function pf(value){return be(value+2048,0,4095)}function yf(value){return value-8}var mf={linear:[0,1,0,0],quadraticIn:[0,0,1,0],quadraticOut:[0,2,-1,0],quadraticInOut:[0,0,2,0,-1,4,-2,0],cubicIn:[0,0,0,1],cubicOut:[0,3,-3,1],cubicInOut:[0,0,0,4,-3,12,-12,4]};var bf=function e(){this._linearEasing=[0,1,0,0,0,1,0,0];this._nameToPolygon={};this._polygonToName={};this.add(mf)};bf.prototype.add=function e(t){var r=this;Object.keys(t).forEach(function(e){var i=t[e].slice();if(i.length<8){i[4]=i[0];i[5]=i[1];i[6]=i[2];i[7]=i[3]}var n=xf.apply(null,i);r._nameToPolygon[e]=i;r._polygonToName[n]=e})};bf.prototype.getPolygonFromName=function e(t){return this._nameToPolygon[t]||this._linearEasing};bf.prototype.getNameFromPolygon=function e(t,r,i,n,a,o,s,u){var l=xf(t,r,i,n,a,o,s,u);return this._polygonToName[l]||"linear"};function xf(e,t,r,i,n,a,o,s){return e+n+(t+a)*256+(r+o)*65536+(i+s)*16777216}var Af=function e(){var t=this;this._elementType=Ks;this._animated=false;this._size=0;this._capacity=yu;this._depth=0;this._baseElt=Zu();this._list=new Array(this._capacity);for(var r=0;r<this._capacity;++r){t._list[r]=Zu()}};Af.prototype.setDepth=function e(t){this._depth=t;return this};Af.prototype.reset=function e(t,r,i){this._elementType=t;this._animated=r;this._depth=i;this._size=0;return this};Af.prototype.next=function e(){if(this._size>=this._capacity){throw new Error("internal error: block.next() was called on a full block")}return this._list[this._size++]};Af.prototype.nextAndReset=function e(){var t=this.next();Yu(t.end);Yu(t.start);qu(t.animation);return t};Af.prototype.forEach=function e(t){this._list.forEach(t)};Af.prototype.getElement=function e(t){return this._list[t]};Af.prototype.getCurrentElement=function e(){return this._list[this._size-1]};Af.prototype.getSize=function e(){return this._size};Af.prototype.getDepth=function e(){return this._depth};Af.prototype.getElements=function e(){return this._list};Af.prototype.getType=function e(){return this._elementType};Af.prototype.isAnimated=function e(){return this._animated};Af.prototype.setGlobalAnimation=function e(t,r,i){var n=this;for(var a=0;a<this._size;++a){var o=n._list[a].animation;o.beginTime=t;o.duration=r;o.easing=i}};var wf={x:0,y:0,zoom:1,angle:0,width:80,height:60,pixelRatio:1,backgroundColor:null,currentTime:0,hideImages:false,isBufferDisplayable:function(){return true}};var Sf={webgl:Wl,canvas:Ql,svg:sf,null:Ku};var Ef=Math.PI*2;var Tf=[0,0,0,0];var Mf=function e(){this._colorManager=new U;this._easingManager=new bf;this._patternManager=new ou;this._shapeManager=new gu;this._boundariesManager=new uf;this._textManager=new _f(this._patternManager);this._bufferList=new Gu;this._maxCoord=0;this._maxScaledSize=0;this._maxPixelSize=0;this._maxMinVisibleSize=0;this._maxSymbolicSize=0;this._maxDashOffset=0;this._maxDashLength=0;this._maxGapLength=0;this._actualCoordToBytes=Su;this._actualScaledSizeToBytes=Au;this._actualPixelSizeToBytes=Au;this._actualMinVisibleSizeToBytes=Tu;this._actualSymbolicSizeToBytes=wu;this._actualDashOffsetToBytes=wu;this._actualDashLengthToBytes=Mu;this._actualGapLengthToBytes=Mu;this._buffersByDepth=[];this._buffersById=[];this._blockIdToAddress=new Uint32Array(0);this._currentDataView=null;this._currentElementSize=0;this._currentBlockOffset=0;this._currentByteOffset=0;this._view=dt(wf);this._domElement=typeof document!=="undefined"?document.createElement("div"):br();this._rendererMustBeReset=true;this._renderType=null;this._renderer=null;this._littleEndian=Le();this._additionalCanvases=[];this._refreshTexts=false;this._debugIdCounter=0};Mf.prototype.addCanvas=function e(t){this._resizeCanvas(t);this._additionalCanvases.push(t);this._updateDomElement()};Mf.prototype.removeCanvas=function e(t){Re(this._additionalCanvases,t);this._updateDomElement()};Mf.prototype.createBlock=function e(){return new Af};Mf.prototype.parseColor=function e(t){return this._colorManager.parseColor(t)};Mf.prototype.clear=function e(){this._blockIdToAddress=new Uint32Array(0);this._patternManager=new ou;this._boundariesManager=new uf;this._textManager=new _f(this._patternManager);this._bufferList=new Gu;this._rendererMustBeReset=true};Mf.prototype.notifyFontsReloaded=function e(){this._patternManager.notifyUpdate();this._textManager.clear();this._refreshTexts=true};Mf.prototype.notifyPatternUpdate=function e(){this._patternManager.notifyUpdate()};Mf.prototype.getShapePoints=function e(t){return this._shapeManager.getDefinitionFromName(t).points};Mf.prototype.checkShapeHit=function e(t,r,i){var n=this._shapeManager.getDefinitionFromName(t);var a=n.getDistanceFromStrokeVertically;var o=n.getDistanceFromStrokeHorizontally;return Math.min(a(r,i),o(r,i))>=0};Mf.prototype.setGlobalBoundaries=function e(t){var r=t.maxBlockId;if(r===void 0)r=0;var i=t.maxCoord;var n=t.maxScaledSize;var a=t.maxPixelSize;var o=t.maxMinVisibleSize;var s=t.maxSymbolicSize;var u=t.maxDashOffset;var l=t.maxDashLength;var f=t.maxGapLength;if(r>this._blockIdToAddress.length){this._resizeBlockArray(r)}if(this._boundariesManager.set(t)){this._maxCoord=i;this._maxScaledSize=n;this._maxPixelSize=a;this._maxMinVisibleSize=o;this._maxSymbolicSize=s;this._maxDashOffset=u;this._maxDashLength=l;this._maxGapLength=f;this._actualCoordToBytes=Su/i;this._actualScaledSizeToBytes=Eu/n;this._actualPixelSizeToBytes=wu/a;this._actualMinVisibleSizeToBytes=Tu/o;this._actualSymbolicSizeToBytes=wu/s;this._actualDashOffsetToBytes=wu/u;this._actualDashLengthToBytes=Mu/l;this._actualGapLengthToBytes=Mu/f;return true}return false};Mf.prototype._resizeBlockArray=function e(t){var r=new Uint32Array(t);r.set(this._blockIdToAddress);this._blockIdToAddress=r};Mf.prototype._clamp=function e(t,r,i){return Math.min(Math.max(t,r),i)};Mf.prototype._signedToUnsignedShort=function e(value){return this._clamp(value+32768,0,65535)};Mf.prototype._parseColor=function e(t){return this._colorManager.parseColor(t)||Tf};Mf.prototype._formatColor=function e(t){var r=this._parseColor(t),i=Math.round(r[0]*15),n=Math.round(r[1]*15),a=Math.round(r[2]*15),o=Math.round(r[3]*15);return(i<<12)+(n<<8)+(a<<4)+o};Mf.prototype._formatCoord=function e(t){return t};Mf.prototype._formatAngle=function e(t){return this._clampAngle(t)*(Eu/Ef)};Mf.prototype._clampAngle=function e(t){return(t%Ef+Ef)%Ef};Mf.prototype._formatScaledSize=function e(value){return Math.ceil(Math.min(value,this._maxScaledSize)*this._actualScaledSizeToBytes)};Mf.prototype._formatPixelSize=function e(value){return Math.ceil(Math.min(value,this._maxPixelSize)*this._actualPixelSizeToBytes)};Mf.prototype._formatMinVisibleSize=function e(t){return Math.round(Math.min(t,this._maxMinVisibleSize)*this._actualMinVisibleSizeToBytes)};Mf.prototype._formatSymbolicSize=function e(t){return Math.round(Math.min(t,this._maxSymbolicSize)*this._actualSymbolicSizeToBytes)};Mf.prototype._formatDashOffset=function e(t){return Math.round(t%this._maxDashOffset*this._actualDashOffsetToBytes)};Mf.prototype._formatDashLength=function e(t){return Math.round(Math.min(t,this._maxDashLength)*this._actualDashLengthToBytes)};Mf.prototype._formatGapLength=function e(t){return Math.round(Math.min(t,this._maxGapLength)*this._actualGapLengthToBytes)};Mf.prototype._signedToUnsignedByte=function e(value){return value+128};Mf.prototype.registerShape=function e(t,r){this._shapeManager.register(t,r)};Mf.prototype._bindBlock=function e(t,r,i,n,a,o){this._checkBlockId(t);var s=this._blockIdToAddress[t],u=this._bufferList.allocateBlock(s,r,i,n,a,o);this._blockIdToAddress[t]=u.address;this._currentDataView=u.buffer.getDataView();this._currentElementSize=u.buffer.getElementSize();this._currentBlockOffset=u.offset;this._currentByteOffset=this._currentBlockOffset*this._currentElementSize;this._currentSideDataView=u.buffer.getSideDataView();this._currentSideElementSize=u.buffer.getTotalSideElementsSize();this._currentSideByteOffset=this._currentBlockOffset*this._currentSideElementSize;return u.address};Mf.prototype._setItemIndex=function e(t){var r=this._currentBlockOffset+t;this._currentByteOffset=r*this._currentElementSize;this._currentSideByteOffset=r*this._currentSideElementSize};Mf.prototype._freeBlock=function e(t){this._checkBlockId(t);var r=this._blockIdToAddress[t],i=this._bufferList.freeBlock(r);this._blockIdToAddress[t]=i;return i};Mf.prototype._checkBlockId=function e(t){if(t>=this._blockIdToAddress.length){this._resizeBlockArray(me(t+1))}};Mf.prototype._setUint16=function e(t,value){this._currentDataView.setUint16(this._currentByteOffset+t,value,this._littleEndian)};Mf.prototype._setInt16=function e(t,value){this._currentDataView.setInt16(this._currentByteOffset+t,value,this._littleEndian)};Mf.prototype._setUint8=function e(t,value){this._currentDataView.setUint8(this._currentByteOffset+t,value)};Mf.prototype._setInt8=function e(t,value){this._currentDataView.setInt8(this._currentByteOffset+t,value)};Mf.prototype._setFloat32=function e(t,value){this._currentDataView.setFloat32(this._currentByteOffset+t,value,this._littleEndian)};Mf.prototype._setShapeAndDashLengthAndGapLength=function e(t,r,i,n){var a=this._shapeManager.getIdFromName(r),o=this._formatDashLength(i),s=this._formatGapLength(n);this._setUint8(t,(a<<4)+(o<<2)+s)};Mf.prototype._setOpacityAndMinVisibleSize=function e(t,r,i){var n=Math.round(r*15);var a=this._formatMinVisibleSize(i);this._setUint8(t+1,(n<<4)+a)};Mf.prototype._setStrokeMinVisibleSizeAndPatternMinVisibleSize=function e(t,r,i){var n=this._formatMinVisibleSize(r),a=this._formatMinVisibleSize(i);this._setUint8(t+2,(n<<4)+a)};Mf.prototype._setFlagsAndAngleOffset=function e(t,r,i,n,a,o,s){var u=+r,l=+i,f=+n,h=+o,d=+a,v=Math.round((s+Ef)%Ef*(8/Ef));var value=(u<<7)+(l<<6)+(f<<5)+(h<<4)+(d<<3)+v;this._setUint8(t+3,value)};Mf.prototype._setPattern=function e(t,r){var i=this._patternManager.getIdFromDefinition(r);this._setUint16(t+4,i)};Mf.prototype._setFillColor=function e(t,r){var i=this._formatColor(r);this._setUint16(t+6,i)};Mf.prototype._setStrokeColor=function e(t,r){var i=this._formatColor(r);this._setUint16(t+8,i)};Mf.prototype._setShapeBoundaries=function e(t,r,i){var n=r*255,a=i*255;this._setUint16(t+10,(n<<8)+a)};Mf.prototype._setX=function e(t,r){this._setFloat32(t+12,r)};Mf.prototype._setY=function e(t,r){this._setFloat32(t+16,r)};Mf.prototype._setAngle=function e(t,r){this._setFloat32(t+20,this._clampAngle(r))};Mf.prototype._setLengthScaled=function e(t,r){this._setFloat32(t+24,r)};Mf.prototype._setThicknessScaled=function e(t,r){var i=this._formatScaledSize(r);this._setUint16(t+28,i)};Mf.prototype._setStrokeWidthScaled=function e(t,r){var i=this._formatScaledSize(r);this._setUint16(t+30,i)};Mf.prototype._setOffsetScaled=function e(t,r){var i=this._formatScaledSize(r);this._setUint16(t+32,i)};Mf.prototype._setLengthAbsoluteAndThicknessAbsolute=function e(t,r,i){var n=this._formatPixelSize(r),a=this._formatPixelSize(i);this._setUint16(t+34,(n<<8)+a)};Mf.prototype._setStrokeWidthAbsoluteAndOffsetAbsolute=function e(t,r,i){var n=this._formatPixelSize(r),a=this._formatPixelSize(i);this._setUint16(t+36,(n<<8)+a)};Mf.prototype._setPatternMask=function e(t,r){var i=this._formatColor(r);this._setUint16(t+38,i)};Mf.prototype._setPatternScaleAndDashOffset=function e(t,r,i){var n=r*127;var a=this._formatDashOffset(i);this._setUint16(t+40,(n<<8)+a)};Mf.prototype._setSymbolicSizeAndCurvature=function e(t,r,i){var n=this._formatSymbolicSize(r);var a=this._signedToUnsignedByte(i);this._setUint16(t+42,(n<<8)+a)};Mf.prototype._setAnimationBeginTime=function e(t,r){this._setFloat32(t,r)};Mf.prototype._setAnimationDuration=function e(t,r){this._setFloat32(t+4,r)};Mf.prototype._setAnimationEasing=function e(t,r){var i=this._easingManager.getPolygonFromName(r);this._setUint16(t+8,(i[0]+128<<8)+(i[4]+128));this._setUint16(t+10,(i[1]+128<<8)+(i[5]+128));this._setUint16(t+12,(i[2]+128<<8)+(i[6]+128));this._setUint16(t+14,(i[3]+128<<8)+(i[7]+128))};Mf.prototype._setTextCharacters=function e(t){this._textManager.storeTextInDataView(this._currentSideDataView,this._currentSideByteOffset,this._currentSideByteOffset+this._currentSideElementSize,t)};Mf.prototype._storeGenericObject=function e(t,r){this._setShapeAndDashLengthAndGapLength(t,r.shape,r.dashLength,r.gapLength);this._setOpacityAndMinVisibleSize(t,r.opacity,r.minVisibleSize);this._setStrokeMinVisibleSizeAndPatternMinVisibleSize(t,r.strokeMinVisibleSize,r.patternMinVisibleSize);this._setFlagsAndAngleOffset(t,r.angleAffectedByView,r.offsetAffectedByAngle,r.adjustAngle,r.isSelfLoop,r.patternSdf,r.offsetAngle);this._setPattern(t,r.pattern);this._setFillColor(t,r.fillColor);this._setStrokeColor(t,r.strokeColor);this._setShapeBoundaries(t,r.shapeStart,r.shapeEnd);this._setX(t,r.x);this._setY(t,r.y);this._setAngle(t,r.angle);this._setLengthScaled(t,r.lengthScaled);this._setThicknessScaled(t,r.thicknessScaled);this._setStrokeWidthScaled(t,r.strokeWidthScaled);this._setOffsetScaled(t,r.offsetScaled);this._setLengthAbsoluteAndThicknessAbsolute(t,r.lengthAbsolute,r.thicknessAbsolute);this._setStrokeWidthAbsoluteAndOffsetAbsolute(t,r.strokeWidthAbsolute,r.offsetAbsolute);this._setPatternMask(t,r.patternMask);this._setPatternScaleAndDashOffset(t,r.patternScale,r.dashOffset);this._setSymbolicSizeAndCurvature(t,r.symbolicSize,r.curvature)};Mf.prototype._storeAnimationInformation=function e(t,r){this._setAnimationBeginTime(t,r.beginTime);this._setAnimationDuration(t,r.duration);this._setAnimationEasing(t,r.easing)};Mf.prototype._storeElement=function e(t,r){this._storeGenericObject(0,t.end);if(r){this._storeGenericObject(Pu,t.start);this._storeAnimationInformation(Pu*2,t.animation)}};Mf.prototype.storeBlock=function e(t,r){var i=this;if(!r||!r.getSize()){return this._freeBlock(t)}var n=r.getType(),a=r.getDepth(),o=r.getSize(),s=r.getElements(),u=r.isAnimated(),l=0;if(n===Js){for(var f=0;f<o;++f){var h=s[f];if(h.end.pattern&&h.end.pattern.type===nu){l=Math.max(l,h.end.pattern.attributes.text.length)}}}var d=this._bindBlock(t,n,u,a,o,l);for(var v=0;v<o;++v){i._setItemIndex(v);i._storeElement(s[v],u)}if(n===Js){for(var c=0;c<o;++c){var _=s[c];i._setItemIndex(c);i._setTextCharacters(_.end.pattern)}}return d};Mf.prototype.freeBlock=function e(t){return this._freeBlock(t)};Mf.prototype._refreshTextElements=function e(){var t=this;var r=this._bufferList.getBuffers();for(var i=0;i<r.length;++i){var n=r[i];if(n.getElementType()===Js){var a=n.getSideDataView();var o=n.getTotalSideElementsSize();var s=n.getSize();var u=0;var l=o;for(var f=0;f<s;++f){var h=t._textManager.extractTextFromDataView(a,u,l);t._textManager.storeTextInDataView(a,u,l,h);u=l;l+=o}n.triggerUpdate()}}};Mf.prototype._extractElement=function e(t,r){if(!t){return null}var i=this._bufferList.getBlockInfo(t);return this._renderer.extractElement(i.buffer,i.offset+r)};Mf.prototype.extractElement=function e(t,r){if(r===void 0)r=0;return this._extractElement(t,r)};Mf.prototype.getDomElement=function e(){return this._domElement};Mf.prototype.measureText=function e(t,r,i,n){return this._textManager.measureText(t,r,i,n)};Mf.prototype.setRenderType=function e(t){if(this._renderType!==t){this._renderType=t;this._rendererMustBeReset=true}};Mf.prototype._recreateMainRenderer=function e(){if(this._renderer){this._renderer.destroy()}this._renderer=this._instanciateRenderer(this._renderType);this._updateDomElement()};Mf.prototype._updateDomElement=function e(){var t=this;var r=this._renderer&&this._renderer.getDomElement();while(this._domElement.firstChild){t._domElement.removeChild(t._domElement.firstChild)}if(r){this._appendDomChild(r)}for(var i=0;i<this._additionalCanvases.length;++i){t._appendDomChild(t._additionalCanvases[i])}};Mf.prototype._appendDomChild=function e(t){t.style.position="absolute";t.style.left="0";t.style.top="0";this._domElement.appendChild(t)};Mf.prototype._instanciateRenderer=function e(t){var r=Sf[t]||Ku;return new r({bufferList:this._bufferList,shapeManager:this._shapeManager,patternManager:this._patternManager,boundariesManager:this._boundariesManager,textManager:this._textManager,colorManager:this._colorManager,easingManager:this._easingManager})};Mf.prototype.setView=function e(t){Object.assign(this._view,t)};Mf.prototype._updateManagers=function e(){this._shapeManager.update();this._patternManager.update();this._textManager.update();this._boundariesManager.update();this._bufferList.update();if(this._refreshTexts){this._refreshTexts=false;this._refreshTextElements()}};Mf.prototype._resizeCanvas=function e(t){$u(t,this._view.width,this._view.height,this._view.pixelRatio)};Mf.prototype.render=function e(){var t=this;if(this._rendererMustBeReset){this._recreateMainRenderer();this._rendererMustBeReset=false}if(this._domElement.offsetWidth!==this._view.width||this._domElement.offsetHeight!==this._view.height){this._domElement.style.width=this._view.width+"px";this._domElement.style.height=this._view.height+"px";for(var r=0;r<this._additionalCanvases.length;++r){t._resizeCanvas(t._additionalCanvases[r])}}this._updateManagers();this._renderer.renderFrame(this._view)};Mf.prototype.export=function e(t,r,i){var n=this._instanciateRenderer(t);var a=Object.assign({},this._view,r);n.setViewportClipping(false);this._updateManagers();n.renderFrame(a);return n.export(i).then(function(){return n.getDomElement()})};Mf.prototype.getCurrentTime=function e(){return oe()};Mf.prototype.getImageData=function e(){return this._renderer&&this._renderer.getImageData()};Mf.prototype.destroy=function e(){if(this._renderer){this._renderer.destroy()}};Mf.prototype.initDebugRenderingLoop=function e(t){var r=this;if(t===void 0)t={};var i=t.triggerKey;if(i===void 0)i="r";var n=t.start;if(n===void 0)n=true;var a=n;document.addEventListener("keydown",function(e){var t=e.key;if(t===i){a=!a}});var o=function(e){if(a||e){r.setView({currentTime:oe()});r.render()}window.requestAnimationFrame(function(){o()})};window.requestAnimationFrame(function(){document.body.appendChild(r.getDomElement());o(true)})};Mf.prototype.E={ELT_GENERIC:Ks,ELT_TEXT:Js,PATTERN_NONE:Qs,PATTERN_IMAGE:eu,PATTERN_TEXT:tu,PATTERN_PIE_CHART:ru,PATTERN_TEXT_OPT:nu};var Cf=function(e){function t(){e.call(this);this.isDummy=true}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;var r={src:{configurable:true}};r.src.set=function(e){var t=this;if(e){this._src=e;setTimeout(function(){if(t.onload){t.onload.call(t)}t.fire("load")},16)}};r.src.get=function(){return this._src};t.prototype.addEventListener=function e(t,r){this.on(t,r)};Object.defineProperties(t.prototype,r);return t}(F);var kf=typeof Image!=="undefined"?Image:Cf;var Nf=function e(){this._images={};this._crossOrigin="anonymous";this._whenReady=[];this._onFetch=[];this._nbLoaded=0;this._nbToLoad=0};Nf.prototype.setImgCrossOrigin=function e(t){this._crossOrigin=t};Nf.prototype.clear=function e(){this._images={};this._nbLoaded=0;this._nbToLoad=0};Nf.prototype.getImage=function e(t){return this._images[t]||null};Nf.prototype.fetch=function e(t){var r=this;if(t&&!(t in this._images)){this._nbToLoad+=1;var i=new kf;i.crossOrigin=this._crossOrigin;i.onload=function(){r._onImgLoad(t)};i.onerror=function(){r._onImgLoad(t);r._images[t]=null};i.src=t;this._images[t]=i}};Nf.prototype._onImgLoad=function e(t){this._nbLoaded+=1;this._onFetch.forEach(function(e){return e(t)});if(this._nbLoaded===this._nbToLoad){this._whenReady.forEach(function(e){return e()});this._whenReady=[]}};Nf.prototype.onFetch=function e(t){this._onFetch.push(t)};Nf.prototype.whenReady=function e(){var t=this;if(this._nbLoaded===this._nbToLoad){return Promise.resolve()}else{return new Promise(function(e){return t._whenReady.push(e)})}};var If=16;function zf(e){if(e==="x"||e==="y"){return{storage:"float",default:Infinity}}else{return{storage:"resource"}}}var Lf=function e(t){var r=this;var i;var n=t.isNode;var a=t.ogma;var o=t.settings;var s=t.engine;var u=t.attributes;var l=t.aliases;var f=t.imageManager;this._name=n?"node":"edge";this._ogma=a;this._settings=o;this._graph=a.modules.graph;this._dom=a.modules.dom;this._engine=s;this._imageManager=f;this._isNode=n;this._refreshAll=true;this._onAttributesComputedListeners=[];this._nodes=null;this._edges=null;this._attributes=u;this._attributeList=Object.keys(u);this._aliases=l;this._originalAttributes=this._initAttributes(function(e){var t=e.name;return zf(t)});this._ruleAttributes=this._initAttributes(function(e){var t=e.name;return zf(t)});this._individualAttributes=this._initAttributes(function(e){var t=e.name;return zf(t)});this._layerAttributes=this._initAttributes(function(e){var t=e.name;return zf(t)});this._prevAttributes=this._initAttributes(function(e){var t=e.defaultValue;var r=e.storage;return{storage:r,default:t}});this._finalAttributes=this._initAttributes(function(e){var t=e.name;var r=e.defaultValue;var i=e.storage;return{storage:i,default:r,name:t}});this._finalAttributes.hidden={_opacityList:this._finalAttributes.opacity,get:function e(t){return!this._opacityList.get(t)},getMultiple:function e(t){var r=this;return t.map(function(e){return r.get(e)})}};if(!this._isNode){this._finalAttributes.shape={_typeList:this._finalAttributes["shape.type"],_headList:this._finalAttributes["shape.head"],_tailList:this._finalAttributes["shape.tail"],_styleList:this._finalAttributes["shape.style"],get:function e(t){return{type:this._typeList.get(t),head:this._headList.get(t),tail:this._tailList.get(t),style:this._styleList.get(t)}},getMultiple:function e(t){var r=this;return t.map(function(e){return r.get(e)})}}}this._layerToIndex=Pf(If);this._usedAttributeSet=new bn;this._attributesByRootKey={};this._curvaturesToRecompute=new bn;this._layerList=[];this._layers={};this._toRefresh=[];this._elements=this._graph.getAttribute(n,"object");this._excludedList=this._graph.getAttribute(n,"excluded");this._layerAttribute=this._graph.createAttribute(n,{name:"layer",storage:If});this._animationStartList=this._graph.createAttribute(n,{name:"animationStart",storage:32,default:0});this._animationEndList=this._graph.createAttribute(n,{name:"animationEnd",storage:32,default:0});this._animationDurationList=this._graph.createAttribute(n,{name:"animationDuration",storage:16,default:0});this._animationEasingList=this._graph.createAttribute(n,{name:"animationEasing",storage:"resource",default:"linear"});this._nextRuleId=1;this._ruleList=[];this._rules={};this._ruleAttributeNames=new bn;if(!n){this._curvatureList=this._graph.createEdgeAttribute({name:"curvature",storage:"int8"});this._sourceList=this._graph.getEdgeAttribute("source");this._targetList=this._graph.getEdgeAttribute("target")}this._finalAttributes.layer=this._layerAttribute;this._finalAttributes.excluded=this._excludedList;this._finalAttributes.source=this._sourceList;this._finalAttributes.target=this._targetList;this._finalAttributes.animationStart=this._animationStartList;this._finalAttributes.animationDuration=this._animationDurationList;this._finalAttributes.animationEasing=this._animationEasingList;if(!n){this._finalAttributes.source=this._sourceList;this._finalAttributes.target=this._targetList;this._finalAttributes.curvature=this._curvatureList}this._sortAttributesByRootKey();a.modules.events.on((i={},i[n?"addNodes":"addEdges"]=function(e){var t=e.objects;var i=e.nodes;var n=e.edges;var a=i||n,o=a._indexes,s=new bn,u=Object.keys(r._rules),l=t.map(function(e){return e.attributes});s.addMultiple(r._setMultipleAttributes(o,r._originalAttributes,l));s.addMultiple(r._computeRuleAttributes(o,u));var f=s.values();r._computeFinalAttributes(o,f);r._computePrevAttributes(o,f)},i[n?"removeNodes":"removeEdges"]=function(e){var t=e.nodes;var i=e.edges;r._markToRefresh((t||i)._indexes)},i[n?"refreshNodeFilters":"refreshEdgeFilters"]=function(e){var t=e.newlyIncluded;var i=e.newlyExcluded;r._markToRefresh(t._indexes);r._markToRefresh(i._indexes);if(!n){var a=[];for(var o=0;o<t._indexes.length;++o){a.push(r._graph.getEdgeDirection(t._indexes[o]))}for(var s=0;s<i._indexes.length;++s){a.push(r._graph.getEdgeDirection(i._indexes[s]))}r._addCurvaturesToUpdate(a)}},i));if(!n){a.modules.events.on({updateDirections:function(e){var t=e.directions;r._addCurvaturesToUpdate(t)}})}};Lf.prototype._sortAttributesByRootKey=function e(){var t=this;ut(this._attributes,function(e,r){var i=r.split(".")[0];t._attributes[r]=e;t._attributeList.push(r);if(!t._attributesByRootKey[i]){t._attributesByRootKey[i]=i===r?null:[r]}else{t._attributesByRootKey[i].push(r)}})};Lf.prototype.onAttributesComputed=function e(t){this._onAttributesComputedListeners.push(t)};Lf.prototype._fireOnAttributesComputedEvent=function e(t){var r=this;for(var i=0;i<this._onAttributesComputedListeners.length;++i){r._onAttributesComputedListeners[i]({attributes:t})}};Lf.prototype.nbCurvedEdges=function e(){var t=this._curvatureList;var r=this._graph._allIndexes(false);var i=0;for(var n=0;n<r.length;++n){if(t.get(r[n])!==0){i+=1}}return i};Lf.prototype.computeCurvatures=function e(){if(!this._isNode&&this._curvaturesToRecompute.size){this._computeCurvatures();this._curvaturesToRecompute.clear()}};Lf.prototype.getCurvature=function e(t){return this._curvatureList.getMultiple(t)};Lf.prototype.getAndResetElementsToUpdate=function e(){this.computeCurvatures();var t=this._refreshAll?this._graph._allIndexes(this._isNode):this._graph._dedupe(this._isNode,this._toRefresh);this._toRefresh=[];this._refreshAll=false;return t};Lf.prototype.getAllElements=function e(){return this._graph._allIndexes(this._isNode)};Lf.prototype.getAttributeContainers=function e(){return this._finalAttributes};Lf.prototype.getPrevAttributeContainers=function e(){return this._prevAttributes};Lf.prototype.getMaxIndex=function e(){return this._graph[this._isNode?"getNodeMaxIndex":"getEdgeMaxIndex"]()};Lf.prototype.getImageManager=function e(){return this._imageManager};Lf.prototype._initAttributes=function e(t){var r=this;return ft(this._attributes,function(e,i){return r._graph.createAttribute(r._isNode,t({name:i,storage:e.storage||"resource",defaultValue:e.default}))})};Lf.prototype.setAnimationProperties=function e(t,r){var i=r.start;var n=r.duration;var a=r.easing;this._animationStartList.setMultiple(t,i);this._animationDurationList.setMultiple(t,n);this._animationEasingList.setMultiple(t,a)};Lf.prototype.resetAnimationDuration=function e(t){this._animationDurationList.setMultiple(t,0)};Lf.prototype.setAnimationEnd=function e(t,r){this._animationEndList.setMultiple(t,r)};Lf.prototype._addCurvaturesToUpdate=function e(t){var r=this;for(var i=0;i<t.length;++i){r._curvaturesToRecompute.add(t[i])}};Lf.prototype.updateAllCurvatures=function e(){this._addCurvaturesToUpdate(this._graph._getAllEdgeDirections());this.refreshAll()};Lf.prototype.getAttributeArray=function e(t){var r=Array.isArray(t)?t.join("."):t;var i=this._aliases[r];if(typeof i==="string"){r=i}var n=this._finalAttributes[r];if(!n){throw new Error(this._name+' attribute "'+r+'" does not exist')}return n};Lf.prototype._computeCurvatures=function e(){var t=this;var r=this._graph,i=["source","target","curvature","width"];var n=this._graph.getAttributes(false,i);var a=n[0];var o=n[1];var s=n[2];var u=n[3];var l=this._settings.edgesAlwaysCurvy,f=this._settings.directedEdges,h=this._curvaturesToRecompute.values();for(var d=0,v=h.length;d<v;++d){var c=h[d],_=r.getParallelIndexes(c);r._filter(false,_);t._markToRefresh(_);if(_.length===1){var g=_[0],p=a.get(g),y=o.get(g);s.set(_[0],p===y||l?1:0)}else{var m=_[0],b=a.get(m),x=0,A=0,w=0,S=0,E=0,T=0;for(var M=0;M<_.length;++M){var C=_[M];if(a.get(C)===b){x+=1}else{A+=1}}var k=x+A;for(var N=0;N<_.length;++N){var I=_[N],z=a.get(I),L=o.get(I),R=u.get(I),D=z===b,F=z===L;var P=void 0,B=void 0,O=void 0,V=void 0,j=void 0;if(f){P=D?E:T;B=x;O=A;V=(D?w:S)+R/2;j=false}else{P=E+T;B=k;O=0;V=w+S+R/2;j=!D}var U=Rf(P,B,O,V,F,j,f,l);s.set(I,Math.ceil(U));if(D){w+=R;E+=1}else{S+=R;T+=1}}}}};Lf.prototype.addLayer=function e(t,r,i){if(this._layerList.length===If){throw new Error("cannot add layer: maximum number of layers ("+If+") reached")}if(this._layers[t]){throw new Error("layer "+t+" already exists")}var n={name:t,depth:r};this._layers[t]=n;this._layerList.push(n);this._layerList.sort(function(e,t){return e.depth-t.depth});this._layerList.forEach(function(e,t){return e.index=t});this.setLayerAttributes(t,i||{})};Lf.prototype.setLayerAttributes=function e(t,r){var i=this;var n=this._engine;var a=this._getLayer(t);var o=this._formatAttributesObject(r);var s=Object.keys(o);for(var u=0;u<s.length;++u){var l=s[u];var value=o[l];var f=i._attributes[l].check;if(typeof value!=="function"){o[l]=f(o[l],n)}}a.attributeList=s;a.attributes=o;this._markAttributesAsUsed(s)};Lf.prototype.updateLayerAttributes=function e(t,r){var i=this._getLayer(t),n=Wt(r);ut(n,function(e,t){return i.attributes[t]=e});this.setLayerAttributes(t,i.attributes)};Lf.prototype._getLayer=function e(t){var r=this._layers[t];if(!r){throw new Error("layer "+t+" does not exist")}return r};Lf.prototype.putOnLayer=function e(t,r){return this._layerAction(true,t,r)};Lf.prototype.removeFromLayer=function e(t,r){return this._layerAction(false,t,r)};Lf.prototype._layerAction=function e(t,r,i){var n=this._getLayer(i),a=n.index,o=n.attributeList;(t?Df:Ff)(this._layerAttribute,a,r);this._computeLayerAttributes(r,o);this._computeFinalAttributes(r,o);return o};Lf.prototype._computeLayerAttributes=function e(t,r){var i=this;var n=this._engine;for(var a=0;a<r.length;++a){var o=r[a];var s=i._layerAttributes[o];var u=i._attributes[o].check;var l=o==="x"||o==="y"?Infinity:undefined;for(var f=0,h=t.length;f<h;++f){var d=t[f];var v=i._layerAttribute.get(d);var c=i._elements.get(d);var value=l;while(v>0&&value===l){var _=i._layerToIndex(v)-1;var g=i._layerList[_];value=g.attributes[o];if(typeof value==="function"){var p=value;value=p(c);value=u(value,n)}if(value===undefined){value=l}v-=1<<_}s.set(d,value)}}};Lf.prototype._markToRefresh=function e(t){var r=this;if(!this._refreshAll){for(var i=0;i<t.length;++i){r._toRefresh.push(t[i])}this._dom.refresh()}};Lf.prototype._markAdjacentEdgesToRefresh=function e(t){if(!this._refreshAll){this._edges._markToRefresh(this._graph._collectAdjacentEdges(t))}};Lf.prototype.refresh=function e(t){this._markToRefresh(t);if(this._isNode){this._markAdjacentEdgesToRefresh(t)}};Lf.prototype.softRefresh=function e(t){this._markToRefresh(t)};Lf.prototype.refreshAll=function e(){this._refreshAll=true;this._dom.refresh()};Lf.prototype._computeFinalAttributes=function e(t,r){var i=this;var n=t.length;for(var a=0;a<r.length;++a){var o=r[a];var s=o==="x"||o==="y"?Infinity:undefined;var u=i._attributes[o];var l=u.isImageUrl;var f=u.default;var h=i._layerAttributes[o];var d=i._individualAttributes[o];var v=i._ruleAttributes[o];var c=i._originalAttributes[o];var _=i._finalAttributes[o];var g=i._prevAttributes[o];for(var p=0;p<n;++p){var y=t[p];var value=h.get(y);if(value===s){value=d.get(y);if(value===s){value=v.get(y);if(value===s){value=c.get(y)}}}if(value===s){value=f}g.set(y,_.get(y));_.set(y,value);if(l){i._imageManager.fetch(value)}}}this._markToRefresh(t);if(this._isNode&&r.some(function(e){return e==="x"||e==="y"})){this._markAdjacentEdgesToRefresh(t)}if(t.length){this._fireOnAttributesComputedEvent(r)}return r};Lf.prototype._computePrevAttributes=function e(t,r){var i=this;for(var n=0;n<r.length;++n){var a=r[n],o=i._finalAttributes[a],s=i._prevAttributes[a];for(var u=0,l=t.length;u<l;++u){var f=t[u];s.set(f,o.get(f))}}return r};Lf.prototype._markAttributesAsUsed=function e(t){var r=this;for(var i=0;i<t.length;++i){r._usedAttributeSet.add(t[i])}};Lf.prototype._formatAttributesObject=function e(t,r,i){var n=this;if(r===void 0)r={};if(i===void 0)i="";if(!t){return r}var a=Object.keys(t);for(var o=0;o<a.length;++o){var s=a[o],value=t[s],u=""+i+s;if(tt(value)){n._formatAttributesObject(value,r,u+".")}else{var l=n._aliases[u];if(typeof l==="string"){r[l]=value}else if(l){var f=l(value);var h=Object.keys(f);for(var d=0;d<h.length;++d){var v=h[d];r[v]=f[v]}}else if(n._attributes[u]){r[u]=value}else{throw new Error(n._name+' attribute "'+u+'" does not exist')}}}return r};Lf.prototype._setSingleAttribute=function e(t,r,i,n){var a;return this._setMultipleAttributes(t,r,(a={},a[i]=n,a))};Lf.prototype._setMultipleAttributes=function e(t,r,i){var n=this;var a=this._engine;var o=new bn;if(typeof i==="function"||Array.isArray(i)){var s;if(typeof i==="function"){s=new Array(t.length);for(var u=0;u<t.length;++u){s[u]=i(n._getElement(t[u]))}}else{s=i}var l=Math.min(t.length,s.length);for(var f=0;f<l;++f){var h=n._formatAttributesObject(s[f]);var d=t[f];var v=Object.keys(h);for(var c=0;c<v.length;++c){var _=v[c];var g=n._attributes[_].check;var p=r[_];var value=g(h[_],a);if(p){o.add(_);p.set(d,value)}}}}else if(tt(i)){var y=this._formatAttributesObject(i);var m=Object.keys(y);var b=function(e){var i=m[e];var s=y[i];var u=r[i];var l=n._attributes[i].check;var f=i==="color";if(typeof s==="function"){var h=s;s=new Array(t.length);for(var d=0;d<t.length;++d){var v=h(n._getElement(t[d]));s[d]=l(v,a)}}else if(Array.isArray(s)&&!f){s=s.map(function(e){return l(e,a)})}else{s=l(s,a)}if(u){o.add(i);u.setMultiple(t,s,f)}};for(var x=0;x<m.length;++x)b(x)}var A=o.values();this._markAttributesAsUsed(A);return A};Lf.prototype._getElement=function e(t){return this._graph._getElement(this._isNode,t)};Lf.prototype.saveCurrentAttributes=function e(t,r){return this._computePrevAttributes(t,r)};Lf.prototype.setMultipleAttributes=function e(t,r){var i=this._setMultipleAttributes(t,this._individualAttributes,r);this._computeFinalAttributes(t,i);return i};Lf.prototype.setSingleAttribute=function e(t,r,i){var n=this._setSingleAttribute(t,this._individualAttributes,r,i);this._computeFinalAttributes(t,n);return n};Lf.prototype.resetAttributes=function e(t,r){if(!r){r=this._usedAttributeSet.values()}this._resetIndividualAttributes(t,r);this._computeFinalAttributes(t,r)};Lf.prototype.getSingleAttribute=function e(t,r){return this._getSingleAttribute(t,r)};Lf.prototype.getMultipleAttributes=function e(t,r){r=r||this._attributeList;return this._getMultipleAttributes(t,r)};Lf.prototype.refreshRules=function e(t){var r=this._ruleAttributeNames.values();this._computeRuleAttributes(t,r);this._computeFinalAttributes(t,r);return r};Lf.prototype._getSingleAttribute=function e(t,r){var i=this.getAttributeArray(r).getMultiple(t);if(r==="color"){for(var n=0;n<i.length;++n){var value=i[n];if(Array.isArray(value)){i[n]=value.slice()}}}return i};Lf.prototype._getMultipleAttributes=function e(t,r){var i=this;if(!Array.isArray(r)){throw new Error("getAttributes: expected array as argument")}var n=new Array(t.length);for(var a=0;a<t.length;++a){n[a]={}}for(var o=0;o<r.length;++o){var s=r[o];var u=i.getAttributeArray(s);for(var l=0;l<t.length;++l){var value=u.get(t[l]);if(Array.isArray(value)){value=value.slice()}Ht(n[l],s,value)}}return n};Lf.prototype._resetIndividualAttributes=function e(t,r){var i=this;for(var n=0;n<r.length;++n){var a=r[n];var o=Array.isArray(a)?a.join("."):a;if(!i._isNode&&o==="shape"){i._resetIndividualAttributes(t,["shape.type","shape.head","shape.tail","shape.style"]);continue}var s=i._aliases[o];if(typeof s==="string"){o=s}var u=i._individualAttributes[o];var l=o==="x"||o==="y"?Infinity:undefined;if(u){u.setMultiple(t,l)}}return r};Lf.prototype._computeRuleAttributes=function e(t,r){var i=this;var n=this._graph;var a=this._isNode;var o=this._engine;for(var s=0;s<r.length;++s){var u=r[s];var l=i._rules[u];var f=i._ruleAttributes[u];var h=i._attributes[u];var d=h.check;if(!f){throw new Error(i._name+' attribute "'+u+'" does not exist')}if(!l){f.reset();continue}for(var v=0;v<t.length;++v){var c=t[v],value=undefined;for(var _=0;_<l.length&&value===undefined;++_){var g=l[_];value=g(n._getElement(a,c))}if(u!=="color"&&Array.isArray(value)){value=value[0]}f.set(c,d(value,o))}}return r};Lf.prototype.addRule=function e(t,r){var i=this;if(!r){r=t;t=undefined}var n=this._formatAttributesObject(r),a={},o=this._nextRuleId++;ut(n,function(e,r){if(typeof e!=="function"){var n=e;e=new Function("return "+yt(n)+";");e.metadata={constant:n}}if(t){var o=e,s=e.onAdd,u=e.onRemove;e=function(e){if(t(e)){return o(e)}};e.onAdd=s;e.onRemove=u}if(e.onAdd){e.onAdd(i._isNode)}a[r]=e;i._ruleAttributeNames.add(r)});this._ruleList.unshift({id:o,attribute:a});var s=Object.keys(n);this._markAttributesAsUsed(s);this._constructRules(s);return o};Lf.prototype.removeRule=function e(t){var r=this.getRuleIndex(t),i=this._ruleList[r],n=Object.keys(i.attribute);this._removeRule(i);this._ruleList.splice(r,1);this._constructRules(n)};Lf.prototype._removeRule=function e(t){var r=this;ut(t.attribute,function(e){if(e.onRemove){e.onRemove(r._isNode)}})};Lf.prototype.getRuleIndex=function e(t){var r=this;for(var i=0;i<this._ruleList.length;++i){if(r._ruleList[i].id===t){return i}}throw new Error(this._name+' attribute rule "'+t+'" does not exist')};Lf.prototype.setRuleIndex=function e(t,r){var i=this.getRuleIndex(t),n=this._ruleList[i],a=Object.keys(n.attribute);this._ruleList.splice(i,1);if(r>=this._ruleList.length){this._ruleList.push(n)}else{if(r<0){r=0}this._ruleList.splice(r,0,n)}this._constructRules(a)};Lf.prototype.clearRules=function e(){var t=this;var r=this._ruleAttributeNames.values();for(var i=0;i<this._ruleList.length;++i){t._removeRule(t._ruleList[i])}this._ruleList=[];this._constructRules(r)};Lf.prototype.getRuleIds=function e(){return this._ruleList.map(function(e){var t=e.id;return t})};Lf.prototype.getRuleListForAttribute=function e(t){return(this._rules[t]||[]).slice()};Lf.prototype._constructRules=function e(t){var r=this;this._rules={};this._ruleList.forEach(function(e){var t=e.attribute;ut(t,function(e,t){var i=r._rules[t];if(!i){i=[];r._rules[t]=i}i.push(e)})});return t};function Rf(e,t,r,i,n,a,o,s){var u;if(n){u=i}else if(o){u=t===1&&r===0&&!s?0:e+1}else if(t%2===1&&!s){u=e===0?0:((e+1)/2|0)*(e%2===0?1:-1)*(a?-1:1)}else{u=((e/2|0)+1)*(e%2===0?1:-1)*(a?-1:1)}return u}function Df(e,t,r){var i=1<<t;for(var n=0,a=r.length;n<a;++n){var o=r[n];e.set(o,e.get(o)|i)}}function Ff(e,t,r){var i=Math.pow(2,e.elementBitSize())-1-(1<<t);for(var n=0,a=r.length;n<a;++n){var o=r[n];e.set(o,e.get(o)&i)}}function Pf(e){var t=[];for(var r=e;r>=0;--r){t.push((r===e?"":"else ")+"if (x >= "+Math.pow(2,r)+") { return "+(r+1)+"; }")}t.push("else { return 0; }");return new Function("x",t.join("\n"))}var Bf={color:{check:Xe,default:"white"},scale:{check:et(.45),default:.45},positionScale:{check:Oe,default:1},image:{check:Ue,default:null,isImageUrl:true},minVisibleSize:{check:et(12),default:12},stroke:{color:{check:Xe,default:"black"},width:{check:et(2),default:2}},text:{content:{check:Ue,default:null},color:{check:Xe,default:"black"},font:{check:je,default:"Arial"},style:{check:He,default:"normal"},scale:{check:et(.5),default:.5}}};var Of={x:{check:Be,default:0,storage:"float"},y:{check:Be,default:0,storage:"float"},radius:{check:et(5),default:5,storage:"float"},color:{check:Qe,default:"grey"},opacity:{check:Oe,default:1},shape:{check:qe,default:"circle"},draggable:{check:Pe,default:true},layoutable:{check:Pe,default:true},innerStroke:{width:{check:et(2),default:2},color:{check:Xe,default:"white"},minVisibleSize:{check:et(12),default:12}},outerStroke:{width:{check:et(5),default:5},color:{check:Xe,default:null},minVisibleSize:{check:et(0),default:0}},badges:{bottomRight:Bf,bottomLeft:Bf,topRight:Bf,topLeft:Bf},halo:{color:{check:Ge,default:null},width:{check:et(50),default:50},strokeColor:{check:Ge,default:null},strokeWidth:{check:et(1),default:1},clustering:{check:Pe,default:false}},icon:{content:{check:Ue,default:null},font:{check:je,default:"Arial"},color:{check:Ge,default:"black"},scale:{check:et(.7),default:.7},style:{check:He,default:"normal"},minVisibleSize:{check:et(12),default:12}},image:{url:{check:Ue,default:null,isImageUrl:true},scale:{check:et(1),default:1},fit:{check:Pe,default:true},tile:{check:Pe,default:false},minVisibleSize:{check:et(12),default:12}},outline:{enabled:{check:Pe,default:false},color:{check:Ge,default:"rgba(0, 0, 0, 0.36)"},minVisibleSize:{check:et(12),default:12}},text:{hidden:{check:Pe,default:false},content:{check:Ue,default:null},font:{check:je,default:"Arial"},color:{check:Xe,default:"black"},size:{check:et(12),default:12},scale:{check:Oe,default:.1},style:{check:He,default:"normal"},align:{check:Ye,default:"center"},margin:{check:et(10),default:10},padding:{check:et(2),default:2},backgroundColor:{check:Xe,default:null},tip:{check:Pe,default:true},minVisibleSize:{check:et(24),default:24},secondary:{content:{check:Ue,default:null},font:{check:je,default:"Arial"},color:{check:Xe,default:"black"},size:{check:et(10),default:10},scale:{check:Oe,default:.08},style:{check:He,default:"normal"},align:{check:Ye,default:"center"},margin:{check:et(5),default:5},padding:{check:et(2),default:2},backgroundColor:{check:Xe,default:null},minVisibleSize:{check:et(24),default:24}},scaling:{check:Pe,default:false},position:{check:Je,default:"bottom"},maxLineLength:{check:Oe,default:0},truncateLength:{check:Oe,default:0}}};var Vf={"badges.topLeft":"badges.topLeft.text.content","badges.topRight":"badges.topRight.text.content","badges.bottomLeft":"badges.bottomLeft.text.content","badges.bottomRight":"badges.bottomRight.text.content","badges.topLeft.text":"badges.topLeft.text.content","badges.topRight.text":"badges.topRight.text.content","badges.bottomLeft.text":"badges.bottomLeft.text.content","badges.bottomRight.text":"badges.bottomRight.text.content",innerStroke:"innerStroke.color",outerStroke:"outerStroke.color",halo:"halo.color",icon:"icon.content",image:"image.url",outline:"outline.enabled",text:"text.content","text.secondary":"text.secondary.content",hidden:function(value){return{opacity:+!value}},"image.rescale":"image.fit","image.duplicate":"image.tile","halo.size":"halo.width","text.backgroundArrowBaseSize":"text.margin","text.backgroundMargin":"text.padding","text.secondary.backgroundArrowBaseSize":"text.secondary.margin","text.secondary.backgroundMargin":"text.secondary.padding","innerStroke.threshold":"innerStroke.minVisibleSize","outerStroke.threshold":"outerStroke.minVisibleSize","icon.threshold":"icon.minVisibleSize","image.threshold":"image.minVisibleSize","text.threshold":"text.minVisibleSize","text.secondary.threshold":"text.secondary.minVisibleSize","badges.topLeft.threshold":"badges.topLeft.minVisibleSize","badges.topRight.threshold":"badges.topLeft.minVisibleSize","badges.bottomLeft.threshold":"badges.topLeft.minVisibleSize","badges.bottomRight.threshold":"badges.topLeft.minVisibleSize"};var jf={width:{check:et(1),default:1},color:{check:We,default:"grey"},opacity:{check:Oe,default:1},minVisibleSize:{check:Oe,default:0},adjustAnchors:{check:Pe,default:true},shape:{type:{check:Ze,default:"line"},head:{check:$e,default:null},tail:{check:$e,default:null},style:{check:Ke,default:"plain"}},stroke:{color:{check:Xe,default:"inherit"},width:{check:et(0),default:0},minVisibleSize:{check:Oe,default:0}},halo:{color:{check:Ge,default:null},width:{check:et(10),default:10}},outline:{enabled:{check:Pe,default:false},color:{check:Ge,default:"rgba(0, 0, 0, 0.36)"},minVisibleSize:{check:Oe,default:0}},text:{hidden:{check:Pe,default:false},content:{check:Ue,default:null},font:{check:je,default:"Arial"},color:{check:Ge,default:"black"},size:{check:et(12),default:12},scale:{check:Oe,default:1},style:{check:He,default:"normal"},align:{check:Ye,default:"center"},margin:{check:et(2),default:2},padding:{check:et(2),default:2},backgroundColor:{check:Xe,default:null},minVisibleSize:{check:Oe,default:4},adjustAngle:{check:Pe,default:true},secondary:{content:{check:Ue,default:null},font:{check:je,default:"Arial"},color:{check:Ge,default:"black"},size:{check:et(12),default:12},scale:{check:Oe,default:.8},style:{check:He,default:"normal"},align:{check:Ye,default:"center"},margin:{check:et(2),default:2},padding:{check:et(2),default:2},backgroundColor:{check:Xe,default:null},minVisibleSize:{check:Oe,default:4}},scaling:{check:Pe,default:false},maxLineLength:{check:Oe,default:0}}};var Uf={line:{"shape.type":"line","shape.head":null,"shape.tail":null,"shape.style":"plain"},arrow:{"shape.type":"line","shape.head":"arrow","shape.tail":null,"shape.style":"plain"},tapered:{"shape.type":"triangle","shape.head":null,"shape.tail":null,"shape.style":"plain"},dashed:{"shape.type":"line","shape.head":null,"shape.tail":null,"shape.style":"dashed"},dotted:{"shape.type":"line","shape.head":null,"shape.tail":null,"shape.style":"dotted"}};var Gf={halo:"halo.color",outline:"outline.enabled",text:"text.content","text.secondary":"text.secondary.content",shape:function(value){return Uf[value]||{}},hidden:function(value){return{opacity:+!value}},strokeWidth:"stroke.width","halo.size":"halo.width",threshold:"minVisibleSize","text.threshold":"text.minVisibleSize","text.secondary.threshold":"text.secondary.minVisibleSize",secondaryText:"text.secondary.content"};function Xf(e,t){if(t<2){return e}var r=e.split("\n");var i=[];for(var n=0;n<r.length;++n){var a=r[n];if(a.length<t){i.push(a)}else{var o=Wf(r[n],t);for(var s=0;s<o.length;++s){i.push(o[s])}}}return i.join("\n")}function Wf(e,t){var r=e.split(" "),i=[],n=0,a=-1,o=[],s=true;for(var u=0;u<r.length;++u){if(s){if(r[u].length>t){var l=Hf(r[u],t);for(var f=0;f<l.length;++f){i.push([l[f]]);++a}n=l[l.length-1].length}else{i.push([r[u]]);++a;n=r[u].length+1}s=false}else if(n+r[u].length<=t){i[a].push(r[u]);n+=r[u].length+1}else{s=true;--u}}for(u=0;u<i.length;++u){o.push(i[u].join(" "))}return o}function Hf(e,t){var r=[];for(var i=0;i<e.length;i+=t-1){r.push(e.substr(i,t-1)+"-")}var n=r[r.length-1].length;r[r.length-1]=r[r.length-1].substr(0,n-1)+" ";return r}function Yf(e,t){if(e===null){return null}e=e.toString();var r=e.split("\n"),i=[],n=0;for(var a=0;a<r.length;a++){var o=r[a];if(!t||t<=1||o.length<t){i.push(o);n=Math.max(n,o.length)}else{var s=Wf(r[a],t);for(var u=0;u<s.length;u++){o=s[u];i.push(o);n=Math.max(n,o.length)}}}return{data:i,maxLength:n,lines:i.length}}function qf(e,t,r,i,n,a,o,s,u){var l=o;var f,h;var d=r.angle;var v=Math.atan2(t-a,e-n)-d;if(v<-Ba){v+=Oa}else if(v>Ba){v-=Oa}if(v<-Ba/2){f=Va;h=u.topLeft}else if(v<0){f=ja;h=u.topRight}else if(v<Ba/2){f=Ga;h=u.bottomRight}else{f=Ua;h=u.bottomLeft}f+=d;var c=h.textContent;var _=h.image;var g=h.positionScale;var p=h.scale;var y=c.get(i);var m=_.get(i);if(eh(y)||m){var b=g.get(i);var x=p.get(i);var A=b*o;var w=x*o;var S=Math.cos(f);var E=Math.sin(f);var T=n+S*A;var M=a+E*A;var C=Qn(e,t,n,a,T,M,w);if(C){var k=C.x-n;var N=C.y-a;var distance=Math.sqrt(k*k+N*N);l=Math.max(l,distance)}}if(s==="square"){var I=Math.abs(Math.cos(v));var z=Math.abs(Math.sin(v));var L=1/Math.max(I,z)*o;l=Math.max(l,L)}return l}function Zf(e){return Math.pow(2,Math.ceil(Math.log2(e)))}function $f(e){var t=e.engine;var r=e.imageManager;var i=e.graph;var n=e.view;var a=e.boundaries;var o=t.E;var s=i.nodes;var u=i.edges;var l=s.getAndResetElementsToUpdate();var f=s.getAttributeContainers();var h=s.getPrevAttributeContainers();var d=u.getAndResetElementsToUpdate();var v=u.getAttributeContainers();var c=u.getPrevAttributeContainers();if(!l.length&&!d.length){return}var _=Math.max(s.getMaxIndex(),u.getMaxIndex());var g=(_+1)*Ea;var p=t.setGlobalBoundaries({maxBlockId:Zf(g),maxScaledSize:Zf(a.maxSize*8),maxPixelSize:255,maxMinVisibleSize:Zf(a.maxMinVisibleSize),maxSymbolicSize:Zf(a.maxSize),maxDashOffset:4,maxDashLength:3,maxGapLength:1});if(p){l=s.getAllElements();d=u.getAllElements()}var y=f.excluded;var m=f.layer;var b=f.animationDuration;var x=f.animationStart;var A=f.animationEasing;var w=f.x;var S=f.y;var E=f.opacity;var T=f.radius;var M=f.color;var C=f.shape;var k=f["innerStroke.width"];var N=f["innerStroke.color"];var I=f["innerStroke.minVisibleSize"];var z=f["outerStroke.width"];var L=f["outerStroke.color"];var R=f["outerStroke.minVisibleSize"];var D=f["badges.bottomRight.color"];var F=f["badges.bottomRight.scale"];var P=f["badges.bottomRight.positionScale"];var B=f["badges.bottomRight.image"];var O=f["badges.bottomRight.minVisibleSize"];var V=f["badges.bottomRight.stroke.color"];var j=f["badges.bottomRight.stroke.width"];var U=f["badges.bottomRight.text.content"];var G=f["badges.bottomRight.text.color"];var X=f["badges.bottomRight.text.font"];var W=f["badges.bottomRight.text.style"];var H=f["badges.bottomRight.text.scale"];var Y=f["badges.bottomLeft.color"];var q=f["badges.bottomLeft.scale"];var Z=f["badges.bottomLeft.positionScale"];var $=f["badges.bottomLeft.image"];var K=f["badges.bottomLeft.minVisibleSize"];var J=f["badges.bottomLeft.stroke.color"];var Q=f["badges.bottomLeft.stroke.width"];var ee=f["badges.bottomLeft.text.content"];var te=f["badges.bottomLeft.text.color"];var re=f["badges.bottomLeft.text.font"];var ie=f["badges.bottomLeft.text.style"];var ne=f["badges.bottomLeft.text.scale"];var ae=f["badges.topRight.color"];var oe=f["badges.topRight.scale"];var se=f["badges.topRight.positionScale"];var ue=f["badges.topRight.image"];var le=f["badges.topRight.minVisibleSize"];var fe=f["badges.topRight.stroke.color"];var he=f["badges.topRight.stroke.width"];var de=f["badges.topRight.text.content"];var ve=f["badges.topRight.text.color"];var ce=f["badges.topRight.text.font"];var _e=f["badges.topRight.text.style"];var ge=f["badges.topRight.text.scale"];var pe=f["badges.topLeft.color"];var ye=f["badges.topLeft.scale"];var me=f["badges.topLeft.positionScale"];var be=f["badges.topLeft.image"];var xe=f["badges.topLeft.minVisibleSize"];var Ae=f["badges.topLeft.stroke.color"];var we=f["badges.topLeft.stroke.width"];var Se=f["badges.topLeft.text.content"];var Ee=f["badges.topLeft.text.color"];var Te=f["badges.topLeft.text.font"];var Me=f["badges.topLeft.text.style"];var Ce=f["badges.topLeft.text.scale"];var ke=f["halo.color"];var Ne=f["halo.width"];var Ie=f["halo.strokeColor"];var ze=f["halo.strokeWidth"];var Le=f["icon.content"];var Re=f["icon.font"];var De=f["icon.color"];var Fe=f["icon.scale"];var Pe=f["icon.style"];var Be=f["icon.minVisibleSize"];var Oe=f["image.url"];var Ve=f["image.scale"];var je=f["image.fit"];var Ue=f["image.tile"];var Ge=f["image.minVisibleSize"];var Xe=f["outline.enabled"];var We=f["outline.color"];var He=f["outline.minVisibleSize"];var Ye=f["text.hidden"];var qe=f["text.content"];var Ze=f["text.font"];var $e=f["text.color"];var Ke=f["text.size"];var Je=f["text.scale"];var Qe=f["text.style"];var et=f["text.align"];var tt=f["text.margin"];var rt=f["text.padding"];var it=f["text.backgroundColor"];var nt=f["text.tip"];var at=f["text.minVisibleSize"];var ot=f["text.secondary.content"];var st=f["text.secondary.font"];var ut=f["text.secondary.color"];var lt=f["text.secondary.size"];var ft=f["text.secondary.scale"];var ht=f["text.secondary.style"];var dt=f["text.secondary.align"];var vt=f["text.secondary.margin"];var ct=f["text.secondary.padding"];var _t=f["text.secondary.backgroundColor"];var gt=f["text.secondary.minVisibleSize"];var pt=f["text.scaling"];var yt=f["text.position"];var mt=f["text.maxLineLength"];var bt=h.x;var xt=h.y;var At=h.opacity;var wt=h.radius;var St=h.color;var Et=h.shape;var Tt=h["innerStroke.width"];var Mt=h["innerStroke.color"];var Ct=h["innerStroke.minVisibleSize"];var kt=h["outerStroke.width"];var Nt=h["outerStroke.color"];var It=h["outerStroke.minVisibleSize"];var zt=h["badges.bottomRight.color"];var Lt=h["badges.bottomRight.scale"];var Rt=h["badges.bottomRight.positionScale"];var Dt=h["badges.bottomRight.image"];var Ft=h["badges.bottomRight.minVisibleSize"];var Pt=h["badges.bottomRight.stroke.color"];var Bt=h["badges.bottomRight.stroke.width"];var Ot=h["badges.bottomRight.text.content"];var Vt=h["badges.bottomRight.text.color"];var jt=h["badges.bottomRight.text.font"];var Ut=h["badges.bottomRight.text.style"];var Gt=h["badges.bottomRight.text.scale"];var Xt=h["badges.bottomLeft.color"];var Wt=h["badges.bottomLeft.scale"];var Ht=h["badges.bottomLeft.positionScale"];var Yt=h["badges.bottomLeft.image"];var qt=h["badges.bottomLeft.minVisibleSize"];var Zt=h["badges.bottomLeft.stroke.color"];var $t=h["badges.bottomLeft.stroke.width"];var Kt=h["badges.bottomLeft.text.content"];var Jt=h["badges.bottomLeft.text.color"];var Qt=h["badges.bottomLeft.text.font"];var er=h["badges.bottomLeft.text.style"];var tr=h["badges.bottomLeft.text.scale"];var rr=h["badges.topRight.color"];var ir=h["badges.topRight.scale"];var nr=h["badges.topRight.positionScale"];var ar=h["badges.topRight.image"];var or=h["badges.topRight.minVisibleSize"];var sr=h["badges.topRight.stroke.color"];var ur=h["badges.topRight.stroke.width"];var lr=h["badges.topRight.text.content"];var fr=h["badges.topRight.text.color"];var hr=h["badges.topRight.text.font"];var dr=h["badges.topRight.text.style"];var vr=h["badges.topRight.text.scale"];var cr=h["badges.topLeft.color"];var _r=h["badges.topLeft.scale"];var gr=h["badges.topLeft.positionScale"];var pr=h["badges.topLeft.image"];var yr=h["badges.topLeft.minVisibleSize"];var mr=h["badges.topLeft.stroke.color"];var br=h["badges.topLeft.stroke.width"];var xr=h["badges.topLeft.text.content"];var Ar=h["badges.topLeft.text.color"];var wr=h["badges.topLeft.text.font"];var Sr=h["badges.topLeft.text.style"];var Er=h["badges.topLeft.text.scale"];var Mr=h["halo.color"];var Cr=h["halo.width"];var kr=h["halo.strokeColor"];var Nr=h["halo.strokeWidth"];var Ir=h["icon.content"];var zr=h["icon.font"];var Lr=h["icon.color"];var Rr=h["icon.scale"];var Dr=h["icon.style"];var Fr=h["icon.minVisibleSize"];var Pr=h["image.url"];var Br=h["image.scale"];var Or=h["image.fit"];var Vr=h["image.tile"];var jr=h["image.minVisibleSize"];var Ur=h["outline.enabled"];var Gr=h["outline.color"];var Xr=h["outline.minVisibleSize"];var Wr=h["text.content"];var Hr=h["text.font"];var Yr=h["text.color"];var qr=h["text.size"];var Zr=h["text.scale"];var $r=h["text.style"];var Kr=h["text.align"];var Jr=h["text.margin"];var Qr=h["text.padding"];var ei=h["text.backgroundColor"];var ti=h["text.tip"];var ri=h["text.minVisibleSize"];var ii=h["text.secondary.content"];var ni=h["text.secondary.font"];var ai=h["text.secondary.color"];var oi=h["text.secondary.size"];var si=h["text.secondary.scale"];var ui=h["text.secondary.style"];var li=h["text.secondary.align"];var fi=h["text.secondary.margin"];var hi=h["text.secondary.padding"];var di=h["text.secondary.backgroundColor"];var vi=h["text.secondary.minVisibleSize"];var ci=h["text.scaling"];var _i=h["text.position"];var gi=h["text.maxLineLength"];var pi=v.source;var yi=v.target;var mi=v.curvature;var bi=v.excluded;var xi=v.layer;var Ai=v.animationDuration;var wi=v.animationStart;var Si=v.animationEasing;var Ei=v.width;var Ti=v.color;var Mi=v["shape.type"];var Ci=v["shape.head"];var ki=v["shape.tail"];var Ni=v["shape.style"];var Ii=v.opacity;var zi=v["stroke.color"];var Li=v["stroke.width"];var Ri=v["stroke.minVisibleSize"];var Di=v.minVisibleSize;var Fi=v.adjustAnchors;var Pi=v["halo.color"];var Bi=v["halo.width"];var Oi=v["outline.enabled"];var Vi=v["outline.color"];var ji=v["outline.minVisibleSize"];var Ui=v["text.hidden"];var Gi=v["text.content"];var Xi=v["text.font"];var Wi=v["text.color"];var Hi=v["text.scaling"];var Yi=v["text.size"];var qi=v["text.scale"];var Zi=v["text.style"];var $i=v["text.align"];var Ki=v["text.margin"];var Ji=v["text.padding"];var Qi=v["text.backgroundColor"];var en=v["text.minVisibleSize"];var tn=v["text.adjustAngle"];var rn=v["text.secondary.content"];var nn=v["text.secondary.font"];var an=v["text.secondary.color"];var on=v["text.scaling"];var sn=v["text.secondary.size"];var un=v["text.secondary.scale"];var ln=v["text.secondary.style"];var fn=v["text.secondary.align"];var hn=v["text.secondary.margin"];var dn=v["text.secondary.padding"];var vn=v["text.secondary.backgroundColor"];var cn=v["text.secondary.minVisibleSize"];var _n=v["text.maxLineLength"];var gn={get:function(){return false}};var pn=c.width;var yn=c.color;var mn=c["shape.type"];var bn=c["shape.head"];var xn=c["shape.tail"];var An=c["shape.style"];var wn=c.opacity;var Sn=c["stroke.color"];var En=c["stroke.width"];var Tn=c["stroke.minVisibleSize"];var Mn=c.minVisibleSize;var Cn=c.adjustAnchors;var kn=c["halo.color"];var Nn=c["halo.width"];var In=c["outline.enabled"];var zn=c["outline.color"];var Ln=c["outline.minVisibleSize"];var Rn=c["text.content"];var Dn=c["text.font"];var Fn=c["text.color"];var Pn=c["text.scaling"];var Bn=c["text.size"];var On=c["text.scale"];var Vn=c["text.style"];var jn=c["text.align"];var Un=c["text.margin"];var Gn=c["text.padding"];var Xn=c["text.backgroundColor"];var Wn=c["text.minVisibleSize"];var Hn=c["text.adjustAngle"];var Yn=c["text.secondary.content"];var qn=c["text.secondary.font"];var Zn=c["text.secondary.color"];var $n=c["text.scaling"];var Kn=c["text.secondary.size"];var Jn=c["text.secondary.scale"];var Qn=c["text.secondary.style"];var ea=c["text.secondary.align"];var ta=c["text.secondary.margin"];var ra=c["text.secondary.padding"];var ia=c["text.secondary.backgroundColor"];var na=c["text.secondary.minVisibleSize"];var aa=c["text.maxLineLength"];var oa={get:function(){return false}};var sa={topLeft:{textContent:Se,image:be,positionScale:me,scale:ye},topRight:{textContent:de,image:ue,positionScale:se,scale:oe},bottomLeft:{textContent:ee,image:$,positionScale:Z,scale:q},bottomRight:{textContent:U,image:B,positionScale:P,scale:F}};var ua={topLeft:{textContent:xr,image:pr,positionScale:gr,scale:_r},topRight:{textContent:lr,image:ar,positionScale:nr,scale:ir},bottomLeft:{textContent:Kt,image:Yt,positionScale:Ht,scale:Wt},bottomRight:{textContent:Ot,image:Dt,positionScale:Rt,scale:Lt}};var la=t.createBlock();var fa=t.createBlock();var ha=t.createBlock();var da=t.createBlock();var va=t.createBlock();var ca={bodyPatternAssigned:false,pixelRatio:Tr(),input:{},output:{},inputPrev:{},outputPrev:{},depthInfo:{}};for(var Sa=0,Ta=l.length;Sa<Ta;++Sa){var Ma=void 0;var Ca=void 0;var ka=void 0;var Na=void 0;var Ia=void 0;var za=void 0;var La=void 0;var Ra=void 0;var Da=void 0;var Fa=void 0;var Pa=void 0;var Ba=void 0;var Oa=void 0;var Za=void 0;var $a=void 0;var Ka=void 0;var Ja=void 0;var Qa=void 0;var eo=void 0;var to=void 0;var ro=void 0;var io=void 0;var no=void 0;var ao=void 0;var oo=void 0;var so=void 0;var uo=void 0;var lo=void 0;var fo=void 0;var ho=void 0;var vo=void 0;var co=void 0;var _o=void 0;var go=void 0;var po=void 0;var yo=void 0;var mo=void 0;var bo=void 0;var xo=void 0;var Ao=void 0;var wo=void 0;var So=void 0;var Eo=void 0;var To=void 0;var Mo=void 0;var Co=void 0;var ko=void 0;var No=void 0;var Io=void 0;var zo=void 0;var Lo=void 0;var Ro=void 0;var Do=void 0;var Fo=void 0;var Po=void 0;var Bo=void 0;var Oo=void 0;var Vo=void 0;var jo=void 0;var Uo=void 0;var Go=void 0;var Xo=void 0;var Wo=void 0;var Ho=void 0;var Yo=void 0;var qo=void 0;var Zo=void 0;var $o=void 0;var Ko=void 0;var Jo=void 0;var Qo=void 0;var es=void 0;var ts=void 0;var rs=void 0;var is=void 0;var ns=void 0;var as=void 0;var os=void 0;var ss=void 0;var us=void 0;var ls=void 0;var fs=void 0;var hs=void 0;var ds=void 0;var vs=void 0;var cs=void 0;var _s=void 0;var gs=void 0;var ps=void 0;var ys=void 0;var ms=void 0;var bs=void 0;var xs=void 0;var As=void 0;var ws=void 0;var Ss=void 0;var Es=void 0;var Ts=void 0;var Ms=void 0;var Cs=void 0;var ks=void 0;var Ns=void 0;var Is=void 0;var zs=void 0;var Ls=void 0;var Rs=void 0;var Ds=void 0;var Fs=void 0;var Ps=void 0;var Bs=void 0;var Os=void 0;var Vs=void 0;var js=void 0;var Us=void 0;var Gs=void 0;var Xs=void 0;var Ws=void 0;var Hs=void 0;var Ys=void 0;var qs=void 0;var Zs=void 0;var $s=void 0;var Qs=void 0;var eu=void 0;var tu=void 0;var ru=void 0;var iu=void 0;var nu=void 0;var au=void 0;var ou=void 0;var su=void 0;var uu=void 0;var lu=void 0;var fu=void 0;var hu=l[Sa];var du=hu*Ea;var vu=du+_a;var cu=du+ga;var _u=du+pa;var gu=du+ya;var pu=du+ma;Ma=y.get(hu);if(Ma){t.freeBlock(vu);t.freeBlock(cu);t.freeBlock(_u);t.freeBlock(gu);t.freeBlock(pu)}else{Na=m.get(hu);Ia=b.get(hu);Ca=Ia>0;ka=Th(Na,ca.depthInfo);ca.bodyPatternAssigned=false;la.reset(Ks,Ca,ka.nodeBody);fa.reset(Js,Ca,ka.nodeText);ha.reset(Ks,Ca,ka.nodeTextBackground);da.reset(Ks,Ca,ka.nodeHalo);va.reset(Ks,Ca,ka.nodeHaloStroke);Ra=w.get(hu);Da=S.get(hu);Oa=C.get(hu);Ba=M.get(hu);Fa=E.get(hu);Pa=T.get(hu);$a=N.get(hu);Za=k.get(hu);Ka=I.get(hu);Qa=L.get(hu);Ja=z.get(hu);ao=Le.get(hu);vo=Oe.get(hu);xo=Ye.get(hu);Ao=qe.get(hu);to=ke.get(hu);io=Ie.get(hu);yo=Xe.get(hu);if(Ca){es=bt.get(hu);ts=xt.get(hu);as=Et.get(hu);ns=St.get(hu);rs=At.get(hu);is=wt.get(hu);ss=Mt.get(hu);os=Tt.get(hu);us=Ct.get(hu);fs=Nt.get(hu);ls=kt.get(hu);gs=Ir.get(hu);ws=Pr.get(hu);Is=Wr.get(hu);ds=Mr.get(hu);cs=kr.get(hu);Cs=Ur.get(hu)}var yu=void 0;if(yo||Ca&&Cs){yu=la.next();mo=We.get(hu);bo=He.get(hu);gh(yu.end,Ra,Da,Pa,Oa,Fa,Qa,Ja,mo,bo);if(Ca){ks=Gr.get(hu);Ns=Xr.get(hu);gh(yu.start,es,ts,is,as,rs,fs,ls,ks,Ns)}}if(Qa||Ca&&fs){yu=la.next();Qa=Qf(Qa,Ba);eo=R.get(hu);lh(yu.end,Ra,Da,Oa,Pa,Qa,Ja,Za,eo,Fa);if(Ca){fs=Qf(fs,ns);hs=It.get(hu);lh(yu.start,es,ts,as,is,fs,ls,os,hs,rs)}}{yu=la.next();$a=Qf($a,Ba);fh(yu.end,Ra,Da,Pa,Oa,Ba,Fa,$a,Za,Ka);if(Ca){ss=Qf(ss,Ba);fh(yu.start,es,ts,is,as,ns,rs,ss,os,us)}}if(th(Ba)||Ca&&th(ns)){yu=sh(ca,la,Ca,Ra,Da,Pa,Oa,Fa,es,ts,is,as,rs);rh(yu.end,Ba);if(Ca){rh(yu.start,ns)}}if(vo||Ca&&ws){yu=sh(ca,la,Ca,Ra,Da,Pa,Oa,Fa,es,ts,is,as,rs);ho=r.getImage(vo);co=Ve.get(hu);_o=je.get(hu);go=Ue.get(hu);po=Ge.get(hu);nh(yu.end,ho,_o,go,co,po);if(Ca){As=r.getImage(ws);Ss=Br.get(hu);Es=Or.get(hu);Ts=Vr.get(hu);Ms=jr.get(hu);nh(yu.start,As,Es,Ts,Ss,Ms)}}if(eh(ao)||Ca&&eh(gs)){yu=sh(ca,la,Ca,Ra,Da,Pa,Oa,Fa,es,ts,is,as,rs);oo=Re.get(hu);so=De.get(hu);uo=Fe.get(hu);lo=Pe.get(hu);fo=Be.get(hu);ih(yu.end,ao,oo,so,uo,lo,fo);if(Ca){ps=zr.get(hu);ys=Lr.get(hu);bs=Rr.get(hu);ms=Dr.get(hu);xs=Fr.get(hu);ih(yu.start,gs,ps,ys,bs,ms,xs)}}ah(r,la,hu,Ca,Va,Ra,Da,Pa,Ba,Fa,es,ts,is,ns,rs,pe,ye,me,xe,Ae,we,be,Se,Ee,Te,Me,Ce,cr,_r,gr,yr,mr,br,pr,xr,Ar,wr,Sr,Er);ah(r,la,hu,Ca,ja,Ra,Da,Pa,Ba,Fa,es,ts,is,ns,rs,ae,oe,se,le,fe,he,ue,de,ve,ce,_e,ge,rr,ir,nr,or,sr,ur,ar,lr,fr,hr,dr,vr);ah(r,la,hu,Ca,Ua,Ra,Da,Pa,Ba,Fa,es,ts,is,ns,rs,Y,q,Z,K,J,Q,$,ee,te,re,ie,ne,Xt,Wt,Ht,qt,Zt,$t,Yt,Kt,Jt,Qt,er,tr);ah(r,la,hu,Ca,Ga,Ra,Da,Pa,Ba,Fa,es,ts,is,ns,rs,D,F,P,O,V,j,B,U,G,X,W,H,zt,Lt,Rt,Ft,Pt,Bt,Dt,Ot,Vt,jt,Ut,Gt);if(!xo&&(eh(Ao)||Ca&&eh(Is))){var mu=fa.next();wo=Ze.get(hu);So=$e.get(hu);Eo=Ke.get(hu);To=Je.get(hu);Uo=pt.get(hu);Go=Qe.get(hu);Xo=et.get(hu);Wo=yt.get(hu);Ho=at.get(hu);Mo=tt.get(hu);Co=rt.get(hu);ko=it.get(hu);No=nt.get(hu)&&Wo!=="center";Yo=mt.get(hu);Io=ot.get(hu);Ao=Eh(Ao);Ao=Xf(Ao,Yo);So=Qf(So,Ba);ko=Qf(ko,Ba);qo=t.measureText(Ao,wo,Go);Zo=qo.width;$o=qo.height;ph(ca,mu.end,Ra,Da,Pa,Fa,Za,Ja,Ao,wo,So,Eo,To,Uo,Go,Xo,Wo,Ho,Mo,Co,Zo,$o);if(Ca){zs=Hr.get(hu);Ls=Yr.get(hu);Rs=qr.get(hu);Ds=Zr.get(hu);ru=ci.get(hu);Fs=$r.get(hu);Ps=Kr.get(hu);iu=_i.get(hu);Us=ri.get(hu);Bs=Jr.get(hu);Os=Qr.get(hu);Vs=ei.get(hu);js=ti.get(hu)&&iu!=="center";nu=gi.get(hu);Gs=ii.get(hu);Is=Eh(Is);Is=Xf(Is,nu);Ls=Qf(Ls,ns);Vs=Qf(Vs,ns);au=t.measureText(Is,zs,Fs);ou=au.width;su=au.height;ph(ca,mu.start,es,ts,is,rs,os,ls,Is,zs,Ls,Rs,Ds,ru,Fs,Ps,iu,Us,Bs,Os,ou,su)}if(ko||Ca&&Vs){yu=ha.next();yh(ca,yu.end,Ra,Da,Pa,Fa,Za,Ja,Eo,To,Uo,Wo,Ho,Mo,Co,ko,Zo,$o);if(Ca){yh(ca,yu.start,es,ts,is,rs,os,ls,Rs,Ds,ru,iu,Us,Bs,Os,Vs,ou,su)}if(No||Ca&&js){yu=ha.next();mh(ca,yu.end,Ra,Da,Pa,Fa,Za,Ja,Eo,To,Uo,Wo,Ho,Mo,Co,ko);if(Ca){mh(ca,yu.start,es,ts,is,rs,os,ls,Rs,Ds,ru,iu,Us,Bs,Os,Vs)}}}if(eh(Io)||Ca&&eh(Gs)){var bu=fa.next();zo=st.get(hu);Lo=ut.get(hu);Ro=lt.get(hu);Do=ft.get(hu);Fo=ht.get(hu);Po=dt.get(hu);jo=gt.get(hu);Bo=vt.get(hu);Oo=ct.get(hu);Vo=_t.get(hu);Io=Eh(Io);Io=Xf(Io,Yo);Lo=Qf(Lo,Ba);Vo=Qf(Vo,Ba);Ko=t.measureText(Io,zo,Fo);Jo=Ko.width;Qo=Ko.height;if(Wo==="bottom"){Bo+=$o*Eo+Mo+Co*2}ph(ca,bu.end,Ra,Da,Pa,Fa,Za,Ja,Io,zo,Lo,Ro,Do,Uo,Fo,Po,"bottom",jo,Bo,Oo,Jo,Qo);if(Ca){Xs=ni.get(hu);Ws=ai.get(hu);Hs=oi.get(hu);Ys=si.get(hu);qs=ui.get(hu);Zs=li.get(hu);$s=vi.get(hu);Qs=fi.get(hu);eu=hi.get(hu);tu=di.get(hu);Gs=Eh(Gs);Gs=Xf(Gs,nu);Ws=Qf(Ws,ns);tu=Qf(tu,ns);uu=t.measureText(Gs,Xs,qs);lu=uu.width;fu=uu.height;if(Wo==="bottom"){Qs+=su*Rs+Bs+Os*2}ph(ca,bu.start,es,ts,is,rs,os,ls,Gs,Xs,Ws,Hs,Ys,ru,qs,Zs,"bottom",$s,Qs,eu,lu,fu)}if(Vo||Ca&&tu){yu=ha.next();yh(ca,yu.end,Ra,Da,Pa,Fa,Za,Ja,Ro,Do,Uo,"bottom",jo,Bo,Oo,Vo,Jo,Qo);if(Ca){yh(ca,yu.start,es,ts,is,rs,os,ls,Hs,Ys,ru,"bottom",$s,Qs,eu,tu,lu,fu)}}}}if(to||Ca&&ds){var xu=da.next();ro=Ne.get(hu);io=Ie.get(hu);fh(xu.end,Ra,Da,Pa,"circle",null,Fa,to,ro,0);if(Ca){vs=Cr.get(hu);cs=kr.get(hu);fh(xu.start,es,ts,is,"circle",null,rs,ds,vs,0)}if(io||Ca&&cs){var Au=va.next();no=ze.get(hu);fh(Au.end,Ra,Da,Pa,"circle",null,Fa,io,ro+no,0);if(Ca){_s=Nr.get(hu);fh(Au.end,es,ts,is,"circle",null,rs,cs,vs+_s,0)}}}if(Ca){za=x.get(hu);La=A.get(hu);la.setGlobalAnimation(za,Ia,La);fa.setGlobalAnimation(za,Ia,La);ha.setGlobalAnimation(za,Ia,La);da.setGlobalAnimation(za,Ia,La);va.setGlobalAnimation(za,Ia,La)}t.storeBlock(vu,la);t.storeBlock(cu,fa);t.storeBlock(_u,ha);t.storeBlock(gu,da);t.storeBlock(pu,va)}}for(var wu=0,Su=d.length;wu<Su;++wu){var Eu=void 0;var Tu=void 0;var Mu=void 0;var Cu=void 0;var ku=void 0;var Nu=void 0;var Iu=void 0;var zu=void 0;var Lu=void 0;var Ru=void 0;var Du=void 0;var Fu=void 0;var Pu=void 0;var Bu=void 0;var Ou=void 0;var Vu=void 0;var ju=void 0;var Uu=void 0;var Gu=void 0;var Xu=void 0;var Wu=void 0;var Hu=void 0;var Yu=void 0;var qu=void 0;var Zu=void 0;var $u=void 0;var Ku=void 0;var Ju=void 0;var Qu=void 0;var el=void 0;var tl=void 0;var rl=void 0;var il=void 0;var nl=void 0;var al=void 0;var ol=void 0;var sl=void 0;var ul=void 0;var ll=void 0;var fl=void 0;var hl=void 0;var dl=void 0;var vl=void 0;var cl=void 0;var _l=void 0;var gl=void 0;var pl=void 0;var yl=void 0;var ml=void 0;var bl=void 0;var xl=void 0;var Al=void 0;var wl=void 0;var Sl=void 0;var El=void 0;var Tl=void 0;var Ml=void 0;var Cl=void 0;var kl=void 0;var Nl=void 0;var Il=void 0;var zl=void 0;var Ll=void 0;var Rl=void 0;var Dl=void 0;var Fl=void 0,Pl=void 0,Bl=void 0,Ol=void 0,Vl=void 0,jl=void 0,Ul=void 0,Gl=void 0,Xl=void 0,Wl=void 0,Hl=void 0,Yl=void 0,ql=void 0,Zl=void 0,$l=void 0,Kl=void 0,Jl=void 0,Ql=void 0,ef=void 0,tf=void 0,rf=void 0,nf=void 0,af=void 0,of=void 0;var sf=void 0,uf=void 0,lf=void 0,ff=void 0,hf=void 0,df=void 0,vf=void 0,cf=void 0,_f=void 0,gf=void 0,pf=void 0,yf=void 0,mf=void 0,bf=void 0,xf=void 0,Af=void 0,wf=void 0,Sf=void 0,Ef=void 0,Tf=void 0,Mf=void 0,Cf=void 0,kf=void 0,Nf=void 0;var If=d[wu];var zf=If*Ea;var Lf=zf+ba;var Rf=zf+xa;var Df=zf+Aa;var Ff=zf+wa;Cu=bi.get(If);if(Cu){t.freeBlock(Lf);t.freeBlock(Rf);t.freeBlock(Df);t.freeBlock(Ff)}else{Iu=xi.get(If);Eu=pi.get(If);Tu=yi.get(If);Du=b.get(Eu);Fu=b.get(Tu);if(Fu>0){zu=Fu;Lu=x.get(Tu);Ru=A.get(Tu)}else if(Du>0){zu=Du;Lu=x.get(Eu);Ru=A.get(Eu)}else{zu=Ai.get(If);Lu=wi.get(If);Ru=Si.get(If)}ku=zu>0;Nu=Th(Iu,ca.depthInfo);la.reset(o.ELT_GENERIC,ku,Nu.edgeBody);fa.reset(o.ELT_TEXT,ku,Nu.edgeText);ha.reset(o.ELT_GENERIC,ku,Nu.edgeTextBackground);da.reset(o.ELT_GENERIC,ku,Nu.edgeHalo);Mu=mi.get(If);Bu=Ti.get(If);Ou=Ii.get(If);Pu=Ei.get(If);Vu=Mi.get(If);ju=Ci.get(If);Gu=ki.get(If);Uu=Ni.get(If);Wu=zi.get(If);Xu=Li.get(If);Hu=Ri.get(If);Yu=Di.get(If);qu=Fi.get(If);Zu=Pi.get(If);Ku=Oi.get(If);el=Ui.get(If);tl=Gi.get(If);rl=rn.get(If);il=w.get(Eu);nl=S.get(Eu);al=T.get(Eu);ol=C.get(Eu);sl=w.get(Tu);ul=S.get(Tu);fl=T.get(Tu);ll=C.get(Tu);if(Bu==="source"){Bu=M.get(Eu)}else if(Bu==="target"){Bu=M.get(Tu)}Wu=Qf(Wu,Bu);if(ku){dl=yn.get(If);vl=wn.get(If);hl=pn.get(If);cl=mn.get(If);_l=bn.get(If);pl=xn.get(If);gl=An.get(If);ml=Sn.get(If);yl=En.get(If);bl=Tn.get(If);xl=Mn.get(If);Al=Cn.get(If);wl=kn.get(If);El=In.get(If);Cl=bt.get(Eu);kl=xt.get(Eu);Nl=wt.get(Eu);Il=Et.get(Eu);zl=bt.get(Tu);Ll=xt.get(Tu);Rl=wt.get(Tu);Dl=Et.get(Tu);if(dl==="source"){dl=St.get(Eu)}else if(dl==="target"){dl=St.get(Tu)}ml=Qf(ml,dl)}var Pf=Eu===Tu,Bf=ca.input,Of=ca.output,Vf=ca.inputPrev,jf=ca.outputPrev;{Bf.width=Pu;Bf.shapeType=Vu;Bf.shapeStyle=Uu;Bf.shapeTail=Gu;Bf.shapeHead=ju;Bf.sourceRadius=al;Bf.targetRadius=fl;Bf.source=Eu;Bf.sourceX=il;Bf.sourceY=nl;Bf.sourceShape=ol;Bf.target=Tu;Bf.targetX=sl;Bf.targetY=ul;Bf.targetShape=ll;Bf.curvature=Mu;Bf.isSelfLoop=Pf;Bf.badgesAttributes=sa;Bf.view=n;Bf.adjustAnchors=qu;Jf(Bf,Of);Fl=Of.bodyType;Pl=Of.bodyX;Bl=Of.bodyY;Ol=Of.bodyLength;Vl=Of.bodyWidth;jl=Of.bodyAngle;Ul=Of.tailType;Gl=Of.tailX;Xl=Of.tailY;Wl=Of.tailLength;Hl=Of.tailWidth;Yl=Of.tailAngle;ql=Of.headType;Zl=Of.headX;$l=Of.headY;Kl=Of.headLength;Jl=Of.headWidth;Ql=Of.headAngle;ef=Of.textX;tf=Of.textY;rf=Of.textAngle;nf=Of.availableSpace;af=Of.dash;of=Of.gap;Mu=Of.curvature}if(ku){Vf.width=hl;Vf.shapeType=cl;Vf.shapeStyle=gl;Vf.shapeTail=pl;Vf.shapeHead=_l;Vf.sourceRadius=Nl;Vf.targetRadius=Rl;Vf.source=Eu;Vf.sourceX=Cl;Vf.sourceY=kl;Vf.sourceRadius=Nl;Vf.target=Tu;Vf.targetX=zl;Vf.targetY=Ll;Vf.targetRadius=Rl;Vf.curvature=Mu;Vf.isSelfLoop=Pf;Vf.badgesAttributes=ua;Vf.view=n;Vf.adjustAnchors=Al;Jf(Vf,jf);sf=jf.bodyType;uf=jf.bodyX;lf=jf.bodyY;ff=jf.bodyLength;hf=jf.bodyWidth;df=jf.bodyAngle;vf=jf.tailType;cf=jf.tailX;_f=jf.tailY;gf=jf.tailLength;pf=jf.tailWidth;yf=jf.tailAngle;mf=jf.headType;bf=jf.headX;xf=jf.headY;Af=jf.headLength;wf=jf.headWidth;Sf=jf.headAngle;Ef=jf.textX;Tf=jf.textY;Mf=jf.textAngle;Cf=Of.availableSpace;kf=jf.dash;Nf=jf.gap;if(Ol<.001){rf=Mf}else if(ff<.001){Mf=rf}}if(Ku||ku&&El){var Uf=void 0,Gf=void 0,Wf=void 0,Hf=void 0,Yf=void 0,qf=void 0,$f=void 0,oh=void 0,uh=void 0,dh=void 0,vh=void 0;var ch=void 0,_h=void 0,bh=void 0,xh=void 0,Ah=void 0,wh=void 0,Sh=void 0,Mh=void 0,Ch=void 0,kh=void 0,Nh=void 0;Ju=Vi.get(If);Qu=ji.get(If);Uf=Pu*Wa;Gf=Ha;Wf=Vl*Xa;Hf=Hl*Xa;Yf=Jl*Xa;qf=Ju;$f=null;oh=0;uh=Math.max(Qu,Yu);dh=Of.dash;vh=Of.gap;if(ku){Tl=zn.get(If);Ml=Ln.get(If);ch=hl*Wa;_h=Ha;bh=hf*Xa;xh=pf*Xa;Ah=wf*Xa;wh=Tl;Sh=null;Mh=0;Ch=Math.max(Ml,xl);kh=jf.dash;Nh=jf.gap}hh(ku,la,Mu,Pf,Fl,Pl,Bl,Ol,Wf,jl,Ul,Gl,Xl,Wl,Hf,Yl,ql,Zl,$l,Kl,Yf,Ql,qf,Ou,$f,oh,Hu,uh,dh,vh,Gf,Uf,sf,uf,lf,ff,bh,df,vf,cf,_f,gf,xh,yf,mf,bf,xf,Af,Ah,Sf,wh,vl,Sh,Mh,bl,Ch,kh,Nh,_h,ch)}{hh(ku,la,Mu,Pf,Fl,Pl,Bl,Ol,Vl,jl,Ul,Gl,Xl,Wl,Hl,Yl,ql,Zl,$l,Kl,Jl,Ql,Bu,Ou,Wu,Xu,Hu,Yu,af,of,0,0,sf,uf,lf,ff,hf,df,vf,cf,_f,gf,pf,yf,mf,bf,xf,Af,wf,Sf,dl,vl,ml,yl,bl,xl,kf,Nf,0,0)}if(Zu||ku&&wl){var Ih=void 0,zh=void 0,Lh=void 0,Rh=void 0,Dh=void 0,Fh=void 0,Ph=void 0;var Bh=void 0,Oh=void 0,Vh=void 0,jh=void 0,Uh=void 0,Gh=void 0,Xh=void 0;$u=Bi.get(If);Ih=0;zh=0;Lh=0;Rh=0;Dh=Zu;Fh=Zu;Ph=$u;if(ku){Sl=Nn.get(If);Bh=0;Oh=0;Vh=0;jh=0;Uh=wl;Gh=wl;Xh=Sl}hh(ku,da,Mu,Pf,Fl,Pl,Bl,Ol,Vl,jl,Ul,Gl,Xl,Wl,Hl,Yl,ql,Zl,$l,Kl,Jl,Ql,Dh,Ou,Fh,Ph,Hu,Yu,Ih,zh,Rh,Lh,sf,uf,lf,ff,hf,df,vf,cf,_f,gf,pf,yf,mf,bf,xf,Af,wf,Sf,Uh,vl,Gh,Xh,bl,xl,Bh,Oh,jh,Vh)}if(!el){Kf(Ya,ca,t,ku,fa,ha,If,ef,tf,rf,nf,Ou,Pu,Bu,Ef,Tf,Mf,Cf,vl,hl,dl,Gi,Xi,Wi,Yi,qi,Hi,Zi,$i,en,Ki,Ji,Qi,tn,_n,Rn,Dn,Fn,Bn,On,Pn,Vn,jn,Wn,Un,Gn,Xn,Hn,aa);Kf(qa,ca,t,ku,fa,ha,If,ef,tf,rf,nf,Ou,Pu,Bu,Ef,Tf,Mf,Cf,vl,hl,dl,rn,nn,an,sn,un,on,ln,fn,cn,hn,dn,vn,gn,_n,Yn,qn,Zn,Kn,Jn,$n,Qn,ea,na,ta,ra,ia,oa,aa)}if(ku){la.setGlobalAnimation(Lu,zu,Ru);fa.setGlobalAnimation(Lu,zu,Ru);ha.setGlobalAnimation(Lu,zu,Ru);da.setGlobalAnimation(Lu,zu,Ru)}t.storeBlock(Lf,la);t.storeBlock(Rf,fa);t.storeBlock(Df,ha);t.storeBlock(Ff,da)}}}function Kf(e,t,r,i,n,a,o,s,u,l,f,h,d,v,c,_,g,p,y,m,b,x,A,w,S,E,T,M,C,k,N,I,z,L,R,D,F,P,B,O,V,j,U,G,X,W,H,Y,q){var Z,$,K,J,Q,ee,te,re,ie,ne,ae,oe,se,ue,le,fe,he;var de,ve,ce,_e,ge,pe,ye,me,be,xe,Ae,we,Se,Ee,Te,Me,Ce;Z=x.get(o);if(i){de=D.get(o)}if(eh(Z)||i&&eh(de)){var ke=n.next();$=A.get(o);K=w.get(o);J=S.get(o);Q=E.get(o);ee=T.get(o);te=M.get(o);re=C.get(o);ie=k.get(o);ne=N.get(o);ae=I.get(o);oe=z.get(o);se=L.get(o);ue=R.get(o);Z=Eh(Z);Z=Xf(Z,ue);K=Qf(K,v);oe=Qf(oe,v);le=r.measureText(Z,$,te);fe=le.width;he=le.height;bh(t,ke.end,e,s,u,l,h,d,Z,$,K,J,Q,ee,te,re,ie,ne,ae,oe,se,fe,he,f);if(i){ve=F.get(o);ce=P.get(o);_e=B.get(o);ge=O.get(o);pe=V.get(o);ye=j.get(o);me=U.get(o);be=G.get(o);xe=X.get(o);Ae=W.get(o);we=H.get(o);Se=Y.get(o);Ee=q.get(o);de=Eh(de);de=Xf(de,Ee);ce=Qf(ce,b);we=Qf(we,b);Te=r.measureText(de,ve,ye);Me=Te.width;Ce=Te.height;bh(t,ke.start,e,c,_,g,y,m,de,ve,ce,_e,ge,pe,ye,me,be,xe,Ae,we,Se,Me,Ce,p)}if(oe||i&&we){var Ne=a.next();xh(t,Ne.end,e,s,u,l,h,d,Z,$,K,J,Q,ee,te,ie,ne,ae,oe,se,fe,he,f);if(i){xh(t,Ne.start,e,c,_,g,y,m,de,ve,ce,_e,ge,pe,ye,be,xe,Ae,we,Se,Me,Ce,p)}}}}function Jf(e,t){var r=e.width;var i=e.shapeStyle;var n=e.shapeTail;var a=e.shapeHead;var o=e.sourceRadius;var s=e.targetRadius;var u=e.isSelfLoop;var l=e.shapeType;var f=e.source;var h=e.sourceX;var d=e.sourceY;var v=e.sourceShape;var c=e.target;var _=e.targetX;var g=e.targetY;var p=e.targetShape;var y=e.curvature;var m=e.badgesAttributes;var b=e.view;var x=e.adjustAnchors;var A,w,S,E;var T,M,C,k;var N,I,z,L,R,D;var F,P,B,O,V,j;var U,G,X,W,H,Y;var q,Z,$,K,J,Q;var ee,te,re,ie,ne;var ae=to[i];var oe=Sh(r,Za);var se=_-h;var ue=g-d;var distance=Math.sqrt(se*se+ue*ue)+Pa;var le=0;var fe=0;var he=0;var de=o;var ve=s;K=0;W=0;if(n){K=oe;fe+=K;le+=1}if(a){W=oe;he+=W;le+=1}if(u){y+=Math.round(o/2);var ce=y*Ka;A=h-ce;w=d;S=h;E=d+ce;ne=ce;if(l==="triangle"||a){if(x){ve=qf(S,E,b,c,_,g,s,p,m)}he+=ve}}else{var _e=(h+_)/2;var ge=(d+g)/2;var pe=distance/2;var ye=ue/distance;var me=-se/distance;var be=y*(distance/Qa)*2;A=_e+ye*be;w=ge+me*be;S=A;E=w;ne=Math.sqrt(be*be+pe*pe)+Pa;if(n||a||l==="triangle"){if(x){de=qf(A,w,b,f,h,d,o,v,m);ve=qf(S,E,b,c,_,g,s,p,m)}var xe=distance-de-ve;var Ae=Math.min(xe/le,oe);if(n){fe+=Math.max(de+Ae-K,0)}if(a){he+=Math.max(ve+Ae-W,0)}else if(l==="triangle"&&xe>0){he+=ve}}}T=(A-h)/ne;M=(w-d)/ne;C=(S-_)/ne;k=(E-g)/ne;N=h+T*fe;I=d+M*fe;z=_+C*he;L=g+k*he;var we=z-N;var Se=L-I;F=l;V=r;if(u){P=h;B=d;O=he*.95;j=$a}else{P=(N+z)/2;B=(I+L)/2;O=Math.sqrt(we*we+Se*Se)+Pa;j=Math.atan2(-Se,we);var Ee=y*(O/Qa)*2;A=P+Se/O*Ee;w=B-we/O*Ee;S=A;E=w}R=ae.dash;D=ae.gap;q=n;J=oe;Z=N-T*K/2;$=I-M*K/2;Q=Math.atan2(M,-T);U=a;H=oe;G=z-C*W/2;X=L-k*W/2;Y=Math.atan2(k,-C);re=j;if(u){ee=wh(.5,N,z,A,S);te=wh(.5,I,L,w,E);ie=0}else{if(y!==0){ee=Ah(.5,N,z,A);te=Ah(.5,I,L,w);ie=0}else{var Te=fe?fe:o;var Me=he?he:s;var Ce=_-h;var ke=g-d;var Ne=Math.sqrt(Ce*Ce+ke*ke)+Pa;var Ie=Te/Ne;var ze=Me/Ne;var Le=h+Ce*Ie;var Re=d+ke*Ie;var De=_-Ce*ze;var Fe=g-ke*ze;ee=(Le+De)/2;te=(Re+Fe)/2;ie=Ne-Te-Me}}t.curveControl1X=A;t.curveControl1Y=w;t.curveControl2X=S;t.curveControl2Y=E;t.sourceToControl1X=T;t.sourceToControl1Y=M;t.targetToControl2X=C;t.targetToControl2Y=k;t.curveStartX=N;t.curveStartY=I;t.curveEndX=z;t.curveEndY=L;t.dash=R;t.gap=D;t.bodyType=F;t.bodyX=P;t.bodyY=B;t.bodyLength=O;t.bodyWidth=V;t.bodyAngle=j;t.headType=U;t.headX=G;t.headY=X;t.headLength=W;t.headWidth=H;t.headAngle=Y;t.tailType=q;t.tailX=Z;t.tailY=$;t.tailLength=K;t.tailWidth=J;t.tailAngle=Q;t.textX=ee;t.textY=te;t.textAngle=re;t.availableSpace=ie;t.distanceToControl=ne;t.curvature=y;return t}function Qf(e,t){return e==="inherit"?t:e}function eh(e){return e||e===0}function th(e){return Array.isArray(e)}function rh(e,t){if(th(t)){e.fillColor=null;e.pattern.type=ru;e.pattern.attributes.colors=t.join(";");e.patternScale=1;e.patternMask=null}else{e.fillColor=t;e.pattern.type=Qs}}function ih(e,t,r,i,n,a,o){e.pattern.type=iu;e.pattern.attributes.text=Eh(t);e.pattern.attributes.font=r;e.pattern.attributes.style=a;e.pattern.attributes.size="sdf";e.patternMinVisibleSize=o;e.patternMask=i;e.patternScale=n;e.patternSdf=false}function nh(e,t,r,i,n,a){var o=r&&!i;e.pattern.type=eu;e.pattern.attributes.image=t;e.pattern.attributes.scaled=o;e.pattern.attributes.duplicated=i;e.patternScale=o?n:0;e.patternMinVisibleSize=a;e.patternMask=null;e.patternSdf=false}function ah(e,t,r,i,n,a,o,s,u,l,f,h,d,v,c,_,g,p,y,m,b,x,A,w,S,E,T,M,C,k,N,I,z,L,R,D,F,P,B){var O;var V;var j;var U;var G;var X;var W;var H;var Y;var q;var Z;var $;var K;var J;O=x.get(r);V=A.get(r);if(i){H=L.get(r);Y=R.get(r)}var Q=O||i&&H;var ee=eh(V)||i&&eh(Y);if(Q||ee){var te=t.next();oh(te.end,r,n,a,o,s,u,l,_,g,p,y,m,b);if(i){oh(te.start,r,n,f,h,d,v,c,M,C,k,N,I,z)}if(O){j=e.getImage(O);nh(te.end,j,true,false,1,0);if(i){q=e.getImage(H);nh(te.start,q,true,false,1,0)}}if(ee){if(Q){te=t.next();oh(te.end,r,n,a,o,s,u,l,_,g,p,y,m,b);te.end.fillColor=null;te.end.strokeColor=null;if(i){oh(te.start,r,n,f,h,d,v,c,M,C,k,N,I,z);te.start.fillColor=null;te.start.strokeColor=null}}U=S.get(r);G=w.get(r);X=T.get(r);W=E.get(r);G=Qf(G,u);ih(te.end,V,U,G,X,W,0);if(i){Z=F.get(r);$=D.get(r);K=B.get(r);J=P.get(r);$=Qf($,v);ih(te.start,Y,Z,$,K,J,0)}}}}function oh(e,t,r,i,n,a,o,s,u,l,f,h,d,v){var c=u.get(t);var _=l.get(t);var g=f.get(t);var p=h.get(t);var y=d.get(t);var m=v.get(t);c=Qf(c,o);y=Qf(y,o);var b=a*_*2;e.x=i;e.y=n;e.opacity=s;e.minVisibleSize=p;e.offsetAngle=r;e.fillColor=c;e.strokeColor=y;e.strokeWidthAbsolute=m;e.offsetScaled=a*g;e.thicknessScaled=b;e.lengthScaled=b;e.symbolicSize=a*2;e.offsetAffectedByAngle=false;e.strokeMinVisibleSize=0;e.patternMinVisibleSize=0;e.shape="circle";e.dashLength=0;e.gapLength=0;e.patternSdf=false;e.shapeStart=0;e.shapeEnd=1;e.angle=0;e.angleAffectedByView=false;e.lengthAbsolute=0;e.thicknessAbsolute=0;e.strokeWidthScaled=0;e.offsetAbsolute=0;e.dashOffset=0;e.adjustAngle=false;e.isSelfLoop=false;e.curvature=0}function sh(e,t,r,i,n,a,o,s,u,l,f,h,d){if(!e.bodyPatternAssigned){e.bodyPatternAssigned=true;return t.getCurrentElement()}else{var v=t.next();uh(v.end,i,n,a,o,s);if(r){uh(v.start,u,l,f,h,d)}return v}}function uh(e,t,r,i,n,a){e.x=t;e.y=r;e.shape=n;e.opacity=a;e.lengthScaled=i*2;e.thicknessScaled=i*2;e.symbolicSize=i*2;e.strokeWidthScaled=0;e.offsetScaled=0;e.lengthAbsolute=0;e.thicknessAbsolute=0;e.strokeWidthAbsolute=0;e.offsetAbsolute=0;e.strokeColor=null;e.strokeWidthAbsolute=0;e.strokeMinVisibleSize=0;e.offsetAffectedByAngle=false;e.offsetAngle=0;e.angle=0;e.angleAffectedByView=false;e.shapeStart=0;e.shapeEnd=1;e.dashLength=0;e.gapLength=0;e.dashOffset=0;e.patternMask=null;e.fillColor=null;e.minVisibleSize=0;e.strokeWidthScaled=false;e.patternSdf=false;e.adjustAngle=false;e.isSelfLoop=false;e.curvature=0}function lh(e,t,r,i,n,a,o,s,u,l){e.x=t;e.y=r;e.shape=i;e.lengthScaled=n*2;e.thicknessScaled=n*2;e.lengthAbsolute=s*2;e.thicknessAbsolute=s*2;e.strokeColor=a;e.strokeWidthAbsolute=o;e.strokeMinVisibleSize=u;e.opacity=l;e.symbolicSize=n*2;e.offsetScaled=0;e.offsetAbsolute=0;e.strokeWidthScaled=0;e.offsetAffectedByAngle=false;e.offsetAngle=0;e.angle=0;e.angleAffectedByView=false;e.shapeStart=0;e.shapeEnd=1;e.dashLength=0;e.gapLength=0;e.dashOffset=0;e.fillColor="transparent";e.minVisibleSize=0;e.patternScale=0;e.pattern.type=Qs;e.patternMinVisibleSize=0;e.patternSdf=false;e.adjustAngle=false;e.isSelfLoop=false;e.curvature=0}function fh(e,t,r,i,n,a,o,s,u,l){e.x=t;e.y=r;e.lengthScaled=i*2;e.thicknessScaled=i*2;e.shape=n;e.fillColor=a;e.opacity=o;e.strokeColor=s;e.strokeWidthAbsolute=u;e.strokeMinVisibleSize=l;e.symbolicSize=i*2;e.offsetScaled=0;e.offsetAbsolute=0;e.strokeWidthScaled=0;e.lengthAbsolute=0;e.thicknessAbsolute=0;e.offsetAffectedByAngle=false;e.offsetAngle=0;e.angle=0;e.angleAffectedByView=false;e.shapeStart=0;e.shapeEnd=1;e.dashLength=0;e.gapLength=0;e.dashOffset=0;e.minVisibleSize=0;e.patternScale=0;e.pattern.type=Qs;e.patternMinVisibleSize=0;e.patternSdf=false;e.adjustAngle=false;e.isSelfLoop=false;e.curvature=0}function hh(e,t,r,i,n,a,o,s,u,l,f,h,d,v,c,_,g,p,y,m,b,x,A,w,S,E,T,M,C,k,N,I,z,L,R,D,F,P,B,O,V,j,U,G,X,W,H,Y,q,Z,$,K,J,Q,ee,te,re,ie,ne,ae){var oe=r===0?1:Ja;var se;if(f||e&&B){se=t.next();f="arrow";B="arrow";{_h(se.end,0,false,f,h,d,v,_,c,A,w,S,E,T,M,0,1,0,0,0,N,I)}if(e){_h(se.start,0,false,B,O,V,j,G,U,$,K,J,Q,ee,te,0,1,0,0,0,ne,ae)}}if(g||e&&X){se=t.next();g="arrow";X="arrow";{_h(se.end,0,false,g,p,y,m,x,b,A,w,S,E,T,M,0,1,0,0,0,N,I)}if(e){_h(se.start,0,false,X,W,H,Y,Z,q,$,K,J,Q,ee,te,0,1,0,0,0,ne,ae)}}var ue=1/oe;var le=0;var fe=0;var he;var de=0;for(var ve=0;ve<oe;++ve){se=t.next();he=de;de+=ue;{_h(se.end,r,i,n,a,o,s,l,u,A,w,S,E,T,M,he,de,C,k,le,N,I);if(C&&oe>1){le+=dh(i,he,de,r,s,u)}}if(e){_h(se.start,r,i,z,L,R,D,P,F,$,K,J,Q,ee,te,he,de,re,ie,fe,ne,ae);if(re&&oe>1){fe+=dh(i,he,de,r,D,F)}}}}function dh(e,t,r,i,n,a){if(e){return ch(t,r,i,n)/a}else{return vh(t,r,i,n)/a}}function vh(e,t,r,i){var n=0;var a=0;var o=i;var s=0;var u=i/2;var l=i/Qa*2*r;var f=Ah(e,n,o,u);var h=Ah(e,a,s,l);var d=Ah(t,n,o,u);var v=Ah(t,a,s,l);var c=d-f;var _=v-h;return Math.sqrt(c*c+_*_)}function ch(e,t,r,i){var n=r*Ka;var a=0;var o=0;var s=0;var u=i;var l=a-n;var f=o;var h=s;var d=u+n;var v=wh(e,a,s,l,h);var c=wh(e,o,u,f,d);var _=wh(t,a,s,l,h);var g=wh(t,o,u,f,d);var p=_-v;var y=g-c;return Math.sqrt(p*p+y*y)}function _h(e,t,r,i,n,a,o,s,u,l,f,h,d,v,c,_,g,p,y,m,b,x){e.curvature=t;e.isSelfLoop=r;e.x=n;e.y=a;e.angle=s;e.thicknessScaled=u;e.lengthScaled=o;e.shape=i;e.fillColor=l;e.strokeColor=h;e.strokeWidthAbsolute=d;e.opacity=f;e.symbolicSize=u;e.minVisibleSize=c;e.strokeMinVisibleSize=v;e.offsetScaled=x;e.offsetAbsolute=b;e.strokeWidthScaled=0;e.lengthAbsolute=0;e.thicknessAbsolute=0;e.angleAffectedByView=true;e.offsetAffectedByAngle=false;e.offsetAngle=1.5707963267948966;e.patternScale=0;e.pattern.type=Qs;e.patternMinVisibleSize=0;e.patternSdf=false;e.shapeStart=_;e.shapeEnd=g;e.dashLength=p;e.gapLength=y;e.dashOffset=m;e.adjustAngle=false}function gh(e,t,r,i,n,a,o,s,u,l){var f=i*2*1.1;e.x=t;e.y=r;e.lengthScaled=f;e.thicknessScaled=f;e.shape=n;e.fillColor=u;e.opacity=a;e.symbolicSize=i*2;e.minVisibleSize=l;e.offsetAbsolute=o?s/2:0;e.offsetScaled=i*.15;e.strokeWidthAbsolute=0;e.strokeWidthScaled=0;e.lengthAbsolute=0;e.thicknessAbsolute=0;e.offsetAffectedByAngle=false;e.offsetAngle=1.5707963267948966;e.strokeColor=null;e.strokeMinVisibleSize=0;e.angle=0;e.angleAffectedByView=false;e.shapeStart=0;e.shapeEnd=1;e.dashLength=0;e.gapLength=0;e.dashOffset=0;e.patternScale=0;e.pattern.type=Qs;e.patternMinVisibleSize=0;e.patternSdf=false;e.adjustAngle=false;e.isSelfLoop=false;e.curvature=0}function ph(e,t,r,i,n,a,o,s,u,l,f,h,d,v,c,_,g,p,y,m,b,x){var A=0;var w=false;var S=false;var E=false;if(g==="bottom"||g==="top"){S=true}else if(g==="right"||g==="left"){w=true}else{E=true}if(!E){A=o+s+y+m}t.x=r;t.y=i;t.opacity=a;t.minVisibleSize=p;t.symbolicSize=n*2;t.offsetScaled=E?0:n;t.offsetAbsolute=E?0:A;t.offsetAffectedByAngle=false;t.offsetAngle=ro[g];t.pattern.type=nu;t.pattern.attributes.text=u;t.pattern.attributes.font=l;t.pattern.attributes.style=c;t.pattern.attributes.align=_;t.pattern.attributes.pixelRatio=e.pixelRatio;t.patternMinVisibleSize=0;t.patternMask=f;if(v){var T=n*d*2,M=x/2*T,C=b/2*T;t.thicknessScaled=T;t.thicknessAbsolute=0;t.pattern.attributes.size="sdf";t.patternScale=1;t.patternSdf=true;if(S){t.offsetScaled+=M}else if(w){t.offsetScaled+=C}}else{var k=h,N=x/2*k,I=b/2*k;t.thicknessScaled=0;t.thicknessAbsolute=k;t.pattern.attributes.size=h;t.patternScale=0;t.patternSdf=false;if(S){t.offsetAbsolute+=N}else if(w){t.offsetAbsolute+=I}}t.lengthScaled=0;t.lengthAbsolute=0;t.shape="square";t.fillColor=null;t.strokeColor=null;t.strokeWidthAbsolute=0;t.strokeWidthScaled=0;t.strokeMinVisibleSize=0;t.angle=0;t.angleAffectedByView=false;t.shapeStart=0;t.shapeEnd=1;t.dashLength=0;t.gapLength=0;t.dashOffset=0;t.adjustAngle=false;t.isSelfLoop=false;t.curvature=0}function yh(e,t,r,i,n,a,o,s,u,l,f,h,d,v,c,_,g,p){var y=0,m=f?n*l*2:u,b=g*m,x=p*m,A=false,w=false,S=false;if(h==="bottom"||h==="top"){w=true}else if(h==="right"||h==="left"){A=true}else{S=true}if(!S){y=o+s+v+c}t.x=r;t.y=i;t.opacity=a;t.minVisibleSize=d;t.symbolicSize=n;t.offsetScaled=S?0:n;t.offsetAbsolute=S?0:y;t.offsetAffectedByAngle=false;t.offsetAngle=ro[h];if(f){t.lengthScaled=b;t.thicknessScaled=x;t.lengthAbsolute=0;t.thicknessAbsolute=0;if(w){t.offsetScaled+=x/2}else if(A){t.offsetScaled+=b/2}}else{t.lengthScaled=0;t.thicknessScaled=0;t.lengthAbsolute=b;t.thicknessAbsolute=x;if(w){t.offsetAbsolute+=x/2}else if(A){t.offsetAbsolute+=b/2}}t.thicknessAbsolute+=c*2;t.lengthAbsolute+=c*2;t.fillColor=_;t.strokeColor=_;t.strokeWidthAbsolute=0;t.strokeWidthScaled=0;t.pattern.type=Qs;t.shape="square";t.strokeMinVisibleSize=0;t.angle=0;t.angleAffectedByView=false;t.shapeStart=0;t.shapeEnd=1;t.dashLength=0;t.gapLength=0;t.dashOffset=0;t.adjustAngle=false;t.isSelfLoop=false;t.curvature=0}function mh(e,t,r,i,n,a,o,s,u,l,f,h,d,v,c,_){var g=o+s+Math.ceil(v/2)+1;t.x=r;t.y=i;t.opacity=a;t.minVisibleSize=d;t.symbolicSize=n;t.x=r;t.y=i;t.opacity=a;t.minVisibleSize=d;t.symbolicSize=n;t.offsetScaled=n;t.offsetAbsolute=g;t.offsetAffectedByAngle=false;t.offsetAngle=ro[h];t.angle=io[h];t.lengthScaled=0;t.lengthAbsolute=v;t.thicknessScaled=0;t.thicknessAbsolute=v*eo;t.fillColor=_;t.strokeColor=null;t.strokeWidthAbsolute=0;t.strokeWidthScaled=0;t.pattern.type=Qs;t.shape="triangle";t.strokeMinVisibleSize=0;t.angleAffectedByView=false;t.shapeStart=0;t.shapeEnd=1;t.dashLength=0;t.gapLength=0;t.dashOffset=0;t.adjustAngle=false;t.isSelfLoop=false;t.curvature=0}function bh(e,t,r,i,n,a,o,s,u,l,f,h,d,v,c,_,g,p,y,m,b,x,A,w){var S=p+y,E=v?s*d:h,T=A*E/2;t.x=i;t.y=n;t.opacity=o;t.minVisibleSize=g;t.symbolicSize=s;t.angle=a;t.angleAffectedByView=true;t.thicknessScaled=0;t.thicknessAbsolute=0;t.offsetScaled=s/2;t.offsetAbsolute=S;t.offsetAffectedByAngle=true;t.offsetAngle=r;if(v){t.thicknessScaled+=E;t.offsetScaled+=T}else{t.thicknessAbsolute+=E;t.offsetAbsolute+=T}t.pattern.type=nu;t.pattern.attributes.text=u;t.pattern.attributes.font=l;t.pattern.attributes.size="sdf";t.pattern.attributes.style=c;t.pattern.attributes.align=_;t.pattern.attributes.pixelRatio=e.pixelRatio;t.patternMinVisibleSize=0;t.patternScale=1;t.patternSdf=true;t.patternMask=f;t.lengthScaled=0;t.lengthAbsolute=0;t.shape="square";t.fillColor=null;t.strokeColor=null;t.strokeWidthAbsolute=0;t.strokeWidthScaled=0;t.strokeMinVisibleSize=0;t.shapeStart=0;t.shapeEnd=1;t.dashLength=0;t.gapLength=0;t.dashOffset=0;t.adjustAngle=true;t.isSelfLoop=false;t.curvature=0;if(b&&!v&&w>0){t.strokeWidthScaled=x*h/w}}function xh(e,t,r,i,n,a,o,s,u,l,f,h,d,v,c,_,g,p,y,m,b,x,A){var w=g+p,S=v?s*d:h,E=b*S,T=x*S;t.x=i;t.y=n;t.opacity=o;t.minVisibleSize=_;t.symbolicSize=s;t.angle=a;t.angleAffectedByView=true;t.fillColor=y;t.strokeColor=null;t.strokeWidthAbsolute=0;t.lengthScaled=0;t.thicknessScaled=0;t.lengthAbsolute=p*2;t.thicknessAbsolute=p*2;t.offsetScaled=s/2;t.offsetAbsolute=w;t.offsetAffectedByAngle=true;t.offsetAngle=r;if(v){t.lengthScaled+=E;t.thicknessScaled+=T;t.offsetScaled+=T/2}else{t.lengthAbsolute+=E;t.thicknessAbsolute+=T;t.offsetAbsolute+=T/2}t.pattern.type=Qs;t.shape="square";t.strokeMinVisibleSize=0;t.strokeWidthScaled=0;t.shapeStart=0;t.shapeEnd=1;t.dashLength=0;t.gapLength=0;t.dashOffset=0;t.adjustAngle=true;t.isSelfLoop=false;t.curvature=0;if(m&&!v&&A>0){t.strokeWidthScaled=b*h/A}}function Ah(e,t,r,i){var n=1-e;return n*n*t+2*n*e*i+e*e*r}function wh(e,t,r,i,n){var a=1-e,o=a*a,s=o*a,u=e*e,l=u*e;return s*t+3*o*e*i+3*a*u*n+l*r}function Sh(e,t){return e+Math.log(e+1)*t}function Eh(value){return value===null?"":value.toString()}function Th(e,t){if(t===void 0)t={};var r=Math.ceil(Math.log2(e)+1|0);var i=r*Fa+ka;t.edgeHalo=Ta;t.nodeHaloStroke=Ma;t.nodeHalo=Ca;t.edgeBody=i+Na;t.edgeTextBackground=i+Ia;t.edgeText=i+za;t.nodeBody=i+La;t.nodeTextBackground=i+Ra;t.nodeText=i+Da;return t}function Mh(e){var t=e.getDepth();if(t===Ca||t===Ma){return true}return(t-ka)%Fa>=La}function Ch(e){var t=(e.getDepth()-ka)%Fa;return t!==Na&&t!==La}var kh=function e(t,r,i){this._graphics=t;this._isNode=r;this._id=i;this._deleted=false};kh.prototype._checkDeleted=function e(){if(this._deleted){throw new Error("the rule is deleted")}};kh.prototype.whenApplied=function e(){this._checkDeleted();return this._graphics.resolveAtNextFrame(this)};kh.prototype.refresh=function e(){this._checkDeleted();this._graphics._refreshRules(this._isNode);return this._graphics.resolveAtNextFrame(this)};kh.prototype.getIndex=function e(){this._checkDeleted();return this._graphics._getRuleIndex(this._isNode,this._id)};kh.prototype.setIndex=function e(t){this._checkDeleted();this._graphics._setRuleIndex(this._isNode,this._id,t);return this._graphics.resolveAtNextFrame(this)};kh.prototype.destroy=function e(){this._checkDeleted();this._graphics._removeRule(this._isNode,this._id);this._deleted=true;return this._graphics.resolveAtNextFrame(this)};kh.prototype.delete=function e(){return this.destroy()};b.extend(function(e){var t=new Bh(e),r=e.modules.camera;var i=e.Node;var n=e.Edge;var a=e.NodeList;var o=e.EdgeList;e.modules.graphics=t;e.reloadFonts=function(){t.reloadFonts()};e.view.getImageData=function(){return t.getImageData()};e.events.onRendererStatusChange=function(t){e.modules.events.on("rendererStatusChange",t);return e.events};e.styles.setNodesVisibility=function(value){return t.setNodesVisibility(value)};e.styles.setEdgesVisibility=function(value){return t.setEdgesVisibility(value)};e.styles.setNodeTextsVisibility=function(value){return t.setNodeTextsVisibility(value)};e.styles.setEdgeTextsVisibility=function(value){return t.setEdgeTextsVisibility(value)};i.prototype.setAttributes=function(e,r){return t.setMultipleAttributes(this,e,r)};i.prototype.setAttribute=function(e,value,r){return t.setSingleAttribute(this,e,value,r)};i.prototype.resetAttributes=function(e){return t.resetAttributes(this,e)};i.prototype.getAttributes=function(e){return t.getMultipleAttributes(this,e)[0]};i.prototype.getAttribute=function(e){return t.getSingleAttribute(this,e)[0]};a.prototype.setAttributes=function(e,r){return t.setMultipleAttributes(this,e,r)};a.prototype.setAttribute=function(e,r,i){return t.setSingleAttribute(this,e,r,i)};a.prototype.getAttributes=function(e){return t.getMultipleAttributes(this,e)};a.prototype.getAttribute=function(e){return t.getSingleAttribute(this,e)};a.prototype.resetAttributes=function(e){return t.resetAttributes(this,e)};n.prototype.setAttributes=function(e,r){return t.setMultipleAttributes(this,e,r)};n.prototype.setAttribute=function(e,value,r){return t.setSingleAttribute(this,e,value,r)};n.prototype.getAttributes=function(e){return t.getMultipleAttributes(this,e)[0]};n.prototype.getAttribute=function(e){return t.getSingleAttribute(this,e)[0]};n.prototype.resetAttributes=function(e){return t.resetAttributes(this,e)};o.prototype.setAttributes=function(e,r){return t.setMultipleAttributes(this,e,r)};o.prototype.setAttribute=function(e,value,r){return t.setSingleAttribute(this,e,value,r)};o.prototype.getAttributes=function(e){return t.getMultipleAttributes(this,e)};o.prototype.getAttribute=function(e){return t.getSingleAttribute(this,e)};o.prototype.resetAttributes=function(e){return t.resetAttributes(this,e)};i.prototype.getPosition=function(){return this.getAttributes(["x","y"])};a.prototype.getPosition=function(){return this.getAttributes(["x","y"])};i.prototype.getPositionOnScreen=function(){return r.graphToScreenCoordinates(this.getPosition())};i.prototype.isInScreen=function(){var e=this.getPositionOnScreen();return e.x>=0&&e.x<=r.width&&e.y>=0&&e.y<=r.height};n.prototype.getCurvature=function(){return t.getCurvature(this)[0]};o.prototype.getCurvature=function(){return t.getCurvature(this)};e.styles.addNodeRule=function(e,r){return t.addNodeRule(e,r)};e.styles.addEdgeRule=function(e,r){return t.addEdgeRule(e,r)};e.styles.getNodeRules=function(){return t.getNodeRules()};e.styles.getEdgeRules=function(){return t.getEdgeRules()};Nh([i,n,a,o],"setStyle","setAttributes");Nh([i,n,a,o],"resetStyle","resetAttributes");Nh([i,n,a,o],"getStyle","getAttribute");Nh([i,a],"setPosition","setAttributes")});function Nh(e,t,r){for(var i=0;i<e.length;++i){var n=e[i];n.prototype[t]=function(e,i){at('Deprecated method "'+t+'"; please use "'+r+'" instead.');return this[r](e,i)}}}var Ih="anonymous";var zh="white";var Lh="default";var Rh={maxBlockId:1024,maxScaledSize:16,maxPixelSize:255,maxMinVisibleSize:16,maxDashOffset:4,maxDashLength:3,maxGapLength:1};b.atInit(function(e,t){if(t.renderer!==undefined){e.setOptions({renderer:t.renderer})}if(t.imgCrossOrigin!==undefined){e.setOptions({imgCrossOrigin:t.imgCrossOrigin})}});Xr(function(){b.instances.forEach(Dh)});Wr(function(){b.instances.forEach(Fh)});b.onDestroy(Fh);function Dh(e){e.reloadFonts()}function Fh(e){e.modules.graphics.getGraphicsEngine().destroy()}var Ph=typeof window==="undefined"||window.__OGMA_HEADLESS?null:"webgl";var Bh=function e(t){var r=this;this._ogma=t;this._debug=t._debug;this._events=t.modules.events;this._dom=t.modules.dom;this._graph=t.modules.graph;this._camera=t.modules.camera;this._events=t.modules.events;this._settings=t.modules.settings;this._imageManager=new Nf;this._engine=new Mf;this._domElement=this._engine.getDomElement();this._animations=[];this._refreshNodeRules=false;this._refreshEdgeRules=false;this._nodeRules=[];this._edgeRules=[];this._cursorStyle=[];this._initDone=false;this._rendererStatus={type:null,code:null,state:null,message:null};this._events.register(["reloadFonts","rendererStatusChange"]);this._events.register(["nodeAttributesChanged","edgeAttributesChanged"]);this._settings.register("renderer",Ph,function(e){r._updateRendererState({type:e,state:"requested",code:null,message:null});r._dom.refresh()});this._dom.setLayer("graphics",this._domElement);this._dom.beforeNextFrame().then(function(){r._initDone=true;r._fireRendererStatusChangeEvent()});this._nodeStyleAttributes=Wt(Of,function(e){return"default"in e});this._edgeStyleAttributes=Wt(jf,function(e){return"default"in e});this._nodeStyleAttributeAliases=Vf;this._edgeStyleAttributeAliases=Gf;this._engine.setGlobalBoundaries(Rh);this._elts=ht(new Lf({ogma:t,settings:this._settings._currentValue,engine:this._engine,imageManager:this._imageManager,isNode:true,attributes:this._nodeStyleAttributes,aliases:this._nodeStyleAttributeAliases}),new Lf({ogma:t,settings:this._settings._currentValue,engine:this._engine,imageManager:this._imageManager,isNode:false,attributes:this._edgeStyleAttributes,aliases:this._edgeStyleAttributeAliases}));this._elts.nodes._edges=this._elts.edges;this._elts.edges._nodes=this._elts.nodes;this._elts.nodes.onAttributesComputed(function(e){r._events.fire("nodeAttributesChanged",e)});this._elts.edges.onAttributesComputed(function(e){r._events.fire("edgeAttributesChanged",e)});this._visibility={nodes:0,edges:0,nodeTexts:0,edgeTexts:0};this._boundaries={maxSize:-1,maxMinVisibleSize:-1};this._isBufferDisplayable=function(e){var t=Mh(e);var i=Ch(e);var n=t?r._visibility.nodes:r._visibility.edges;var a=t?r._visibility.nodeTexts:r._visibility.edgeTexts;var o=n===0;var s=!i||a===0;return o&&s};this._imageManager.onFetch(function(){r._engine.notifyPatternUpdate();r._dom.refresh()});this._events.on({cameraMove:function(){return r._dom.refresh()},beforeNewFrame:function(){var e=oe();r._resolveAnimations(function(t){var r=t.resolveTime;return r<=e})},newFrame:function(){r._loadGraphInGraphicsEngine();r._render()},clear:function(){r._nextGeIndex=1;r._availableGeIndexes=[];r._engine.clear();r.refreshAll()},viewChanged:function(e){var t=e.type;if(t==="rotate"){var i=r._ogma.getEdges().filter(function(e){return e.getAttribute("adjustAnchors")});r._elts.edges.refresh(i._indexes)}},"addNodes addEdges nodeAttributesChanged edgeAttributesChanged":function(e){var t=e.attributes;if(!t||t.includes("radius")||t.includes("width")){r._boundaries.maxSize=-1}if(!t||t.some(function(e){return e.indexOf("minVisibleSize")!==-1})){r._boundaries.maxMinVisibleSize=-1}}});this._settings.register("imgCrossOrigin",Ih,function(){return r._updateImageCrossOrigin()});this._settings.register("backgroundColor",zh,function(){return r._dom.refresh()});this._settings.register("cursor.default",Lh,function(){return r._applyCursorStyle()});this._settings.register("edgesAlwaysCurvy",false,function(){return r._elts.edges.updateAllCurvatures()});this._settings.register("directedEdges",false,function(){return r._elts.edges.updateAllCurvatures()});this._nextGeIndex=1;this._availableGeIndexes=[]};Bh.prototype._render=function e(){var t=this._settings.get("renderer");var r=this._dom.getDimensions();var i=this._camera.getView();var n=Tr();var a=oe();var o=this._settings.get("backgroundColor");var s=this._isBufferDisplayable;this._engine.setView({x:i.x,y:i.y,zoom:i.zoom,angle:i.angle,width:r.width,height:r.height,pixelRatio:n,currentTime:a,backgroundColor:o,isBufferDisplayable:s});this._engine.setRenderType(t);try{this._engine.render();if(this._rendererStatus.state==="requested"){this._updateRendererState({state:"ok"})}}catch(e){if(this._debug){throw e}var u=e.code;if(u===void 0)u="OTHER";var l=e.message;var f=this._formatRendererName(t);var h=this._rendererStatus.state==="requested";var d="Error while initializing the "+f+" renderer";var v="The "+f+" renderer encountered an unexpected runtime error";var c=h?d:v;var _=null;if(t==="webgl"){c+="; fallbacking on canvas renderer";_="canvas"}at(l);at(c);this._updateRendererState({state:"error",code:u,message:l});this._settings.set("renderer",_)}};Bh.prototype._formatRendererName=function e(t){if(t==="webgl"){return"WebGL"}else if(t==="svg"){return"SVG"}else{return t}};Bh.prototype._fireRendererStatusChangeEvent=function e(){var t={type:this._rendererStatus.type,state:this._rendererStatus.state,code:this._rendererStatus.code,message:this._rendererStatus.message};this._events.fire("rendererStatusChange",t)};Bh.prototype._updateRendererState=function e(t){var r=t.type;var i=t.state;var n=t.code;var a=t.message;var o=false;if(r!==undefined&&this._rendererStatus.type!==r){this._rendererStatus.type=r;o=true}if(i!==undefined&&this._rendererStatus.state!==i){this._rendererStatus.state=i;o=true}if(n!==undefined&&this._rendererStatus.code!==n){this._rendererStatus.code=n;o=true}if(a!==undefined&&this._rendererStatus.message!==a){this._rendererStatus.message=a;o=true}if(o&&this._initDone){this._fireRendererStatusChangeEvent()}};Bh.prototype.getImageData=function e(){var t=this;return this._dom.afterNextFrame().then(function(){return t._engine.getImageData()})};Bh.prototype.addCanvas=function e(t){this._engine.addCanvas(t)};Bh.prototype.removeCanvas=function e(t){this._engine.removeCanvas(t)};Bh.prototype.getNodeAttributes=function e(){return this._elts.nodes.getAttributeContainers()};Bh.prototype.getEdgeAttributes=function e(){return this._elts.edges.getAttributeContainers()};Bh.prototype.getGraphicsEngine=function e(){return this._engine};Bh.prototype.allocateGraphicsEngineBlockId=function e(){if(this._availableGeIndexes.length){return this._availableGeIndexes.pop()}else{return this._nextGeIndex++*Ea+Sa}};Bh.prototype.releaseGraphicsEngineBlockId=function e(t){this._engine.freeBlock(t);this._availableGeIndexes.push(t);this._dom.refresh()};Bh.prototype.addCursorStyle=function e(t){if(!t){return}this._cursorStyle.push(t);this._applyCursorStyle()};Bh.prototype.removeCursorStyle=function e(t){if(!t){return}var r=this._cursorStyle.lastIndexOf(t);if(r!==-1){this._cursorStyle.splice(r,1);this._applyCursorStyle()}};Bh.prototype._applyCursorStyle=function e(){var t=this._cursorStyle[this._cursorStyle.length-1]||this._settings.get("cursor.default");Ur(this._domElement,t)};Bh.prototype.reloadFonts=function e(){this._events.fire("reloadFonts");this._engine.notifyFontsReloaded();this._dom.refresh()};Bh.prototype._updateImageCrossOrigin=function e(){this._imageManager.setImgCrossOrigin(this._settings.get("imgCrossOrigin"))};Bh.prototype.getDomElement=function e(){return this._domElement};Bh.prototype._computeMaxSize=function e(){var t=Math.max(De(this._ogma.getNodes("all").getAttribute("radius"))*2,De(this._ogma.getEdges("all").getAttribute("width")));return isFinite(t)?t:10};Bh.prototype._computeMaxMinVisibleSize=function e(){var t=this._graph.getAllAttributes().filter(function(e){var t=e.getName();return t&&t.indexOf("minVisibleSize")!==-1});return De(t.map(function(e){return De(e.getValues())}))};Bh.prototype._loadGraphInGraphicsEngine=function e(){if(this._refreshNodeRules){this.refreshRules(this._ogma.getNodes());this._refreshNodeRules=false}if(this._refreshEdgeRules){this.refreshRules(this._ogma.getEdges());this._refreshEdgeRules=false}if(this._boundaries.maxSize===-1){this._boundaries.maxSize=this._computeMaxSize()}if(this._boundaries.maxMinVisibleSize===-1){this._boundaries.maxMinVisibleSize=this._computeMaxMinVisibleSize()}$f({engine:this._engine,imageManager:this._imageManager,graph:this._elts,view:this._camera.getView(),boundaries:this._boundaries})};Bh.prototype._forceCompleteGraphRefresh=function e(){this.refreshAll();this._loadGraphInGraphicsEngine()};Bh.prototype.export=function e(t,r,i,n){var a=this;var o;return this._imageManager.whenReady().then(function(){if(i==="all"){o=Wh(a._ogma);a._forceCompleteGraphRefresh()}else{a._loadGraphInGraphicsEngine()}return a._engine.export(t,r,n)}).then(function(e){if(i==="all"){Hh(o);a._forceCompleteGraphRefresh()}return e})};Bh.prototype.refreshAll=function e(){this._elts.nodes.refreshAll();this._elts.edges.refreshAll()};Bh.prototype.computeCurvatures=function e(){this._elts.edges.computeCurvatures()};Bh.prototype.resolveAtNextFrame=function e(t){return this._dom.afterNextFrame().then(function(){return t})};Bh.prototype.isAnimating=function e(){return this._animations.length>0};Bh.prototype.getAnimation=function e(t){return this._addAnimation(t,this._getAnimationResolveTime(t))};Bh.prototype._assignAnimationAttributes=function e(t,r,i,n){this._elts.fetch(t.isNode).setAnimationProperties(t._indexes,{start:r,duration:i,easing:n})};Bh.prototype._assignAnimationEndAttribute=function e(t,r){this._elts.fetch(t.isNode).setAnimationEnd(t._indexes,r)};Bh.prototype._resolveAnimations=function e(t){var r=[],i=[];this._animations.forEach(function(e){if(t(e)){r.push(e)}else{i.push(e)}});this._animations=i;r.forEach(function(e){var t=e.resolve;var r=e.elements;return t(r)})};Bh.prototype._getAnimationResolveTime=function e(t){var r=t.isNode,i=t._indexes,n=this._elts.fetch(r)._animationEndList,a=0;for(var o=0;o<i.length;++o){a=Math.max(a,n.get(i[o]))}return a};Bh.prototype._addAnimation=function e(t,r){var i=this;return new Promise(function(e){i._animations.push({resolveTime:r,resolve:e,elements:t});return t})};Bh.prototype._animate=function e(t,r,i){var n=this;var a=this._elts.fetch(t.isNode);var o=jh(i);var s=o.duration;var u=o.easing;var l=o.chain;var f=oe();var h=l?Math.max(this._getAnimationResolveTime(t),f):f;var d=h+s;if(!l){this._resolveAnimations(function(e){return Vh(t,e.elements)})}this._assignAnimationEndAttribute(t,d);var v=function(){n._dom.refresh();n._assignAnimationAttributes(t,h,s,u);return r(t)};if(h===f&&s===0){var c=v(t);a.saveCurrentAttributes(t._indexes,c);return Promise.resolve(t)}else{this._dom.refresh(d);return this._addAnimation(t,h).then(v).then(function(e){return n._addAnimation(t,d).then(function(t){a.saveCurrentAttributes(t._indexes,e);a.resetAnimationDuration(t._indexes);a.refresh(t._indexes);return t})})}};Bh.prototype.setMultipleAttributes=function e(t,r,i){var n=this;return this._animate(t,function(e){return n._setMultipleAttributes(e,r)},i)};Bh.prototype.setSingleAttribute=function e(t,r,value,i){var n=this;return this._animate(t,function(e){return n._setSingleAttribute(e,r,value)},i)};Bh.prototype._setMultipleAttributes=function e(t,r){return this._elts.fetch(t.isNode).setMultipleAttributes(t._indexes,r)};Bh.prototype._setSingleAttribute=function e(t,r,value){return this._elts.fetch(t.isNode).setSingleAttribute(t._indexes,r,value)};Bh.prototype.resetAttributes=function e(t,r){return this._elts.fetch(t.isNode).resetAttributes(t._indexes,r)};Bh.prototype.getSingleAttribute=function e(t,r){return this._elts.fetch(t.isNode).getSingleAttribute(t._indexes,r)};Bh.prototype.getMultipleAttributes=function e(t,r){return this._elts.fetch(t.isNode).getMultipleAttributes(t._indexes,r)};Bh.prototype.getCurvature=function e(t){return this._elts.edges.getCurvature(t._indexes)};Bh.prototype.hideTexts=function e(){this.setNodeTextsVisibility(false);this.setEdgeTextsVisibility(false)};Bh.prototype.showTexts=function e(){this.setNodeTextsVisibility(true);this.setEdgeTextsVisibility(true)};Bh.prototype.setNodesVisibility=function e(value){return this._updateVisibilityCounter("nodes",value)};Bh.prototype.setNodeTextsVisibility=function e(value){return this._updateVisibilityCounter("nodeTexts",value)};Bh.prototype.setEdgesVisibility=function e(value){return this._updateVisibilityCounter("edges",value)};Bh.prototype.setEdgeTextsVisibility=function e(value){return this._updateVisibilityCounter("edgeTexts",value)};Bh.prototype._updateVisibilityCounter=function e(t,value){this._visibility[t]+=value?-1:1;this._dom.refresh()};Bh.prototype.addLayer=function e(t,r){if(r===void 0)r={};var i=r.nodeAttributes;var n=r.edgeAttributes;var a=r.depth;this._elts.nodes.addLayer(t,a,i);this._elts.edges.addLayer(t,a,n)};Bh.prototype.resetLayerStyle=function e(t,r){if(r===void 0)r={};var i=r.nodeAttributes;var n=r.edgeAttributes;if(i){this._elts.nodes.setLayerAttributes(t,i)}if(n){this._elts.edges.setLayerAttributes(t,n)}};Bh.prototype.updateLayerAttributes=function e(t,r){if(r===void 0)r={};var i=r.nodeAttributes;var n=r.edgeAttributes;if(i){this._elts.nodes.updateLayerAttributes(t,i)}if(n){this._elts.edges.updateLayerAttributes(t,n)}};Bh.prototype.putOnLayer=function e(t,r,i){var n=this;return this._animate(t,function(e){return n._elts.fetch(e.isNode).putOnLayer(e._indexes,r)},i)};Bh.prototype.removeFromLayer=function e(t,r,i){var n=this;return this._animate(t,function(e){return n._elts.fetch(e.isNode).removeFromLayer(e._indexes,r)},i)};Bh.prototype.addNodeRule=function e(t,r){return this._addRule(true,t,r)};Bh.prototype.addEdgeRule=function e(t,r){return this._addRule(false,t,r)};Bh.prototype.getNodeRules=function e(){return this._getRules(true)};Bh.prototype.getEdgeRules=function e(){return this._getRules(false)};Bh.prototype._refreshRules=function e(t){this[t?"_refreshNodeRules":"_refreshEdgeRules"]=true;this._dom.refresh()};Bh.prototype._addRule=function e(t,r,i){var n=this._elts.fetch(t).addRule(r,i),a=new kh(this,t,n);this[t?"_nodeRules":"_edgeRules"][n]=a;this._refreshRules(t);return a};Bh.prototype._removeRule=function e(t,r){this._elts.fetch(t).removeRule(r);this[t?"_nodeRules":"_edgeRules"][r]=undefined;this._refreshRules(t)};Bh.prototype._getRuleIndex=function e(t,r){return this._elts.fetch(t).getRuleIndex(r)};Bh.prototype._setRuleIndex=function e(t,r,i){this._elts.fetch(t).setRuleIndex(r,i);this._refreshRules(t)};Bh.prototype._getRules=function e(t){var r=this[t?"_nodeRules":"_edgeRules"];return this._elts.fetch(t).getRuleIds().map(function(e){return r[e]})};Bh.prototype.refreshRules=function e(t){var r=this;return this._animate(t,function(e){return r._elts.fetch(e.isNode).refreshRules(e._indexes)})};Bh.prototype.getRuleListForAttribute=function e(t,r){return this._elts.fetch(t).getRuleListForAttribute(r)};Bh.prototype.detectNode=function e(t){var r=this;var i=t.position;var n=t.margin;var a=t.texts;var o=this._engine,s=this._graph._allIndexes(true),u=this._graph._nodes,l=this._elts.nodes.getAttributeContainers(),f=l.excluded,h=l.animationDuration,d=l.x,v=l.y,c=l.radius,_=l.shape,g=l["innerStroke.width"],p=l["innerStroke.width"],y=l["text.hidden"],m=l["text.content"],b=l["text.margin"],x=l["text.padding"],A=l["text.position"],w=l["text.size"],S=l["text.scale"],E=l["text.scaling"],T=l["text.font"],M=l["text.style"],C=l["text.minVisibleSize"],k=l["text.maxLineLength"],N=0;var I=this._camera.getZoom(),z=i.x,L=i.y;var R={left:{x:-1,y:0},right:{x:1,y:0},top:{x:0,y:-1},bottom:{x:0,y:1},center:{x:0,y:0}};for(var D=0;D<s.length;++D){var F=s[D];if(!f.get(F)&&h.get(F)===0){var P=d.get(F),B=v.get(F),O=r._camera.graphToScreenCoordinates({x:P,y:B}),V=O.x,j=O.y,U=_.get(F),G=c.get(F)*I,X=G+n,W=(z-V)/X,H=(L-j)/X;if(o.checkShapeHit(U,W,H)){N=F}else if(a){var Y=Oh(m.get(F)),q=y.get(F),Z=C.get(F),$=G*2;if(!q&&Y&&$>=Z){Y=Xf(Y,k.get(F));var K=g.get(F),J=p.get(F),Q=b.get(F),ee=x.get(F),te=w.get(F),re=S.get(F),ie=E.get(F),ne=T.get(F),ae=M.get(F),oe=A.get(F),se=o.measureText(Y,ne,ae),ue=ie?re*G:te,le=se.width*ue/2+ee+n,fe=se.height*ue/2+ee+n,he=R[oe];var de=K+J+Q+G,ve=(de+le)*he.x,ce=(de+fe)*he.y,_e=V+ve,ge=j+ce,pe=_e-le,ye=_e+le,me=ge-fe,be=ge+fe;if(z>pe&&z<ye&&L>me&&L<be){N=F}}}}}return u.get(N)||null};Bh.prototype.detectEdge=function e(t){var r=t.position;var i=t.margin;var n=this._engine,a=this._graph._allIndexes(false),o=this._graph._edges,s=this._elts.edges.getAttributeContainers(),u=this._elts.nodes.getAttributeContainers(),l=s.excluded,f=s.animationDuration,h=u.x,d=u.y,v=u.radius,c=u.shape,_=s.source,g=s.target,p=s.curvature,y=s.width,m=s["shape.type"],b=s["shape.head"],x=s["shape.tail"],A=s["text.content"],w=s["text.margin"],S=s["text.padding"],E=s["text.position"],T=s["text.size"],M=s["text.font"],C=s["text.style"],k=s["text.minVisibleSize"],N=0,I={},z={},L=this._camera.getZoom(),R=i/L,D=this._camera.screenToGraphCoordinates(r),F=D.x,P=D.y;for(var B=0;B<a.length;++B){var O=a[B];if(!l.get(O)&&f.get(O)===0){var V=_.get(O),j=g.get(O),U=V===j,G=p.get(O),X=m.get(O),W=b.get(O),H=x.get(O),Y=y.get(O),q=h.get(V),Z=d.get(V),$=v.get(V),K=h.get(j),J=d.get(j),Q=v.get(j);I.width=Y;I.shapeStyle="plain";I.shapeTail=H;I.shapeHead=W;I.isSelfLoop=U;I.shapeType=X;I.sourceX=q;I.sourceY=Z;I.targetX=K;I.targetY=J;I.sourceRadius=$;I.targetRadius=Q;I.curvature=G;var ee=Jf(I,z);var te=ee.bodyType;var re=ee.curveControl1X;var ie=ee.curveControl1Y;var ne=ee.curveControl2X;var ae=ee.curveControl2Y;var oe=ee.curveStartX;var se=ee.curveStartY;var ue=ee.curveEndX;var le=ee.curveEndY;var fe=te==="triangle";if(U){if(ho(F,P,oe,se,ue,le,re,ie,ne,ae,Y,R)){N=O}}else if(G!==0){if(uo(F,P,oe,se,ue,le,re,ie,Y,R,fe)){N=O}}else{if(yi(F,P,oe,se,ue,le,Y,R,fe)){N=O}}}}return o.get(N)||null};Bh.prototype._getAttributeArray=function e(t,r){return this._elts.fetch(t).getAttributeArray(r)};Bh.prototype.getNbCurvedEdges=function e(){return this._elts.edges.nbCurvedEdges()};function Oh(e){return e===null?"":e.toString()}function Vh(e,t){if(e===t){return true}if(e.isNode!==t.isNode){return false}for(var r=0;r<e._indexes.length;++r){var i=e._indexes[r];for(var n=0;n<t._indexes.length;++n){if(i===t._indexes[n]){return true}}}return false}function jh(e){if(typeof e==="number"){e={duration:e}}else if(typeof e!=="object"||e===null){e={}}return{duration:Uh(e.duration),easing:e.easing||"linear",chain:!!e.chain}}function Uh(e){if(typeof e!=="number"||!isFinite(e)||e<0){return 0}else{return e}}function Gh(e,t){var r=e.modules.graph.getAttribute(t,"excluded"),i=(t?e.getNodes("all"):e.getEdges("all"))._indexes,n=r.getMultiple(i);r.fill(i,0);return{excludedList:r,indexes:i,values:n}}function Xh(e){var t=e.excludedList;var r=e.indexes;var i=e.values;t.setMultiple(r,i)}function Wh(e){return{nodes:Gh(e,true),edges:Gh(e,false)}}function Hh(e){var t=e.nodes;var r=e.edges;Xh(t);Xh(r)}var Yh=function e(t){this._graph=t.modules.graph;this._camera=t.modules.camera;this._graphics=t.modules.graphics;this._settings=t.modules.settings};Yh.prototype.getNodesInScreenByDistance=function e(t){var r=t.getPositionOnScreen();var i=r.x;var n=r.y;return this._graph.getNodes().filter(function(e){return e.isInScreen()&&e!==t}).sort(function(e,t){var r=e.getPositionOnScreen(),a=t.getPositionOnScreen();return distance(r.x,r.y,i,n)-distance(a.x,a.y,i,n)})};Yh.prototype.getNearestNodesForNode=function e(t,r,i){if(r===void 0)r=240;var n=t.getPosition();var a=n.x;var o=n.y;return this.getNearestNodes(a,o,r,i,t)};Yh.prototype.getNearestNodes=function e(t,r,i,n,a){if(n){var o=this._camera.screenToGraphVector({x:i,y:i});i=distance(0,0,o.x,o.y)}return this._getNearestNodes(t,r,i,a)};Yh.prototype._getNearestNodes=function e(t,r,i,n){var a=[];var o=i*i;var s=n?n._index:0;var u=this._graph._getIndexes(true);var l=this._graph.getAttributes(true,["excluded","x","y"]);var f=l[0];var h=l[1];var d=l[2];for(var v=0,c=u.length;v<c;v++){var _=u[v];if(_===s||f.get(_)){continue}var g=t-h._buffer[_],p=r-d._buffer[_];if(g*g+p*p<=o){a.push(_)}}return new this._graph.NodeList(a)};Yh.prototype.getPointsForEdge=function e(t,r){if(r===void 0)r=false;var i=10;var n=this._graph.getEdgeAttribute("curvature"),a=t.getSource(),o=t.getTarget(),s=a.getPosition(),u=o.getPosition(),l=n.get(t._index),f=s,h=u,d;if(r){f=this._camera.graphToScreenCoordinates(f);h=this._camera.graphToScreenCoordinates(h)}if(l===0&&a!==o){d=[f,h]}else{d=new Array(i);if(a!==o){var v={};if(r){v=this._camera.graphToScreenCoordinates(v)}for(var c=0;c<i;++c){d[c]=so(c/(i-1),f.x,f.y,h.x,h.y,v.x,v.y)}}else{var _={x1:0,y1:0,x2:0,y2:0},g={x:_.x1,y:_.y1},p={x:_.x2,y:_.y2};if(r){g=this._camera.graphToScreenCoordinates(g);p=this._camera.graphToScreenCoordinates(p)}for(var y=0;y<i;++y){d[y]=fo(y/(i-1),f.x,f.y,h.x,h.y,g.x,g.y,p.x,p.y)}}}return d};Yh.prototype.getNodesByBoundingBox=function e(t,r,i,n,a){if(a){var o;o=this._camera.screenToGraphVector({x:t,y:r});t=o.x;r=o.y;o=this._camera.screenToGraphVector({x:i,y:n});i=o.x;n=o.y}var s=this._graph;var u=s._getIndexes(true);var l=[];var f=s.getAttributes(true,["excluded","x","y"]);var h=f[0];var d=f[1];var v=f[2];for(var c=0,_=u.length;c<_;c++){var g=u[c];if(h.get(g)){continue}var p=d._buffer[g],y=v._buffer[g];if(p>=t&&p<=i&&y>=r&&y<=n){l.push(g)}}return new s.NodeList(l)};b.extend(function(e){var t=new Yh(e);e.modules.spatial=t});b.extend(function(e){e.modules.ruleRefresher=new qh(e)});var qh=function e(t){var r=this;this._graph=t.modules.graph;this._graphics=t.modules.graphics;this._events=t.modules.events;this._stylesAndFilters={styles:true,filters:true};this._events.on({updateNodeData:function(e){var t=e.nodes;return Zh(r,t,r._stylesAndFilters)},"updateEdgeData addEdges":function(e){var t=e.edges;return $h(r,t,r._stylesAndFilters)},beforeRemoveEdges:function(e){var i=e.edges;var n=i.getSource().concat(i.getTarget()).dedupe();setTimeout(function(){var e=t.getNodes(n);r._graph._refreshFilterRules(true,e._indexes);r._graphics.refreshRules(e)},0)}})};qh.prototype.refreshFilters=function e(){$h(this,this._graph.getEdges(),{filters:true});Zh(this,this._graph.getNodes(),{filters:true})};function Zh(e,t,r){var i=r.styles;var n=r.filters;var a=t.getAdjacentNodes({includeSources:true,filter:"all"}),o=t.getAdjacentEdges({filter:"all"});if(n){e._graph._refreshFilterRules(true,a._indexes);e._graph._refreshFilterRules(false,o._indexes)}if(i){e._graphics.refreshRules(a);e._graphics.refreshRules(o)}}function $h(e,t,r){var i=r.styles;var n=r.filters;var a=t.getSource().concat(t.getTarget()).dedupe(),o=t;if(n){e._graph._refreshFilterRules(true,a._indexes);e._graph._refreshFilterRules(false,o._indexes)}if(i){e._graphics.refreshRules(a);e._graphics.refreshRules(o)}}b.extend(function(e){var t=new Jh(e);e.modules.watcher=t;e.schema={watchNodeObjectProperty:function e(r){return t.watchNodeObjectProperty(r)},watchEdgeObjectProperty:function e(r){return t.watchEdgeObjectProperty(r)},watchNodeNonObjectProperty:function e(r){return t.watchNodeNonObjectProperty(r)},watchEdgeNonObjectProperty:function e(r){return t.watchEdgeNonObjectProperty(r)}}});function Kh(e){if(typeof e!=="object"||e===null||Array.isArray(e)){return{path:Qh(e),filter:"visible",unwindArrays:false}}else{return{path:Qh(e.path),filter:ed(e.filter),unwindArrays:!!e.unwindArrays}}}var Jh=function e(t){var r=this;this._data=t.modules.data;this._graph=t.modules.graph;this._events=t.modules.events;this._propertyWatchers=[];this._objectPropertyWatchers=[];this._toUpdate=[];this._ogma=t;this._events.on({"refreshNodeFilters refreshEdgeFilters":function(e){var t=e.isNode;var i=e.newlyIncluded;var n=e.newlyExcluded;for(var a=0,o=r._propertyWatchers.length;a<o;a++){var s=r._propertyWatchers[a];if(s.isNode===t&&s.filter==="visible"){ad(s,i.getData(s.property));od(s,n.getData(s.property));td(s)}}},"updateNodeData updateEdgeData":function(e){var t=e.isNode;var i=e.changes;for(var n=0;n<r._propertyWatchers.length;++n){var a=r._propertyWatchers[n],o=a.property,s=a.filter==="all";if(a.isNode!==t){continue}for(var u=0;u<i.length;++u){var l=i[u],f=l.property||[],h=id(f,o);if(h){var d=l.nodes||l.edges,v=[],c=[];for(var _=0;_<d.size;++_){var g=d.get(_);if(s||g.isVisible()){v.push(xt(l.newValues[_],h));c.push(xt(l.previousValues[_],h))}}if(v.length){ad(a,v);od(a,c);td(a)}}}}for(var p=0,y=r._objectPropertyWatchers.length;p<y;p++){var m=r._objectPropertyWatchers[p];var b=m._path;var x=function(e){var t=i[e];var r=t.property;var n=t.nodes;var a=t.edges;var o=n||a,s=o.isNode;if(!r||r.length<=b.length+1&&b.every(function(e,t){return e===r[t]})){m._updateSubPropertiesToWatch(s,o)}};for(var A=0;A<i.length;++A)x(A)}},"addNodes addEdges":function(e){var t=e.nodes;var i=e.edges;var n=t||i;var a=function(e){var t=r._propertyWatchers[e],i=t.filter==="all";if(t.isNode===n.isNode){setTimeout(function(){var e=i?n:n.filter(function(e){return e.isVisible()}),r=e.getData(t.property);if(r.length){ad(t,r);td(t)}},0)}};for(var o=0;o<r._propertyWatchers.length;++o)a(o);for(var s=0,u=r._objectPropertyWatchers.length;s<u;s++){r._objectPropertyWatchers[s]._updateSubPropertiesToWatch(n.isNode,n)}},"beforeRemoveNodes beforeRemoveEdges":function(e){var t=e.nodes;var i=e.edges;var n=t||i;var a=function(e){var t=r._propertyWatchers[e],i=t.filter==="all";if(t.isNode===n.isNode){var a=i?n:n.filter(function(e){return e.isVisible()}),o=a.getData(t.property);if(o.length){setTimeout(function(){od(t,o);td(t)},0)}}};for(var o=0;o<r._propertyWatchers.length;++o)a(o)}})};Jh.prototype.watchNodeObjectProperty=function e(t){return this._watchObjectProperty(true,Kh(t))};Jh.prototype.watchEdgeObjectProperty=function e(t){return this._watchObjectProperty(false,Kh(t))};Jh.prototype.watchNodeNonObjectProperty=function e(t){return this._watchNonObjectProperty(true,Kh(t))};Jh.prototype.watchEdgeNonObjectProperty=function e(t){return this._watchNonObjectProperty(false,Kh(t))};Jh.prototype._watchPropertyInformation=function e(t,r,i,n,a){var o=this._findWatcher(t,r,n,a);if(!o){o=this._createWatcher(t,r,n,a)}if(i){o.onChange.push(i)}return o.info};Jh.prototype._unwatchPropertyInformation=function e(t,r,i,n,a){var o=this._findWatcher(t,r,n,a);if(!o){return}var s=o.onChange,u=s.indexOf(i);if(u!==-1){s.splice(u,1);if(s.length===0){var l=this._propertyWatchers.indexOf(o);this._propertyWatchers.splice(l,1)}}};Jh.prototype._watchObjectProperty=function e(t,r){var i=new ld(this,t,r);this._objectPropertyWatchers.push(i);i._updateSubPropertiesToWatch(t,this._graph[t?"getNodes":"getEdges"](r.filter));return i};Jh.prototype._watchNonObjectProperty=function e(t,r){return new fd(this,t,r)};Jh.prototype._findWatcher=function e(t,r,i,n){var a=this;for(var o=0;o<this._propertyWatchers.length;++o){var s=a._propertyWatchers[o];if(s.isNode===t&&s.filter===i&&s.unwindArrays===n&&rd(s.property,r)){return s}}return null};Jh.prototype._createWatcher=function e(t,r,i,n){var a={isNode:t,property:r,nbNumbers:0,nbAny:0,nbTotal:0,values:new vi,boundaries:null,onChange:[],filter:i,unwindArrays:n,info:undefined};a.info=new nd(a);ad(a,this._ogma[t?"getNodes":"getEdges"](i).getData(r));this._propertyWatchers.push(a);return a};function Qh(value){if(value===null||value===undefined){return[]}else{return Se(value)}}function ed(value){return value==="all"?"all":"visible"}function td(e){for(var t=0;t<e.onChange.length;++t){e.onChange[t](e.info)}}function rd(e,t){if(e.length!==t.length){return false}for(var r=0;r<e.length;++r){if(e[r]!==t[r]){return false}}return true}function id(e,t){if(e.length>t.length){return null}for(var r=0;r<e.length;++r){if(e[r]!==t[r]){return null}}return t.slice(r)}var nd=function e(t){this._watcher=t};nd.prototype.isNode=function e(){return this._watcher.isNode};nd.prototype.getPath=function e(){return this._watcher.property.slice()};nd.prototype.getBoundaries=function e(){var t=this._watcher.boundaries;return t?{min:t.min,max:t.max}:null};nd.prototype.getValues=function e(){return this._watcher.values.keys()};nd.prototype.getValueCount=function e(value){return this._watcher.values.get(value)||0};nd.prototype.getCount=function e(){return this._watcher.nbTotal};nd.prototype.getType=function e(){if(this._watcher.nbAny>0){return"any"}else if(this._watcher.nbNumbers>0){return"number"}else{return"undefined"}};function ad(e,t,r){var i=e.values,n=!r&&e.unwindArrays;for(var a=0;a<t.length;++a){var value=t[a];if(!r&&value!==undefined){e.nbTotal+=1}if(n&&Array.isArray(value)){ad(e,value,true)}else{var o=i.get(value);if(o){i.set(value,o+1)}else{i.set(value,1);if(ud(value)){if(!e.boundaries){e.boundaries={min:value,max:value}}else if(value<e.boundaries.min){e.boundaries.min=value}else if(value>e.boundaries.max){e.boundaries.max=value}e.nbNumbers+=1}else if(value!==undefined){e.nbAny+=1}}}}}function od(e,t,r){var i=e.values,n=!r&&e.unwindArrays,a=e.boundaries,o=false;for(var s=0;s<t.length;++s){var value=t[s];if(!r&&value!==undefined){e.nbTotal-=1}if(n&&Array.isArray(value)){o|=od(e,value,true)}else{var u=i.get(value);if(u>1){i.set(value,u-1)}else{i.delete(value);if(ud(value)){e.nbNumbers-=1;if(a&&(a.min===value||a.max===value)){o=true}}else if(value!==undefined){e.nbAny-=1}}}}if(!r&&o){e.boundaries=sd(i.keys())}return o}function sd(e){var t=undefined,r=undefined;for(var i=0;i<e.length;++i){var value=e[i];if(ud(value)){if(t===undefined||value<t){t=value}if(r===undefined||value>r){r=value}}}return t===undefined?null:{min:t,max:r}}function ud(value){return typeof value==="number"&&isFinite(value)}var ld=function e(t,r,i){var n=i.path;var a=i.filter;var o=i.unwindArrays;this._module=t;this._isNode=r;this._path=n;this._filter=a;this._unwindArrays=o;this._propertyList=[];this._properties={};this._onAddHandlers=[];this._onRemoveHandlers=[];this._onUpdateHandlers=[]};ld.prototype.onPropertyAdded=function e(t){this._onAddHandlers.push(t);return this};ld.prototype.onPropertyRemoved=function e(t){this._onRemoveHandlers.push(t);return this};ld.prototype.onPropertyUpdated=function e(t){this._onUpdateHandlers.push(t);return this};ld.prototype.getPath=function e(){return this._path.slice()};ld.prototype.getProperties=function e(){return this._propertyList.slice()};ld.prototype.getPropertyInfo=function e(t){var r=this._properties[t];return r?r.info:null};ld.prototype.destroy=function e(){var t=this;ut(this._properties,function(e,r){var i=e.handler;var n=t._path.concat([r]);t._module._unwatchPropertyInformation(t._isNode,n,i,t._filter,t._unwindArrays)});this._propertyList=undefined;this._properties=undefined;this._onAddHandlers=undefined;this._onRemoveHandlers=undefined;this._onUpdateHandlers=undefined;var r=this._module._objectPropertyWatchers.indexOf(this);this._module._objectPropertyWatchers.splice(r,1)};ld.prototype.kill=function e(){return this.destroy()};ld.prototype._updateSubPropertiesToWatch=function e(t,r){var i=this;if(t!==this._isNode){return}var n=r.getData(this._path);for(var a=0;a<n.length;a++){var o=n[a];if(tt(o)){var s=Object.keys(o);for(var u=0;u<s.length;u++){i._addSubPropertyToWatch(s[u])}}}};ld.prototype._addSubPropertyToWatch=function e(t){var r=this;if(!this._properties[t]){var i=this._path.concat([t]);var n=function(){return r._triggerPropertyUpdate(t)};var a=this._unwindArrays;var o=this._isNode;var s=this._filter;var u=this._module._watchPropertyInformation(o,i,n,s,a);this._properties[t]={handler:n,info:u};this._triggerPropertyUpdate(t)}};ld.prototype._triggerPropertyUpdate=function e(t){var r=this._properties[t];var i=r.info;var n=this._propertyList.indexOf(t),a=n!==-1,o=i.getType()!=="undefined";if(!a&&o){this._propertyList.push(t);this._triggerHandlers("_onAddHandlers",t,i);this._triggerHandlers("_onUpdateHandlers",t,i)}else if(a&&!o){this._propertyList.splice(n,1);this._triggerHandlers("_onUpdateHandlers",t,i);this._triggerHandlers("_onRemoveHandlers",t,i)}else if(a&&o){this._triggerHandlers("_onUpdateHandlers",t,i)}};ld.prototype._triggerHandlers=function e(t,r,i){var n=this[t];for(var a=0,o=n.length;a<o;a++){n[a](r,i)}};var fd=function e(t,r,i){var n=this;var a=i.path;var o=i.filter;var s=i.unwindArrays;this._module=t;this._isNode=r;this._path=a||[];this._filter=o;this._unwindArrays=s;this._onUpdateHandlers=[];this._triggerUpdate=function(e){for(var t=0;t<n._onUpdateHandlers.length;++t){n._onUpdateHandlers[t](e)}};this._info=t._watchPropertyInformation(this._isNode,this._path,this._triggerUpdate,this._filter,this._unwindArrays)};fd.prototype.onUpdate=function e(t){this._onUpdateHandlers.push(t)};fd.prototype.getPropertyInfo=function e(){return this._info};fd.prototype.getPath=function e(){return this._path.slice()};fd.prototype.destroy=function e(){this._module._unwatchPropertyInformation(this._isNode,this._path,this._triggerUpdate,this._filter,this._unwindArrays)};fd.prototype.kill=function e(){return this.destroy()};b.extend(function(e){var t=new hd(e);e.modules.rules=t;e.rules={map:function e(r){return t.createMapping(r)},slices:function e(r){return t.createSlices(r)},template:function e(r){return t.createTemplate(r)}}});var hd=function e(t){this._ogma=t;this._graph=t.modules.graph;this._graphics=t.modules.graphics;this._watcher=t.modules.watcher;this._data=t.modules.data;this._events=t.modules.events};hd.prototype.createMapping=function e(t){if(t===void 0)t={};var r=t.field;var i=t.values;if(i===void 0)i={};var n=t.fallback;r=Se(r);if(!bt(n)){n=[n]}if(n.length===0){n=[undefined]}if(typeof i!=="object"||i===null||bt(i)){throw new Error('"mapping" should be an object')}return cd(this,r,function(e){return dd(e.getValues(),i,n)})};hd.prototype.createSlices=function e(t){if(t===void 0)t={};var r=t.field;var i=t.fallback;var n=t.stops;if(n===void 0)n={};var a=t.values;if(a===void 0)a={nbSlices:7};var o=t.reverse;if(o===void 0)o=false;r=Se(r);if(!a.nbSlices){a.nbSlices=7}return cd(this,r,function(e){return vd(e.getValues(),e.getBoundaries(),i,n,a,o)})};hd.prototype.createTemplate=function e(t){if(typeof t!=="string"){throw new TypeError('"template" should be a string')}var r=[],i=0;while(true){var n=-1,a=t.indexOf("{{",i);if(a!==-1){n=t.indexOf("}}",a+2)}if(n!==-1){r.push(t.substring(i,a));r.push(t.substring(a+2,n));i=n+2}else{r.push(t.slice(i));break}}return function(e){var t=r[0];for(var i=1;i<r.length;i+=2){t+=e.getData(r[i]);t+=r[i+1]}return t}};function dd(e,t,r){e=e.map(function(e){return""+e}).sort();var i=0,n={};for(var a=0;a<e.length;++a){var value=e[a];if(value in t){n[value]=t[value]}else{n[value]=r[i];i=(i+1)%r.length}}return n}function vd(e,t,r,i,n,a){var o={};if(!t){for(var s=0;s<e.length;++s){o[e[s]]=r}}else{var u=bt(n)?n.length:n.nbSlices,l,f;if(bt(i)){l=i.slice()}else{var h=i.min;var d=i.max;if(h===undefined||d===undefined){h=t.min;d=t.max}var v=(d-h)/u;l=[];for(var c=1;c<u;++c){l.push(h+v*c)}}if(bt(n)){f=n}else{var _=n.min;var g=n.max;var p=l.length+1,y=(g-_)/l.length;f=[];for(var m=0;m<p;++m){f.push(_+m*y)}}if(a){f.reverse()}if(l.length!==f.length-1){throw new Error("there should be exactly one more value that stops")}for(var b=0;b<e.length;++b){var value=e[b],x=+value;if(!isFinite(x)){o[value]=r}else{for(var A=0;A<l.length&&l[A]<=value;++A){}o[value]=f[A]}}}return o}function cd(e,t,r){var i={field:t,mapping:null},n=function(t){i.mapping=r(t);e._graphics.refreshRules(t.isNode()?e._ogma.getNodes():e._ogma.getEdges());_d(e)},a=function(a){var o=e._watcher._watchPropertyInformation(a,t,n,true);i.mapping=r(o);_d(e)},o=function(r){e._watcher._unwatchPropertyInformation(r,t,n);_d(e)},s=function(e){var value=e.getData(t),r=i.mapping;if(bt(value)){return value.map(function(e){return r[e]})}else{return r[value]}};s.onAdd=a;s.onRemove=o;s.metaData=i;s.getMapping=function(){return dt(i.mapping)};return s}function _d(e){e._ogma.modules.legend.refresh()}var gd={mouseEventRate:15,wheelDebounceTime:60,doubleClickTimer:500};var pd={0:"left",1:"middle",2:"right"};b.extend(function(e){e.modules.mouse=new yd(e)});var yd=function e(t){var r=this;this._dom=t.modules.dom;this._settings=t.modules.settings;this._events=t.modules.events;this._graphics=t.modules.graphics;this._focus=false;this._domElt=this._graphics.getDomElement();this._x=0;this._y=0;this._left=false;this._middle=false;this._right=false;this._settings.register("mouse.enabled",true);this._settings.register("mouse.wheelEnabled",true);this._settings.register("mouse.disableWheelUntilMouseDown",false);this._events.register(["mouseDown","mouseUp","mouseMove","mouseWheel","mouseClick","mouseDoubleClick","mouseLeave","documentMouseMove","documentMouseUp"]);this._dom.addDocumentEventListener("contextmenu",function(e){if(r._focus&&r._settings.get("mouse.enabled")){e.preventDefault()}},false);this._initializeListeners()};var md={x:{configurable:true},y:{configurable:true},left:{configurable:true},right:{configurable:true},middle:{configurable:true}};md.x.get=function(){return this._x};md.y.get=function(){return this._y};md.left.get=function(){return this._left};md.right.get=function(){return this._right};md.middle.get=function(){return this._middle};yd.prototype._isEnabled=function e(){return this._settings.get("mouse.enabled")};yd.prototype._isWheelEnabled=function e(){return this._settings.get("mouse.wheelEnabled")};yd.prototype._disableWheelUntilMouseDown=function e(){return this._settings.get("mouse.disableWheelUntilMouseDown")};yd.prototype._initializeListeners=function e(){var t=this;var r=this;var i={left:0,middle:0,right:0},n=function(e,t){return r._events.fire(e,t)};var a=0,o=0,s=0,u=0,l,f={left:false,middle:false,right:false},h=null;var d=function(e,value){if(value===void 0)value=0;if(e){i[e]=value}else{i.left=value;i.middle=value;i.right=value}};var v=function(e){l=Gr(r._domElt);if(!l){return false}h=pd[e.button];s=a;u=o;a=e.clientX-l.left;o=e.clientY-l.top;r._x=a;r._y=o;r._left=f.left;r._right=f.right;r._middle=f.middle;return true};var c=function(e){if(v(e)){var t=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail));n("mouseWheel",{delta:t,x:a,y:o})}};function _(e){if(r._isEnabled()&&r._isWheelEnabled()&&(!r._disableWheelUntilMouseDown()||r._focus)){if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}if(e.stopPropagation){e.stopPropagation()}else{e.cancelBubble=true}c(e)}}this._dom.addElementEventListener(this._domElt,"mousewheel",_);this._dom.addElementEventListener(this._domElt,"DOMMouseScroll",_);this._dom.addDocumentEventListener("mousemove",function(e){if(!t._isEnabled()||!v(e)){return}var r=a-s;var i=o-u;if(a>0&&a<l.width&&o>0&&o<l.height){if(r===0&&i===0){return}d();n("mouseMove",{x:a,y:o,dx:r,dy:i})}else{n("documentMouseMove",{x:a,y:o,dx:r,dy:i})}});this._dom.addElementEventListener(this._domElt,"mouseleave",function(){if(!t._isEnabled()){return}t._focus=false;n("mouseLeave")});this._dom.addElementEventListener(this._domElt,"mousedown",function(e){if(!t._isEnabled()||!v(e)){return}t._focus=true;f[h]=true;i[h]+=1;setTimeout(d,gd.doubleClickTimer,h,0);n("mouseDown",{button:h,x:a,y:o})});this._dom.addDocumentEventListener("mouseup",function(e){if(!t._isEnabled()||!v(e)){return}f[h]=false;if(a>0&&a<l.width&&o>0&&o<l.height){if(i[h]===1){n("mouseClick",{button:h,x:a,y:o})}else if(i[h]>1){n("mouseDoubleClick",{button:h,x:a,y:o});d(h)}n("mouseUp",{button:h,x:a,y:o})}else{n("documentMouseUp",{button:h,x:a,y:o})}})};Object.defineProperties(yd.prototype,md);b.extend(function(e){var t=new bd(e);e.modules.virtualMouse=t;e.mouse={move:function e(r){return t.move(r)},down:function e(r){return t.down(r)},up:function e(r){return t.up(r)},click:function e(r){return t.click(r)},doubleClick:function e(r){return t.doubleClick(r)},drag:function e(r,i){return t.drag(r,i)},wheel:function e(r){return t.wheel(r)}}});var bd=function e(t){this._ogma=t;this._events=t.modules.events;this._events.register(["virtualDown","virtualUp","virtualMove","virtualClick","virtualDoubleClick","virtualWheel"])};var xd={x:{configurable:true},y:{configurable:true}};xd.x.get=function(){return this._ogma.modules.captor._x||0};xd.y.get=function(){return this._ogma.modules.captor._y||0};bd.prototype.move=function e(t){var r=t.x;var i=t.y;if(r!==undefined&&i!==undefined){var n=r-this.x;var a=i-this.y;this._events.fire("virtualMove",{x:r,y:i,dx:n,dy:a});return Ad()}else{return Promise.resolve()}};bd.prototype.down=function e(t){var r=this;if(t===void 0)t={};var i=t.x;var n=t.y;var a=t.button;if(a===void 0)a="left";return this.move({x:i,y:n}).then(function(){r._events.fire("virtualDown",{x:r.x,y:r.y,button:a});r._events.fire("virtualMove",{x:r.x,y:r.y,dx:0,dy:0});return Ad()})};bd.prototype.up=function e(t){var r=this;if(t===void 0)t={};var i=t.x;var n=t.y;var a=t.button;if(a===void 0)a="left";return this.move({x:i,y:n}).then(function(){r._events.fire("virtualUp",{x:r.x,y:r.y,button:a});return Ad()})};bd.prototype.click=function e(t){var r=this;if(t===void 0)t={};var i=t.x;var n=t.y;var a=t.button;if(a===void 0)a="left";return this.move({x:i,y:n}).then(function(){r._events.fire("virtualClick",{x:r.x,y:r.y,button:a});return Ad()})};bd.prototype.doubleClick=function e(t){var r=this;if(t===void 0)t={};var i=t.x;var n=t.y;var a=t.button;if(a===void 0)a="left";return this.move({x:i,y:n}).then(function(){r._events.fire("virtualDoubleClick",{x:r.x,y:r.y,button:a});return Ad()})};bd.prototype.drag=function e(t,r){var i=this;return this.down(t).then(function(){return i.move(r)}).then(function(){return i.up()})};bd.prototype.wheel=function e(t){var r=this;var i=t.x;var n=t.y;var a=t.delta;return this.move({x:i,y:n}).then(function(){r._events.fire("virtualWheel",{x:r.x,y:r.y,delta:a});return Ad()})};Object.defineProperties(bd.prototype,xd);function Ad(){return new Promise(function(e){setTimeout(function(){return setTimeout(e,0)},0)})}var wd={doubleTapTimer:500,touchEventRate:15};b.extend(function(e){e.modules.touch=new Sd(e)});var Sd=function e(t){this._dom=t.modules.dom;this._events=t.modules.events;this._settings=t.modules.settings;this._graphics=t.modules.graphics;this._x=0;this._y=0;this._pressed=false;this._domElt=this._graphics.getDomElement();this._settings.register("touch.enabled",true);this._events.register(["touchDown","touchUp","touchTap","touchDoubleTap","touchMove","touchStartGesture","touchProgressGesture","touchEndGesture","documentTouchMove","documentTouchUp"]);Td(this)};var Ed={x:{configurable:true},y:{configurable:true},pressed:{configurable:true}};Ed.x.get=function(){return this._x};Ed.y.get=function(){return this._y};Ed.pressed.get=function(){return this._pressed};Sd.prototype._isEnabled=function e(){return this._settings.get("touch.enabled")};Sd.prototype._bind=function e(t,r){this._dom.addElementEventListener(this._domElt,t,r)};Object.defineProperties(Sd.prototype,Ed);function Td(e){var t=function(t,r){return e._events.fire(t,r)};var r=0,i=0,n=0,a=0,o=false,s=0,u=false,l=false,f=1,h=0;var d=function(){e._x=r;e._y=i;e._pressed=o};var v=function(e,t,n,a){f=e;h=t;r=n;i=a;d()};var c=function(t){var n=Gr(e._domElt);if(!n){return null}var a=t.touches[0].clientX-n.left;var o=t.touches[0].clientY-n.top;var s=t.touches[1].clientX-n.left;var u=t.touches[1].clientY-n.top;var l=(a+s)/2,d=(o+u)/2,c=l-r,_=d-i,g=distance(a,o,s,u),p=g/f,y=Si(a,o,s,u),m=y-h,b={dx:c,dy:_,rotation:m,scale:p};v(g,y,l,d);return b};var _=function(e){if(e.touches.length!==2&&l){l=false;t("touchEndGesture")}else if(e.touches.length===2&&!l){if(c(e,true)){l=true;t("touchStartGesture")}}return e.touches.length===2};var g=function(e){if(e.touches.length===2&&l){var n=c(e);if(n){var a=n.dx;var o=n.dy;var s=n.rotation;var u=n.scale;t("touchProgressGesture",{dx:a,dy:o,rotation:s,scale:u,x:r,y:i})}}};var p=function(t,r){e._bind(t,r)};var y=function(s){if(s.touches.length!==1){o=false;if(s.touches.length>1){t("touchUp",{x:r,y:i})}return false}else{var u=Gr(e._domElt);if(u){n=r;a=i;r=s.touches[0].clientX-u.left;i=s.touches[0].clientY-u.top;o=true;d()}return true}};var m=function(){s=0};p("touchstart",function(e){_(e);if(y(e)){t("touchDown",{x:r,y:i});s+=1;setTimeout(m,wd.doubleTapTimer);u=true}});var b=function(e){_(e);y(e);if(e.touches.length===0){if(s===1){t("touchTap",{x:r,y:i})}else if(s>1){t("touchDoubleTap",{x:r,y:i});m()}t("touchUp",{x:r,y:i})}};p("touchend",b);p("touchcancel",b);p("touchmove",function(e){g(e);if(u){u=false;return}m();if(y(e)){t("touchMove",{x:r,y:i,dx:r-n,dy:i-a})}});var x=function(e){return e.preventDefault()};p("touchstart",x);p("touchend",x);p("touchcancel",x)}var Md={65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",13:"enter",16:"shift",17:"ctrl",18:"alt",27:"esc",46:"del",8:"backspace",32:"space",224:"cmd",91:"cmd",92:"cmd",93:"cmd",187:"+",189:"-"};var Cd={};(function(){var e=Object.keys(Md);e.forEach(function(e){var t=Md[e];if(!Cd[t]){Cd[t]=[]}Cd[t].push(e)})})();b.extend(function(e){var t=new kd(e);e.modules.keyboard=t;e.events.onKeyPress=function(r,i){t.onKeyPress(r,i);return e.events};e.keyboard={isKeyPressed:function e(r){return t.isPressed(r)},resetKeys:function e(){t.resetKeys()}}});var kd=function e(t){var r=this;this._dom=t.modules.dom;this._events=t.modules.events;this._events.register(["keyUp","keyDown"]);this._binds=[];this._pressed=[];this._onKeyDown=function(e){var t=e.keyCode||e.which,i=r._binds[t];r._pressed[t]=true;if(i){for(var n=0;n<i.length;++n){var a=i[n],o=true;for(var s=0;s<a.keys.length;++s){var u=false,l=a.keys[s];for(var f=0;f<l.length;++f){if(r._pressed[l[f]]){u=true}}if(!u){o=false}}if(o){a.handler()}}}r._events.fire("keyDown",{key:Md[t],code:t})};this._onKeyUp=function(e){var t=e.keyCode||e.which;r._pressed[t]=false;r._events.fire("keyUp",{key:Md[t],code:t})};this._onBlur=function(){return r._resetKeys()};this._dom.addWindowEventListener("keydown",this._onKeyDown);this._dom.addWindowEventListener("keyup",this._onKeyUp);this._dom.addWindowEventListener("visibilitychange",this._onBlur);this._dom.addWindowEventListener("blur",this._onBlur,false)};kd.prototype.resetKeys=function e(){this._resetKeys()};kd.prototype._resetKeys=function e(){var t=this;for(var r=0;r<this._pressed.length;++r){if(t._pressed[r]){t._pressed[r]=false;t._events.fire("keyUp",{key:Md[r],code:r})}}};kd.prototype.onKeyPress=function e(t,r){var i=this;if(typeof t==="number"){t=[t]}else if(typeof t==="string"){t=t.split(" ")}else if(!Array.isArray(t)){throw new TypeError(t+" is not a number, string or array")}else if(t.length===0){throw new Error("the array should contain at least one element")}var n=[];t.forEach(function(e){if(typeof e==="number"){n.push([e])}else if(typeof e==="string"){var t=Cd[e];if(!t){throw new Error(e+" is not a valid key identifier")}n.push(t)}else{throw new TypeError(e+" is not a valid key identifier")}});var a=n.pop(),o={keys:n,handler:r};a.forEach(function(e){if(!i._binds[e]){i._binds[e]=[]}i._binds[e].push(o)})};kd.prototype.isPressed=function e(t){var r=this;if(typeof t==="number"){return this._pressed[t]}else if(typeof t==="string"){var i=Cd[t];if(i){for(var n=0;n<i.length;++n){if(r._pressed[i[n]]){return true}}}}return false};b.extend(function(e){var t=new Nd(e);var r=e.modules.events;e.modules.captor=t;e.getHoveredElement=function(){return t.getPointedElement()};e.view.getElementAt=function(e){return t.getElementAt(e)};e.getPointerInformation=function(){return t.getCursorInformation()};At(e.events,{onMouseMove:function t(i){r.on("move",i);return e.events},onMouseButtonDown:function t(i){r.on("down",i);return e.events},onMouseButtonUp:function t(i){r.on("up",i);return e.events},onClick:function t(i){r.on("click",i,{delay:true});return e.events},onDoubleClick:function t(i){r.on("doubleClick",i,{delay:true});return e.events},onMouseWheel:function t(i){r.on("wheel",i,{delay:true});return e.events},onHover:function t(i){r.on("hover",i);return e.events},onUnhover:function t(i){r.on("unhover",i);return e.events},onDragStart:function t(i){r.on("dragStart",i,{delay:true});return e.events},onDragProgress:function t(i){r.on("dragProgress",i,{delay:true});return e.events},onDragEnd:function t(i){r.on("dragEnd",i,{delay:true});return e.events},onGestureStart:function t(i){r.on("gestureStart",i);return e.events},onGestureProgress:function t(i){r.on("gestureProgress",i);return e.events},onGestureEnd:function t(i){r.on("gestureEnd",i);return e.events}})});var Nd=function e(t){var r=this;this._ogma=t;this._graph=t.modules.graph;this._graphics=t.modules.graphics;this._camera=t.modules.camera;this._mouse=t.modules.mouse;this._touch=t.modules.touch;this._events=t.modules.events;this._settings=t.modules.settings;this._elt=null;this._hoveredElt=null;this._draggedElt=null;this._enabled=true;this._init=false;this._hover=false;this._x=undefined;this._y=undefined;this._timeout=null;this._buttons={left:{isPressed:false,isDragging:false},middle:{isPressed:false,isDragging:false},right:{isPressed:false,isDragging:false}};this._events.register(["move","down","up","click","doubleClick","hover","unhover","wheel","dragStart","dragProgress","dragEnd","gestureStart","gestureProgress","gestureEnd"]);this._settings.register("detect.nodes",true);this._settings.register("detect.edges",true);this._settings.register("detect.nodeTexts",true);this._settings.register("detect.edgeTexts",true);this._settings.register("detect.nodeErrorMargin",5);this._settings.register("detect.edgeErrorMargin",7);this._events.on({"removeNodes removeEdges clear":function(){Vd(r,r._x,r._y);if(!r._timeout){r._timeout=setTimeout(function(){Rd(r,{x:r._x,y:r._y,dx:0,dy:0});r._timeout=null},0)}},"mouseMove touchMove virtualMove":function(e,t){var i=e.x;var n=e.y;var a=e.dx;var o=e.dy;Rd(r,{x:i,y:n,dx:a,dy:o,source:Id(t)})},"mouseDown touchDown virtualDown":function(e,t){var i=e.x;var n=e.y;var a=e.button;if(a===void 0)a="left";Ld(r,{x:i,y:n,button:a,source:Id(t)})},"mouseUp touchUp virtualUp":function(e,t){var i=e.x;var n=e.y;var a=e.button;if(a===void 0)a="left";Pd(r,{x:i,y:n,button:a,source:Id(t)})},"mouseClick touchTap virtualClick":function(e,t){var i=e.x;var n=e.y;var a=e.button;if(a===void 0)a="left";Bd(r,{x:i,y:n,button:a,source:Id(t)})},"mouseDoubleClick touchDoubleTap virtualDoubleClick":function(e,t){var i=e.x;var n=e.y;var a=e.button;if(a===void 0)a="left";Od(r,{x:i,y:n,button:a,source:Id(t)})},"mouseWheel virtualWheel":function(e){var t=e.x;var i=e.y;var n=e.delta;r._x=t;r._y=i;zd(r,"wheel",undefined,{x:t,y:i,delta:n,source:"mouse",target:r._hoveredElt})},touchStartGesture:function(e){return r._events.fire("gestureStart",e)},touchProgressGesture:function(e){return r._events.fire("gestureProgress",e)},touchEndGesture:function(e){return r._events.fire("gestureEnd",e)},documentMouseMove:function(e,t){var i=e.x;var n=e.y;var a=e.dx;var o=e.dy;var s=Id(t);ut(r._buttons,function(e,t){var u=e.isDragging;if(u){zd(r,"dragProgress",r._draggedElt,{x:i,y:n,dx:a,dy:o,button:t,source:s})}})},documentMouseUp:function(e,t){var i=e.x;var n=e.y;var a=e.button;if(a===void 0)a="left";var o=Id(t);if(r._buttons[a].isDragging){zd(r,"dragEnd",r._draggedElt,{x:i,y:n,button:a,source:o});if(Dd(r)===0){r._draggedElt=null}r._buttons[a].isDragging=false;r._buttons[a].isPressed=false}}})};Nd.prototype.getElementAt=function e(t){var r=t.x;var i=t.y;return Ud(this,r,i)};Nd.prototype.getPointedElement=function e(){return this._hoveredElt};Nd.prototype.getDraggedElement=function e(){return this._draggedElt};Nd.prototype.isAnyButtonPressed=function e(){return Fd(this)>0};Nd.prototype.isButtonPressed=function e(t){return this._buttons[t].isPressed};Nd.prototype.isLeftPressed=function e(){return this.isButtonPressed("left")};Nd.prototype.getCursorPosition=function e(){return{x:this._x,y:this._y}};Nd.prototype.getCursorInformation=function e(){return{x:this._x,y:this._y,target:this._hoveredElt}};Nd.prototype.setDetectionEnabled=function e(value){var t=this._enabled;this._enabled=!!value;return t};function Id(e){if(e.indexOf("touch")===0){return"touch"}else{return"mouse"}}function zd(e,t,r,i){i.target=r||null;e._events.fire(t,i);return i}function Ld(e,t){var r=t.x;var i=t.y;var n=t.button;var a=t.source;jd(e,r,i);if(e._elt!==e._hoveredElt){Vd(e,r,i)}e._hoveredElt=e._elt;e._hoveredEltIsNode=e._elt&&e._elt.isNode;e._buttons[n].isPressed=true;zd(e,"down",e._hoveredElt,{x:r,y:i,button:n,source:a})}function Rd(e,t){var r=t.x;var i=t.y;var n=t.dx;var a=t.dy;var o=t.source;e._events.fire("move",{x:r,y:i,dx:n,dy:a,source:o});e._x=r;e._y=i;ut(e._buttons,function(t,s){var u=t.isPressed;var l=t.isDragging;if(u){if(!l){e._buttons[s].isDragging=true;if(e._hoveredElt){if(e._hover){zd(e,"unhover",e._hoveredElt,{x:r,y:i,source:o});e._hover=false}}if(!e._draggedElt){e._draggedElt=e._hoveredElt;e._draggedEltIsNode=e._hoveredEltIsNode}zd(e,"dragStart",e._draggedElt,{x:r,y:i,button:s,source:o})}else{zd(e,"dragProgress",e._draggedElt,{x:r,y:i,dx:n,dy:a,button:s,source:o})}}});jd(e,r,i);if(e._elt!==e._hoveredElt){if(e._hoveredElt&&e._hover){e._hover=true;zd(e,"unhover",e._hoveredElt,{x:r,y:i,source:o})}e._hoveredElt=e._elt;e._hoveredEltIsNode=e._isNode;if(e._elt){e._hover=true;zd(e,"hover",e._hoveredElt,{x:r,y:i,source:o})}}}function Dd(e){return lt(e._buttons,function(e,t){var r=t.isDragging;if(r===void 0)r=false;return e+r},0)}function Fd(e){return lt(e._buttons,function(e,t){var r=t.isPressed;if(r===void 0)r=false;return e+r},0)}function Pd(e,t){var r=t.x;var i=t.y;var n=t.button;var a=t.source;var o=e._buttons[n];var s=o.isPressed;var u=o.isDragging;if(!s){return}if(u){zd(e,"dragEnd",e._draggedElt,{x:r,y:i,button:n,source:a});e._buttons[n].isDragging=false;if(Dd(e)===0){e._draggedElt=null}}e._buttons[n].isPressed=false;jd(e,r,i);zd(e,"up",e._elt,{x:r,y:i,button:n,source:a});if(!Fd(e)&&!e._hover&&a!=="touch"){e._hoveredElt=e._elt;e._hoveredEltIsNode=e._isNode;if(e._hoveredElt){zd(e,"hover",e._hoveredElt,{x:r,y:i,source:a});e._hover=true}}}function Bd(e,t){var r=t.x;var i=t.y;var n=t.button;var a=t.source;zd(e,"click",e._hoveredElt,{x:r,y:i,button:n,source:a})}function Od(e,t){var r=t.x;var i=t.y;var n=t.button;var a=t.source;zd(e,"doubleClick",e._hoveredElt,{x:r,y:i,button:n,source:a})}function Vd(e,t,r){ut(e._buttons,function(i,n){var a=i.isDragging;if(a){zd(e,"dragEnd",e._draggedElt,{x:t,y:r,button:n})}});if(e._hover&&e._hoveredElt){zd(e,"unhover",e._hoveredElt,{x:t,y:r})}Object.keys(e._buttons).forEach(function(t){e._buttons[t].isPressed=false;e._buttons[t].isDragging=false});e._hover=false;e._hoveredElt=null;e._draggedElt=null}function jd(e,t,r){e._elt=Ud(e,t,r);e._isNode=!e._elt||e._elt.isNode}function Ud(e,t,r){if(!e._enabled||t===undefined||r===undefined){return null}var i=e._settings.get("detect.nodeErrorMargin"),n=e._settings.get("detect.edgeErrorMargin"),a=null;if(e._settings.get("detect.nodes")){a=e._graphics.detectNode({position:{x:t,y:r},margin:i,texts:e._settings.get("detect.nodeTexts")})}if(!a&&e._settings.get("detect.edges")){a=e._graphics.detectEdge({position:{x:t,y:r},margin:n,texts:e._settings.get("detect.edgeTexts")})}return a}b.extend(function(e){e.modules.sync=new Gd(e)});var Gd=function e(t){var r=this;this._dom=t.modules.dom;this._events=t.modules.events;this._captor=t.modules.captor;this._delayedCalls=[];this._idIdle=function(){return!r._captor.isAnyButtonPressed()&&!r._dom.isPlayingFrame()};this._events.on({"down up beforeNewFrame newFrame":function(){r._delayedCalls.forEach(function(e){return e.reset()})}})};Gd.prototype._nextTimeIdle=function e(t){var r=this;var i=new Xd(this._idIdle,t);this._delayedCalls.push(i);return i.whenDone().then(function(){r._delayedCalls.splice(r._delayedCalls.indexOf(i),1)})};Gd.prototype.debounceIdle=function e(t,r){var i=this;if(r===void 0)r=0;var n=false;var a=[];var o=function(){var e=a;n=false;a=[];t();e.forEach(function(e){return e()})};return function(){return new Promise(function(e){a.push(e);if(!n){n=true;i._nextTimeIdle(r).then(o)}})}};var Xd=function e(t,r){var i=this;this._promise=new Promise(function(e){return i._resolve=e});this._isIdle=t;this._delay=r;this._timeout=null;this._done=false;this._startTimeout()};Xd.prototype._startTimeout=function e(){var t=this;this._timeout=setTimeout(function(){if(t._isIdle()){t._done=true;t._resolve()}else{t._startTimeout()}},this._delay)};Xd.prototype.reset=function e(){if(!this._done){clearTimeout(this._timeout);this._startTimeout()}};Xd.prototype.whenDone=function e(){return this._promise};var Wd=function e(t){if(t===void 0)t={};var r=t.xValues;if(r===void 0)r=[];var i=t.yValues;if(i===void 0)i=[];var n=t.sizeValues;if(n===void 0)n=[];this.minX=Fe(r);this.minY=Fe(i);this.maxX=De(r);this.maxY=De(i);this.minSize=Fe(n);this.maxSize=De(n);this.cx=this.minX+(this.maxX-this.minX)/2;this.cy=this.minY+(this.maxY-this.minY)/2;this.width=this.maxX-this.minX;this.height=this.maxY-this.minY};var Hd=40;var Yd="quadraticInOut";var qd=200;b.atInit(function(e){e.view.locateGraph()});b.extend(function(e){var t=new Zd(e);var r=e.Node;var i=e.Edge;var n=e.NodeList;var a=e.EdgeList;e.modules.locate=t;r.prototype.locate=function(e){return t.locateElements(this,e)};n.prototype.locate=function(e){return t.locateElements(this,e)};i.prototype.locate=function(e){return t.locateElements(this,e)};a.prototype.locate=function(e){return t.locateElements(this,e)};r.prototype.getBoundingBox=function(){return t.getBoundingBox(this)};n.prototype.getBoundingBox=function(){return t.getBoundingBox(this)};i.prototype.getBoundingBox=function(e){return t.getBoundingBox(this,e)};a.prototype.getBoundingBox=function(e){return t.getBoundingBox(this,e)};e.view.locateGraph=function(e){return t.locateGraph(e)};e.view.locateRawGraph=function(e,r){return t.locateRawGraph(e,r)};e.view.getGraphBoundingBox=function(){return t.getGraphBoundingBox()}});var Zd=function e(t){var r=this;this._ogma=t;this._dom=t.modules.dom;this._events=t.modules.events;this._camera=t.modules.camera;this._graph=t.modules.graph;this._graphics=t.modules.graphics;this._settings=t.modules.settings;this._sync=t.modules.sync;this._cacheValid=true;this._cachedGraphBoundingBox=new Wd;this._scheduleCacheUpdate=this._sync.debounceIdle(function(){r._updateCache()},50);this._events.on({"addNodes removeNodes addEdges removeEdges refreshNodeFilters refreshEdgeFilters clear":function(){r._invalidCache()},"nodeAttributesChanged edgeAttributesChanged":function(e){var t=e.attributes;if(t.includes("x")||t.includes("y")||t.includes("radius")){r._invalidCache()}}})};Zd.prototype.locateGraph=function e(t){return this._locateBoundingBox(this.getGraphBoundingBox(),t)};Zd.prototype.locateElements=function e(t,r){return this._locateBoundingBox(this.getBoundingBox(t),r)};Zd.prototype.locateRawGraph=function e(t,r){return this._locateBoundingBox(this._getRawGraphBoundingBox(t),r)};Zd.prototype.getGraphBoundingBox=function e(){if(!this._cacheValid){this._updateCache()}return Object.assign({},this._cachedGraphBoundingBox)};Zd.prototype._invalidCache=function e(){this._cacheValid=false};Zd.prototype._updateCache=function e(){this._cacheValid=true;this._cachedGraphBoundingBox=this.getBoundingBox(this._ogma.getNodes())};Zd.prototype.getBoundingBox=function e(t,r){if(t.isNode){return this._getNodesBoundingBox(t.toList())}else{return this._getEdgesBoundingBox(t.toList(),r)}};Zd.prototype._getNodesBoundingBox=function e(t){var r=t.size;var i=t.getAttribute("x");var n=t.getAttribute("y");var a=t.getAttribute("radius");var o=[];var s=[];var u=[];for(var l=0;l<r;++l){var f=a[l];var h=i[l];var d=n[l];o.push(h-f,h+f);s.push(d-f,d+f);u.push(f*2)}return new Wd({xValues:o,yValues:s,sizeValues:u})};Zd.prototype._getEdgesBoundingBox=function e(t,r){if(r===void 0)r=false;this._graphics.computeCurvatures();var i=t.size;var n=t.getSource();var a=t.getTarget();var o=t.getCurvature();var s=n.getAttribute("x");var u=n.getAttribute("y");var l=n.getAttribute("radius");var f=a.getAttribute("x");var h=a.getAttribute("y");var d=a.getAttribute("radius");var v={x1:0,y1:0,x2:0,y2:0};var c={x:0,y:0};var _={minX:0,minY:0,maxX:0,maxY:0};var g=[];var p=[];var y=[];for(var m=0;m<i;++m){var b=n.get(m);var x=a.get(m);var A=o[m];var w=s[m];var S=u[m];var E=l[m];var T=f[m];var M=h[m];var C=d[m];y.push(E*2,C*2);if(r||A===0){g.push(w-E,w+E,T-C,T+C);p.push(S-E,S+E,M-C,M+C)}else if(b===x){oo(w,S,E,A,v);mo(w,S,v.x1,v.y1,v.x2,v.y2,T,M,_);g.push(_.minX,_.maxX);p.push(_.minY,_.maxY)}else{no(w,S,T,M,A,c);yo(w,S,c.x,c.y,T,M,_);g.push(_.minX,_.maxX);p.push(_.minY,_.maxY)}}return new Wd({xValues:g,yValues:p,sizeValues:y})};Zd.prototype._getRawGraphBoundingBox=function e(t){return new Wd({xValues:t.nodes.map(function(e){return e.x||0}),yValues:t.nodes.map(function(e){return e.y||0}),sizeValues:t.nodes.map(function(e){return+(e.attributes&&e.attributes.radius)||5})})};Zd.prototype._computeCameraConfig=function e(t,r,i){var n,a,o,s;if(typeof r==="number"){n=r;a=r;o=r;s=r}else{n=ot(r.left,Hd);a=ot(r.right,Hd);o=ot(r.top,Hd);s=ot(r.bottom,Hd)}var u=this._dom.getDimensions();var l=(u.width-n-a)/(t.maxX-t.minX);var f=(u.height-o-s)/(t.maxY-t.minY);var h=Math.min(l,f);var d=this._settings.get("minZoom");var v=this._settings.get("maxZoom");var c=t.maxSize;if(c&&i&&c*h>i){h=i/c}h=be(h,d,v);return{x:t.cx+(a-n)/(h*2),y:t.cy+(s-o)/(h*2),zoom:h}};Zd.prototype._locateBoundingBox=function e(t,r){if(r===void 0)r={};if(isNaN(t.cx)){return Promise.resolve()}var i=r.padding;if(i===void 0)i={};var n=r.easing;if(n===void 0)n=Yd;var a=r.duration;if(a===void 0)a=0;var o=r.maxNodeSizeOnScreen;if(o===void 0)o=qd;var s=this._computeCameraConfig(t,i,o);var u=s.x;var l=s.y;var f=s.zoom;var h=f/this._camera.getZoom();return this._moveCamera(u,l,f,a,n,h)};Zd.prototype._moveCamera=function e(t,r,i,n,a,o){if(o>1.01){this._camera.setCenter({x:t,y:r},{duration:n,easing:a});return this._camera.setZoom(i,{duration:n,easing:a,startAfter:.5})}else if(o<.99){this._camera.setCenter({x:t,y:r},{duration:n,easing:a,startAfter:.5});return this._camera.setZoom(i,{duration:n,easing:a})}else{return this._camera.setCenter({x:t,y:r},{duration:n,easing:a})}};Zd.prototype.computeConfigForBounds=function e(t,r){if(r===void 0)r={};var i=r.padding;if(i===void 0)i={};var n=r.maxNodeSizeOnScreen;if(n===void 0)n=qd;return this._computeCameraConfig(t,i,n)};function $d(e,t){var r=e.x;var i=e.y;var n=e.indexes;var a=t.getAttribute(true,"radius").getMultiple(n);var o=[];var s=[];var u=[];for(var l=0;l<n.length;++l){var f=r[l];var h=i[l];var d=a[l]*2;u.push(d);o.push(f+d,f-d);s.push(h+d,h-d)}return new Wd({xValues:o,yValues:s,sizeValues:u})}b.extend(function(e){e.modules.imports=new Kd(e);e.fetch=function(e){return Vr(e)}});var Kd=function e(t){this._ogma=t;this._graph=t.modules.graph;this._locate=t.modules.locate;this._dom=t.modules.dom;this._camera=t.modules.camera;this._importers={}};Kd.prototype.from=function e(t,r){var i=this._importers[t];if(!i){throw new Error(t+" is not a valid importer.")}return new Promise(function(e,t){try{var n=i.translate(r);e(n)}catch(e){t(e)}})};Kd.prototype.register=function e(t,r){if(typeof r==="function"){r={translate:r,webWorkerCompatible:false}}gt(this._importers,t,r,"importer")};var Jd=Av(" ");var Qd=Av("<");var ev=Av(">");var tv=Av('"');var rv=Av("\n");var iv=Av("\r");var nv=Av("/");var av=Av("\\");var ov=Av("a");var sv=Av("z");var uv=Av("A");var lv=Av("Z");var fv=Av("0");var hv=Av("9");var dv=Av(":");var vv=-1;var cv=-2;var _v=-3;var gv=-4;function pv(e){var t=new Int32Array(e.length);for(var r=0,i=e.length;r<i;++r){t[r]=e.charCodeAt(r)}return t}function yv(e,t,r,i){var n=i.length;if(r-t!==n){return false}for(var a=0;a<n;++a){if(e[t+a]!==i[a]){return false}}return true}function mv(e,t,r,i){return xv(e.tags,t,r,i)}function bv(e,t,r,i){return xv(e.attributes,t,r,i)}function xv(e,t,r,i){var n=e.length;for(var a=0;a<n;++a){if(yv(t,r,i,e[a])){return a}}e.push(t.slice(r,i));return n}function Av(e){return e.charCodeAt(0)}function wv(e,t,r){var i,n,a;r=Tv(t,r);i=t[r];if(i===ev||i===nv){return r}n=r;r=Cv(t,r);a=bv(e,t,n,r);while(t[r]!==tv){++r}++r;n=r;while((i=t[r])!==tv){if(i===av){++r}++r}e.tokens.push(_v,a,n,r);return r+1}function Sv(e,t){var r,i,n,a,o=e.length;var s={tags:[],attributes:[],tokens:[]};var u=s.tokens;t=Tv(e,t);while(t<o){a=e[t];if(a===Qd){t=Tv(e,++t);if(e[t]===nv){u.push(cv);while(e[++t]!==ev){}}else{r=t;t=Cv(e,r);n=mv(s,e,r,t);u.push(vv,n);a=e[t];while(a!==ev&&a!==nv){t=wv(s,e,t);a=e[t]}if(a===nv){u.push(cv);while(e[++t]!==ev){}}}t+=1}else{r=t;while(e[++t]!==Qd){}i=t-1;while(Ev(e[i])){--i}u.push(gv,r,i+1)}t=Tv(e,t)}return s}function Ev(e){return e===Jd||e===rv||e===iv}function Tv(e,t){while(Ev(e[t])){++t}return t}function Mv(e){return e>=ov&&e<=sv||e>=uv&&e<=lv||e===dv||e>=fv&&e<=hv}function Cv(e,t){while(Mv(e[t])){++t}return t}function kv(e,t){var r=["this.id = undefined;","this.attributes = {","  text: undefined,","  color: undefined,","  "+(e?"radius":"width")+": undefined",e?"  ,x: undefined":"",e?"  ,y: undefined":"","};"];if(!e){r.push("this.source = undefined;","this.target = undefined;")}var i=Object.keys(t);if(i.length){r.push("  this.data = {")}for(var n=0;n<i.length;++n){var a=i[n],o=t[a],s=o.title;r.push('  "'+s+'": '+(o.default!==undefined?JSON.stringify(o.default):undefined)+(n===i.length-1?"":","))}if(i.length){r.push("};")}return new Function(r.join("\n"))}function Nv(e){if(e.indexOf("\\")===-1){return e}e=e.replace(/\\"/g,'"');return e}function Iv(e){if(e.indexOf("<gexf")===-1){throw new Error("not a GEXF file")}var t=pv(e),r=Sv(t,e.indexOf("<gexf ")),i={},n=[],a={},o=[];r.tags.forEach(function(e,t){var r=String.fromCharCode.apply(null,e);i[r]=t;n.push(r)});r.attributes.forEach(function(e,t){var r=String.fromCharCode.apply(null,e);a[r]=t;o.push(r)});var s=i.attributes,u=i.attribute,l=i.node,f=i.edge,h=i.default,d=i["viz:position"],v=i["viz:size"],c=i["viz:color"],_=i.attvalue,g=a.class,p=a.id,y=a.type,m=a.title,b=a.label,x=a.source,A=a.target,w=a.x,S=a.y,E=a.r,T=a.g,M=a.b,C=a.a,k=a.value,N=a.for,I=a.weight,z=4,L=5,R=6;var D=1,F=2,P=3,B=4,O=5;var V={float:D,double:D,integer:F,boolean:P,string:B,"list-string":O};var j=0,U=r.tokens,G=U.length;var X=new Array(16),W=0,H=0,Y=0,q=true,Z={},$={},K=null,J=null,Q=null,ee=undefined,te=null,re=0,ie=0,ne=0,ae=1,oe=null,se=undefined,ue=false,le=true,fe=null,he=null,de=[],ve=[],ce=0,_e=null;while(j<G){var ge=U[j];if(ge===vv){H=W;W=U[j+1];X[Y]=W;Y+=1;if(W===l){if(!fe){fe=kv(true,Z)}te=new fe;le=true;_e=Z}else if(W===f){if(!he){he=kv(false,$)}te=new he;le=false;_e=$}j+=2}else if(ge===cv){if(K&&W===u){_e=q?Z:$;var pe=V[J],value=ee;if(value){if(pe===D){value=+value}else if(pe===F){value=+value|0}else if(pe===P){value=value==="true"}else if(pe===O){value=value.split(" ").filter(function(e){return e})}}_e[K]={title:Q||K,type:pe,default:value};K=null;Q=null;J=null;ee=undefined}else if(W===l&&Y===z){if(ue){te.attributes.color="rgba("+re+", "+ie+", "+ne+", "+ae+")";re=0;ie=0;ne=0;ae=1;ue=false}if(!te.id){te.id=++ce}de.push(te)}else if(W===f&&Y===z){if(!te.id){te.id=++ce}ve.push(te)}else if(W===_&&Y===R&&oe){var ye=(le?Z:$)[oe];if(ye){if(se===undefined){se=ye.default}else{pe=ye.type;if(pe){if(pe===D){se=+se}else if(pe===F){se=+se|0}else if(pe===P){se=se==="true"}else if(pe===O){se=se.split(" ").filter(function(e){return e}).map(function(e){return Nv(e)})}else{se=Nv(se)}}}te.data[_e[oe].title]=se}oe=null;se=null}Y-=1;W=H;H=X[Y-2];j+=1}else if(ge===_v){var me=U[j+1];value=e.substring(U[j+2],U[j+3]);if(W===s){if(me===g){q=value!=="edge"&&value!=="edges"}}else if(W===u){if(me===p){K=value}else if(me===y){J=value}else if(me===m){Q=value}}else if((W===l||W===f)&&Y===z){if(me===p){te.id=value}else if(me===b){te.attributes.text=value}else if(me===x){te.source=value}else if(me===A){te.target=value}else if(me===I){te.attributes.width=+value}}else if(W===d&&Y===L){if(me===w){te.attributes.x=+value}else if(me===S){te.attributes.y=-value}}else if(W===c&&Y===L){ue=true;if(me===E){re=value}else if(me===T){ie=value}else if(me===M){ne=value}else if(me===C){ae=value}}else if(W===v&&Y===L){if(me===k){if(le){te.attributes.radius=+value}else{te.attributes.width=+value}}}else if(W===_&&Y===R){if(me===N||me===p){oe=value}else if(me===k){se=value}}j+=4}else if(ge===gv){value=e.substring(U[j+1],U[j+2]);if(W===h){ee=value}j+=3}else{throw new Error("at index "+j+": token "+ge)}}return{nodes:de,edges:ve}}b.extend(function(e){e.modules.imports.register("gexf",{translate:Iv,webWorkerCompatible:true});e.parse.gexf=function(t){return e.modules.imports.from("gexf",t)};e.parse.gexfFromUrl=function(t){return Vr(t).then(function(t){return e.modules.imports.from("gexf",t)})}});function zv(e,t,r){r=r||t;if(t in e){if(!e.attributes){e.attributes={}}e.attributes[r]=e[t]}}function Lv(e){var t=JSON.parse(e),r=t.nodes||[],i=t.edges||[];for(var n=0,a=r.length;n<a;++n){var o=r[n];if(typeof o.size==="string"){o.size=+o.size}if(typeof o.x==="string"){o.x=+o.x}if(typeof o.y==="string"){o.y=+o.y}zv(o,"x");zv(o,"y");zv(o,"size","radius");zv(o,"color");zv(o,"text")}for(var s=0,u=i.length;s<u;++s){var l=i[s];if(typeof l.size==="string"){l.size=+l.size}zv(l,"size","width");zv(l,"color");zv(l,"text")}return t}b.extend(function(e){e.modules.imports.register("json",{translate:Lv,webWorkerCompatible:true});e.parse.json=function(t){return e.modules.imports.from("json",t)};e.parse.jsonFromUrl=function(t){return Vr(t).then(function(t){return e.modules.imports.from("json",t)})}});b.extend(function(e){e.modules.imports.register("neo4j",Ov);e.parse.neo4j=function(t){return e.modules.imports.from("neo4j",t)}});function Rv(e){if(typeof e!=="object"||e===null){throw new Error("Ogma can only retrieve nodes and relationships from Neo4j. "+"Please make sure that your Cypher query returns nodes and edges, not values.")}if(typeof e.identity!=="number"){e.identity=e.identity.low;if("start"in e&&"end"in e){e.start=e.start.low;e.end=e.end.low}}}var Dv=function(e){return"start"in e&&"end"in e&&"type"in e};var Fv=function(e){return"segments"in e};function Pv(e,t){t.segments.forEach(function(t){Bv(e,t.start);Bv(e,t.end);Bv(e,t.relationship)})}function Bv(e,t){if(t){if(Array.isArray(t)){t.forEach(function(t){return Bv(e,t)})}else if(Fv(t)){Pv(e,t)}else{Rv(t);if(Dv(t)){e.edges.push({id:t.identity,source:t.start,target:t.end,data:{neo4jType:t.type,neo4jProperties:t.properties}})}else{e.nodes.push({id:t.identity,attributes:{x:Math.random()*100,y:Math.random()*100},data:{neo4jLabels:t.labels,neo4jProperties:t.properties}})}}}}function Ov(e){var t={nodes:[],edges:[]};e.records.forEach(function(e){e.forEach(function(e){Bv(t,e)})});return t}b.extend(function(e){e.modules.imports.register("janus",Vv);e.parse.janus=function(t){return e.modules.imports.from("janus",t)}});function Vv(e){var t=[],r=[];var i=function(e){if(!e||typeof e!=="object"){return}if(e.type==="vertex"){var n={};if(e.properties){Object.keys(e.properties).forEach(function(t){n[t]=e.properties[t][0].value})}t.push({id:e.id+"",data:{id:e.id+"",categories:[e.label],properties:n}})}else if(e.type==="edge"){r.push({id:e.id+"",source:e.inV+"",target:e.outV+"",data:{id:e.id+"",type:e.label,properties:e.properties||{}}})}else if(Array.isArray(e)){e.forEach(function(e){return i(e)})}else{Object.keys(e).forEach(function(t){return i(e[t])})}};i(e);return{nodes:t,edges:r}}b.extend(function(e){e.modules.labels=new nc(e.modules)});var jv=1.2;var Uv=5;var Gv=Math.PI/2;var Xv="text.hidden";var Wv="topDown";var Hv="bottomUp";var Yv=.25;var qv=6;var Zv=5;var $v={left:-1,right:1,top:0,bottom:0,center:0};var Kv={left:0,right:0,top:-1,bottom:1,center:0};var Jv=4;var Qv={left:-1,right:0,top:-1/2,bottom:-1/2,center:-1/2};var ec={left:-1/2,right:-1/2,top:-1,bottom:0,center:-1/2};var tc={x1:0,y1:0,x2:0,y2:0};var rc=new Yi;var ic=["x","y","radius","width","text.content","text.minVisibleSize","text.size","text.scale","text.scaling","text.padding","text.margin","text.position"];var nc=function e(t){var r=this;var i=t.dom;var n=t.graph;var a=t.graphics;var o=t.camera;var s=t.events;var u=t.settings;var l=t.sync;this._dom=i;this._graph=n;this._graphics=a;this._camera=o;this._events=s;this._settings=u;this._sync=l;this._engine=a.getGraphicsEngine();n.getNodeAttribute("layer").initialize();n.getEdgeAttribute("layer").initialize();this._textBBoxes=[];this._textQuad=new $o(function(e){var t=qv;var i=t*e;return r._textBBoxes.slice(i,i+t)},Uv);this._enabled=false;this._forceEnabled=false;this._events.register(["labelCollisionsRemoved"]);this._updateDebounced=this._sync.debounceIdle(function(){return r._updateLabels()},100);u.register("texts.preventOverlap",true,function(e){return r._onToggle(e)});u.register("texts.debug",false,function(e){return r._toggleDebug(e)});u.register("texts.removalStrategy",Wv);this._rects=[];this._events.on({viewChanged:function(){r._update()},"nodeAttributesChanged edgeAttributesChanged":function(e){var t=e.attributes;if(t.some(function(e){return ic.includes(e)})){r._update()}},setContainer:function(e){var t=e.element;if(t){r._enable()}else{r._disable()}}})};nc.prototype._update=function e(){if(this._enabled||this._forceEnabled){this._updateDebounced()}};nc.prototype._enable=function e(){this._enabled=true;this._update()};nc.prototype._disable=function e(){this._enabled=false};nc.prototype.forceEnable=function e(){this._forceEnabled=true};nc.prototype._onToggle=function e(t){if(t){this._update()}else{this._reset()}};nc.prototype._toggleDebug=function e(t){if(t){this._canvas=Er();this._graphics.addCanvas(this._canvas);this._ctx=this._canvas.getContext("2d");this._update()}else if(this._canvas){this._graphics.removeCanvas(this._canvas);this._canvas=this._ctx=null}};nc.prototype.update=function e(){this._update()};nc.prototype._onCameraMove=function e(){this._update()};nc.prototype.forceUpdate=function e(){this._updateLabels()};nc.prototype._updateLabels=function e(){if(!this._settings.get("texts.preventOverlap")){return}this._intersects=[];var t=this._textQuad;t.clear();var r=this._textBBoxes=[];var i=this._rects=[];var n=this._camera.getAngle();var a=this._camera.getProjectedScreenBounds(Yv);var o=this._settings.get("texts.removalStrategy")===Hv;this._screen=a;var s={angle:n,zoom:this._camera.getZoom(),sin:Math.sin(n),cos:Math.cos(n),screen:a};var u={remove:{nodes:[],edges:[]},redraw:{nodes:[],edges:[]}};this._fillNodeTexts(t,r,i,s,o,u);this._fillEdgeTexts(t,r,i,s,o,u);this._clearOverlaps(u);if(this._settings.get("texts.debug")){this.drawAll(s)}};nc.prototype._fillNodeTexts=function e(t,r,i,n,a,o){var s=this;var u=this._graph;var l=o.remove.nodes;var f=o.remove.edges;var h=o.redraw.nodes;var d=n.angle;var v=n.zoom;var c=n.sin;var _=n.cos;var g=n.screen;var p=u.getNodes()._indexes.slice();var y=u.getNodeAttribute("layer")._buffer;Gn(p,y);var m=u.getAttributes(true,["x","y","radius","innerStroke.width","outerStroke.width","text.content","text.position","text.size","text.font","text.style","text.maxLineLength","text.scaling","text.scale","text.minVisibleSize","text.padding","text.margin","animationDuration"]);var b=m[0];var x=m[1];var A=m[2];var w=m[3];var S=m[4];var E=m[5];var T=m[6];var M=m[7];var C=m[8];var k=m[9];var N=m[10];var I=m[11];var z=m[12];var L=m[13];var R=m[14];var D=m[15];var F=m[16];var P=u.getNodeAttribute(Xv);var B,O;for(var V=0,j=p.length;V<j;V++){B=p[V];var U=F.get(B);var G=E.get(B);if(G===null||G===""||U){continue}var X=A.get(B);var W=L.get(B);if(X*2*v<W){continue}var H=b.get(B);var Y=x.get(B);if(g[0]>H||g[2]<H||g[1]>Y||g[3]<Y){continue}if(typeof G==="number"){G=G.toString()}var q=!I.get(B);var Z=T.get(B);var $=R.get(B);var K=z.get(B);var J=(q?M.get(B):K*X)*jv;var Q=k.get(B);var ee=C.get(B);var te=N.get(B);var re=Yf(G,te);var ie=re.lines;var ne=$+w.get(B)+S.get(B)+D.get(B);var ae=$v[Z];var oe=Kv[Z];var se=s._engine.measureText(G,ee,Q,J).width;var ue=ie*J*jv;var le=se/2/v;var fe=ue/2/v;var he=ne/v;var de=Qv[Z]*se;var ve=ec[Z]*ue;if(q){de/=v;ve/=v}de=de+ae*he+le+ae*X;ve=ve+oe*he+fe+oe*X;var ce=xo(H-le,Y-fe,se/v,ue/v,-d,c,-_);var _e=[H-le,Y-fe,se/v,ue/v,d];var ge=_*de-c*ve;var pe=c*de+_*ve;ce[0]+=ge;ce[1]+=pe;ce[2]+=ge;ce[3]+=pe;_e[0]+=ge;_e[1]+=pe;var ye=t.query(ce);if(ye.length!==0){var me=false;var be=Ao(_e[0],_e[1],_e[2],_e[3],_e[4]);for(var xe=0;xe<ye.length;xe++){var Ae=ye[xe];var we=Ae*Zv;var Se=Ao(i[we],i[we+1],i[we+2],i[we+3],i[we+4]);if(ca(be,Se)){s._intersects.push(be,Se);me=true;if(a){t.remove(Ae);if(r[Ae*qv+4]===1){l.push(r[Ae*qv+5])}else{f.push(r[Ae*qv+5])}}else{break}}}if(me&&!a){l.push(B);continue}}if(P.get(B)){h.push(B)}O=r.length/qv;r.push(ce[0],ce[1],ce[2],ce[3],1,B);t.insert(O);i.push(_e[0],_e[1],_e[2],_e[3],_e[4])}};nc.prototype._fillEdgeTexts=function e(t,r,i,n,a,o){var s=this;var u=this._graph;var l,f;var h=o.remove.nodes;var d=o.remove.edges;var v=o.redraw.edges;var c=n.angle;var _=n.zoom;var g=n.screen;var p=u.getAttributes(true,["x","y","radius"]);var y=p[0];var m=p[1];var b=p[2];var x=u.getEdges()._indexes.slice();var A=u.getEdgeAttribute("layer")._buffer;Gn(x,A);var w=u.getEdgeAttribute(Xv);var S=Math.PI;var E=this._graph.getAttributes(false,["source","target","width","curvature"]);var T=E[0];var M=E[1];var C=E[2];var k=E[3];var N=this._graph.getAttributes(false,["text.content","text.scaling","text.size","text.font","text.style","text.scale","text.maxLineLength","text.padding","animationDuration","text.minVisibleSize"]);var I=N[0];var z=N[1];var L=N[2];var R=N[3];var D=N[4];var F=N[5];var P=N[6];var B=N[7];var O=N[8];var V=N[9];for(var j=0,U=x.length;j<U;j++){l=x[j];var G=O.get(l);var X=I.get(l);if(X===null||X===""||G){continue}var W=T.get(l);var H=M.get(l);var Y=C.get(l);var q=k.get(l);var Z=V.get(l);if(Y*_<Z){continue}var $=(y.get(W)+y.get(H))/2;var K=(m.get(W)+m.get(H))/2;if(g[0]>$||g[2]<$||g[1]>K||g[3]<K){continue}if(typeof X==="number"){X=X.toString()}var J=!z.get(l);var Q=F.get(l);var ee=R.get(l);var te=(J?L.get(l):Q*Y)*jv;var re=D.get(l);var ie=P.get(l);var ne=B.get(l);var ae=y.get(W),oe=m.get(W);var se=y.get(H),ue=m.get(H);var le=void 0;if(W===H){le=S/4-c;oo(ae,oe,q,b.get(W),tc);fo(.5,ae,oe,se,ue,tc.x1,tc.y1,tc.x2,tc.y2,rc);$=rc.x;K=rc.y}else if(q===0){le=Si(ae,oe,se,ue)-c}else{le=Si(ae,oe,se,ue)-c;no(ae,oe,se,ue,q,tc);so(.5,ae,oe,se,ue,tc.x,tc.y,rc);$=rc.x;K=rc.y}var fe=ne+Jv;var he=Yf(X,ie);var de=he.lines;var ve=s._engine.measureText(X,ee,re,te).width*jv;var ce=de*te;var _e=ve/_/2;var ge=ce/_/2;var pe=Math.abs(le)<Gv?1:-1;var ye=pe*(fe/_+Y/2+ge);var me=[$-_e,K-ge,$+_e,K+ge,le+c];wo(me,-(le+c),-ye,me);me[2]=me[2]-me[0];me[3]=me[3]-me[1];le=S-le-c;var be=xo($-_e,K-ge,_e*2,ge*2,le);wo(be,le,ye,be);var xe=t.query(be);if(xe.length){var Ae=false;var we=Ao(me[0],me[1],me[2],me[3],me[4]);for(var Se=0;Se<xe.length;Se++){var Ee=xe[Se];var Te=Ee*Zv;var Me=Ao(i[Te],i[Te+1],i[Te+2],i[Te+3],i[Te+4]);if(ca(we,Me)){Ae=true;s._intersects.push(we,Me);if(a){t.remove(Ee);if(r[Ee*qv+4]===1){h.push(r[Ee*qv+5])}else{d.push(r[Ee*qv+5])}}else{break}}}if(Ae&&!a){d.push(l);continue}}if(w.get(l)){v.push(l)}w.set(l,false);f=r.length/qv;r.push(be[0],be[1],be[2],be[3],0,l);t.insert(f);i.push(me[0],me[1],me[2],me[3],me[4])}};nc.prototype._clearOverlaps=function e(t){var r=this;var i=t.remove.nodes;var n=t.remove.edges;var a=t.redraw.nodes;var o=t.redraw.edges;var s;var u=new Array(i.length+a.length);var l=new Array(n.length+o.length);var f=new this._graph.NodeList(i.concat(a));var h=new this._graph.EdgeList(n.concat(o));for(s=0;s<i.length;s++){u[s]=true}for(s=i.length;s<u.length;s++){u[s]=false}for(s=0;s<n.length;s++){l[s]=true}for(s=n.length;s<l.length;s++){l[s]=false}f.setAttribute(Xv,u);h.setAttribute(Xv,l);setTimeout(function(){return r._events.fire("labelCollisionsRemoved",t)})};nc.prototype._reset=function e(){var t=this._graph;var r=t.getEdges()._indexes;var i=t.getNodes()._indexes;var n=[];var a=[];var o=t.getNodeAttribute(Xv);var s=t.getEdgeAttribute(Xv);var u;for(var l=0;l<i.length;l++){u=i[l];if(o.get(u)){n.push(u)}}for(var f=0;f<r.length;f++){u=r[f];if(s.get(u)){a.push(u)}}o.reset();s.reset();this._clearOverlaps({remove:{nodes:[],edges:[]},redraw:{nodes:n,edges:a}})};nc.prototype.drawAll=function e(){var t=this;this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height);var r=this._textBBoxes;for(var i=0,n=r.length;i<n;i+=6){ac(r.slice(i,i+4),t._ctx,t._camera,"#aaaaaa")}var a=this._rects;for(var o=0;o<a.length;o+=5){var s=Ao(a[o],a[o+1],a[o+2],a[o+3],a[o+4]);oc(s,t._ctx,t._camera,"green")}this._intersects.forEach(function(e){return oc(e,t._ctx,t._camera,"red")})};function ac(e,t,r,i){if(i===void 0)i="#22ff00";return oc([[e[0],e[1]],[e[2],e[1]],[e[2],e[3]],[e[0],e[3]]].map(function(e){return{x:e[0],y:e[1]}}),t,r,i)}function oc(e,t,r,i){if(i===void 0)i="#ff0000";t.strokeStyle=i;t.lineWidth=1;t.beginPath();var n=b.utils.getPixelRatio();for(var a=0,o=e.length;a<o;a++){var s=r.graphToScreenCoordinates(e[a]);if(a===0){t.moveTo(s.x*n,s.y*n)}else{t.lineTo(s.x*n,s.y*n)}}t.closePath();t.stroke()}var sc=["hover","zoom","panning","rotation","gesture","drag","selection","tooltip","user","interactions","resizing","rewiring","connectNodes","lasso"];b.extend(function(e){var t=new uc(e);e.modules.interactions=t});var uc=function e(t){this._captor=t.modules.captor;this._events=t.modules.events;this._settings=t.modules.settings;this._timeout=null;this._current=null;this._started=false;this._scheduled=[];this._priority=0;this._startFunc=null};uc.prototype.onDrag=function e(t){return lc(this,"dragStart","dragProgress","dragEnd",t)};uc.prototype.onGesture=function e(t){return lc(this,"gestureStart","gestureProgress","gestureEnd",t)};uc.prototype.onClick=function e(t){return fc(this,"click",t)};uc.prototype.onDoubleClick=function e(t){return fc(this,"doubleClick",t)};uc.prototype.onHover=function e(t){return fc(this,"hover",t)};uc.prototype.onUnhover=function e(t){return fc(this,"unhover",t)};uc.prototype.onMouseWheel=function e(t){return fc(this,"wheel",t)};uc.prototype.onMouseDown=function e(t){return fc(this,"down",t)};uc.prototype.onMouseUp=function e(t){return fc(this,"up",t)};uc.prototype.onMouseMove=function e(t){return fc(this,"move",t)};function lc(e,t,r,i,n){var a;var o=n.check;var s=n.onStart;var u=n.onStop;var l=n.onProgress;var f=n.priority;var h=n.disableDetection;if(f!==undefined){var d=hc(e,{priority:pt(sc,f,"interaction"),disableDetection:h,check:o,onStart:s,onStop:u,onProgress:l});e._events.on((a={},a[t]=function(e){return d.start(e)},a[r]=function(e){return d.progress(e)},a[i]=function(e){return d.stop(e)},a));return d}else{var v=false;e._events.on(t,function(e){v=!o||o(e);if(v&&s){s(e)}});if(l){e._events.on(r,function(e){if(v){l(e)}})}if(u){e._events.on(i,function(e){if(v){if(u){u(e)}v=false}})}}}function fc(e,t,r){if(typeof r==="function"){r={handler:r}}var i=r.priority;var n=r.handler;var a=r.check;if(i!==undefined){var o=hc(e,{priority:pt(sc,i,"interaction"),check:a,handler:n});e._events.on(t,o)}else if(n){if(a){e._events.on(t,function(e){if(a(e)){n(e)}})}else{e._events.on(t,n)}}}function hc(e,t){if(t===void 0)t={};if(typeof t==="function"){t={onStart:t}}else if(!tt(t)){throw new TypeError("invalid parameters "+t+": not an object")}var r=ot(t.onStart,t.handler),i=ot(t.onProgress,function(){}),n=ot(t.onStop,function(){}),a=ot(t.check,function(){return true}),o=ot(t.disableDetection,false),s=ot(t.priority,0),u=null,l=null;r=ot(r,function(){});var f=function(t){if(a(t)&&(!e._current||s>=e._priority)){e._priority=s;if(e._current!==u){if(e._current){e._current.stop()}e._current=u;e._started=false;e._scheduled=null;e._startFunc=function(){if(o){l=e._captor.setDetectionEnabled(false)}r(t)};dc(e)}return true}return false};var h=function(t){if(e._current===u){if(e._started){if(o){e._captor.setDetectionEnabled(l)}n(t)}if(e._timeout){clearTimeout(e._timeout)}e._timeout=null;e._current=null;e._priority=0;e._started=false;e._scheduled=null}};var d=function(t){if(e._current===u&&e._started){i(t)}};u=function(t){if(f(t)){e._scheduled=h}};u.start=f;u.stop=h;u.progress=d;return u}function dc(e){if(!e._timeout){e._timeout=setTimeout(function(){if(e._startFunc){e._startFunc();e._startFunc=null;e._started=true}if(e._scheduled){e._scheduled()}e._scheduled=null;e._timeout=null},0)}}var vc=1e3;b.extend(function(e){var t=new cc(e);var r=e.Node;var i=e.Edge;var n=e.NodeList;var a=e.EdgeList;e.modules.classes=t;e.createClass=function(e,r){t.create(e,r)};e.updateClass=function(e,r){t.update(e,r)};e.events.onNodesClassAdded=function(r,i){t.onNodesClassAdded(r,i);return e.events};e.events.onNodesClassRemoved=function(r,i){t.onNodesClassRemoved(r,i);return e.events};e.events.onEdgesClassAdded=function(r,i){t.onEdgesClassAdded(r,i);return e.events};e.events.onEdgesClassRemoved=function(r,i){t.onEdgesClassRemoved(r,i);return e.events};e.getNodesByClassName=function(e){return t.getNodesByClass(e)};r.prototype.addClass=function(e,r){return t.addClassToNodes(e,this,r)};n.prototype.addClass=function(e,r){return t.addClassToNodes(e,this,r)};r.prototype.removeClass=function(e,r){return t.removeNodesFromClass(e,this,r)};n.prototype.removeClass=function(e,r){return t.removeNodesFromClass(e,this,r)};r.prototype.hasClass=function(e){return t.nodesHaveClass(e,this)[0]};n.prototype.hasClass=function(e){return t.nodesHaveClass(e,this)};e.getEdgesByClassName=function(e){return t.getEdgesByClass(e)};i.prototype.addClass=function(e,r){return t.addClassToEdges(e,this,r)};a.prototype.addClass=function(e,r){return t.addClassToEdges(e,this,r)};i.prototype.removeClass=function(e,r){return t.removeEdgesFromClass(e,this,r)};a.prototype.removeClass=function(e,r){return t.removeEdgesFromClass(e,this,r)};i.prototype.hasClass=function(e){return t.edgesHaveClass(e,this)[0]};a.prototype.hasClass=function(e){return t.edgesHaveClass(e,this)}});var cc=function e(t){var r=this;this._graphics=t.modules.graphics;this._graph=t.modules.graph;this._events=t.modules.events;this._classes=[];this._classesByName={};this._events.on({"refreshNodeFilters refreshEdgeFilters":function(e){var t=e.newlyExcluded;for(var i=0;i<r._classes.length;++i){gc(r,r._classes[i].name,t)}}})};cc.prototype.create=function e(t,r){if(r===void 0)r={};var i=r.nodeAttributes;var n=r.edgeAttributes;var a=r.after;if(this._classesByName[t]){throw new Error('class "'+t+'" already exists')}var o=yc(this,a)+1,s=bc(this,o),u={name:t,priority:s,set:this._graph.createSet(),nodeAddEvtName:"nodeClassAdded_"+t,edgeAddEvtName:"edgeClassAdded_"+t,nodeRemovalEvtName:"nodeClassRemoved_"+t,edgeRemovalEvtName:"edgeClassRemoved_"+t};this._events.register([u.nodeAddEvtName,u.edgeAddEvtName,u.nodeRemovalEvtName,u.edgeRemovalEvtName]);this._classes.splice(o,0,u);this._classesByName[t]=u;this._graphics.addLayer(t,{nodeAttributes:i,edgeAttributes:n,depth:s});return s};cc.prototype.update=function e(t,r){var i=r.nodeAttributes;var n=r.edgeAttributes;this.setNodeAttributes(t,i);this.setEdgeAttributes(t,n)};cc.prototype.setNodeAttributes=function e(t,r){if(r===null){this._graphics.resetLayerStyle(t,{nodeAttributes:{}})}else{this._graphics.updateLayerAttributes(t,{nodeAttributes:r})}this._graphics.putOnLayer(this.getNodesByClass(t),t)};cc.prototype.setEdgeAttributes=function e(t,r){if(r===null){this._graphics.resetLayerStyle(t,{edgeAttributes:{}})}else{this._graphics.updateLayerAttributes(t,{edgeAttributes:r})}this._graphics.putOnLayer(this.getEdgesByClass(t),t)};cc.prototype.getNodesByClass=function e(t){return mc(this,t).set.getNodes()};cc.prototype.getEdgesByClass=function e(t){return mc(this,t).set.getEdges()};cc.prototype.onNodesClassAdded=function e(t,r){this._events.on(mc(this,t).nodeAddEvtName,r)};cc.prototype.onEdgesClassAdded=function e(t,r){this._events.on(mc(this,t).edgeAddEvtName,r)};cc.prototype.onNodesClassRemoved=function e(t,r){this._events.on(mc(this,t).nodeRemovalEvtName,r)};cc.prototype.onEdgesClassRemoved=function e(t,r){this._events.on(mc(this,t).edgeRemovalEvtName,r)};cc.prototype.addClassToNodes=function e(t,r,i){return _c(this,t,r,i)};cc.prototype.addClassToEdges=function e(t,r,i){return _c(this,t,r,i)};cc.prototype.removeNodesFromClass=function e(t,r,i){return gc(this,t,r,i)};cc.prototype.removeEdgesFromClass=function e(t,r,i){return gc(this,t,r,i)};cc.prototype.nodesHaveClass=function e(t,r){return mc(this,t).set.hasNodes(r)};cc.prototype.edgesHaveClass=function e(t,r){return mc(this,t).set.hasEdges(r)};cc.prototype.clearNodes=function e(t,r){return pc(this,t,true,r)};cc.prototype.clearEdges=function e(t,r){return pc(this,t,false,r)};function _c(e,t,r,i){var n;var a=r.isNode,o=mc(e,t),s=o.set.addElements(r);var u=e._graphics.putOnLayer(s,t,{duration:i,chain:false}).then(function(){return r});if(s.size){e._events.fire(o[a?"nodeAddEvtName":"edgeAddEvtName"],(n={},n[a?"nodes":"edges"]=s,n._className=t,n))}return u}function gc(e,t,r,i){var n;var a=r.isNode,o=mc(e,t),s=o.set.removeElements(r);var u=e._graphics.removeFromLayer(s,t,{duration:i,chain:false}).then(function(){return r});if(s.size){e._events.fire(o[a?"nodeRemovalEvtName":"edgeRemovalEvtName"],(n={},n[a?"nodes":"edges"]=s,n._className=t,n))}return u}function pc(e,t,r,i){var n;var a=mc(e,t);var o=a.set[r?"clearNodes":"clearEdges"]();var s=e._graphics.removeFromLayer(o,t,{duration:i,chain:false});if(o.size){e._events.fire(a[r?"nodeRemovalEvtName":"edgeRemovalEvtName"],(n={},n[r?"nodes":"edges"]=o,n._className=t,n))}return s}function yc(e,t){for(var r=0;r<e._classes.length;++r){if(e._classes[r].name===t){return r}}return-1}function mc(e,t){var r=yc(e,t);if(r===-1){throw new Error('class "'+t+'" does not exist')}return e._classes[r]}function bc(e,t){var r=e._classes,i=r.length;if(t===i){return t===0?vc:r[t-1].priority*2}else if(t===0){return r[0].priority/2}else{return(r[t-1].priority+r[t].priority)/2}}var xc=function(){return{}};var Ac=function(){return undefined};var wc=function(){return false};var Sc=function(){};var Ec=function(){};var Tc=function(){};var Mc=function(e){function t(t,r){e.call(this);this._dependencies=r;this.configure(t);this._complete=false}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.configure=function e(t){this._onStart=t.onStart||Ec;this._onEnd=t.onEnd||Tc;this._update=t.update||Ac;this._onUpdate=t.onUpdate||Sc;this._createContext=t.context||xc;this._isRunning=t.isRunning||wc};t.prototype.onStart=function e(){this.fire("start",{target:this});this._onStart.call(this);return this};return t}(F);var Cc=function(e){function t(t,r){var i=this;e.call(this,t,r);var n=[kc(t.imports),"","","var __CONTEXT = ("+this._createContext.toString()+")(),","    __UPDATE_FUNC = "+this._update.toString()+",","    __IS_RUNNING_FUNC = "+this._isRunning.toString()+";","",'self.addEventListener("message", function (evt) {',"  var result    = __UPDATE_FUNC(evt.data, __CONTEXT);","  var isRunning = __IS_RUNNING_FUNC(__CONTEXT, evt.data);","  self.postMessage({ result: result, isRunning: isRunning });","});"].join("\n");this._worker=Ln(n);this._sync=function(e){i.sync(e)};this._worker.addEventListener("message",this._sync)}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.sync=function e(t){var r=t.data.isRunning;var i=t.data.result;var n=this._onUpdate.call(this,i,this._dependencies,r);this.fire("update",{target:this,isRunning:r});if(r){this.send(n)}else{this.stop(i)}};t.prototype.stop=function e(t){if(!this._complete){this._onEnd.call(this,t,this._dependencies);this._worker.terminate();this.fire("stop",{target:this})}this._complete=true};t.prototype.send=function e(t){this._worker.postMessage(t);return this};return t}(Mc);function kc(e){if(!e||e.length===0){return""}var t=[];var r=Object.keys(e);for(var i=0,n=r.length;i<n;i++){var a=r[i];var o=e[a];if(typeof o!=="function"){throw new Error('Asynchronous task: dependency "'+a+'" is not found')}else{t.push("var "+a+" = "+o.toString()+";")}}return t.join("\n")}var Nc=function(e){function t(t,r){e.call(this,t,r);this._context=this._createContext()}if(e)t.__proto__=e;t.prototype=Object.create(e&&e.prototype);t.prototype.constructor=t;t.prototype.sync=function e(t){var r=this._update(t,this._context),i=this._isRunning(this._context,t);t=this._onUpdate.call(this,r,this._dependencies,i);this.fire("update",{target:this,isRunning:i});if(i){this.send(t)}else{this.stop(r)}};t.prototype.send=function e(t){var r=this;if(!this._complete){setTimeout(function(){return r.sync(t)},0)}return this};t.prototype.stop=function e(t){if(!this._complete){this._onEnd(t,this._dependencies);this._complete=true}};return t}(Mc);b.extend(function(e){return e.modules.tasks=new Ic(e)});var Ic=function e(t){this._ogma=t};Ic.prototype.run=function e(t,r,i,n){var a=ot(i,true),o=t.configure||function(e){return e};var s=zc(o,r,n);var u=a?Cc:Nc;var l=new u(t,n);l.onStart();l.send(s);return l};function zc(e,t,r){var i=e(t,r);if(i===undefined){i=t}return i}b.extend(function(e){e.modules.generators=new Lc(e);e.generate={}});var Lc=function e(t){this._ogma=t;this._graph=t.modules.graph;this._tasks=t.modules.tasks;this._generators={}};Lc.prototype.register=function e(t,r){gt(this._generators,t,r,"generator")};Lc.prototype.load=function e(t,r){var i=pt(this._generators,t,"generator"),n=i.configure(r);return Promise.resolve(i.generate(n))};function Rc(e){if(e===void 0)e={};var t=e.nodes;if(t===void 0)t=10;var r=e.edges;if(r===void 0)r=10;var i=e.texts;if(i===void 0)i=false;return{nodes:t,edges:r,texts:i}}function Dc(e){var t=e.nodes;var r=e.edges;var i=e.texts;var n=[],a=[];for(var o=0;o<t;o++){n.push({id:o,attributes:{x:Math.random()*200,y:Math.random()*200,text:i?"Node "+o:undefined}})}for(var s=0;s<r;s++){a.push({id:s,source:Math.random()*t|0,target:Math.random()*t|0,attributes:{text:i?"Edge "+s:undefined}})}return{nodes:n,edges:a}}b.extend(function(e){e.modules.generators.register("random",{configure:Rc,generate:Dc});e.generate.random=function(t){return e.modules.generators.load("random",t)}});function Fc(e){if(e===void 0)e={};var t=e.rows;if(t===void 0)t=4;var r=e.columns;if(r===void 0)r=4;return{rows:t,columns:r}}function Pc(e){var t=e.rows;var r=e.columns;var i={nodes:[],edges:[]},n=20,a=20,o=0;for(var s=0;s<t;++s){for(var u=0;u<r;++u){var l=s*r+u;i.nodes.push({id:l,attributes:{x:u*n,y:s*a}});if(u!==r-1){i.edges.push({id:o,source:l,target:s*r+u+1});o+=1}if(s!==t-1){i.edges.push({id:o,source:l,target:(s+1)*r+u});o+=1}}}return i}b.extend(function(e){e.modules.generators.register("grid",{configure:Fc,generate:Pc});e.generate.grid=function(t){return e.modules.generators.load("grid",t)}});function Bc(e){if(e===void 0)e={};var t=e.length;if(t===void 0)t=5;return{length:t}}function Oc(e){var t=e.length;var r={nodes:[],edges:[]};if(t<=0){return r}r.nodes.push({id:0,attributes:{x:Math.random()*100,y:Math.random()*100}});for(var i=1;i<t;++i){r.nodes.push({id:i,attributes:{x:Math.random()*100,y:Math.random()*100}});r.edges.push({id:i-1,source:i-1,target:i})}return r}b.extend(function(e){e.modules.generators.register("path",{configure:Bc,generate:Oc});e.generate.path=function(t){return e.modules.generators.load("path",t)}});function Vc(e){if(e===void 0)e={};var t=e.children;if(t===void 0)t=2;var r=e.height;if(r===void 0)r=3;if(!Ve(t)){throw new TypeError('Invalid argument: "children" is not a positive number, was '+t)}if(!Oe(r)){throw new TypeError('Invalid argument: "height" is not a positive number, was '+r)}return{children:t,height:r}}function jc(e){var t=e.children;var r=e.height;r+=1;var i=Math.pow(t,r),n=[],a=[],o=1,s=0,u=0;for(var l=0;l<r;++l){var f=i/(o+1)/1.5;for(var h=0;h<o;++h){var d=s++;n.push({id:d,attributes:{x:(h+1)*f*10,y:l*20}});if(l!==r-1){for(var v=0;v<t;++v){a.push({id:u,source:d,target:d*t+v+1});u+=1}}}o*=t}return{nodes:n,edges:a}}b.extend(function(e){e.modules.generators.register("balancedTree",{configure:Vc,generate:jc});e.generate.balancedTree=function(t){return e.modules.generators.load("balancedTree",t)}});function Uc(e){if(e===void 0)e={};var t=e.nodes;if(t===void 0)t=20;var r=e.edges;var i=e.p;if(!Be(t)||t<3){throw new TypeError("Invalid argument: options.nodes is not a number >= 3, was "+t)}if(r!==undefined&&i!==undefined){throw new TypeError("Invalid argument: choose between options.edges and options.p")}if(r===undefined&&i===undefined){i=.1}return{nodes:t,edges:r,p:i}}function Gc(e){var t={nodes:[],edges:[]},r,i,n,a=0,o=e.nodes,s=e.p;if(e.p>=0){for(i=0;i<o;i++){t.nodes.push({id:i,attributes:{x:Math.random()*100,y:Math.random()*100}});for(n=0;n<i;n++){if(Math.random()<s){t.edges.push({id:a++,source:i,target:n})}}}}else{var u=[],l=e.edges;for(i=0;i<o;i++){t.nodes.push({id:i,x:Math.random()*100,y:Math.random()*100,size:1});for(n=i+1;n<o;n++){u.push({source:i,target:n})}}a=u.length-1;for(i=0;i<l;i++){r=u.splice(Math.floor(Math.random()*a),1)[0];r.id=i;t.edges.push(r);a--}}return t}b.extend(function(e){e.modules.generators.register("erdosRenyi",{configure:Uc,generate:Gc});e.generate.erdosRenyi=function(t){return e.modules.generators.load("erdosRenyi",t)}});function Xc(e){if(e===void 0)e={};var t=e.nodes;if(t===void 0)t=40;var r=e.m0;if(r===void 0)r=5;var i=e.m;if(i===void 0)i=1;var n=e.scale;if(n===void 0)n=100;if(!Be(t)||t<3){throw new TypeError("Invalid argument: options.nodes is not a number >= 3, was "+t)}if(!Be(r)||r>=t){throw new TypeError("Invalid argument: options.m0 is not a number < "+t+", was "+r)}if(!Be(r)||i>=r){throw new TypeError("Invalid argument: options.m is not a number <= "+r+", was "+i)}if(!Be(n)||n<0){throw new TypeError("Invalid argument: options.scale is not a number or is less than 0")}return{nodes:t,m0:r,m:i,scale:n}}function Wc(e){var t={nodes:[],edges:[]},r={},i=[],n,a,o,s,u,l,f,h,d=e.scale,v=0,c=e.nodes,_=e.m0,g=e.m;var p=d/10;for(n=0;n<_;n++){t.nodes.push({id:n,attributes:{x:Math.random()*p,y:Math.random()*p}});i[n]=0}for(n=0;n<_;n++){for(a=n+1;a<_;a++){o={id:v++,source:n,target:a};r[o.source+"-"+o.target]=o;t.edges.push(o);i[n]++;i[a]++}}for(n=_;n<c;n++){t.nodes.push({id:n,attributes:{x:Math.random()*d,y:Math.random()*d}});i[n]=0;s=0;for(a=0;a<n;a++){s+=i[a]}u=0;for(l=0;l<g;l++){f=Math.random();h=0;for(a=0;a<n;a++){if(r[n+"-"+a]||r[a+"-"+n]){continue}if(n==1){h=1}else{h+=i[a]/s+u/(n-l)}if(f<=h){u+=i[a]/s;o={id:v++,source:n,target:a};r[o.source+"-"+o.target]=o;t.edges.push(o);i[n]++;i[a]++;break}}}}return t}b.extend(function(e){e.modules.generators.register("barabasiAlbert",{configure:Xc,generate:Wc});e.generate.barabasiAlbert=function(t){return e.modules.generators.load("barabasiAlbert",t)}});function Hc(e){if(e===void 0)e={};var t=e.nodes;if(t===void 0)t=50;var r=e.width;if(r===void 0)r=100;var i=e.height;if(i===void 0)i=100;var n=e.x;if(n===void 0)n=0;var a=e.y;if(a===void 0)a=0;if(!isFinite(t)||t<1){throw new RangeError("Tree generator: number of nodes must be a positive integer")}return{nodes:t,width:r,height:i,x:n,y:a}}function Yc(e){var t=e.nodes;var r=e.x;var i=e.y;var n=e.width;var a=e.height;var o=r-n/2;var s=i-a/2;return{nodes:new Array(t).fill(0).map(function(e,t){return{id:t,attributes:{x:o+Math.random()*n,y:s+Math.random()*a}}}),edges:new Array(t-1).fill(0).map(function(e,t){return{id:t,source:Math.floor(Math.sqrt(t)),target:t+1}})}}b.extend(function(e){e.modules.generators.register("randomTree",{configure:Hc,generate:Yc});e.generate.randomTree=function(t){return e.modules.generators.load("randomTree",t)}});var qc=5;var Zc=10;var $c=10;var Kc=2.7;var Jc=1/5;function Qc(e){var t=e.depth;if(t===void 0)t=3;var r=e.breadth;if(r===void 0)r=3;var i=e.nbNodes;if(i!==undefined){r=5;t=Math.ceil(Math.log(i)/Math.log(5))}return{depth:t,breadth:r,nbNodes:i}}function e_(e){var t=e.depth;var r=e.breadth;var i=e.nbNodes;var n={id:0,attributes:{x:0,y:0,radius:r_(t+1)}};var a={nodes:[n],edges:[]};i_(a,r,t,n,1);if(i!==undefined){a.nodes=a.nodes.slice(0,i);a.edges=a.edges.slice(0,Math.max(i-1,0))}return a}function t_(e){return Math.pow(Kc,e)*Zc}function r_(e){return qc+t_(e)/$c}function i_(e,t,r,i,n){if(r===0){return n}var distance=t_(r);var a=r_(r);var o=a*Jc;var s=-Math.PI;var u=Math.PI*2/t;var l=i.attributes.x;var f=i.attributes.y;for(var h=0;h<t;++h){var d=Math.cos(s);var v=Math.sin(s);var c={id:n,attributes:{x:l+distance*d,y:f+distance*v,radius:a}};var _={id:n,source:i.id,target:n,attributes:{width:o}};e.nodes.push(c);e.edges.push(_);n=i_(e,t,r-1,c,n+1);s+=u}return n}b.extend(function(e){e.modules.generators.register("flower",{configure:Qc,generate:e_});e.generate.flower=function(t){return e.modules.generators.load("flower",t)}});var n_=40;var a_="layoutStart";var o_="layoutEnd";var s_="layoutComputed";var u_="complete";var l_={defaultSyncDuration:500,skipTextDrawing:true,useWebWorker:true,locate:false};b.extend(function(e){var t=new f_(e);e.modules.layouts=t;e.layouts={stop:function(){return t.stop()}};e.events.onLayoutStart=function(t){e.modules.events.on(a_,t);return e.events};e.events.onLayoutComplete=function(t){e.modules.events.on(o_,t);return e.events};e.events.onLayoutComputed=function(t){e.modules.events.on(s_,t);return e.events}});var f_=function e(t){var r=this;this._modules=t.modules;this._events=t.modules.events;this._graph=t.modules.graph;this._graphics=t.modules.graphics;this._tasks=t.modules.tasks;this._settings=t.modules.settings;this._locate=t.modules.locate;this._camera=t.modules.camera;this._layouts={};Object.keys(l_).forEach(function(e){r._settings.register("layouts."+e,l_[e])});this._events.register([a_,o_,s_]);this._currentLayout=null;this._events.on("clear",function(){return r.stop()})};f_.prototype.register=function e(t,r){gt(this._layouts,t,r,"layout")};f_.prototype.getAvailableLayouts=function e(){return Object.keys(this._layouts)};f_.prototype.start=function e(t,r){var i=this;if(r===void 0)r={};var n=this._layouts[t];var a=this._settings;var o=this;return new Promise(function(e){if(!n){throw new Error("layout "+t+" does not exist")}if(i._currentLayout){i.stop()}var s=typeof r.duration==="number"?r.duration:a.get("layouts.defaultSyncDuration");var u=n.onSync;var l=r.onSync;var f=r.onEnd;var h=-Infinity;var d=ot(r.skipTextDrawing,a.get("layouts.skipTextDrawing"));var v=r.locate||a.get("layouts.locate");r.name=t;r.skipTextDrawing=d;if(v&&typeof v==="boolean"){v={}}var c={update:n.update,isRunning:n.isRunning,configure:n.configure,context:n.context,imports:n.imports,onStart:function(){if(d){o._graphics.hideTexts()}o.onStart(n,r,this)},onUpdate:function(e,r,i){var n=this;var a=oe();if(i&&a-h<n_){return}h=a;if(l){setTimeout(function(){return l(e,r,i)},s)}if(u){var f=u(e,r,i);o._events.fire(s_,{type:s_,name:t});var d=o._assignNodePositions(f,s);if(!i){if(v){o._animateCamera(f,v,s)}d.then(function(){return n.fire(u_)})}}else if(!i){this.fire(u_)}},onEnd:function(t,i){this.once(u_,function(){o.onComplete(t,n,r,i,e,f)})}};delete r.onSync;delete r.onEnd;i._currentLayout=i._tasks.run(c,r,ot(r.useWebWorker,i._settings.get("layouts.useWebWorker")),i._modules)})};f_.prototype._animateCamera=function e(t,r,i){var n=$d(t,this._graph);var a=this._locate.computeConfigForBounds(n,r);return this._camera.setView(a,{duration:i,easing:r.easing})};f_.prototype.onComplete=function e(t,r,i,n,a,o){var s=this;this._graphics.refreshAll();this._currentLayout=null;if(r.onEnd){r.onEnd(t,n,null,false)}if(i.skipTextDrawing){setTimeout(function(){return s._graphics.showTexts()},50)}var u=i.nodeData.indexes;var l=h_(u,this._graph,this._graphics);var f=i.nodeData;this._events.fire(o_,{type:o_,name:i.name,positions:{current:l.positions,before:f.positions},ids:l.ids});setTimeout(function(){if(o){o(t)}a()},0)};f_.prototype.onStart=function e(t,r,i){var n=this._graph;var a=n.nodeIndexList(r.nodes);var o=h_(a,n,this._graphics);r.nodeData=o;a=o.ids;this._events.fire(a_,{type:a_,name:r.name,ids:a,task:i})};f_.prototype.stop=function e(){if(this._currentLayout){this._currentLayout.stop();this._currentLayout.fire(u_);this._currentLayout=null}return this};f_.prototype.isRunning=function e(){return!!this._currentLayout};f_.prototype._assignNodePositions=function e(t,r){if(!t){return Promise.resolve()}var i=t.indexes;var n=t.x;var a=t.y;var o=this._graph._getElements(true,i),s=new Array(i.length);for(var u=0;u<s.length;++u){s[u]={x:n[u],y:a[u]}}return o.setAttributes(s,r)};function h_(e,t){var r=e.length;var i=t._getIds(true,e);var n=t._getElements(true,e).getPosition();return{positions:n,indexes:e,ids:i,size:r}}var d_={configure:function(e,t){var r=t.graph;var i=t.camera;var n=t.graphics;if(!e.nodes){e.nodes=r.getNodes()}if(e.nodes&&e.nodes instanceof r.NodeList){e.nodes=e.nodes.getId()}var a=r.nodeIndexList(e.nodes);var o,s={},u={};var l=a.length,f,h;var d=r._nodes,v=r._edges;if(e.nodes){e=kt(e);delete e.nodes}var c=n._getAttributeArray(true,"innerStroke.width");var _=n._getAttributeArray(true,"outerStroke.width");var g=r._degrees(a);var p=r.getNodeAttributesArrays(["x","y","radius"],{ids:a,destArrays:[new Float32Array(l),new Float32Array(l),new Array(l)]});var y=p[0];var m=p[1];var b=p[2];c=c.getMultiple(a);_=_.getMultiple(a);var x=new r.NodeList(a).getAttribute("layoutable");var A=typeof e.nodeMass==="function"?e.nodeMass:function(e,t,r){return t+1};delete e.nodeMass;var w=typeof e.edgeWeight==="function"?e.edgeWeight:function(e){return 1};delete e.edgeWeight;if(!isFinite(e.scalingRatio)){delete e.scalingRatio}var S=a.reduce(function(e,t,r){if(!x[r]){e[t]=true}return e},{});var E=0,T=0,M=0,C=0;var k=i.getZoom();for(h=0;h<a.length;++h){var N=a[h];var I=y[h],z=m[h];var L=b[h]+(c[h]+_[h])/k;s[N]={id:N,x:I,y:z,degree:g[h],size:L,pinned:!!S[N],mass:A(d.get(N),g[h],h)};C=Math.max(L,C)}if(l>1){for(h=0;h<l;h++){var R=s[a[h]];E+=R.x;T+=R.y}}E/=l;T/=l;var D={x:E,y:T};o=r._getAdjacentElements(false,a);f=o.length;var F=r._getSources(o);var P=r._getTargets(o);for(h=0;h<f;h++){var B=o[h];var O=F[h];var V=P[h];if(s[O]&&s[V]){u[B]={source:O,target:V};u[B].weight=w(v.get(B))}}return{nodes:s,edges:u,maxSize:C,config:Zt(e),barycentre:D}},context:function(){return{}},update:function(e,t){var r;if(!t.W){r={ppn:10,ppe:3,ppr:9,MAX_SUBDIVISION_RETRIES:3,maxForce:10,iterations:0,converged:false,settings:{linLogMode:false,outboundAttractionDistribution:false,adjustSizes:false,edgeWeightInfluence:0,scalingRatio:100,strongGravityMode:true,gravity:1,slowDown:1,barnesHutOptimize:false,barnesHutTheta:.5,startingIterations:10,iterationsPerRender:10,maxIterations:1e3,avgDistanceThreshold:.01,autoStop:true,alignNodeSiblings:true,nodeSiblingsScale:5,nodeSiblingsAngleMin:0}};t.W=r;c(e,e.config);r.settings=o(e.config,r.settings);t.nodes=e.nodes;t.edges=e.edges;t.barycentre=e.barycentre}else{r=t.W}var i=t.NodeMatrix,n=t.EdgeMatrix,a;function o(){var e=arguments;var t,r,i={},n=arguments.length;for(t=n-1;t>=0;t--){for(r in arguments[t]){i[r]=e[t][r]}}return i}function s(e,t,r,i){var n=r-e,a=i-t;return Math.sqrt(n*n+a*a)}function u(value,e,t,r,i){return(i-r)*(value-e)/(t-e)+r}function l(e){return Math.acos(e.x/Math.sqrt(e.x*e.x+e.y*e.y))}function f(e,t,r,i){return{xi:-(i-t),yi:r-e,xiPrime:i-t,yiPrime:-(r-e)}}function h(e,t){return{x:(e.xiPrime-e.xi)/t,y:(e.yiPrime-e.yi)/t}}function d(e,t,r,i,n){return{x:e+(r-e)*n,y:t+(i-t)*n}}function v(e,t){var i=e.nodes,n=e.edges,a=e.maxSize,o=Object.keys(e.nodes),s=Object.keys(e.edges),u=o.length*r.ppn,l=s.length*r.ppe,f={},h,d,v;var c=Math.pow(10,Math.log(Math.max(a,1))-6);var _=c/2;var g=Math.random;var p=t.randomizeFactor||1;var y;if(t.randomize==="locally"){y=function(e){return e+g()*p}}else if(t.randomize==="globally"){y=function(e){return g()*p}}else{y=function(e){return e+g()*c-_}}var m=new Float32Array(u);var b=new Float32Array(l);for(h=d=0,v=o.length;h<v;h++){var x=o[h],A=i[x];var w=A.x;var S=A.y;if(!A.pinned){w=y(w);S=y(S)}f[x]=d;m[d]=w;m[d+1]=S;m[d+2]=0;m[d+3]=0;m[d+4]=0;m[d+5]=0;m[d+6]=A.mass;m[d+7]=1;m[d+8]=A.size;m[d+9]=A.pinned||0;d+=r.ppn}for(h=d=0,v=s.length;h<v;h++){x=s[h];var E=n[x];b[d]=f[E.source];b[d+1]=f[E.target];b[d+2]=E.weight||0;d+=r.ppe}return{nodes:m,edges:b}}function c(e,i){var n=v(e,i);t.NodeMatrix=n.nodes;t.EdgeMatrix=n.edges;r.nodesLength=t.NodeMatrix.length;r.edgesLength=t.EdgeMatrix.length}function _(){var e,t,o,v,c,_,g,p,y,m,b;var x,A,w,S,E,T,M,C,distance,k,N;for(_=0;_<r.nodesLength;_+=r.ppn){i[_+4]=i[_+2];i[_+5]=i[_+3];i[_+2]=0;i[_+3]=0}if(r.settings.outboundAttractionDistribution){x=0;for(_=0;_<r.nodesLength;_+=r.ppn){x+=i[_+6]}x/=r.nodesLength}if(r.settings.barnesHutOptimize){var I=Infinity,z=-Infinity,L=Infinity,R=-Infinity,D,F,P,B;a=[];for(_=0;_<r.nodesLength;_+=r.ppn){I=Math.min(I,i[_+0]);z=Math.max(z,i[_+0]);L=Math.min(L,i[_+1]);R=Math.max(R,i[_+1])}var O=z-I,V=R-L;if(O>V){L-=(O-V)/2;R=L+O}else{I-=(V-O)/2;z=I+V}a[0+0]=-1;a[0+1]=(I+z)/2;a[0+2]=(L+R)/2;a[0+3]=Math.max(z-I,R-L);a[0+4]=-1;a[0+5]=-1;a[0+6]=0;a[0+7]=0;a[0+8]=0;v=1;for(_=0;_<r.nodesLength;_+=r.ppn){c=0;P=r.MAX_SUBDIVISION_RETRIES;while(true){if(a[c+5]>=0){if(i[_+0]<a[c+1]){if(i[_+1]<a[c+2]){D=a[c+5]}else{D=a[c+5]+r.ppr}}else{if(i[_+1]<a[c+2]){D=a[c+5]+r.ppr*2}else{D=a[c+5]+r.ppr*3}}a[c+7]=(a[c+7]*a[c+6]+i[_+0]*i[_+6])/(a[c+6]+i[_+6]);a[c+8]=(a[c+8]*a[c+6]+i[_+1]*i[_+6])/(a[c+6]+i[_+6]);a[c+6]+=i[_+6];c=D;continue}else{if(a[c+0]<0){a[c+0]=_;break}else{a[c+5]=v*r.ppr;m=a[c+3]/2;b=a[c+5];a[b+0]=-1;a[b+1]=a[c+1]-m;a[b+2]=a[c+2]-m;a[b+3]=m;a[b+4]=b+r.ppr;a[b+5]=-1;a[b+6]=0;a[b+7]=0;a[b+8]=0;b+=r.ppr;a[b+0]=-1;a[b+1]=a[c+1]-m;a[b+2]=a[c+2]+m;a[b+3]=m;a[b+4]=b+r.ppr;a[b+5]=-1;a[b+6]=0;a[b+7]=0;a[b+8]=0;b+=r.ppr;a[b+0]=-1;a[b+1]=a[c+1]+m;a[b+2]=a[c+2]-m;a[b+3]=m;a[b+4]=b+r.ppr;a[b+5]=-1;a[b+6]=0;a[b+7]=0;a[b+8]=0;b+=r.ppr;a[b+0]=-1;a[b+1]=a[c+1]+m;a[b+2]=a[c+2]+m;a[b+3]=m;a[b+4]=a[c+4];a[b+5]=-1;a[b+6]=0;a[b+7]=0;a[b+8]=0;v+=4;B=c+0;if(i[a[B]+0]<a[c+1]){if(i[a[B]+1]<a[c+2]){D=a[c+5]}else{D=a[c+5]+r.ppr}}else{if(i[a[B]+1]<a[c+2]){D=a[c+5]+r.ppr*2}else{D=a[c+5]+r.ppr*3}}a[c+6]=i[a[B]+6];a[c+7]=i[a[B]+0];a[c+8]=i[a[B]+1];a[D+0]=a[c+0];a[c+0]=-1;if(i[_+0]<a[c+1]){if(i[_+1]<a[c+2]){F=a[c+5]}else{F=a[c+5]+r.ppr}}else{if(i[_+1]<a[c+2]){F=a[c+5]+r.ppr*2}else{F=a[c+5]+r.ppr*3}}if(D===F){if(P--){c=D;continue}else{P=r.MAX_SUBDIVISION_RETRIES;break}}a[F+0]=_;break}}}}}if(r.settings.barnesHutOptimize){A=r.settings.scalingRatio;for(_=0;_<r.nodesLength;_+=r.ppn){c=0;while(true){if(a[c+5]>=0){distance=Math.sqrt((i[_+0]-a[c+7])*(i[_+0]-a[c+7])+(i[_+1]-a[c+8])*(i[_+1]-a[c+8]));if(2*a[c+3]/distance<r.settings.barnesHutTheta){w=i[_+0]-a[c+7];S=i[_+1]-a[c+8];if(r.settings.adjustSizes){if(distance>0){N=A*i[_+6]*a[c+6]/distance/distance;i[_+2]+=w*N;i[_+3]+=S*N}else if(distance<0){N=-A*i[_+6]*a[c+6]/distance;i[_+2]+=w*N;i[_+3]+=S*N}}else{if(distance>0){N=A*i[_+6]*a[c+6]/distance/distance;i[_+2]+=w*N;i[_+3]+=S*N}}if(a[c+4]<0){break}c=a[c+4];continue}else{c=a[c+5];continue}}else{if(a[c+0]>=0&&a[c+0]!==_){w=i[_+0]-i[a[c+0]+0];S=i[_+1]-i[a[c+0]+1];distance=Math.sqrt(w*w+S*S);if(r.settings.adjustSizes){if(distance>0){N=A*i[_+6]*i[a[c+0]+6]/distance/distance;i[_+2]+=w*N;i[_+3]+=S*N}else if(distance<0){N=-A*i[_+6]*i[a[c+0]+6]/distance;i[_+2]+=w*N;i[_+3]+=S*N}}else{if(distance>0){N=A*i[_+6]*i[a[c+0]+6]/distance/distance;i[_+2]+=w*N;i[_+3]+=S*N}}}if(a[c+4]<0){break}c=a[c+4];continue}}}}else{A=r.settings.scalingRatio;for(g=0;g<r.nodesLength;g+=r.ppn){for(p=0;p<g;p+=r.ppn){w=i[g+0]-i[p+0];S=i[g+1]-i[p+1];if(r.settings.adjustSizes){distance=Math.sqrt(w*w+S*S)-i[g+8]-i[p+8];if(distance>0){N=A*i[g+6]*i[p+6]/distance/distance;i[g+2]+=w*N;i[g+3]+=S*N;i[p+2]+=w*N;i[p+3]+=S*N}else if(distance<0){N=100*A*i[g+6]*i[p+6];i[g+2]+=w*N;i[g+3]+=S*N;i[p+2]-=w*N;i[p+3]-=S*N}}else{distance=Math.sqrt(w*w+S*S);if(distance>0){N=A*i[g+6]*i[p+6]/distance/distance;i[g+2]+=w*N;i[g+3]+=S*N;i[p+2]-=w*N;i[p+3]-=S*N}}}}}b=r.settings.gravity/r.settings.scalingRatio;A=r.settings.scalingRatio;for(_=0;_<r.nodesLength;_+=r.ppn){N=0;w=i[_+0];S=i[_+1];distance=Math.sqrt(w*w+S*S);if(r.settings.strongGravityMode){if(distance>0){N=A*i[_+6]*b}}else{if(distance>0){N=A*i[_+6]*b/distance}}i[_+2]-=w*N;i[_+3]-=S*N}A=1*(r.settings.outboundAttractionDistribution?x:1);for(y=0;y<r.edgesLength;y+=r.ppe){g=n[y+0];p=n[y+1];m=n[y+2];M=Math.pow(m,r.settings.edgeWeightInfluence);w=i[g+0]-i[p+0];S=i[g+1]-i[p+1];if(r.settings.adjustSizes){distance=Math.sqrt(w*w+S*S)-i[g+8]-i[p+8];if(r.settings.linLogMode){if(r.settings.outboundAttractionDistribution){if(distance>0){N=-A*M*Math.log(1+distance)/distance/i[g+6]}}else{if(distance>0){N=-A*M*Math.log(1+distance)/distance}}}else{if(r.settings.outboundAttractionDistribution){if(distance>0){N=-A*M/i[g+6]}}else{if(distance>0){N=-A*M}}}}else{distance=Math.sqrt(w*w+S*S);if(r.settings.linLogMode){if(r.settings.outboundAttractionDistribution){if(distance>0){N=-A*M*Math.log(1+distance)/distance/i[g+6]}}else{if(distance>0){N=-A*M*Math.log(1+distance)/distance}}}else{if(r.settings.outboundAttractionDistribution){distance=1;N=-A*M/i[g+6]}else{distance=1;N=-A*M}}}if(distance>0){i[g+2]+=w*N;i[g+3]+=S*N;i[p+2]-=w*N;i[p+3]-=S*N}}var j,U,G,X,W=0;if(r.settings.adjustSizes){for(_=0;_<r.nodesLength;_+=r.ppn){if(!i[_+9]){j=Math.sqrt(i[_+2]*i[_+2]+i[_+3]*i[_+3]);if(j>r.maxForce){i[_+2]=i[_+2]*r.maxForce/j;i[_+3]=i[_+3]*r.maxForce/j}U=i[_+6]*Math.sqrt((i[_+4]-i[_+2])*(i[_+4]-i[_+2])+(i[_+5]-i[_+3])*(i[_+5]-i[_+3]));G=Math.sqrt((i[_+4]+i[_+2])*(i[_+4]+i[_+2])+(i[_+5]+i[_+3])*(i[_+5]+i[_+3]))/2;X=.1*Math.log(1+G)/(1+Math.sqrt(U));E=i[_+0];T=i[_+1];i[_+0]=i[_+0]+i[_+2]*(X/r.settings.slowDown);i[_+1]=i[_+1]+i[_+3]*(X/r.settings.slowDown);w=i[_+0];S=i[_+1];distance=Math.sqrt((w-E)*(w-E)+(S-T)*(S-T));W+=distance}}}else{for(_=0;_<r.nodesLength;_+=r.ppn){if(!i[_+9]){U=i[_+6]*Math.sqrt((i[_+4]-i[_+2])*(i[_+4]-i[_+2])+(i[_+5]-i[_+3])*(i[_+5]-i[_+3]));G=Math.sqrt((i[_+4]+i[_+2])*(i[_+4]+i[_+2])+(i[_+5]+i[_+3])*(i[_+5]+i[_+3]))/2;X=i[_+7]*Math.log(1+G)/(1+Math.sqrt(U));i[_+7]=Math.min(1,Math.sqrt(X*(i[_+2]*i[_+2]+i[_+3]*i[_+3])/(1+Math.sqrt(U))));E=i[_+0];T=i[_+1];i[_+0]=i[_+0]+i[_+2]*(X/r.settings.slowDown);i[_+1]=i[_+1]+i[_+3]*(X/r.settings.slowDown);w=i[_+0];S=i[_+1];distance=Math.sqrt((w-E)*(w-E)+(S-T)*(S-T));W+=distance}}}r.iterations++;if(r.settings.autoStop){r.converged=r.iterations>r.settings.maxIterations||W/r.nodesLength<r.settings.avgDistanceThreshold;if(r.converged&&r.settings.alignNodeSiblings){var H={},Y={},q,Z;for(y=0;y<r.edgesLength;y+=r.ppe){g=n[y+0];p=n[y+1];if(g===p){continue}H[g]=H[g]||{};H[p]=H[p]||{};H[g][p]=true;H[p][g]=true}Object.keys(H).forEach(function(e){e=~~e;Z=Object.keys(H[e]);if(Z.length==2){q=Z[0]+";"+Z[1];if(q in Y){Y[q].push(e)}else{q=Z[1]+";"+Z[0];if(!Y[q]){Y[q]=[~~Z[1],~~Z[0]]}Y[q].push(e)}}});var $,K,J,Q,ee,te,re,ie,ne,ae,oe,se,ue,le,fe,he=r.settings.nodeSiblingsAngleMin;Object.keys(Y).forEach(function(e){K=Y[e].shift();J=Y[e].shift();$=Y[e].filter(function(e){return!i[e+9]});if($.length==1){return}te=i[K+0];re=i[K+1];ie=i[J+0];ne=i[J+1];Q=Object.keys(H[K]).length;ee=Object.keys(H[J]).length;ae=u(Q/(Q+ee),0,1,1/4,3/4);se=d(te,re,ie,ne,ae);ue=f(te,re,ie,ne);oe=s(te,re,ie,ne);le=h(ue,oe);fe=l(le);if(2*he>Math.PI){throw new Error("ForceLink.Worker - Invalid parameter: angleMin must be smaller than 2 PI.")}if(he>0){if(fe<he||fe>Math.PI-he&&fe<=Math.PI){le={x:Math.cos(Math.PI-he)*2,y:Math.sin(Math.PI-he)*2}}else if(fe>2*Math.PI-he||fe>=Math.PI&&fe<Math.PI+he){le={x:Math.cos(he)*2,y:Math.sin(he)*2}}}var t=0,n=1,a=1;if($.length%2==1){a=0;t=1}for(var o=0;o<$.length;o++){i[$[o]+0]=se.x+n*le.x*a*(t||o>=2?r.settings.nodeSiblingsScale:r.settings.nodeSiblingsScale*2/3);i[$[o]+1]=se.y+n*le.y*a*(t||o>=2?r.settings.nodeSiblingsScale:r.settings.nodeSiblingsScale*2/3);n=-n;a+=(o+t)%2}})}}}function g(){if(r.settings.autoStop){while(!r.converged){_()}}else{var e=r.iterations===0?r.settings.startingIterations:r.iterations+r.settings.iterationsPerRender;while(r.iterations!==e){_()}}return{nodes:p(t.nodes),barycentre:t.barycentre}}function p(e){var t=Object.keys(e);var n={};for(var a=0;a<i.length;a+=r.ppn){var o=t[a/r.ppn];n[o]={id:o,x:i[a+0],y:i[a+1],pinned:i[a+9]}}return n}return g()},isRunning:function(e){return!e.W.settings.autoStop},onSync:function(e,t){var r=e.nodes;var i=e.barycentre;var n=t.graph;var a=Object.keys(r);var o=a.length;var s=0,u=0;var l,f,h,d,v,c,_,g;var p=new Array(o);var y=new Array(o);var m=new Array(o);var b=new Array(o);var x=n.getAttributes(true,["x","y"]);var A=x[0];var w=x[1];for(l=0;l<o;l++){f=a[l];h=r[f];g=parseInt(f);p[l]=g;b[l]=h.pinned;if(h.pinned){d=A.get(g);v=w.get(g)}else{d=h.x;v=h.y}y[l]=d;m[l]=v;s+=d;u+=v}c=s/o-i.x;_=u/o-i.y;for(l=0;l<o;l++){if(!b[l]){y[l]-=c;m[l]-=_}}return{indexes:p,x:y,y:m}}};b.extend(function(e){e.layouts.forceLink=function(t){if(t===void 0)t={};return e.modules.layouts.start("forceLink",t)};e.modules.layouts.register("forceLink",d_)});var v_={configure:function(e,t){var r=t.graph;var i=e.sortBy;var n=e.rows;var a=e.cols;if(!e.nodes){e.nodes=r.getNodes()}if(e.nodes&&!(e.nodes instanceof r.NodeList)){e.nodes=r.getNodes(e.nodes)}function o(e){return e===undefined||typeof e==="number"&&isFinite(e)&&e>0}if(!o(n)){throw new TypeError('"rows" should be a positive integer')}if(!o(a)){throw new TypeError('"cols" should be a positive integer')}var s=e.nodes;var u=e.nodes._indexes;var l=u.length;if(n){a=Math.ceil(l/n)}else if(a){n=Math.ceil(l/a)}else{a=Math.ceil(Math.sqrt(l));n=Math.ceil(l/a)}var f,h;var d;var v=e.sortFallbackValue;if(typeof i==="string"){if(i==="radius"){d=r.getAttribute(true,"radius").getMultiple(u)}else if(i==="random"){d=new Array(l);for(f=0;f<l;f++){d[f]=Math.random()}}else{d=s.getData(i);if(v!==undefined){for(f=0;f<l;f++){if(d[f]===undefined){d[f]=v}}}}}else{d=new Array(l);for(f=0;f<l;f++){d[f]=f}}var c=[];var _=s.getAttribute("layoutable");for(f=0;f<l;++f){h=u[f];if(_[f]){c.push({id:h,attr:d[f]})}}var g=s.getBoundingBox(),p=g.maxSize*.65,y=g.minX+p,m=g.maxX-p,b=g.minY+p,x=g.maxY-p;if(g.width<p*a*2){y=g.cx-p*a+p;m=g.cx+p*a-p}if(g.height<p*n*2){b=g.cy-p*n+p;x=g.cy+p*n-p}return{sort:!!i,nodes:c,reverse:!!e.reverse,cols:a,rows:n,minX:y,maxX:m,minY:b,maxY:x}},update:function(e){if(e.sort){e.nodes.sort(function(e,t){var r=e.attr,i=t.attr;if(r<i){return-1}else if(r>i){return 1}else{return 0}})}if(e.reverse){e.nodes.reverse()}var t=(e.maxX-e.minX)/(e.cols-1),r=(e.maxY-e.minY)/(e.rows-1),i=0,n=0,a=e.minX,o=e.minY;if(!isFinite(t)){t=0}if(!isFinite(r)){r=0}for(var s=0;s<e.nodes.length;++s){var u=e.nodes[s];u.x=a+i*t;u.y=o+n*r;i+=1;if(i===e.cols){n+=1;i=0}}return e.nodes},onSync:function(e){var t=e.length;var r=new Uint32Array(t);var i=new Array(t);var n=new Array(t);for(var a=0;a<e.length;++a){var o=e[a];r[a]=o.id;i[a]=o.x;n[a]=o.y}return{indexes:r,x:i,y:n}}};b.extend(function(e){e.layouts.grid=function(t){if(t===void 0)t={};return e.modules.layouts.start("grid",t)};e.modules.layouts.register("grid",v_)});var c_={configure:function(e,t){var r=t.graph;var i=t.data;if(e.centralNode===undefined){throw new Error('concentric layout: missing parameter "centralNode"')}else if(!(e.centralNode instanceof r.Node)){e.centralNode=r.getNode(e.centralNode)}if(!e.nodes){e.nodes=r.getNodes()}else if(!(e.nodes instanceof r.NodeList)){e.nodes=r.getNodes(e.nodes)}var n=r._getIndex(true,e.centralNode);var a=e.centralNode.getPosition();var o=a.x,s=a.y;var u=null,l,f;var h=r.nodeIndexList(e.nodes);var d=[];var v=h.length;var c=r.getNodeAttributesArrays(["radius"],{ids:h,destArrays:[new Array(v)]});var _=c[0];var g=e.nodes.getAttribute("layoutable");for(l=0;l<v;l++){f=h[l];if(f===n||g[l]){d.push(f)}}if(d.indexOf(n)===-1){d.push(n)}v=d.length;var p={},y=new Array(v);for(l=0;l<v;l++){p[d[l]]=y[l]=l}var m=new Array(v);for(l=0;l<v;l++){var b=r._getAdjacentElements(true,[d[l]]);for(var x=0,A=b.length;x<A;x++){b[x]=p[b[x]]}m[l]=b}if(e.sortBy){if(e.sortBy==="random"){u="random"}else if(e.sortBy==="radius"){u=_.slice()}else if(e.sortBy==="degree"){u=e.nodes.getDegree()}else{u=i.getProperty(e.nodes,e.sortBy)}}return{sourceNodeIndex:d.indexOf(n),centerX:e.centerX==="number"?e.centerX:o,centerY:e.centerY==="number"?e.centerY:s,list:d,indexes:y,size:v,totalSize:v,attributes:{adjacentNodes:m,size:_},sortAttr:u,clockwise:e.clockwise===undefined?true:e.clockwise,circleHopRatio:e.circleHopRatio||5,allowOverlap:!!e.allowOverlap}},context:function(){return{dijkstra:function(e,t,r,i,n){var a=Math.pow(2,31)-1,o=new Int32Array(i),s=new Int32Array(i),u=new Int8Array(i),l,f,h;for(h=0;h<i+1;++h){o[h]=a;s[h]=-1}for(h=0;h<i;++h){l=t[h];if(l!==undefined){o[l]=a;s[l]=-1}}o[n]=0;while(true){var d=a,v=-1;for(h=0;h<r;++h){l=t[h];f=o[l];if(!u[l]&&f<d){d=f;v=l;u[l]=true}}if(v===-1){break}var c=e[v],_=c.length,g=d+1;for(h=0;h<_;++h){l=c[h];f=o[l];if(g<f){o[l]=g;s[l]=v}}}return o},determinePropertyType:function(e,t,r){for(var i=0;i<r;++i){if(typeof e[t[i]]!=="number"){return"string"}}return"number"}}},update:function(e,t){var r=e.attributes.adjacentNodes,i=e.attributes.size,n=e.indexes,a=e.size,o=e.sourceNodeIndex,s=e.centerX,u=e.centerY,l=e.sortAttr,f=new Array(e.totalSize),h=new Array(e.totalSize);var d=t.dijkstra(r,n,e.size,e.totalSize,o),v=0,c={},_;for(_=0;_<a;++_){var g=i[n[_]];if(g>v){v=g}}var p=v*e.circleHopRatio,y=0,m=0,b=Math.PI/9;for(_=0;_<a;++_){var x=n[_],distance=d[x],A=c[distance];if(!A){A=[];c[distance]=A}A.push(x)}var w=null,S=true;if(l==="random"){w=function(){return Math.random()-.5}}else if(l){var E=t.determinePropertyType(l,n,g);w=E==="number"?function(e,t){return l[e]-l[t]}:function(e,t){return l[e]<l[t]?-1:1}}else{S=false}var T=Object.keys(c).sort(function(e,t){return parseInt(e)-parseInt(t)});for(_=0;_<T.length;++_){var M=c[T[_]],C=M.length,k=m,N=Math.PI*2/C;if(_!==0&&!e.allowOverlap){var I=Math.PI*2*y,z=0,L=0;for(R=0;R<C;++R){z+=i[M[R]]}L=z*2*Math.SQRT2;if(L>I){y+=L/(2*Math.PI)-y}}if(S){M.sort(w);if(!e.clockwise){M.reverse()}}for(var R=0;R<C;++R){x=M[R];f[x]=Math.cos(k)*y+s;h[x]=Math.sin(k)*y+u;g=i[x];var D=e.allowOverlap?1:g/z*C;k+=N*D}y+=p;m+=b}return{x:f,y:h,indexes:e.list}},isRunning:function(){return false},onSync:function(e){var t=e.indexes;var r=e.x;var i=e.y;return{indexes:t,x:r,y:i}}};b.extend(function(e){e.layouts.concentric=function(t){if(t===void 0)t={};return e.modules.layouts.start("concentric",t)};e.modules.layouts.register("concentric",c_)});var __={defaultDirected:true,defaultMultigraph:true,defaultCompound:false,defaultRankDir:"TB",maxNbEdges:500,maxNbNodes:500};b.extend(function(e){e.layouts.hierarchical=function(t){if(t===void 0)t={};t.useWebWorker=false;return e.modules.layouts.start("hierarchical",t)};e.modules.layouts.register("hierarchical",g_)});var g_={configure:function(e,t){if(e===void 0)e={};var r=t.graph;var i=ie("dagre",{globalVarName:"dagre"});if(!i||!i.graphlib){throw new Error("to use the dagre plugin, please include lib/dagre.min.js")}if(!e.nodes){e.nodes=r.getNodes()}if(e.nodes&&e.nodes instanceof r.NodeList){e.nodes=e.nodes.getId()}var n=dt(__);var a=r.getEdges();var o=r.getNodes(e.nodes);var s=o.size,u=a.size,l=n.maxNbNodes,f=n.maxNbEdges;if(l&&s>l){throw new Error("Unable to run dagre layout: the graph has "+s+" nodes (maximum allowed: "+l+")")}if(f&&u>f){throw new Error("Unable to run dagre layout: the graph has "+u+" edges (maximum allowed: "+f+")")}e=e||{};e.directed=ot(e.directed,n.defaultDirected);e.multigraph=ot(e.multigraph,n.defaultMultigraph);e.compound=ot(e.compound,n.defaultCompound);e.rankdir=ot(e.rankdir,n.defaultRankDir);if(["TB","BT","LR","RL"].indexOf(e.rankdir)===-1){throw new Error('defaultRankDir should be one of the "TB", "BT", "LR", "RL"')}var h=o.getId();var d=o.getAttribute("layoutable").reduce(function(e,value,t){e[h[t]]=value;return e},{});return{nodes:h,edges:a.map(function(e){return{id:e.getId(),source:e.getSource().getId(),target:e.getTarget().getId()}}),options:Zt(e),layoutable:d}},context:function(){},update:function(e){var t=e.nodes;var r=e.edges;var i=e.options;var n=e.layoutable;var a=ie("dagre",{globalVarName:"dagre"});var o=new a.graphlib.Graph({directed:i.directed,multigraph:i.multigraph,compound:i.compound});o.setGraph(i);t.forEach(function(e){if(n[e]){o.setNode(e,{})}});r.forEach(function(e){var t=e.source;var r=e.target;var i=e.id;if(o.node(t)&&o.node(r)){o.setEdge(t,r,{id:i})}});a.layout(o);var s=o.nodes();return{ids:s,positions:s.map(function(e){return o.node(e)})}},isRunning:function(){return false},onSync:function(e,t){var r=e.ids;var i=e.positions;var n=t.graph;var a=new Array(r.length);var o=new Array(r.length);var s=new Array(r.length);for(var u=0;u<r.length;++u){var l=i[u];a[u]=n._getIndex(true,r[u]);o[u]=l.x;s[u]=l.y}return{indexes:a,x:o,y:s}}};function p_(e,t,r,i,n){return{x:e+n*(r-e),y:t+n*(i-t)}}function y_(e,t,r){var i=Infinity;var n,a;for(var o=1,s=t.length;o<s;o+=2){var u=t[o-1],l=t[o%s];var f=(u[0]+l[0])/2,h=(u[1]+l[1])/2;var d=e[0]-f,v=e[1]-h;var c=d*d+v*v;if(c<i){i=c;n=u;a=l}}return m_(n[0],n[1],a[0],a[1],r)}function m_(e,t,r,i,n){var a=(e+r)/2,o=(t+i)/2;var s=e-r,u=t-i;var l=-u,f=s;var h=Math.sqrt(l*l+f*f);l/=h;f/=h;return[a-n*l,o-n*f]}function b_(e,t){var r=t[0];var i=t[1];var n=t[2];var a=Math.abs;for(var o=0,s=e.length;o<s;o++){var u=e[o];var l=u[0];var f=u[1];var h=a(l-r),d=a(f-i);if(h+d<=n){return true}if(h>n||d>n){continue}if(h*h+d*d<=n*n){return true}}return false}function x_(e,t,r){var i=ki(r.cx,r.cy,e,t,r.minX,r.minY,r.maxX,r.maxY);var n=+Infinity,a,o;for(var s=0,u=i.length;s<u;s++){var l=i[s];a=distance(e,t,l.x,l.y);if(a<n){n=a;o=l}}return o}function A_(e,t,r){var i=t.nodes;var n=t.margin;if(n===void 0)n=5;var a=t.duration;if(a===void 0)a=0;var o=e.modules;var s=o.graph;var u=e.getNodes();var l=i._indexes.reduce(function(e,t){e[t]=true;return e},{});var f=new s.NodeList(u._indexes.slice().filter(function(e){return!l[e]}));var h=f.getPosition().map(function(e){return[e.x,e.y]});var d=i.getPosition();var v=i.getBoundingBox();var c=f.getBoundingBox();var _=minDisk(d.map(function(e){return e.x}),d.map(function(e){return e.y}),i.getAttribute("radius"));var g=_[0];var p=_[1];var y=_[2]+(v.maxSize+c.maxSize)+n;var m=0,b=0,x;if(b_(h,[_[0],_[1],y])){if(f.size<=3){if(Jn([g,p,_[2]],c)){var A=x_(g,p,c);x=distance(c.cx,c.cy,A.x,A.y);var w=p_(c.cx,c.cy,A.x,A.y,(x+y)/x);m=w.x-g;b=w.y-p}}else{var S=new Mo(h.slice()).triangulate();var convexhull=No(h);var E=Io(f,20,y,S,convexhull);if(E.length>0){var T=Infinity;for(var M=0,C=E.length;M<C;M++){var k=E[M];m=g-k[0];b=p-k[1];x=Math.sqrt(m*m+b*b);if(x<T){T=x;A=k}}m=A[0]-g;b=A[1]-p}else{A=y_([g,p],convexhull,y);m=A[0]-v.cx;b=A[1]-v.cy}}}if(m||b){i.setAttributes(d.map(function(e){e.x+=m;e.y+=b;return e}),a).then(r)}else{setTimeout(r,0)}}function w_(e,t,r){var i=dt(t);i.duration=0;e.layouts.forceLink(i).then(function(){A_(e,t,r)})}function S_(e,t,r){var i=t.nodes;var n=t.duration;var a=t.centralNode;var o=i;var s=o.reduce(function(e,t){e[t._index]=true;return e},{});var u=e.getNodes();if(t.focusOnGroupShape){e.layouts.forceLink({nodes:o,duration:0}).then(function(){var t=o.concat(a);var i=t.getAttribute("layoutable");t.setAttributes({layoutable:false});e.layouts.forceLink({nodes:e.getNodes(),duration:n}).then(function(){t.setAttributes(i);r()})})}else{var l=dt(t);delete l.centralNode;l.nodes=u;l.nodeMass=function(e,t){var r=s[e._index]?1:2;return(t+1)*r};e.layouts.forceLink(l).then(r)}}b.extend(function(e){e.layouts.incremental=function(t){if(t===void 0)t={};return new Promise(function(r){var i=t.nodes;var n=t.centralNode;if(!i){throw new Error("Incremental ForceLink layout: no nodes are selected")}if("margin"in t&&!isFinite(t.margin)){throw new Error("Incremental ForceLink layout: margin has to be a positive number")}if(n&&!n.getAttribute("layoutable")){S_(e,t,r)}else{w_(e,t,r)}})}});var E_=function(e,t){return e-t};var T_={imports:{minHeap:minHeap,bellmanFord:bellmanFord,dijkstra:dijkstra,johnson:johnson,distance:distance,circleCircleIntersection:circleCircleIntersection,circleSortCompare:circleSortCompare,weightedStress:weightedStress,distanceStress:distanceStress,constrainedStress:constrainedStress,stressMinimizationStep:stressMinimizationStep,removeRadialOverlap:removeRadialOverlap},configure:function(e,t){if(e===void 0)e={};var r=t.graph;var i=null,n,a,o,s=-1;var u=null;if(e.centralNode!==undefined&&e.centralNode!==null){i=r.getNode(e.centralNode,true);o=i.getPosition();n=isFinite(e.centerX)?parseFloat(e.centerX):o.x;a=isFinite(e.centerY)?parseFloat(e.centerY):o.y;s=i._index}else{throw new Error('concentric layout: missing parameter "centralNode"')}if(!e.nodes){e.nodes=r.getNodes()}if(e.nodes&&!(e.nodes instanceof r.NodeList)){e.nodes=r.getNodes(e.nodes)}var l=r._getIndexes(true,e.nodes);var f=r._getElements(true,l);var h=f.getAttribute("layoutable");l=l.filter(function(e,t){return h[t]||e===s});if(l.indexOf(s)===-1){l.push(s)}l.sort(E_);var d=l.length;var v=r.getConnectedComponents(true,true);var c=k_(l,v,s);v=c;var _=r._degrees(l);var g=r.getNodeAttributesArrays(["x","y","radius"],{ids:l,destArrays:[new Float32Array(d),new Float32Array(d),new Array(d),new Uint8Array(d)]});var p=g[0];var y=g[1];var m=g[2];var b=r.getEdgeAttributesArrays(["source","target","width"]);var x=b[0];var A=b[1];var w=r._getAdjacencyTable(true,true,1,l);var S=isFinite(e.radiusRatio)?parseFloat(e.radiusRatio):Math.SQRT2;var E=isFinite(e.radiusDelta)?parseFloat(e.radiusDelta):0;var T=isFinite(e.nodeGap)?parseInt(e.nodeGap):10;var M=d*(isFinite(e.repulsion)?parseFloat(e.repulsion):1);var C=isFinite(e.maxIterations)?parseInt(e.maxIterations):100;if(C<1){throw new RangeError("maxIterations must be a positive integer")}var k=isFinite(e.iterationsPerRender)?parseInt(e.iterationsPerRender):20;if(k<1){throw new RangeError("iterationsPerRender must be a positive integer")}var N=isFinite(e.epsilon)?parseFloat(e.epsilon):.001;if(N<=0){throw new RangeError("epsilon has to be a positive number")}return{centerIndex:s,centerX:n,centerY:a,list:l,components:c,X:p,Y:y,degree:_,size:d,currStress:Number.POSITIVE_INFINITY,epsilon:N,maxSteps:C,iterationsPerRender:k,attributes:{size:m,adjacency:w,weights:A.map(function(){return 1}),sources:x,targets:A},sortAttr:u,allowOverlap:!!e.allowOverlap,nodeGap:T,radiusRatio:S,radiusDelta:E,repulsion:M,randomize:"randomize"in e?!!e.randomize:true,renderSteps:!!e.renderSteps}},context:function(){return{getHighestNodeSize:function e(t,r){var i=0;for(var n=0,a=r.length;n<a;n++){var o=t[r[n]];if(o>i){i=o}}return i},grid:function e(t,r){if(r===void 0)r=8;var i=t.size;var n=new Float32Array(i);var a=new Float32Array(i);var o,s,u=this.getHighestNodeSize(t.attributes.size,t.list,i);var l=u*r;var f=Math.ceil(Math.sqrt(i));var h=Math.ceil(i/f);var d=-Math.floor((h-1)*l/2);var v=-Math.floor((f-1)*l/2);for(o=0;o<f;o++){for(s=0;s<h;s++){n[o*h+s]=d+s*l;a[o*h+s]=v+o*l}}return{x:n,y:a}},connectSubgraphs:function e(t,r,i,n,a,o){var s,u;function l(e,value){var t=new Uint32Array(e.length+1);t.set(e);t[e.length]=value;return t}var f=function(e){s=t[e];var f=0,h=0;s.forEach(function(e,t){if(a[e]>f){h=t;f=a[e]}});u=s[h];var d=r[o[u]];d.nodes=l(d.nodes,i);d.weights.push(n);d=r[i];d.nodes=l(d.nodes,u);d.weights.push(n)};for(var h=1;h<t.length;h++)f(h)},correctSubgraphsDistances:function e(t,r,i,n,a){var o=Array.prototype.reduce.call(t[i],function(e,t,r){if(r!==i&&t<n&&t>e){e=t}return e},0);var s=n-o-1;for(var u=1;u<r.length;u++){var l=r[u];for(var f=0,h=l.length;f<h;f++){var d=a[l[f]];t[i][d]-=s;t[d][i]-=s}}},establishRadii:function e(t,r,i,n,a,o,s,u){var l=Object.create(null);var f=a[r];var h=f,d=0;var v=f;for(var c in n){var _=n[c];var g=0;var p=0,y=void 0;for(var m=0,b=_.length;m<b;m++){y=a[_[m]];p=Math.max(p,y);g+=y*2+o}var x=g/(2*Math.PI)+p;var A=p+h;var w=u?d+Math.max(u,A):d*s;d=Math.max(d,x,v,w);l[c]=d;h=p}l[0]=0;l[Number.POSITIVE_INFINITY]=d;return l},initData:function e(t,r){t.step=0;t.data=r;t.totalSteps=r.totalSteps;t.currStress=Number.POSITIVE_INFINITY;t.prevStress=0;t.epsilon=t.data.epsilon;var i={},n={};t.normIndexes=r.list.reduce(function(e,a,o){e[o]=i[a]=o;n[a]=r.degree[o];if(a===r.centerIndex){t.centerIndexPos=o}return e},new Uint32Array(r.list.length));var a=t.centerIndexPos;var o=r.components[0].length;this.connectSubgraphs(r.components,r.attributes.adjacency,r.centerIndex,o,n,i);var s=johnson({sources:r.attributes.sources,targets:r.attributes.targets,weights:r.attributes.weights,indexes:r.list,adjacency:r.attributes.adjacency,undirected:true});this.correctSubgraphsDistances(s,r.components,a,o,i);t.D=s;t.rings=this.groupRings(s,a,t.normIndexes);t.radii=this.establishRadii(s,a,t.normIndexes,t.rings,r.attributes.size,r.nodeGap,r.radiusRatio,r.radiusDelta)},groupRings:function e(t,r,i){var n=t[r];var a=Object.create(null);for(var o=0,s=i.length;o<s;o++){if(o!==r){var u=n[o];a[u]=a[u]||[];a[u].push(i[o])}}return a},removeOverlaps:function e(t,r){var i=t.centerIndexPos;var n=r.attributes.size;var a=t.rings;var o=r.X[i];var s=r.Y[i];for(var u in a){var l=a[u];var f=distance(o,s,r.X[l[0]],r.Y[l[0]]);removeRadialOverlap({X:r.X,Y:r.Y,sizes:n,indexes:l,center:[o,s],R:f,gap:r.nodeGap,inPlace:true})}},easingQuadraticInOut:function(e){if((e*=2)<1){return.5*e*e}return-.5*(--e*(e-2)-1)}}},update:function(e,t){e=e||t.data;var r=e.list;var i=e.centerIndex;var n=e.X||new Float32Array(e.size);var a=e.Y||new Float32Array(e.size);var o=null;var s;if(t.step===undefined){t.initData(t,e)}else{t.step++}var u=e.repulsion;var l=function(e){return t.radii[e]||1};if(t.step===0){if(e.randomize){s=t.grid(e);e.X=s.x;e.Y=s.y}e.spent=0}else if(!t.converged){var f=e.maxSteps;var h=e.iterationsPerRender;var d=t.step;var v=Math.min(d+h,f+1);while(d<=v||!t.converged){var c=t.easingQuadraticInOut(Math.min(d,f)/f);t.step=d++;s=stressMinimizationStep(t.D,n,a,e.size,t.centerIndexPos,u,c,t.normIndexes,l);e.X=s.X;e.Y=s.Y;t.prevStress=t.currStress;t.currStress=constrainedStress(t.D,e.X,e.Y,e.size,t.centerIndexPos,u,c,t.normIndexes,r,i);t.converged=t.converged||Math.abs(t.currStress-t.prevStress)<=t.epsilon}}if(t.converged){if(t.overlapRemoved||t.data.allowOverlap){t.done=true;o=Object.keys(t.rings).reduce(function(e,i){e[i]=t.rings[i].map(function(e){return r[e]});return e},{})}else{t.removeOverlaps(t,e,i);t.overlapRemoved=true}}return{x:e.X,y:e.Y,indexes:e.list,components:t.overlapRemoved?e.components:undefined,rings:o,centerIndex:t.centerIndexPos,cx:e.centerX,cy:e.centerY,step:t.step,renderSteps:e.renderSteps,converged:t.converged,overlapRemoved:t.overlapRemoved,stress:t.currStress,done:t.done}},isRunning:function(e){if(!e.converged){return true}else{return e.data.allowOverlap?false:!e.done}},onSync:function(e,t){if(e.renderSteps||e.done){return M_(e,t)}},onEnd:function(e,t){return M_(e,t)}};function M_(e){var t=e.x,r=e.y;var i=e.indexes.length;var n=t[e.centerIndex]-e.cx;var a=r[e.centerIndex]-e.cy;for(var o=0;o<i;o++){t[o]-=n;r[o]-=a}return{indexes:e.indexes,x:t,y:r}}function C_(e,t){var r=0,i=e.length-1,n;var a;while(r<=i){n=(r+i)/2|0;a=e[n];if(a<t){r=n+1}else if(a>t){i=n-1}else{return n}}return-1}function k_(e,t,r){var i=e.slice().sort(E_),n=[];for(var a=0,o=t.length;a<o;a++){var s=[],u=t[a];var l=false;for(var f=0,h=u.length;f<h;f++){var d=u[f];var v=C_(i,d);if(v!==-1){if(d===r){l=true}s.push(d)}}if(s.length!==0){n[l?"unshift":"push"](s.sort(E_))}}return n}b.extend(function(e){e.layouts.radial=function(t){if(t===void 0)t={};return e.modules.layouts.start("radial",t)};e.modules.layouts.register("radial",T_)});b.extend(function(e){var t=new N_(e);e.modules.transform=t;e.transformations={remove:function e(r,i){return t.removeRule(r,i)},getIndex:function e(r){return t.getRuleIndex(r)},setIndex:function e(r,i,n){return t.setRuleIndex(r,i,n)},clear:function e(r){return t.clearRules(r)},refresh:function e(r){if(r===undefined){r=t._rules.map(function(e){return e._id})}else if(typeof r==="number"){r=[r]}else if(!Array.isArray(r)){r=[]}if(r.length===0){return Promise.resolve()}else{return Promise.all(r.map(function(e){return new Promise(function(r){t.setRuleIndex(e,t.getRuleIndex(e),r)})}))}}}});var N_=function e(t){var r=this;this._ogma=t;this._graph=t.modules.graph;this._rules=[];this._timeout=null;this._idCounter=1;this._updating=false;this._updateFromDataChange=true;this._onRefresh=[];this._refreshSync=function(){r._updating=true;r._updateFromDataChange=false;z_(r);r._updating=false;r._timeout=null;setTimeout(function(){r._updateFromDataChange=true;for(var e=0,t=r._onRefresh.length;e<t;e++){r._onRefresh[e]()}r._onRefresh.length=0},0)};this._refresh=function(e){if(e){r._onRefresh.push(e)}if(!r._timeout){r._timeout=setTimeout(r._refreshSync,0)}};this._nodeVirtualList=this._graph.createAttribute(true,{name:"virtual",storage:1});this._edgeVirtualList=this._graph.createAttribute(false,{name:"virtual",storage:1});t.modules.events.on({"addNodes addEdges removeNodes removeEdges":function(){if(!r._updating&&r._rules.length){r._refresh()}},"updateNodeData updateEdgeData":function(){if(r._updateFromDataChange&&r._rules.length){r._refresh()}}})};N_.prototype.addRule=function e(t,r){if(typeof t!=="function"){throw new Error("expected function")}this._rules.push(new L_(this._ogma,t,this._idCounter));this._idCounter+=1;this._refresh(r);return this._idCounter-1};N_.prototype.nextId=function e(){return this._idCounter};N_.prototype.removeRule=function e(t,r){var i=I_(this,t);var n=i.rule;var a=i.index;n.destroy();this._rules.splice(a,1);this._refresh(r)};N_.prototype.getRuleIndex=function e(t){return I_(this,t).index};N_.prototype.getRule=function e(t){return I_(this,t).rule};N_.prototype.setRuleIndex=function e(t,r,i){var n=I_(this,t);var a=n.index;var o=n.rule;this._rules.splice(a,1);if(r<0){this._rules.unshift(o)}else if(r>=this._rules.length){this._rules.push(o)}else{this._rules.splice(r,0,o)}this._refresh(i)};N_.prototype.clearRules=function e(t){var r=this;for(var i=this._rules.length-1;i>=0;--i){r._rules[i].destroy()}this._rules=[];this._refresh(t)};function I_(e,t){for(var r=0;r<e._rules.length;++r){var i=e._rules[r];if(i._id===t){return{rule:i,index:r}}}throw new Error('rule "'+t+'" does not exist')}function z_(e){if(e._rules.length){var t=e._graph.getRaw();for(var r=0;r<e._rules.length;++r){var i=e._rules[r];t=i.update(t)}}e._graph._refreshFilters(true);e._graph._refreshFilters(false)}var L_=function e(t,r,i){this._ogma=t;this._id=i;this._rule=r;this._nodes=new R_(true,t);this._edges=new R_(false,t,this._nodes)};L_.prototype.update=function e(t){var r=this._rule(t,this._id);var i=r.virtualNodes;if(i===void 0)i=[];var n=r.virtualEdges;if(n===void 0)n=[];var a=r.hiddenNodes;if(a===void 0)a=[];var o=r.hiddenEdges;if(o===void 0)o=[];var s=this._nodes.update(i,a),u=this._edges.update(n,o);var l=t.nodes;var f=t.edges;this._ogma.removeEdges(u);this._ogma.removeNodes(s);var h=this._nodes.getVirtualElements(),d=this._edges.getVirtualElements();for(var v=0;v<a.length;++v){D_(l,a[v])}for(var c=0;c<o.length;++c){D_(f,o[c])}l.push.apply(l,h);f.push.apply(f,d);return{nodes:l,edges:f}};L_.prototype.destroy=function e(){this._edges.reverse();this._nodes.reverse()};L_.prototype.kill=function e(){return this.destroy()};var R_=function e(t,r,i){this._isNode=t;this._ogma=r;this._filter=r.modules.graph._addFilter(t);this._virtualElements=[];this._nodes=i};R_.prototype.update=function e(t,r){var i=this;if(!t){t=[]}if(!r){r=[]}var n=this._ogma,a=this._isNode,o=[],s=this._virtualElements.slice(),u=new Array(t.length),l=new Array(t.length),f=new Array(t.length);for(var h=0;h<t.length;++h){var d=t[h];var v=d.id;var c=d.attributes;var _=d.data;if(!D_(s,v)){var g={id:v};if(!a){g.source=d.source;g.target=d.target}o.push(g)}else if(a){delete c.x;delete c.y}l[h]=c;u[h]=v;f[h]=_}this._virtualElements=u;this._filter.reset();for(var p=0;p<r.length;++p){i._filter.set(r[p]._index,1)}var y=n.modules.graph._addElementsSync(a,o);n.modules.transform[a?"_nodeVirtualList":"_edgeVirtualList"].setMultiple(y._indexes,1);var m=n[a?"getNodes":"getEdges"](u);m.setAttributes(l);m.setData(f);return s};R_.prototype.getVirtualElements=function e(){return this._ogma[this._isNode?"getNodes":"getEdges"](this._virtualElements).toArray()};R_.prototype.reverse=function e(){this._ogma.modules.graph._removeFilter(this._isNode,this._filter);this._ogma[this._isNode?"removeNodes":"removeEdges"](this._virtualElements)};function D_(e,t){var r=e.indexOf(t);if(r===-1){return false}else{e[r]=e[e.length-1];e.length-=1;return true}}b.extend(function(e){var t=new F_(e);e.modules.pathfinding=t;e.pathfinding={astar:function e(r,i,n){if(n===void 0)n={};return t.astar(r,i,n)},dijkstra:function e(r,i,n){if(n===void 0)n={};return t.dijkstra(r,i,n)},dijkstraBig:function e(r,i,n){if(n===void 0)n={};return t.dijkstraBig(r,i,n)}}});var F_=function e(t){this._graph=t.modules.graph;this._objectList=this._graph.getAttribute(true,"object")};F_.prototype.astar=function e(t,r,i){return U_(this,t,r,ct(i,P_))};F_.prototype.dijkstra=function e(t,r,i){return U_(this,t,r,ct(i,B_))};F_.prototype.dijkstraBig=function e(t,r,i){var n=i.directed!==undefined?!!i.directed:false;var a=this._graph.getAdjacencyTable(!n,true,1,this._graph.getNodes());var o=dijkstra(a,t._index,r._index,this._graph.getNodes()._indexes,undefined,false);return o.path?new this._graph.NodeList(o.path):null};var P_={pathLengthFunction:O_,heuristicLengthFunction:O_};var B_={pathLengthFunction:V_,heuristicLengthFunction:j_};function O_(e,t){var r=e.getPosition(),i=t.getPosition();return distance(r.x,r.y,i.x,i.y)}function V_(){return 1}function j_(){return 0}function U_(e,t,r,i){if(i===void 0)i={};var n=e._graph._getIndex(true,t),a=e._graph._getIndex(true,r),o=i.pathLengthFunction,s=i.heuristicLengthFunction,u=i.filter,l=i.directed?"out":"both",f=e._objectList,h=f.get(n),d=f.get(a),v=null;if(n===a){v=[n]}else{var c=e._graph._elts.nodes._nextIndex,_=new _i(Uint32Array),g=new _i(Uint32Array),p=new Int32Array(c),y=new Float32Array(c),m=new Float32Array(c);for(var b=0;b<c;++b){p[b]=-1;y[b]=Infinity;m[b]=Infinity}g.add(n);y[n]=0;m[n]=s(h,d);while(g.length!==0){var x=g.length,A=g.get(0),w=0,S=m[A];for(var E=1;E<x;++E){var T=g.get(E),M=m[T];if(M<S){S=M;A=T;w=E}}if(A===a){v=G_(p,n,a);break}var C=f.get(A);g.removeByPosition(w);_.add(A);var k=e._graph._getElement(true,A).getAdjacentNodes({direction:l,filter:u})._indexes;for(var N=0;N<k.length;++N){var I=k[N],z=f.get(I);if(_.has(I)){continue}var L=y[A]+o(C,z);if(!g.add(I)&&L>=y[I]){continue}p[I]=A;y[I]=L;m[I]=L+s(z,d)}}}return v?e._graph._getElements(true,v):null}function G_(e,t,r){var i=[r],n=r;while(n!==t){n=e[n];i.push(n)}i.reverse();return i}b.extend(function(e){e.modules.cameraInteractions=new H_(e)});var X_=function(e){var t=e.graphWidth;var r=e.graphHeight;var i=e.viewWidth;var n=e.viewHeight;return Math.min(i/t,n/r)*.2};var W_=function(e){var t=e.smallestNodeSize;var r=e.viewWidth;var i=e.viewHeight;return Math.min(r,i)/t*.5};var H_=function e(t){var r=this;this._ogma=t;this._locate=t.modules.locate;this._dom=t.modules.dom;this._camera=t.modules.camera;this._settings=t.modules.settings;this._interactions=t.modules.interactions;this._graphics=t.modules.graphics;this._settings.register("interactions.zoom.enabled",true);this._settings.register("interactions.zoom.onDoubleClick",false);this._settings.register("interactions.zoom.duration",150);this._settings.register("interactions.zoom.modifier",1.8);this._settings.register("interactions.zoom.minValue",X_);this._settings.register("interactions.zoom.maxValue",W_);this._settings.register("interactions.zoom.hideNodes",false);this._settings.register("interactions.zoom.hideEdges",false);this._settings.register("interactions.zoom.hideNodeTexts",false);this._settings.register("interactions.zoom.hideEdgeTexts",false);this._settings.register("interactions.pan.enabled",true);this._settings.register("interactions.pan.hideNodes",false);this._settings.register("interactions.pan.hideEdges",false);this._settings.register("interactions.pan.hideNodeTexts",false);this._settings.register("interactions.pan.hideEdgeTexts",false);this._settings.register("interactions.rotation.enabled",true);this._settings.register("interactions.rotation.hideNodes",false);this._settings.register("interactions.rotation.hideEdges",false);this._settings.register("interactions.rotation.hideNodeTexts",false);this._settings.register("interactions.rotation.hideEdgeTexts",false);this._settings.register("interactions.gesture.enabled",true);this._settings.register("interactions.gesture.hideNodes",false);this._settings.register("interactions.gesture.hideEdges",false);this._settings.register("interactions.gesture.hideNodeTexts",false);this._settings.register("interactions.gesture.hideEdgeTexts",false);this._interactions.onMouseWheel({priority:"zoom",disableDetection:true,check:function(){return r._settings.get("interactions.zoom.enabled")},handler:function(e){var t=e.x;var i=e.y;var n=e.delta;return q_(r,n,t,i)}});this._interactions.onDoubleClick({priority:"zoom",disableDetection:true,check:function(){var e=r._settings.get("interactions.zoom.enabled");var t=r._settings.get("interactions.zoom.onDoubleClick");return e&&t},handler:function(e){var t=e.x;var i=e.y;return q_(r,1,t,i)}});this._interactions.onDrag({priority:"panning",disableDetection:true,check:function(e){var t=e.button;var i=r._settings.get("interactions.pan.enabled");return t==="left"&&i},onStart:function(){Y_(r,"pan",true)},onProgress:function(e){var t=e.dx;var i=e.dy;r._camera.move({x:-t,y:-i})},onStop:function(){Y_(r,"pan",false)}});this._interactions.onDrag({priority:"rotation",disableDetection:true,check:function(e){var t=e.button;return t==="right"&&r._settings.get("interactions.rotation.enabled")},onStart:function(e){var t=e.x;var i=e.y;r._rotationStart={x:t,y:i};Y_(r,"rotation",true)},onProgress:function(e){var t=e.x;var i=e.y;r._rotate({x:t,y:i})},onStop:function(){Y_(r,"rotation",false)}});this._interactions.onGesture({priority:"gesture",disableDetection:true,check:function(){return r._settings.get("interactions.gesture.enabled")},onStart:function(){Y_(r,"gesture",true)},onProgress:function(e){var t=e.dx;var i=e.dy;var n=e.rotation;var a=e.scale;var o=e.x;var s=e.y;r._camera.rotate(-n);r._camera.zoomIn(a,undefined,{x:o,y:s});r._camera.move({x:-t,y:-i})},onStop:function(){Y_(r,"gesture",true)}})};H_.prototype._rotate=function e(t){var r=t.x;var i=t.y;var n=this._ogma.view.getSize();var a=n.width;var o=n.height;var s=a/2;var u=o/2;var l=this._rotationStart.x-s;var f=this._rotationStart.y-u;var h=r-s;var d=i-u;var v=Math.atan2(f,l)-Math.atan2(d,h);this._rotationStart={x:r,y:i};this._camera.rotate(v)};function Y_(e,t,r){var value=!r;var i=e._settings.get("interactions."+t+".hideNodes");var n=e._settings.get("interactions."+t+".hideEdges");var a=e._settings.get("interactions."+t+".hideNodeTexts");var o=e._settings.get("interactions."+t+".hideEdgeTexts");if(i){e._ogma.styles.setNodesVisibility(value)}if(a){e._ogma.styles.setNodeTextsVisibility(value)}if(n){e._ogma.styles.setEdgesVisibility(value)}if(o){e._ogma.styles.setEdgeTextsVisibility(value)}}function q_(e,t,r,i){var n=e._settings.get("interactions.zoom.modifier");var a=e._settings.get("interactions.zoom.duration");var o=e._settings.get("interactions.zoom.easing");var s=e._settings.get("interactions.zoom.minValue");var u=e._settings.get("interactions.zoom.maxValue");var l=e._ogma.view.getGraphBoundingBox();var f=e._ogma.view.getZoom();var h=e._ogma.view.getSize();var d={duration:a,easing:o};var v=f*(t>0?n:1/n);if(!isNaN(l.cx)){var c={smallestNodeSize:l.minSize,graphWidth:l.width,graphHeight:l.height,viewWidth:h.width,viewHeight:h.height};var _=s&&s(c);var g=u&&u(c);if(Z_(_)&&v<_){if(v<f){v=Math.min(f,_)}}else if(Z_(g)&&v>g){if(v>f){v=Math.max(f,g)}}}Y_(e,"zoom",true);e._camera.setZoom(v,d,{refX:r,refY:i}).then(function(){Y_(e,"zoom",false)})}function Z_(value){return typeof value==="number"&&isFinite(value)}var $_=100;var K_={outline:true,"outerStroke.color":"red","outerStroke.width":5,"text.backgroundColor":"rgb(220, 220, 220)","text.minVisibleSize":0,"innerStroke.minVisibleSize":0};var J_={outline:true,"text.backgroundColor":"rgb(220, 220, 220)","text.minVisibleSize":0,color:"red"};b.extend(function(e){e.modules.hover=new Q_(e);e.styles.setHoveredNodeAttributes=function(t){return e.modules.hover.updateNodeAttributes(t)};e.styles.setHoveredEdgeAttributes=function(t){return e.modules.hover.updateEdgeAttributes(t)}});var Q_=function e(t){var r=this;this._graph=t.modules.graph;this._graphics=t.modules.graphics;this._settings=t.modules.settings;this._captor=t.modules.captor;this._events=t.modules.events;this._classes=t.modules.classes;this._settings.register("cursor.node","pointer",function(value,e){if(r._hovered&&r._hovered.isNode){r._graphics.removeCursorStyle(e);r._graphics.addCursorStyle(value)}});this._settings.register("cursor.edge","pointer",function(value,e){if(r._hovered&&!r._hovered.isNode){r._graphics.removeCursorStyle(e);r._graphics.addCursorStyle(value)}});this._settings.register("nodeHover",true,function(value){if(!value&&r._hovered&&r._hovered.isNode){ig(r,r._hovered)}});this._settings.register("edgeHover",true,function(value){if(!value&&r._hovered&&!r._hovered.isNode){ig(r,r._hovered)}});this._classes.create("hoverExtremityHighlighted",{nodeAttributes:K_});this._classes.create("hovered",{nodeAttributes:K_,edgeAttributes:J_});var i=function(){r._classes.clearNodes("hoverExtremityHighlighted");r._classes.getEdgesByClass("hovered").getExtremities().addClass("hoverExtremityHighlighted")};this._classes.onEdgesClassAdded("hovered",i);this._classes.onEdgesClassRemoved("hovered",i);this._timeout=null;this._hovered=null;this._events.on({hover:function(e){var t=e.target;return rg(r,t)},unhover:function(e){var t=e.target;return ig(r,t)},clear:function(){r._hovered=null;if(r._timeout){clearTimeout(r._timeout)}}})};Q_.prototype.updateNodeAttributes=function e(t){this._classes.setNodeAttributes("hovered",t);this._classes.setNodeAttributes("hoverExtremityHighlighted",t)};Q_.prototype.updateEdgeAttributes=function e(t){this._classes.setEdgeAttributes("hovered",t)};function eg(e){if(e._timeout){clearTimeout(e._timeout);e._timeout=null}}function tg(e){return e._graphics.isAnimating()}function rg(e,t){if(!t.isNode&&!e._settings.get("edgeHover")||t.isNode&&!e._settings.get("nodeHover")||eg(e)||tg(e)){return}var r=function(){if(tg(e)){e._timeout=setTimeout(r,$_)}else{ng(e,true,t);e._hovered=t;e._timeout=null}};e._timeout=setTimeout(r,$_)}function ig(e,t){eg(e);if(e._hovered===t){ng(e,false,t);e._hovered=null}}function ng(e,t,r){var i=e._settings.get(r.isNode?"cursor.node":"cursor.edge");e._graphics[t?"addCursorStyle":"removeCursorStyle"](i);r[t?"addClass":"removeClass"]("hovered");if(r.isNode&&t){r.setAttribute("text.hidden",false)}}var ag={number:1,duration:1e3,interval:800,startColor:"rgba(0 ,0 ,0 , 0.6)",endColor:"rgba(0, 0, 0, 0.0)",width:50,startRatio:1,endRatio:2};var og={number:1,duration:1e3,interval:800,startColor:"rgba(0, 0, 0, 0.6)",endColor:"rgba(0, 0, 0, 0.0)",width:10,startRatio:1,endRatio:2};b.extend(function(e){var t=new sg(e);e.modules.pulses=t;e.Node.prototype.pulse=function(e){t.pulse(this,e)};e.NodeList.prototype.pulse=function(e){t.pulse(this,e)};e.Edge.prototype.pulse=function(e){t.pulse(this,e)};e.EdgeList.prototype.pulse=function(e){t.pulse(this,e)}});var sg=function e(t){this._graph=t.modules.graph;this._dom=t.modules.dom;this._graphics=t.modules.graphics;this._events=t.modules.events;this._classes=t.modules.classes;this._engine=this._graphics.getGraphicsEngine();this._block=this._engine.createBlock();this._singleNodePulse=this._singleNodePulse.bind(this);this._singleEdgePulse=this._singleEdgePulse.bind(this)};sg.prototype.pulse=function e(t,r){var i=this;setTimeout(function(){return i._doPulse(t,r)},0)};sg.prototype._doPulse=function e(t,r){var i=this;var n=t.isNode,a=ct(r,n?ag:og),o=a.number,s=a.interval,u=0;for(var l=0;l<o;++l){setTimeout(n?i._singleNodePulse:i._singleEdgePulse,u,t,a);u+=s}};sg.prototype._singleNodePulse=function e(t,r){var i=this;var n=r.startRatio;var a=r.endRatio;var o=r.startColor;var s=r.endColor;var u=r.width;var l=r.duration;var f=t._indexes,h=this._engine.getCurrentTime(),d=this._graphics.getNodeAttributes(),v=d.layer,c=d.x,_=d.y,g=d.radius,p=d.color,y=new Array(f.length);n=Math.min(n,8);a=Math.min(a,8);for(var m=0;m<f.length;++m){var b=f[m],x=p.get(b),A=v.get(b),w=c.get(b),S=_.get(b),E=g.get(b),T=E*2*n,M=E*2*a,C=Th(A).nodeBody,k=i._graphics.allocateGraphicsEngineBlockId(),N=i._block.reset(Ks,true,C),I=N.nextAndReset(),z=ug(o,x),L=ug(s,x);I.end.x=w;I.end.y=S;I.end.thicknessScaled=M;I.end.lengthScaled=M;I.end.strokeWidthAbsolute=u;I.end.strokeColor=L;I.start.x=w;I.start.y=S;I.start.thicknessScaled=T;I.start.lengthScaled=T;I.start.strokeWidthAbsolute=u;I.start.strokeColor=z;I.animation.duration=l;I.animation.beginTime=h;i._engine.storeBlock(k,N);y[m]=k}setTimeout(function(){for(var e=0;e<y.length;++e){i._graphics.releaseGraphicsEngineBlockId(y[e])}},l);this._dom.refresh(h+l)};sg.prototype._singleEdgePulse=function e(t,r){var i=this;var n=r.startRatio;var a=r.endRatio;var o=r.startColor;var s=r.endColor;var u=r.duration;var l=r.width,f=t._indexes,h=new Array(f.length),d={},v={},c=this._engine.getCurrentTime(),_=this._graphics.getEdgeAttributes(),g=this._graphics.getNodeAttributes(),p=_.layer,y=_.source,m=_.target,b=_.curvature,x=_.width,A=_["shape.type"],w=_["shape.style"],S=_["shape.head"],E=_["shape.tail"],T=g.x,M=g.y,C=g.radius;n=Math.min(n,8);a=Math.min(a,8);for(var k=0;k<f.length;++k){var N=f[k],I=p.get(N),z=Th(I).edgeBody,L=i._graphics.allocateGraphicsEngineBlockId(),R=i._block.reset(Ks,true,z),D=y.get(N),F=m.get(N),P=b.get(N),B=D===F,O=x.get(N),V=A.get(N),j=w.get(N),U=E.get(N),G=S.get(N),X=C.get(D),W=C.get(F),H=T.get(D),Y=M.get(D),q=T.get(F),Z=M.get(F);d.width=O;d.shapeType=V;d.shapeStyle=j;d.shapeTail=U;d.shapeHead=G;d.sourceRadius=X;d.targetRadius=W;d.sourceX=H;d.sourceY=Y;d.targetX=q;d.targetY=Z;d.curvature=P;d.isSelfLoop=B;Jf(d,v);var $=v.bodyType;var K=v.bodyX;var J=v.bodyY;var Q=v.bodyLength;var ee=v.bodyWidth;var te=v.bodyAngle;var re=v.tailX;var ie=v.tailY;var ne=v.tailLength;var ae=v.tailWidth;var oe=v.tailAngle;var se=v.headX;var ue=v.headY;var le=v.headLength;var fe=v.headWidth;var he=v.headAngle;var de=ee*n,ve=ee*a;var ce=true,_e=null,ge=1,pe=0,ye=0,me=0,be=0,xe=0,Ae=0,we=null,Se=null;hh(ce,R,P,B,$,K,J,Q,ve,te,we,re,ie,ne,ae,oe,Se,se,ue,le,fe,he,_e,ge,s,l,pe,ye,me,be,xe,Ae,$,K,J,Q,de,te,we,re,ie,ne,ae,oe,Se,se,ue,le,fe,he,_e,ge,o,l,pe,ye,me,be,xe,Ae);R.setGlobalAnimation(c,u,"linear");i._engine.storeBlock(L,R);h[k]=L}setTimeout(function(){for(var e=0;e<h.length;++e){i._graphics.releaseGraphicsEngineBlockId(h[e])}},u);this._dom.refresh(c+u)};function ug(e,t){if(e==="inherit"){return Array.isArray(t)?t[0]:t}else{return e}}var lg={outline:true,"outerStroke.color":"red","outerStroke.width":5,"text.backgroundColor":"rgb(220, 220, 220)","text.minVisibleSize":0,"innerStroke.minVisibleSize":0};var fg={outline:true,"text.backgroundColor":"rgb(220, 220, 220)","text.minVisibleSize":0,color:"red","stroke.width":2};b.extend(function(e){var t=new hg(e),r=e.modules.classes;var i=e.Node;var n=e.Edge;var a=e.NodeList;var o=e.EdgeList;e.modules.selection=t;e.events.onNodesSelected=function(t){r.onNodesClassAdded("selected",t);return e.events};e.events.onNodesUnselected=function(t){r.onNodesClassRemoved("selected",t);return e.events};e.events.onEdgesSelected=function(t){r.onEdgesClassAdded("selected",t);return e.events};e.events.onEdgesUnselected=function(t){r.onEdgesClassRemoved("selected",t);return e.events};e.styles.setSelectedNodeAttributes=function(e){return t.setNodeAttribute(e)};e.styles.setSelectedEdgeAttributes=function(e){return t.setEdgeAttributes(e)};e.clearSelection=function(){return t.clear()};e.getSelectedNodes=function(){return t.getSelectedNodes()};e.getNonSelectedNodes=function(){return t.getNonSelectedNodes()};e.getSelectedEdges=function(){return t.getSelectedEdges()};e.getNonSelectedEdges=function(){return t.getNonSelectedEdges()};i.prototype.setSelected=function(e){t.setActive(this,e)};i.prototype.isSelected=function(){return t.areActive(this)};a.prototype.setSelected=function(e){t.setActive(this,e)};a.prototype.isSelected=function(){return t.areActive(this)};n.prototype.setSelected=function(e){t.setActive(this,e)};n.prototype.isSelected=function(){return t.areActive(this)};o.prototype.setSelected=function(e){t.setActive(this,e)};o.prototype.isSelected=function(){return t.areActive(this)}});var hg=function e(t){var r=this;this._events=t.modules.events;this._settings=t.modules.settings;this._graph=t.modules.graph;this._keyboard=t.modules.keyboard;this._graphics=t.modules.graphics;this._interactions=t.modules.interactions;this._classes=t.modules.classes;this._classes.create("selectionExtremityHighlighted",{nodeAttributes:lg});this._classes.create("selected",{nodeAttributes:lg,edgeAttributes:fg});var i=function(){r._classes.clearNodes("selectionExtremityHighlighted");r._classes.getEdgesByClass("selected").getExtremities().addClass("selectionExtremityHighlighted")};this._classes.onEdgesClassAdded("selected",i);this._classes.onEdgesClassRemoved("selected",i);this._settings.register("interactions.selection.enabled",true);this._settings.register("interactions.selection.multiSelectionKey","ctrl");this._interactions.onClick({priority:"selection",check:function(e){var t=e.button;return t==="left"&&r._settings.get("interactions.selection.enabled")},handler:function(e){var t=e.target;if(!t){r._classes.clearEdges("selected");r._classes.clearNodes("selected")}else{var i=r._settings.get("interactions.selection.multiSelectionKey"),n=i&&r._keyboard.isPressed(i);r._classes[t.isNode?"clearEdges":"clearNodes"]("selected");if(!n){var a=r._classes[t.isNode?"getNodesByClass":"getEdgesByClass"]("selected");a.filter(function(e){return e!==t}).removeClass("selected");if(!t.hasClass("selected")){t.addClass("selected")}}else if(t.hasClass("selected")){t.removeClass("selected")}else{t.addClass("selected")}}}});this._events.on("beforeRemoveEdges",function(e){var t=e.edges;return t.setSelected(false)})};hg.prototype.setNodeAttribute=function e(t){this._classes.setNodeAttributes("selected",t);this._classes.setNodeAttributes("selectionExtremityHighlighted",t)};hg.prototype.setEdgeAttributes=function e(t){this._classes.setEdgeAttributes("selected",t)};hg.prototype.setActive=function e(t,r){if(bt(r)){var i=function(e,t){return r[t]?"toSelect":"toUnselect"};var n=i.toSelect;var a=i.toUnselect;if(n){n.addClass("selected")}if(a){n.removeClass("selected")}}else{t[r?"addClass":"removeClass"]("selected")}};hg.prototype.areActive=function e(t){return t.hasClass("selected")};hg.prototype.getSelectedNodes=function e(){return this._classes.getNodesByClass("selected")};hg.prototype.getSelectedEdges=function e(){return this._classes.getEdgesByClass("selected")};hg.prototype.getNonSelectedNodes=function e(){return this._graph.getNodes().filter(function(e){return!e.hasClass("selected")})};hg.prototype.getNonSelectedEdges=function e(){return this._graph.getEdges().filter(function(e){return!e.hasClass("selected")})};hg.prototype.clear=function e(){this._classes.clearEdges("selected");this._classes.clearNodes("selected")};b.extend(function(e){e.modules.drag=new vg(e);e.events.onNodeDragStart=function(t){e.modules.events.on("startMoveNodesByDragging",t);return e.events};e.events.onNodeDragProgress=function(t){e.modules.events.on("progressMoveNodesByDragging",t);return e.events};e.events.onNodeDragEnd=function(t){e.modules.events.on("endMoveNodesByDragging",t);return e.events}});var dg="__dragged";var vg=function e(t){var r=this;this._graph=t.modules.graph;this._camera=t.modules.camera;this._graphics=t.modules.graphics;this._selection=t.modules.selection;this._events=t.modules.events;this._settings=t.modules.settings;this._classes=t.modules.classes;this._classes.create(dg,{after:"selected"});this._events.register(["startMoveNodesByDragging","progressMoveNodesByDragging","endMoveNodesByDragging"]);this._settings.register("interactions.drag.enabled",true);this._settings.register("interactions.drag.cursor","move");this._settings.register("interactions.drag.onBeforeDrag",null);this._dragged=null;this._start=null;this._end=null;this._startDrag=null;t.modules.interactions.onDrag({priority:"drag",disableDetection:true,check:function(e){var t=e.target;var i=r._settings.get("interactions.drag.enabled"),n=t&&t.isNode&&t.getAttribute("draggable");return i&&n},onStart:function(e){var t=e.target;var i=e.x;var n=e.y;if(t.isSelected()){r._dragged=r._selection.getSelectedNodes().filter(function(e){return e.getAttribute("draggable")})}else{r._dragged=r._graph._getElements(true,[t._index])}r._start=r._dragged.getPosition();r._end=dt(r._start);r._onBeforeDrag=r._settings.get("interactions.drag.onBeforeDrag");r._startDrag=cg(r,i,n);r._dragged.addClass(dg);r._events.fire("startMoveNodesByDragging",{nodes:r._dragged});r._graphics.addCursorStyle(r._settings.get("interactions.drag.cursor"))},onProgress:function(e){var t=e.x;var i=e.y;var n=r._dragged._indexes,a=cg(r,t,i),o=a.x-r._startDrag.x,s=a.y-r._startDrag.y;for(var u=0;u<n.length;++u){var l=r._start[u],f=r._end[u];f.x=l.x+o;f.y=l.y+s}if(r._onBeforeDrag){r._onBeforeDrag(t,i,r._end)}r._dragged.setAttributes(r._end);r._events.fire("progressMoveNodesByDragging",{nodes:r._dragged})},onStop:function(){r._dragged.removeClass(dg);r._graphics.removeCursorStyle(r._settings.get("interactions.drag.cursor"));r._events.fire("endMoveNodesByDragging",{nodes:r._dragged,start:r._start,end:r._end});r._dragged=null;r._start=null;r._end=null}})};function cg(e,t,r){var i=e._camera.getAngle(),n=e._camera.getZoom(),a=Math.cos(i),o=Math.sin(i),s=t/n,u=r/n,l=a*s-o*u,f=o*s+a*u;return{x:l,y:f}}b.extend(function(e){var t=new _g(e);e.modules.grouping=t;e.transformations.addNodeGrouping=function(e){return new Promise(function(r){var i=t.addNodeGrouping(e,function(){return r(i)})})};e.transformations.addEdgeGrouping=function(e){return new Promise(function(r){var i=t.addEdgeGrouping(e,function(){return r(i)})})};e.transformations.removeNodeGrouping=function(e,r){if(r===void 0)r=0;return new Promise(function(i){t.removeGrouping(e,r,i)})}});var _g=function e(t){this._graph=t.modules.graph;this._transform=t.modules.transform;this._graphics=t.modules.graphics;this._nodeToGroup=this._graph.createAttribute(true,{storage:"any"});this._edgeToGroup=this._graph.createAttribute(false,{storage:"any"})};_g.prototype.addNodeGrouping=function e(t,r){var i=this;var n=gg(this,t);if(typeof t.duration==="number"&&t.duration>0){this.animateGrouping(n(this._graph.getVisible(),""),"",t.duration).then(function(){return i._transform.addRule(n,r)});return this._transform.nextId()}else{return this._transform.addRule(n,r)}};_g.prototype.animateGrouping=function e(t,r,i){var n=this;var a=t.virtualNodes;var o=t.groupToNodes;return new Promise(function(e){var t=a.reduce(function(e,t){e[t.id]=t;return e},{});var s=o.keys();var u=[],l=[];for(var f=0,h=s.length;f<h;f++){var d=s[f];if(d!==undefined){var v=t[mg(r,d)];var c=o.get(d);var _={x:v.attributes.x,y:v.attributes.y};l.push.apply(l,c._indexes);for(var g=0,p=c.size;g<p;g++){u.push(_)}}}var y=new n._graph.NodeList(l);var m=n._graph.getAttributes(true,["x","y"]);var b=m[0];var x=m[1];var A=b.getMultiple(l),w=x.getMultiple(l);n._graphics.hideTexts();y.setAttributes(u,i).then(function(){e();n._graphics.showTexts();setTimeout(function(){b.setMultiple(l,A);x.setMultiple(l,w)},0)})})};_g.prototype.addEdgeGrouping=function e(t,r){return this._transform.addRule(pg(this,t),r)};_g.prototype.removeGrouping=function e(t,r,i){var n=this;if(r===void 0)r=0;if(r>0){this._graphics.hideTexts();var a=this._transform.getRule(t);var o=a._nodes.getVirtualElements();var s=new this._graph.NodeList(o.map(function(e){return e._index}));var u=s.getPosition();var l=s.getId().reduce(function(e,t,r){e[t]=u[r];return e},{});var f=[],h=[],d=[];var v=this._nodeToGroup._buffer;for(var c=1,_=v.length;c<_;c++){var g=v[c];if(g!==undefined&&g!==0){var p=mg(t,g);if(l[p]){var y=l[p];f.push(c);h.push(y.x);d.push(y.y)}}}var m=new this._graph.NodeList(f);var b=m.getPosition();var x=this._graph.getAttributes(true,["x","y"]);var A=x[0];var w=x[1];A.setMultiple(f,h);w.setMultiple(f,d);this._transform.removeRule(t,function(){m.setAttributes(b,r).then(function(){n._graphics.showTexts();i()})})}else{this._transform.removeRule(t,i)}};function gg(e,t){if(t===void 0)t={};var r=t.selector;var i=t.groupIdFunction;var n=t.nodeGenerator;var a=t.edgeGenerator;var o=t.ignoreEdgeDirection;if(o===void 0)o=false;var s=t.groupSelfLoopEdges;if(s===void 0)s=false;if(!i){i=function(){return"default"}}if(!n){n=function(){return{}}}var u=r?function(e){return r(e)?i(e):undefined}:i;return function(t,r){return wg(e,t,r,u,n,a,o,s)}}function pg(e,t){if(t===void 0)t={};var r=t.selector;var i=t.groupIdFunction;var n=t.generator;var a=t.ignoreEdgeDirection;if(a===void 0)a=false;if(!i){i=function(){return"default"}}if(!n){n=function(){return{}}}var o=r?function(e){return r(e)?i(e):undefined}:i;return function(t,r){return Eg(e,t,r,o,n,a)}}function yg(e){var t=e.get(0);return{data:dt(t.getData()),attributes:{width:t.getAttribute("width"),color:t.getAttribute("color")}}}function mg(e,t){return"#"+e+"["+t+"]"}function bg(e,t,r){return"#"+e+"["+t+"->"+r+"]"}function xg(e,t,r){var i=t.toString(),n=r.toString(),a=i<n?i:n,o=a===i?n:i;return"#"+e+"["+a+"<->"+o+"]"}function Ag(e,t,r,i,n,a){if(e){if(t){return xg(r,i,n)}else{return bg(r,i,n)}}else{return mg(r,a)}}function wg(e,t,r,i,n,a,o,s){var u=t.nodes;var l=t.edges;var f=new vi,h=new vi,d=e._nodeToGroup,v=[],c=[],_=[],g=[];for(var p=0;p<u.length;++p){var y=u[p],m=i(y),b=f.get(m);if(!b){b=new e._graph.NodeList;f.set(m,b)}b._indexes.push(y._index);d.set(y._index,m)}for(var x=0;x<l.length;++x){var A=l[x],w=A.getSource(),S=A.getTarget(),E=d.get(w._index),T=d.get(S._index);if(E!==undefined||T!==undefined){if(E!==T||s){var M=E!==undefined?mg(r,E):w.getId(),C=T!==undefined?mg(r,T):S.getId(),k=Ag(a,o,r,M,C,A.getId()),N=h.get(k);if(N){N.edges._indexes.push(A._index)}else{h.set(k,{source:M,target:C,edges:new e._graph.EdgeList([A._index])})}}else{g.push(A)}}}var I=f.keys(),z=h.keys();for(var L=0;L<I.length;++L){var R=I[L];if(R!==undefined){var D=f.get(R),F=n(D,R,r);F.id=mg(r,R);if(!F.attributes){F.attributes={}}if(!("x"in F.attributes)||!("y"in F.attributes)){var P=D.reduce(function(e,t){var r=t.getPosition();e.x+=r.x;e.y+=r.y;return e},{x:0,y:0});var B=P.x;var O=P.y;F.attributes.x=B/D.size;F.attributes.y=O/D.size}v.push(F);_.push.apply(_,D.toArray())}}if(!a){a=yg}for(var V=0;V<z.length;++V){var j=z[V];if(j!==undefined){var U=h.get(j);var G=U.source;var X=U.target;var W=U.edges;var H=a(W,j,r);H.id=j;H.source=G;H.target=X;c.push(H);g.push.apply(g,W.toArray())}}return{virtualNodes:v,virtualEdges:c,hiddenNodes:_,hiddenEdges:g,groupToNodes:f}}function Sg(e,t){var r=e.toString(),i=t.toString();return r<i?[r,i]:[i,r]}function Eg(e,t,r,i,n,a){var o=t.edges;var s=new vi,u=e._edgeToGroup,l=[],f=[];for(var h=0;h<o.length;++h){var d=o[h],v=d.getSource().getId(),c=d.getTarget().getId(),_=i(d),g=_;if(_){if(a){var p=Sg(v,c);var y=p[0];var m=p[1];_="#"+r+"("+y+"<->"+m+")["+_+"]"}else{_="#"+r+"("+v+"->"+c+")["+_+"]"}var b=s.get(_);if(!b){b={source:v,target:c,groupId:g,edges:new e._graph.EdgeList};s.set(_,b)}b.edges._indexes.push(d._index)}u.set(d._index,_)}var x=s.keys();for(var A=0;A<x.length;++A){var w=x[A];if(w!==undefined){var S=s.get(w);var E=S.source;var T=S.target;var M=S.edges;var C=S.groupId;var k=n(M,C,r);k.id=w;k.source=E;k.target=T;l.push(k);f.push.apply(f,M.toArray())}}return{virtualEdges:l,hiddenEdges:f}}var Tg={"top-left":"left","bottom-left":"left","top-right":"right","bottom-right":"right"};var Mg={"top-left":"top","bottom-left":"bottom","top-right":"top","bottom-right":"bottom"};b.extend(function(e){var t=new kg(e);e.modules.brand=t;e.tools.brand={set:function e(r,i){return t.set(r,i)},remove:function e(){t.remove()}}});var Cg={position:"bottom-right",horizontalMargin:0,verticalMargin:0,className:null};var kg=function e(t){this._dom=t.modules.dom;this._brand=null};kg.prototype.set=function e(t,r){var i=ct(r,Cg);var n=i.position;var a=i.horizontalMargin;var o=i.verticalMargin;var s=i.className;if(!Tg[n]){n=Cg.position}this.remove();var u=document.createElement("div");u.innerHTML=t;u.style.position="absolute";u.style[Tg[n]]=a+"px";u.style[Mg[n]]=o+"px";u.style.padding="0px 0px 0px 0px";u.style.zIndex="1000";if(s){u.setAttribute("class",s)}this._brand=u;this._dom.setLayer("brand",this._brand);return u};kg.prototype.remove=function e(){this._dom.setLayer("brand",null);this._brand=null};var Ng="geo.latitude";var Ig="geo.longitude";var zg=.2;b.extend(function(e){var t=new Ug(e);var r=e.modules;var i=r.graph;e.modules.geo=t;e.geo={enable:function(e){return t.enable(e)},disable:function(e){return t.disable(e)},setOptions:function(e){return t.setOptions(e)},enabled:function(){return t.isEnabled()},getCenter:function(){return t.getCenter()},getView:function(){return t.getView()},getZoom:function(){return t.getZoom()},setZoom:function(e){return t.setZoom(e)},setView:function(e,r,i){return t.setView(e,r,i)},setCenter:function(e,r){return t.setCenter(e,r)},toggle:function(e){return t.toggle(e)},resetCoordinates:function(){return t.resetCoordinates()},updateCoordinates:function(){return t.updateCoordinates()}};i.Node.prototype.getGeoCoordinates=function(){return{latitude:i.getAttribute(true,Ng).get(this._index),longitude:i.getAttribute(true,Ig).get(this._index)}};function n(e,t){return e.getAdjacentEdges({filter:"raw"}).filter(function(e){return t.get(e.getSource()._index)===0&&t.get(e.getTarget()._index)===0})}i.Node.prototype.setGeoCoordinates=function(e,t){var r=this;return this.toList().setGeoCoordinates([e],t).then(function(){return r})};i.NodeList.prototype.getGeoCoordinates=function(){var e=new Array(this._indexes.length);var t=i.getAttribute(true,Ng).getMultiple(this._indexes);var r=i.getAttribute(true,Ig).getMultiple(this._indexes);for(var n=0,a=this._indexes.length;n<a;n++){e[n]={latitude:t[n],longitude:r[n]}}return e};i.NodeList.prototype.setGeoCoordinates=function(e,r){var a=this.getId();var o=this._indexes;var s=new Array(o.length);var u=new Array(o.length);var l=t.isEnabled();var f=t._nodeVisibilityFilter;var h=t._edgeVisibilityFilter;var d=[],v=[];var c,_;if(e===null){e=new Array(o.length).fill(null)}if(e.length!==o.length){throw new RangeError("You must provide coordinates for each node in the NodeList")}for(var g=0,p=o.length;g<p;g++){var y=e[g];var m=a[g];var b=o[g];var x=void 0,A=void 0;if(y===null||y.latitude===null&&y.longitude===null){x=A=undefined;r=0;d.push(m)}else{x=y.latitude;A=y.longitude;Wg(m,x);Xg(m,A);if(l&&f.get(b)===1){v.push(m)}}s[g]=x;u[g]=A}this.setData(t._settings.latitudePath,s);this.setData(t._settings.longitudePath,u);d=i.getNodes(d);c=d.getAdjacentEdges();v=i.getNodes(v);i.getAttribute(true,Ng).setMultiple(o,s);i.getAttribute(true,Ig).setMultiple(o,u);if(l){f.setMultiple(d._indexes,1);h.setMultiple(c._indexes,1);f.setMultiple(v._indexes,0);if(v.size>0){_=n(this,f);h.setMultiple(_._indexes,0);t._onNodesAdded(v);t._onEdgesAdded(_)}}return t._redrawNodes(r,this).then(function(e){gp(t,d,r),pp(t,c,r);return e})};e.events.onGeoModeEnabled=function(t){e.modules.events.on("geoEnabled",t);return e.events};e.events.onGeoModeDisabled=function(t){e.modules.events.on("geoDisabled",t);return e.events};e.events.onGeoModeLoaded=function(t){e.modules.events.on("geoLoaded",t);return e.events}});var Lg=8;var Rg={latitudePath:"latitude",longitudePath:"longitude",maxZoomLevel:17,wrapCoordinates:true,tileUrlTemplate:"https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}.png",tileUrlSubdomains:"abc",attribution:null,backgroundColor:"silver",opacity:1,duration:0,detectRetina:false,disableNodeDragging:true,tileBuffer:1};var Dg=256;var Fg=500;var Pg=100;var Bg=100;var Og=0;var Vg=10;function jg(e){if(e===void 0)e={};var t=e.tileUrlSubdomains;var r=e.tileUrlTemplate;var i=e.attribution;var n=e.latitudePath;var a=e.longitudePath;if(r&&typeof r!=="string"){throw new TypeError("Geo mode: tileUrlTemplate must be a URL string")}if(t&&typeof t!=="string"){throw new TypeError("Geo mode: tileUrlTemplate must be a string")}if(i&&typeof i!=="string"){throw new TypeError("Geo mode: Map attribution must be a string")}if(n&&typeof n!=="string"&&!Array.isArray(n)){throw new TypeError("Geo mode: Latitude path must be a valid property path: "+"a string or an array of strings.")}if(a&&typeof a!=="string"&&!Array.isArray(a)){throw new TypeError("Geo mode: Longitude path must be a valid property path: "+"a string or an array of strings.")}}var Ug=function e(t){var r=this;this._ogma=t;this._dom=t.modules.dom;this._graphics=t.modules.graphics;this._graph=t.modules.graph;this._data=t.modules.data;this._camera=t.modules.camera;this._events=t.modules.events;this._settingsModule=t.modules.settings;this._locate=t.modules.locate;this._brand=t.modules.brand;this._settings=_t({},Rg);this._screen=this._dom.getDimensions();this._tiles={};this._tileSize=Dg*Tr();this._enableMapBackground=false;this._init=false;this._enabled=false;this._sIndex=0;this._lat=0;this._lng=0;this._zoom=1;this._zoomOffset=0;this._loadingTiles=0;this._prevXList=this._graph.createNodeAttribute({name:"geo.prevX",storage:"float"});this._prevYList=this._graph.createNodeAttribute({name:"geo.prevY",storage:"float"});this._graph.createNodeAttribute({name:"geo.prevLat",storage:"float"});this._graph.createNodeAttribute({name:"geo.prevLng",storage:"float"});this._prevRadiusList=this._graph.createNodeAttribute({name:"geo.prevSize",storage:"float"});this._graph.createNodeAttribute({name:Ng,storage:"float"});this._graph.createNodeAttribute({name:Ig,storage:"float"});this._prevWidthList=this._graph.createEdgeAttribute({name:"geo.prevSize",storage:"float"});this._events.register(["geoEnabled","geoDisabled","geoLoaded","geoReady"]);this._events.on({addNodes:function(e){return r._onNodesAdded(e.nodes)},addEdges:function(e){return r._onEdgesAdded(e.edges)},setContainer:function(e){if(e&&r._enabled){cp(r,e)}},cameraMove:function(){return hp(r)},resize:function(){return r._onResize()},endMoveNodesByDragging:function(e){return Ep(r,e.nodes)}})};Ug.prototype._onNodesDrawn=function e(t){if(this._enabled&&!this._transition){Ep(this,t)}};Ug.prototype._onResize=function e(){Hg(this);hp(this)};Ug.prototype._readNodesCoordinates=function e(t){var r=this._graph;var i=this._settings;var n=i.longitudePath;var a=i.latitudePath;var o=i.wrapCoordinates;var s=r.getAttributes(true,[Ng,Ig]);var u=s[0];var l=s[1];var f=this._nodeVisibilityFilter;var h=t._indexes;var d=t.getId();var v=h.length;var c=t.getData(a);var _=t.getData(n);var g,p,y,m,b;for(var x=0;x<v;x++){p=_[x];g=c[x];m=h[x];y=d[x];if(g!==undefined&&p!==undefined){Xg(y,p);Wg(y,g);b=0;if(o){p=p%180;g=be(+g,-Np,Np)}else if(!Gp(g,p)){b=1}l.set(m,p);u.set(m,g)}else{b=1}if(f){f.set(m,b)}}};Ug.prototype._onNodesAdded=function e(t){this._readNodesCoordinates(t);if(this._enabled){_p(this,t);Ap(this,t);this._graph._refreshFilters()}};Ug.prototype._onEdgesAdded=function e(t){if(this._enabled){Sp(this,t)}else{Mp(this,t,"width","geo.prevSize")}};Ug.prototype._onSettingsChanged=function e(t,r){if(this._enabled){if(t.tileUrlTemplate!==r.tileUrlTemplate){clearTimeout(this._redrawTimer);Jg(this);hp(this)}if(t.sizeZoomReferential!==r.sizeZoomReferential){wp(this,this._graph.getNodes());wp(this,this._graph.getEdges())}if(t.attribution!==r.attribution){Yg(this)}if(t.maxZoomLevel!==r.maxZoomLevel){this._settingsModule.update({minZoom:1,maxZoom:Math.pow(2,r.maxZoomLevel)})}}if(t.wrapCoordinates!==r.wrapCoordinates){this._readNodesCoordinates(this._graph.getNodes())}};Ug.prototype._updateVisibility=function e(t,r){var i=this._graph;var n=this._settings;var a=n.latitudePath;var o=n.longitudePath;var s=n.wrapCoordinates;var u=t._indexes;var l=i._allIndexes(false);var f=t.getData(a);var h=t.getData(o);var d=u.length;var v=new Array(d);var c={};var _,g;for(var p=0;p<d;p++){_=f[p];g=h[p];var y=_===undefined||g===undefined||!s&&!Gp(_,g);v[p]=y;c[u[p]]=!y}var m=i.getAttribute(false,"source").getMultiple(l);var b=i.getAttribute(false,"target").getMultiple(l);var x=new Array(l.length);for(var A=0,w=l.length;A<w;A++){x[A]=!(c[m[A]]&&c[b[A]])}this._nodeVisibilityFilter.setMultiple(u,v);this._edgeVisibilityFilter.setMultiple(l,x);this._graph._refreshFilters();if(r){setTimeout(r)}};Ug.prototype._transformToGeoSpace=function e(t,r){var i=this;var n=r.X;var a=r.Y;var o=r.indexes;var s=this._graph;var u=this._camera;var l=s.getAttributes(true,["x","y","radius"]);var f=l[0];var h=l[1];var d=l[2];var v=f.getMultiple(o);var c=h.getMultiple(o);var _=d.getMultiple(o);var g=Gg(v,c,_);var p=Gg(n,a);var y=0;if(v.length===0||c.length===0){g.cx=g.cy=0;g.width=g.height=0}if(!isFinite(p.width)||!isFinite(p.height)){p.cx=p.cy=0;p.width=p.height=0}var m=p.cx-g.cx;var b=p.cy-g.cy;var x;if(v.length>1&&!this._settings.sizeZoomReferential){x=Math.max(p.width,p.height)/Math.max(g.width,g.height)*Tr()}else{x=Math.pow(2,-(this._settings.sizeZoomReferential||Lg))}y=De(d.getMultiple(o));p=Eo(p,y*x);var A=this._locate.computeConfigForBounds(p);A.zoom=Xp(A.zoom);var w=u.zoom/A.zoom;m+=(g.cx-u.x)*w;b+=(g.cy-u.y)*w;var S=g.cx+m;var E=g.cy+b;for(var T=0,M=o.length;T<M;T++){var C=v[T],k=c[T];v[T]=(C+m-S)*w+S;c[T]=(k+b-E)*w+E}this._scaleInfo={ratio:w,sizeRatio:x,dx:m,dy:b,zoom:u.zoom,x:u.x,y:u.y};var N=s.getAttribute(false,"width");var I=s._allIndexes(false).filter(function(e){return i._edgeVisibilityFilter.get(e)===0});f.setMultiple(o,v);h.setMultiple(o,c);d.setMultiple(o,d.getMultiple(o).map(function(e){return e*w}));N.setMultiple(I,N.getMultiple(I).map(function(e){return e*w}));this._scaleInfo.cameraConfig={zoom:u.zoom/w,x:(u.x+m-S)*w+S,y:(u.y+b-E)*w+E};this._graphics.refreshAll()};Ug.prototype._show=function e(t){var r=this;var i=this._dom.getContainer();var n=this._settings.duration;if(i){if(!this._init){cp(this,i)}this._dom.setLayer("geo",this._rcanvas)}this._enableTime=oe();this._enableMapBackground=false;var a=this._graph.getNodes();var o=this._graph.getEdges();this._nodeVisibilityFilter=this._graph._addFilter(true);this._edgeVisibilityFilter=this._graph._addFilter(false);this._updateVisibility(a,function(){r._readNodesCoordinates(a);r._graphics.refreshAll();_p(r,a);Mp(r,o,"width","geo.prevSize");r._graphics.hideTexts();var e=mp(r,a);r._transformToGeoSpace(a,e);r._edgeSizeRatio=r._scaleInfo.sizeRatio;r._nodeSizeRatio=r._scaleInfo.sizeRatio;Promise.all([Ap(r,a,e,n),Sp(r,o,n),r._camera.setView(r._scaleInfo.cameraConfig,n)]).then(function(){r._graphics.showTexts();r._prevSettings=r._settingsModule.update({backgroundColor:null,minZoom:1,maxZoom:Math.pow(2,r._settings.maxZoomLevel),"interactions.rotation.enabled":false,"interactions.zoom.minValue":function(){return 0},"interactions.zoom.maxValue":function(){return Math.pow(2,r._settings.maxZoomLevel)}});r._enableMapBackground=true;Yg(r);if(r._graph.getNodes().size===0){r.setCenter(0,0)}ep(r,r._settings.opacity,r._settings.backgroundColor);t()}).catch(function(e){it(e.stack)})})};Ug.prototype._transformToGraphSpace=function e(t){var r=this;var i=this._graph.getAttributes(true,["x","y","geo.prevX","geo.prevY","radius","geo.prevSize"]);var n=i[0];var a=i[1];var o=i[2];var s=i[3];var u=i[4];var l=i[5];var f=t._indexes.filter(function(e){return r._nodeVisibilityFilter.get(e)===0});var h=n.getMultiple(f);var d=a.getMultiple(f);var v=u.getMultiple(f);var c=Gg(h,d,v);var _=this._graph._allIndexes(true);var g=Gg(o.getMultiple(_),s.getMultiple(_),l.getMultiple(_));c=Eo(g,zg*g.maxSize);this._settingsModule.update({minZoom:this._prevSettings.minZoom});var p=this._locate.computeConfigForBounds(g);p.zoom=Xp(p.zoom);this._scaleInfo.cameraConfig=p;var y=g.cx-c.cx;var m=g.cy-c.cy;var b=this._camera.zoom/p.zoom;y+=(c.cx-this._camera.x)*b;m+=(c.cy-this._camera.y)*b;var x=c.cx+y;var A=c.cy+m;for(var w=0,S=f.length;w<S;w++){var E=h[w],T=d[w];h[w]=(E+y-x)*b+x;d[w]=(T+m-A)*b+A;v[w]*=b}n.setMultiple(f,h);a.setMultiple(f,d);u.setMultiple(f,v);var M=this._graph._allIndexes(false).filter(function(e){return r._edgeVisibilityFilter.get(e)===0});var C=this._graph.getAttribute(false,"width");C.setMultiple(M,C.getMultiple(M).map(function(e){return e/b}));this._graphics.refreshAll()};Ug.prototype._hide=function e(t){var r=this;var i=this._dom.getContainer();var n=this._settings.duration;var a=n/2;var o=se();var s=function(){var e=se();var t=(e-o)/a;if(t<1&&t>=0){ep(r,1-t,r._prevBgColor);r._fadeTimer=W(s)}};clearTimeout(this._redrawTimer);if(a!==0){this._fadeTimer=W(s)}else{s()}var u=this._graph.getNodes();var l=this._graph.getEdges();this._transformToGraphSpace(u);this._graphics.hideTexts();this._camera.setView(this._scaleInfo.cameraConfig,n);Promise.all([gp(this,u,n),pp(this,l,n)]).then(function(){qg(r);r._graphics.showTexts();r._graph._removeFilter(true,r._nodeVisibilityFilter);r._graph._removeFilter(false,r._edgeVisibilityFilter);r._nodeVisibilityFilter=null;r._edgeVisibilityFilter=null;r._graph._refreshFilters();r._graphics.refreshAll();if(i){r._dom.setLayer("geo",null)}setTimeout(function(){r._settingsModule.update(r._prevSettings);Jg(r);t()},0)})};Ug.prototype.enable=function e(t){return this.setEnabled(true,t)};Ug.prototype.disable=function e(t){return this.setEnabled(false,t)};Ug.prototype.isEnabled=function e(){return this._enabled};Ug.prototype.toggle=function e(t){return this.setEnabled(!this._enabled,t)};Ug.prototype.setOptions=function e(t){if(t===void 0)t={};jg(t);var r=this._settings;this._settings=_t({},this._settings,Rg,t);this._onSettingsChanged(r,this._settings)};Ug.prototype.setEnabled=function e(value,t){var r=this;if(t===void 0)t={};jg(t);if(value!==this._enabled&&!this._transition){this._enabled=value;this._transition=true;this._settings=_t({},this._settings,Rg,t);if(value){if(this._settings.disableNodeDragging){this._nodeDraggingSetting=this._settingsModule.get("interactions.drag.enabled");this._settingsModule.update({interactions:{drag:{enabled:false}}})}this._show(function(){r._transition=false;r._events.fire("geoEnabled");r._events.fire("geoReady")})}else{this._hide(function(){r._transition=false;r._events.fire("geoDisabled");if(r._settings.disableNodeDragging){r._settingsModule.update({interactions:{drag:{enabled:r._nodeDraggingSetting}}})}})}}return new Promise(function(e){if(r._transition){r._events.once(value?"geoEnabled":"geoDisabled",e)}else{e()}})};Ug.prototype.resetCoordinates=function e(){if(!this._enabled){return}var t=this._graph.getNodes();yp(this,t);Ap(this,t);this._graphics.refreshAll()};Ug.prototype.updateCoordinates=function e(){Ep(this,this._graph.getNodes());if(this._enabled){this._graphics.refreshAll()}};Ug.prototype._redrawNodes=function e(t,r){if(this._enabled){return xp(this,r,t).then(function(){return r})}else{return Promise.resolve(r)}};Ug.prototype.setView=function e(t,r,i){if(!this._enabled){throw new Error("Geo mode is not enabled")}jp(this,i);Up(t,r);vp(this,t,r,i);dp(this)};Ug.prototype.setCenter=function e(t,r){this.setView(t,r,this._zoom)};Ug.prototype.setZoom=function e(t){this.setView(this._lat,this._lng,t)};Ug.prototype.getView=function e(){return{latitude:this._lat,longitude:this._lng,zoom:this._zoom}};Ug.prototype.getCenter=function e(){return{latitude:this._lat,longitude:this._lng}};Ug.prototype.getZoom=function e(){return this._zoom};Ug.prototype.exportBackground=function e(t,r){var i=this;r=r||this._camera.getView();return new Promise(function(e){var n=Math.log2(r.zoom);var a=Op(r.x,r.y);var o=a[0];var s=a[1];var u=r.pixelRatio||Tr();i._tileSize=Dg*u;if(!Zg(i,t.getContext("2d"),t.width,t.height,n,o,s,false)){setTimeout(function(){i.exportBackground(t,r).then(function(){i._tileSize=Dg*Tr()}).then(e)},Pg)}else{i._tileSize=Dg*Tr();e()}})};Ug.prototype.whenReady=function e(){var t=this;return new Promise(function(e){var r=function(){return t.whenReady().then(e)};if(t.isEnabled()){if(t._transition){t._events.once("geoReady",r)}else if(!Qg(t)){setTimeout(r,50)}else{e()}}else{t._events.once("geoEnabled",r)}})};function Gg(e,t,r){var i=0;var n=e.reduce(function(n,a,o){var s=e[o],u=t[o];var l=r?r[o]/2:0;n.minX=Math.min(s-l,n.minX);n.minY=Math.min(u-l,n.minY);n.maxX=Math.max(s+l,n.maxX);n.maxY=Math.max(u+l,n.maxY);i=Math.max(i,l*2);return n},{minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity});n.width=n.maxX-n.minX;n.height=n.maxY-n.minY;n.cx=n.minX+n.width*.5;n.cy=n.minY+n.height*.5;n.maxSize=i;return n}function Xg(e,t){if(isNaN(t)){throw new TypeError("node "+e+": "+t+" is not a valid longitude")}}function Wg(e,t){if(isNaN(t)){throw new TypeError("node "+e+": "+t+" is not a valid latitude")}}function Hg(e){if(e._init){var t=e._screen=e._dom.getDimensions();var r=t.width;var i=t.height;e._tileSize=Dg*Tr();zr(e._canvas,r,i);zr(e._rcanvas,r,i)}}function Yg(e){if(!e._enabled){return}var t=e._settings.attribution;if(t){e._brand.set(t)}else{e._brand.remove()}}function qg(e){e._brand.remove()}function Zg(e,t,r,i,n,a,o,s){t=t||e._ctx;var u=Math.ceil(n);var l=1/Math.pow(2,u-n);var f=e._settings.tileBuffer;var h=e._tileSize*l;var d=u;r+=f*2*h;i+=f*2*h;if(e._settings.detectRetina){h/=Tr();d+=1;f*=2}var v=Vp(a,o,d);var c=v.x|0;var _=v.y|0;var g=r/2-(v.x-c)*h;var p=i/2-(v.y-_)*h;while(g>0){g-=h;c-=1}while(p>0){p-=h;_-=1}var y=true;g-=f*h;p-=f*h;var m=[];var b,x,A,w,S;for(b=g,x=c;b<r;b+=h,++x){for(A=p,w=_;A<i;A+=h,++w){m.push([x,w,b,A])}}e._tileBounds=[c-f,_-f,x+f,w+f];var E=c+(x-c)/2;var T=_+(w-_)/2;m.sort(function(e,t){return Fi(e[0],e[1],E,T)-Fi(t[0],t[1],E,T)});for(b=0,S=m.length;b<S;b++){var M=m[b];y&=rp(e,t,M[2],M[3],d,M[0],M[1],h,s)}clearTimeout(e._pruneTimer);e._pruneTimer=setTimeout(function(){return $g(e,d)},Fg);return y}function $g(e,t){var r={};var i=e._settings.tileBuffer;var n=e._tileBounds;var a,o,s,u,l,f;for(var h in e._tiles){var d=h.split("/");f=parseInt(d[0]);u=parseInt(d[1]);l=parseInt(d[2]);r[f]=r[f]||[];r[f].push([u,l])}var v=[];for(f in r){var c=parseInt(f);var _=Math.pow(2,c-t);var g=r[f];for(a=0,o=g.length;a<o;a++){s=g[a];u=s[0];l=s[1];if(u<n[0]*_-i||u>n[2]*_+i||l<n[1]*_-i||l>n[3]*_+i){v.push(lp(c,s[0],s[1]))}}}Kg(e,v);return v.length}function Kg(e,t){for(var r=0,i=t.length;r<i;r++){var n=t[r];var a=e._tiles[n];if(a){if(!a.err&&!a.loaded){Og--}if(a.img){up(a.img)}}delete e._tiles[n]}}function Jg(e){Kg(e,Object.keys(e._tiles));e._tiles={}}function Qg(e){var t=0;Object.keys(e._tiles).forEach(function(r){var i=e._tiles[r];if(i&&!i.loaded&&!i.err){t++}});return t===0}function ep(e,t,r){if(!e._enableMapBackground||!e._ctx){return}var i=e._ctx;var n=e._lat;var a=e._lng;var o=e._zoom;var s=Tr();var u=e._screen.width*s;var l=e._screen.height*s;i.fillStyle=r||e._settings.backgroundColor;i.fillRect(0,0,u,l);if(typeof t==="number"&&t!==e._opacity){e._opacity=t;e._rcanvas.style.opacity=t}if(!Zg(e,e._ctx,u,l,o,n,a,true)){clearTimeout(e._redrawTimer);e._redrawTimer=setTimeout(function(){return ep(e,t,r)},Bg)}else{e._events.fire("geoLoaded")}e._rctx.drawImage(e._canvas,0,0)}function tp(e){return e instanceof Image}function rp(e,t,r,i,n,a,o,s,u){var l=fp(e,n,a,o,true);if(tp(l)){t.drawImage(l,r,i,s,s);return true}else if(l===ip.LOADING){if(u){var f;l=fp(e,n-1,a/2|0,o/2|0,false);if(tp(l)){f=l.naturalWidth/2;var h=a&1?f:0;var d=o&1?f:0;t.drawImage(l,h,d,f,f,r,i,s,s)}else{var v=fp(e,n+1,a*2,o*2,false);var c=fp(e,n+1,a*2+1,o*2,false);var _=fp(e,n+1,a*2,o*2+1,false);var g=fp(e,n+1,a*2+1,o*2+1,false);if(tp(v)&&tp(c)&&tp(_)&&tp(g)){f=s/2;t.drawImage(v,r,i,f,f);t.drawImage(c,r+f,i,f,f);t.drawImage(_,r,i+f,f,f);t.drawImage(g,r+f,i+f,f,f)}}}return false}else{return true}}var ip={INVALID:1,LOADING:2,MISSING:3};function np(e,t){var r=e._sIndex;if(t.length>0){r=(r+1)%t.length;e._sIndex=r;return r}return 0}function ap(e,t,r,i){var n=e._settings.tileUrlSubdomains;var a=np(e,n);return e._settings.tileUrlTemplate.replace("{z}",i).replace("{x}",t).replace("{y}",r).replace("{s}",n.charAt(a))}function op(){if(this._tile){Og--;this._tile.err=true;up(this)}}function sp(){if(this._tile){Og--;this._tile.loaded=true;up(this)}}function up(e){e.onLoad=e.onError=null;e._tile=null}function lp(e,t,r){return e+"/"+t+"/"+r}function fp(e,t,r,i,n){var a=Math.pow(2,t)-1;if(t<0||r<0||r>a||i<0||i>a){return ip.INVALID}var o=lp(t,r,i);var s=e._tiles[o];if(!s){if(!n){return ip.MISSING}else{if(!e._camera.animationInProgress()&&Og<Vg){var u=new Image;s={img:u,err:false,loaded:false};u._tile=s;u.setAttribute("crossOrigin","anonymous");u.onError=op;u.onload=sp;u.src=ap(e,r,i,t);Og++}e._tiles[o]=s;return ip.LOADING}}else if(s.err){return ip.MISSING}else if(!s.loaded){return ip.LOADING}else{return s.img}}function hp(e){if(e._enabled){var t=e._camera;var r=Math.max(0,Math.log2(t.zoom));var i=Op(t.x,t.y);vp(e,i[0],i[1],r)}}function dp(e){var t=Bp(e._lat,e._lng);var r=Math.pow(2,e._zoom);e._camera.setView({x:t[0],y:t[1],zoom:r})}function vp(e,t,r,i){if(!e._enabled){return}e._lat=t;e._lng=r;e._zoom=i;ep(e)}function cp(e,t){e._rcanvas=document.createElement("canvas");e._rctx=e._rcanvas.getContext("2d");e._canvas=document.createElement("canvas");e._ctx=e._canvas.getContext("2d");e._rcanvas.style.position="absolute";e._rcanvas.style.zIndex=+(t.style.zIndex||0)-1;e._rcanvas.className="ogma-geo-container";e._init=true;Hg(e)}function _p(e,t){Tp(e,t,"x","geo.prevX");Tp(e,t,"y","geo.prevY");Tp(e,t,"radius","geo.prevSize");Tp(e,t,Ng,"geo.prevLat");Tp(e,t,Ig,"geo.prevLng")}function gp(e,t,r){return t.setAttributes({x:e._prevXList.getMultiple(t._indexes),y:e._prevYList.getMultiple(t._indexes),radius:e._prevRadiusList.getMultiple(t._indexes)},r)}function pp(e,t,r){return t.setAttributes({width:e._prevWidthList.getMultiple(t._indexes)},r)}function yp(e,t){Tp(e,t,"geo.prevLat",Ng);Tp(e,t,"geo.prevLng",Ig);xp(e,t)}function mp(e,t){var r=e._nodeVisibilityFilter;var i=e._graph.getAttributes(true,[Ng,Ig]);var n=i[0];var a=i[1];var o=new Array(2),s,u,l;var f=t._indexes;var h=n.getMultiple(f);var d=a.getMultiple(f);var v=f.length;var c=[];var _=[];var g=[];for(var p=0,y=v;p<y;++p){l=f[p];s=h[p],u=d[p];if(r.get(l)===0){Bp(s,u,o);_.push(o[0]);g.push(o[1]);c.push(l)}}return{X:_,Y:g,indexes:c}}function bp(e,t){var r=t.isNode;var i=e._graph.getAttributes(r,["geo.prevSize"]);var n=i[0];var a=r?e._nodeSizeRatio:e._edgeSizeRatio;if(e._settings.sizeZoomReferential){a=Math.pow(2,-e._settings.sizeZoomReferential)}var o=t._indexes;var s=r?e._nodeVisibilityFilter:e._edgeVisibilityFilter;var u=s.getMultiple(o);var l=n.getMultiple(o);for(var f=0,h=o.length;f<h;f++){if(u[f]===0){l[f]*=a}}return l}function xp(e,t,r){var i=mp(e,t);var n=i.X;var a=i.Y;return t.filter(function(t){return e._nodeVisibilityFilter.get(t._index)===0}).setAttributes({x:n,y:a},r).then(function(){return e._graph._refreshFilters()})}function Ap(e,t,r,i){if(r===void 0)r=mp(e,t);t=new e._graph.NodeList(r.indexes);return t.setAttributes({x:r.X,y:r.Y,radius:bp(e,t)},i)}function wp(e,t,r){return t.setAttribute("radius",bp(e,t),r)}function Sp(e,t,r){return t.setAttribute("width",bp(e,t),r)}function Ep(e,t){var r=e._graph.getAttributes(true,["x","y",Ng,Ig]);var i=r[0];var n=r[1];var a=r[2];var o=r[3];var s=new Array(2),u,l,f;var h=t._indexes;var d=[],v=[],c=[];for(var _=0,g=h.length;_<g;_++){f=h[_];u=a.get(f);l=o.get(f);if(l!==undefined&&u!==undefined){Op(i.get(f),n.get(f),s);c.push(f);d.push(s[0]);v.push(s[1])}}a.setMultiple(c,d);o.setMultiple(c,v)}function Tp(e,t,r,i){Cp(e,true,t,r,i)}function Mp(e,t,r,i){Cp(e,false,t,r,i)}function Cp(e,t,r,i,n){var a=e._graph;var o=a.getAttribute(t,i);var s=a.getAttribute(t,n);var u=r._indexes;s.setMultiple(u,o.getMultiple(u))}var kp=6378137;var Np=85.0511287798;var Ip=256;var zp=Math.PI/180;var Lp=180/Math.PI;var Rp=.5/(Math.PI*kp);var Dp=.5;var Fp=-Rp;var Pp=.5;function Bp(e,t,r){if(r===void 0)r=[];var i=Math.max(Math.min(Np,e),-Np);var n=Math.sin(i*zp);r[0]=Ip*(Rp*(kp*t*zp)+Dp);r[1]=Ip*(Fp*(kp*Math.log((1+n)/(1-n))/2)+Pp);return r}function Op(e,t,r){if(r===void 0)r=[];e=(e/Ip-Dp)/Rp;t=(t/Ip-Pp)/Fp;r[0]=(2*Math.atan(Math.exp(t/kp))-Math.PI/2)*Lp;r[1]=e*Lp/kp;return r}function Vp(e,t,r){var i=1<<r;e=e*zp;return{x:i*((t+180)/360),y:i*(1-Math.log(Math.tan(e)+1/Math.cos(e))/Math.PI)/2}}function jp(e,t){var r=e._settings.maxZoomLevel;if(typeof t!=="number"||!(t>=0&&t<=r)){throw new Error("invalid zoom value "+t+": expected value between 0 and "+r)}}function Up(e,t){if(typeof e!=="number"){throw new Error("invalid latitude "+e+": expected number")}if(typeof t!=="number"){throw new Error("invalid longitude "+t+": expected number")}}function Gp(e,t){return e>-Np&&e<Np&&t>=-180&&t<=180}function Xp(e){return Math.pow(2,Math.floor(Math.log2(e)))}var Wp={strokeColor:"black",strokeWidth:5,dashed:true,cursorStyle:"cell",createNodes:true,condition:function(){return true},onNodeCreated:function(){},onEdgeCreated:function(){},onComplete:function(){}};b.extend(function(e){var t=new Hp(e);e.modules.connectNodes=t;e.tools.connectNodes={enable:function e(r){t.enable(r);return this},disable:function e(){t.disable();return this},enabled:function e(){return t.enabled()}};e.events.onNodesConnected=function(t){e.modules.events.on("connectedNodes",t);return e.events}});var Hp=function e(t){var r=this;this._ogma=t;this._dom=t.modules.dom;this._camera=t.modules.camera;this._captor=t.modules.captor;this._graph=t.modules.graph;this._graphics=t.modules.graphics;this._interactions=t.modules.interactions;this._events=t.modules.events;this._settings=t.modules.settings;this._engine=this._graphics.getGraphicsEngine();this._block=this._engine.createBlock();this._depth=Th(0).edgeBody;this._enabled=false;this._options=null;this._blockId=null;this._startNode=null;this._startPos=null;this._endPos=null;this._cursorEnabled=false;this._events.register(["connectNodes"]);this._interaction=this._interactions.onDrag({priority:"connectNodes",check:function(e){var t=e.target;var i=e.button;if(i===void 0)i="left";return r._enabled&&i==="left"&&t&&t.isNode},onStart:function(e){var t=e.target;r._cursorEnabled=true;r._startNode=t;r._startPos=t.getPosition();r._graphics.addCursorStyle(r._options.cursorStyle);r._blockId=r._graphics.allocateGraphicsEngineBlockId()},onProgress:function(e){var t=e.x;var i=e.y;r._endPos=r._camera.screenToGraphCoordinates({x:t,y:i});r._drawLine()},onStop:function(){var e=r._options;var t=e.condition;var i=e.onNodeCreated;var n=e.onEdgeCreated;var a=e.onComplete;var o=r._captor.getPointedElement(),s=null,u=null;r._graphics.releaseGraphicsEngineBlockId(r._blockId);if(!o&&r._options.createNodes){o=r._ogma.addNode({attributes:{x:r._endPos.x,y:r._endPos.y}});u=o;if(i){i(u)}}if(o&&(u||!t||t(o))){s=r._ogma.addEdge({source:r._startNode,target:o});if(n){n(s)}}if(a){a({source:r._startNode,target:o,edge:s})}r.disable()}});this._events.on({clear:function(){return r.disable()}})};Hp.prototype._drawLine=function e(){this._block.reset(Ks,false,this._depth);var t=this._block.nextAndReset(),r=t.end,i=Li(this._startPos,this._endPos);r.x=i.x;r.y=i.y;r.lengthScaled=i.length;r.angle=i.angle;r.angleAffectedByView=true;r.fillColor=this._options.strokeColor;r.thicknessAbsolute=this._options.strokeWidth;r.thicknessScaled=0;r.shape="line";if(this._options.dashed){r.dashLength=3;r.gapLength=1}this._engine.storeBlock(this._blockId,this._block);this._dom.refresh()};Hp.prototype.enable=function e(t){if(this._enabled){return}this._options=ct(t,Wp);this._enabled=true;this._cursorEnabled=false;this._prevSettings=this._settings.update({"cursor.node":this._options.cursorStyle,"detect.edges":false});if(this._captor.isLeftPressed()){this._interaction.start(this._captor.getCursorInformation())}return this};Hp.prototype.disable=function e(){if(!this._enabled){return}this._enabled=false;this._settings.update(this._prevSettings);if(this._cursorEnabled){this._graphics.removeCursorStyle(this._options.cursorStyle)}};Hp.prototype.enabled=function e(){return this._enabled};var Yp=["color","shape","radius","icon.content","image.url"];var qp=["color","shape","width"];var Zp=Math.PI;var $p=2*Math.PI;var Kp=1.6;var Jp=3;var Qp=.9;var ey={position:"bottom",widgetWidth:130,fontFamily:"Arial",fontSize:10,fontColor:"black",titleFontSize:12,titleFontColor:"black",titleMaxLength:20,titleTextAlign:"left",shapeColor:"grey",backgroundColor:"white",borderColor:"black",borderRadius:0,borderWidth:1,innerMargin:10,outerMargin:5,circleStrokeWidth:3,titleFunction:function(e){return e[e.length-1]}};b.extend(function(e){var t=new ry(e);e.modules.legend=t;e.tools.legend={enable:function e(r){return t.enable(r)},disable:function e(){return t.disable()},enabled:function e(){return t.enabled()}}});var ty=["widgetWidth","fontSize","titleFontSize","borderRadius","borderWidth","innerMargin","outerMargin","circleStrokeWidth"];var ry=function e(t){var r=this;this._graphics=t.modules.graphics;this._dom=t.modules.dom;this._settings=dt(ey);this._enabled=false;this._canvas=Er();this._timeout=null;this._widgets=null;this._promises=[];this._refreshSync=function(){if(r._enabled){iy(r);ny(r,r._canvas);var e=r._promises;r._promises=[];e.forEach(function(e){return e()})}r._timeout=null};this._refresh=function(){return new Promise(function(e){if(!r._timeout){r._timeout=setTimeout(r._refreshSync,0)}r._promises.push(e)})};t.modules.events.on({"resize reloadFonts":this._refresh,resize:function(){if(r._enabled){ny(r,r._canvas)}}})};ry.prototype.enable=function e(t){this._enabled=true;this._userSettings=ct(t,ey);this._setSettings();this._graphics.addCanvas(this._canvas);return this._refresh()};ry.prototype._setSettings=function e(){var t=this;var r=Tr();this._settings={};Object.keys(ey).forEach(function(e){return t._settings[e]=t._userSettings[e]});ty.forEach(function(e){return t._settings[e]*=r})};ry.prototype.disable=function e(){if(this._enabled){if(this._timeout){clearTimeout(this._timeout);this._timeout=null}this._enabled=false;this._graphics.removeCanvas(this._canvas)}};ry.prototype.enabled=function e(){return this._enabled};ry.prototype.refresh=function e(){return this._refresh()};ry.prototype.drawOnCanvas=function e(t){iy(this);ny(this,t)};function iy(e){e._widgets=[];Yp.forEach(function(t){return Ty(e,true,t)});qp.forEach(function(t){return Ty(e,false,t)})}function ny(e,t){e._setSettings();var r={width:t.width,height:t.height},i=false,n=e._settings;if(!r.width||!r.height||!e._widgets){return false}t.getContext("2d").clearRect(0,0,t.width,t.height);if(n.position==="top"||n.position==="bottom"){i=Ey(r,n,e._widgets,n.position==="bottom")}else{i=Ay(r,n,e._widgets,n.position==="left")}if(i){e._widgets.forEach(function(e){return ay(n,t,e)})}return i}function ay(e,t,r){var i=t.getContext("2d");var n=r.x;var a=r.y;var o=r.height;var s=r.isNode;var u=r.styleProperty;var l=r.title;var f=r.mapping;var h=r.iconFont;ly(i,e,n,a,o);fy(i,e,l,n,a);var d=e.fontSize*Kp,v=e.fontSize/2*Kp*Qp,c=e.fontSize*Jp,_=e.fontSize,g=uy(e,s),p=a+Iy(e),y=n+e.innerMargin+g/2,m=n+e.innerMargin*2+g,b=vt(f),x=Ly(b),A=e.fontColor,w=e.shapeColor,S=mt(f);if(x){S.sort(function(e,t){return Fe(f[t])-Fe(f[e])})}if(u!=="radius"&&u!=="width"){S.forEach(function(t){var r=f[t];if(u==="color"){if(s){dy(i,y,p,v,t)}else{vy(i,y,p,c,_,t)}}else if(u==="shape"){if(s){py(i,y,p,v,t,w)}else{my(i,y,p,c,_,t,w)}}else if(u==="icon.content"){cy(i,y,p,t,h,v,A)}else if(u==="image.url"){_y(i,y,p,v,t)}hy(i,e,m,p,r,x);p+=d})}else if(x){var E=Ry(b),T=Dy(b),M=(E+T)/2;if(E%2===0||T%2===0){M=Math.round(M)}if(s){var C=e.fontSize*.7,k=C*3,N=(C+k)/2,I=n+e.innerMargin+k,z=I+k+e.innerMargin,L=p+k*2-e.innerMargin*.5,R=e.circleStrokeWidth;oy(i,I,L-C,C,w,R);oy(i,I,L-N,N,w,R);oy(i,I,L-k,k,w,R);sy(i,e.fontFamily,e.fontSize,e.fontColor,"left");i.fillText(Fy(E),z,L+C-C*2);i.fillText(Fy(M),z,L+C-N*2);i.fillText(Fy(T),z,L+C-k*2)}else{var D=(e.widgetWidth-2*e.innerMargin)/3,F=e.fontSize,P=p-e.innerMargin/2,B=P+F*2,O=n+e.innerMargin;i.fillStyle=w;i.fillRect(O,P-F/2,D+1,F);i.fillRect(O+D,P-F/3,D+1,F/1.5);i.fillRect(O+D*2,P-F/6,D,F/3);sy(i,e.fontFamily,e.fontSize,e.fontColor,"center");i.fillText(Fy(T),O+D*.5,B);i.fillText(Fy(M),O+D*1.5,B);i.fillText(Fy(E),O+D*2.5,B)}}}function oy(e,t,r,i,n,a){e.beginPath();e.arc(t,r,i,0,$p);e.strokeStyle=n;e.lineWidth=a;e.stroke()}function sy(e,t,r,i,n,a){if(n===void 0)n="left";if(a===void 0)a="middle";e.textAlign=n;e.textBaseline=a;e.fillStyle=i;e.font=r+'px "'+t+'"'}function uy(e,t){return t?e.fontSize:e.fontSize*Jp}function ly(e,t,r,i,n){by(e,r,i,t.widgetWidth,n,t.borderRadius,t.backgroundColor,t.borderColor,t.borderWidth)}function fy(e,t,r,i,n){sy(e,t.fontFamily,t.titleFontSize,t.titleFontColor,t.titleTextAlign);var a=t.titleTextAlign==="center",o=t.widgetWidth-t.innerMargin*2,s=e.measureText(r).width,u=i+(a?t.widgetWidth/2:t.innerMargin),l=n+t.titleFontSize/2+t.innerMargin;if(s>o){var f=o/s,h=(r.length*f|0)-2;r=r.substr(0,h)+""}e.fillText(r,u,l)}function hy(e,t,r,i,n,a){var o;if(a){if(n.length===1){o=Fy(n[0])}else{var s=Fe(n),u=De(n);o=Fy(s)+" - "+Fy(u)}}else{o=n.join()}sy(e,t.fontFamily,t.fontSize,t.fontColor);e.fillText(o,r,i)}function dy(e,t,r,i,n){e.beginPath();e.arc(t,r,i,0,2*Zp);e.fillStyle=n;e.fill()}function vy(e,t,r,i,n,a){e.fillStyle=a;e.fillRect(t-i/2,r-n/2,i,n)}function cy(e,t,r,i,n,a,o){sy(e,n,a*2,o,"center");e.fillText(i,t,r)}function _y(e,t,r,i,n){if(!e._imgStore){e._imgStore={}}var a=e._imgStore[n];if(!a){a=new Image;a.src=n;a.onload=function(){e.drawImage(a,t-i,r-i,i*2,i*2)};e._imgStore[n]=a}else{e.drawImage(a,t-i,r-i,i*2,i*2)}}var gy=.31;function py(e,t,r,i,n,a){e.fillStyle=a;if(n==="circle"){dy(e,t,r,i,a)}else if(n==="square"){e.fillRect(t-i,r-i,i*2,i*2)}else if(n==="cross"){e.fillRect(t-i,r-i*gy,i*2,i*2*gy);e.fillRect(t-i*gy,r-i,i*2*gy,i*2)}else if(n==="diamond"){e.beginPath();e.moveTo(t-i,r);e.lineTo(t,r-i);e.lineTo(t+i,r);e.lineTo(t,r+i);e.fill()}else if(n==="equilateral"){e.beginPath();e.moveTo(t,r-i);e.lineTo(t+Math.cos(Zp/2-$p/5)*i,r+Math.sin(-Zp/2+$p/5)*i);e.lineTo(t+Math.cos(Zp/2-$p/5*2)*i,r+Math.sin(-Zp/2+$p/5*2)*i);e.lineTo(t+Math.cos(Zp/2-$p/5*3)*i,r+Math.sin(-Zp/2+$p/5*3)*i);e.lineTo(t+Math.cos(Zp/2-$p/5*4)*i,r+Math.sin(-Zp/2+$p/5*4)*i);e.fill()}else if(n==="star"){e.beginPath();e.moveTo(t,r-i);e.lineTo(t+Math.cos(Zp/2-$p/5*2)*i,r+Math.sin(-Zp/2+$p/5*2)*i);e.lineTo(t+Math.cos(Zp/2-$p/5*4)*i,r+Math.sin(-Zp/2+$p/5*4)*i);e.lineTo(t+Math.cos(Zp/2-$p/5)*i,r+Math.sin(-Zp/2+$p/5)*i);e.lineTo(t+Math.cos(Zp/2-$p/5*3)*i,r+Math.sin(-Zp/2+$p/5*3)*i);e.fill()}}var yy=1/3;function my(e,t,r,i,n,a,o){e.fillStyle=o;if(a==="line"){e.fillRect(t-i/2,r-n/4,i,n/2)}else if(a==="arrow"){e.fillRect(t-i/2,r-n/4,i*(1-yy),n/2);e.beginPath();e.moveTo(t+i*(1-yy-.5),r-n/2);e.lineTo(t+i*(1-yy-.5),r+n/2);e.lineTo(t+i/2,r);e.fill()}else if(a==="dashed"||a==="dotted"){e.beginPath();e.moveTo(t-i/2,r);e.lineTo(t+i/2,r);e.strokeStyle=o;e.lineWidth=n/2;e.setLineDash(a==="dashed"?[8,3]:[3,3]);e.stroke()}else if(a==="tapered"){e.beginPath();e.moveTo(t-i/2,r-n/2);e.lineTo(t-i/2,r+n/2);e.lineTo(t+i/2,r);e.fill()}}function by(e,t,r,i,n,a,o,s,u){e.setLineDash([]);e.beginPath();e.moveTo(t+a,r);e.lineTo(t+i-a,r);e.quadraticCurveTo(t+i,r,t+i,r+a);e.lineTo(t+i,r+n-a);e.quadraticCurveTo(t+i,r+n,t+i-a,r+n);e.lineTo(t+a,r+n);e.quadraticCurveTo(t,r+n,t,r+n-a);e.lineTo(t,r+a);e.quadraticCurveTo(t,r,t+a,r);e.closePath();e.fillStyle=o;e.fill();e.strokeStyle=s;e.lineWidth=u;e.stroke()}function xy(e,t){if(e.isNode!==t.isNode){return e.isNode?e:t}else{return e.title<=t.title?-1:1}}function Ay(e,t,r,i){var n=t.widgetWidth+t.outerMargin,a=Math.floor((e.width-t.outerMargin)/n),o=e.height,s=t.outerMargin,u=i?t.outerMargin:e.width-n,l=1;r=r.slice().sort(xy);for(var f=0;f<r.length;++f){var h=r[f];if(s+h.height>o){if(s===t.outerMargin){return false}else{s=t.outerMargin;l+=1;if(i){u+=n}else{u-=n}}}h.x=u;h.y=s;s+=h.height}return l<=a}function wy(e,t,r){var i=null;for(var n=0;n<t.length;++n){var a=t[n];if((a.isNode===e.isNode||t.length===1)&&(i===null||a.height<t[i].height)){i=n}}a=t[i];a.content.push(e);a.height+=e.height+r.outerMargin}function Sy(e){var t=0;for(var r=1;r<e.length;++r){if(e[r].height>e[t].height){t=r}}return t}function Ey(e,t,r,i){r=r.slice();var n=t.widgetWidth+t.outerMargin,a=Math.floor((e.width-t.outerMargin)/n),o=e.height-t.outerMargin,s=new Array(Math.min(a,r.length)),u=r.length,l=0,f=0,h=0,d=0;for(var v=0;v<u;++v){var c=r[v];if(c.isNode){l+=1;f+=c.height}else{h+=1;d+=c.height}}var _=f+d,g=f/_,p=d/_,y=Math.round(g*a),m=Math.round(p*a);if(y>l){y=l}else if(m>h){y=a-h}if(a===0){return false}for(var b=0;b<s.length;++b){s[b]={content:[],height:0,isNode:b<y}}for(b=0;b<u;++b){var x=Sy(r);wy(r[x],s,t);r.splice(x,1)}if(s.every(function(e){var t=e.content;return t.length===1})){s.sort(Ny)}else{s.sort(ky)}var A=t.outerMargin;for(b=0;b<s.length;++b){var w=s[b];if(w.height>o){return false}w.content.sort(Cy);var S=0;for(var E=0;E<w.content.length;++E){var T=w.content[E];T.x=A;T.y=i?e.height-S-T.height-t.outerMargin:S+t.outerMargin;S+=T.height+t.outerMargin}A+=n}return true}function Ty(e,t,r){var i=My(e,t,r);if(i){if(r==="icon.content"){var n=e._graphics.getRuleListForAttribute(t,"icon.font"),a=null;if(!n.length){a="Arial"}else{var o=n[0].metaData;if(o){a=o.constant}}if(a){i.iconFont=a;e._widgets.push(i)}}else{e._widgets.push(i)}}}function My(e,t,r){var i=e._graphics.getRuleListForAttribute(t,r),n=i[0]&&i[0].metaData;if(n&&n.mapping&&n.field){var a={};ut(n.mapping,function(e,t){if(e===undefined||t==="undefined"){return}if(e in a){a[e].push(t)}else{a[e]=[t]}});if(Object.keys(a).length===0){return null}return{isNode:t,title:e._settings.titleFunction(n.field),styleProperty:r,dataProperty:n.field,mapping:a,height:zy(e,a,r,t)}}else{return null}}function Cy(e,t){return e.height-t.height}function ky(e,t){if(e.isNode!==t.isNode){return e.isNode?e:t}else{return t.height-e.height}}function Ny(e,t){if(e.isNode!==t.isNode){return e.isNode?e:t}else{return e.content[0].title<=t.content[0].title?-1:1}}function Iy(e){return e.innerMargin+(e.titleFontSize+e.fontSize)*Kp}function zy(e,t,r,i){var n=e._settings,a=n.outerMargin+Iy(n),o=n.fontSize*Kp,s=a-n.innerMargin*.8;if(r!=="radius"&&r!=="width"){s+=Object.keys(t).length*o}else{s+=o*(i?3:2)}return s}function Ly(e){if(bt(e)){return e.reduce(function(e,t){return e&&Ly(t)},true)}else{return e==="undefined"||!isNaN(+e)}}function Ry(e){if(bt(e)){return e.reduce(function(e,t){return Math.min(e,Ry(t))},Infinity)}else{return isNaN(e)?Infinity:+e}}function Dy(e){if(bt(e)){return e.reduce(function(e,t){return Math.max(e,Dy(t))},-Infinity)}else{return isNaN(e)?-Infinity:+e}}function Fy(e,t){e=+e;var r=["K","M","B","T","P","E","Z","Y"];if(e>9999){var i=0;while(i<r.length&&e>999){e/=1e3;++i}return Py(e)+r[i-1]}else if(t){return Math.round(e).toString()}else if(e<10){return(Math.round(e*1e3)/1e3).toString()}else if(e<100){return(Math.round(e*100)/100).toString()}else if(e<1e3){return(Math.round(e*10)/10).toString()}else{return Math.round(e).toString()}}function Py(e){if(e<10){return Math.round(e*100)/100}else if(e<100){return Math.round(e*10)/10}else if(e<1e3){return Math.round(e)}}var By={strokeColor:"#00C3FF",fillColor:"rgba(0,195,255,0.1)",strokeWidth:1,cursorStyle:"cell",callback:function(e){var t=e.nodes;return t.setSelected(true)}};b.extend(function(e){var t=new Oy(e);e.modules.lasso=t;e.tools.lasso={enable:function(e){return t.enable(e)},disable:function(){return t.disable()},enabled:function(){return t.enabled()}}});var Oy=function e(t){var r=this;this._ogma=t;this._graphics=t.modules.graphics;this._graph=t.modules.graph;this._selection=t.modules.selection;this._captor=t.modules.captor;this._render=t.modules.render;this._interactions=t.modules.interactions;this._options=dt(By);this._enabled=false;this._points=[];this._canvas=Er();this._ctx=this._canvas.getContext("2d");this._interaction=this._interactions.onDrag({priority:"lasso",check:function(){return r._enabled},onStart:function(e){var t=e.x;var i=e.y;jy(r,t,i,false)},onProgress:function(e){var t=e.x;var i=e.y;return jy(r,t,i,true)},onStop:function(){var e=r._ogma.getNodes().filter(function(e){return Vy(e.getPositionOnScreen(),r._points)});r._ctx.clearRect(0,0,r._canvas.width,r._canvas.height);r._points=[];r.disable();r._options.callback({nodes:e})}})};Oy.prototype.enable=function e(t){if(this._enabled){return}this._enabled=true;this._prevDetect=this._captor.setDetectionEnabled(false);this._options=ct(t,By);this._graphics.addCanvas(this._canvas);Ur(this._canvas,this._options.cursorStyle);if(this._captor.isLeftPressed()){this._interaction.start(this._captor.getCursorPosition())}};Oy.prototype.disable=function e(){if(!this._enabled){return}this._enabled=false;this._captor.setDetectionEnabled(this._prevDetect);this._graphics.removeCanvas(this._canvas)};Oy.prototype.enabled=function e(){return this._enabled};function Vy(e,t){return aa(e.x,e.y,t)}function jy(e,t,r,i){var n=Tr();var a=e._ctx;var o=e._options;var s=e._points;a.clearRect(0,0,e._canvas.width,e._canvas.height);s.push({x:t,y:r});if(i){var u=s[0];a.lineWidth=o.strokeWidth;a.lineJoin="bevel";a.strokeStyle=o.strokeColor;a.fillStyle=o.fillColor;a.beginPath();a.moveTo(u.x*n,u.y*n);for(var l=1;l<s.length;++l){var f=s[l];a.lineTo(f.x*n,f.y*n)}a.stroke();if(o.fillColor){a.fill()}}}var Uy={strokeColor:"#00C3FF",fillColor:"rgba(0,195,255,0.1)",strokeWidth:1,cursorStyle:"cell",callback:function(e){var t=e.nodes;var r=e.edges;t.setSelected(true);r.setSelected(true)}};b.extend(function(e){var t=new Gy(e);e.modules.rectangleSelect=t;e.tools.rectangleSelect={enable:function(e){return t.enable(e)},disable:function(){return t.disable()},enabled:function(){return t.enabled()}}});var Gy=function e(t){var r=this;this._ogma=t;this._graph=t.modules.graph;this._selection=t.modules.selection;this._camera=t.modules.camera;this._dom=t.modules.dom;this._graphics=t.modules.graphics;this._interactions=t.modules.interactions;this._keyboard=t.modules.keyboard;this._spatial=t.modules.spatial;this._captor=t.modules.captor;this._options=dt(Uy);this._canvas=Er();this._ctx=this._canvas.getContext("2d");this._enabled=false;this._start=null;this._interaction=this._interactions.onDrag({priority:"lasso",disableDetection:true,check:function(){return r._enabled},onStart:function(e){var t=e.x;var i=e.y;r._start={x:t,y:i};r._ctx.fillStyle=r._options.fillColor;r._ctx.strokeStyle=r._options.strokeColor;r._ctx.lineWidth=r._options.strokeWidth},onProgress:function(e){var t=e.x;var i=e.y;return Zy(r,{x:t,y:i})},onStop:function(){var e=r._captor.getCursorPosition(),i=qy(r,e),n=r._ogma.getNodes().filter(function(e){return Xy(e.getPositionOnScreen(),i)}),a=n.size?new t.EdgeList:t.getEdges().filter(function(e){return Hy(r,e,i)});Yy(r);r.disable();r._options.callback({nodes:n,edges:a})}})};Gy.prototype.enable=function e(t){if(this._enabled){return}this._enabled=true;this._options=ct(t,Uy);this._graphics.addCanvas(this._canvas);Ur(this._canvas,this._options.cursorStyle);if(this._captor.isLeftPressed()){this._interaction.start(this._captor.getCursorPosition())}};Gy.prototype.disable=function e(){if(!this._enabled){return}this._enabled=false;this._graphics.removeCanvas(this._canvas)};Gy.prototype.enabled=function e(){return this._enabled};function Xy(e,t){return e.x>=t.x1&&e.x<=t.x2&&e.y>=t.y1&&e.y<=t.y2}function Wy(e,t,r){var i=e.x<r.x1,n=e.x>r.x2,a=e.y<r.y1,o=e.y>r.y2,s=t.x<r.x1,u=t.x>r.x2,l=t.y<r.y1,f=t.y>r.y2;if(i&&s||n&&u||o&&f||a&&l){return false}if(!i&&!n&&!a&&!o||!s&&!u&&!l&&!f){return true}return Ai(e,t,{x:r.x1,y:r.y1},{x:r.x1,y:r.y2})||Ai(e,t,{x:r.x2,y:r.y2},{x:r.x1,y:r.y2})||Ai(e,t,{x:r.x1,y:r.y1},{x:r.x2,y:r.y1})||Ai(e,t,{x:r.x2,y:r.y2},{x:r.x2,y:r.y1})}function Hy(e,t,r){var i=e._spatial.getPointsForEdge(t,true);for(var n=0;n<i.length-1;++n){if(Wy(i[n],i[n+1],r)){return true}}return false}function Yy(e){e._ctx.clearRect(0,0,e._canvas.width,e._canvas.height)}function qy(e,t){var r=e._start.x,i=e._start.y,n=t.x,a=t.y,o=Math.abs(r-n),s=Math.abs(i-a),u=r<n?r:n,l=i<a?i:a;return{x1:u,y1:l,x2:u+o,y2:l+s,p1:{x:u,y:l},p2:{x:u+o,y:l+s},width:o,height:s}}function Zy(e,t){var r=qy(e,t);var i=r.x1;var n=r.y1;var a=r.width;var o=r.height;var s=Tr();Yy(e);e._ctx.strokeRect(i*s,n*s,a*s,o*s);if(e._options.fillColor){e._ctx.fillRect(i*s,n*s,a*s,o*s)}}var $y={cursor:"nesw-resize",color:"#00C3FF",lineWidth:1,handleSize:6,detectionMargin:5,snappingRatio:1.25,nbNodesToSnapTo:5,previewColor:"rgba(0, 0, 0, 0.2)",sizeIndicatorColor:"black",sizeIndicatorOffset:5,sizeIndicatorWidth:3,sizeIndicatorThickness:1};b.extend(function(e){var t=new Ky(e);e.modules.resizing=t;e.tools.resize={enable:function e(r){return t.enable(r)},disable:function e(){return t.disable()},enabled:function e(){return t.enabled()}}});var Ky=function e(t){var r=this;this._dom=t.modules.dom;this._interactions=t.modules.interactions;this._events=t.modules.events;this._camera=t.modules.camera;this._dom=t.modules.dom;this._spatial=t.modules.spatial;this._graphics=t.modules.graphics;this._engine=this._graphics.getGraphicsEngine();this._canvas=Er();this._init();this._interactions.onDrag({priority:"resizing",disableDetection:true,check:function(){return r._enabled&&r._pointedNode},onStart:function(e){var t=e.x;var i=e.y;r._x=t;r._y=i;r._nodeBeingResized=r._pointedNode},onProgress:function(e){var t=e.x;var i=e.y;r._x=t;r._y=i;r._displayHandles()},onStop:function(){r._nodesToHighlight.forEach(function(e,t){var i=r._additionalRadiuses[t]/r._camera.zoom;e.setAttributes({radius:e.getAttribute("radius")+i,x:e.getPosition().x+i,y:e.getPosition().y-i})});r._pointedNode=null;r._nodeBeingResized=null;r._displayHandles()}});this._onSelectionChange=function(){if(!r._enabled){return}r._nodesToHighlight=t.getSelectedNodes();r._displayHandles()};this._events.on({"cameraMove progressMoveNodesByDragging":function(){return r._displayHandles()},"move down":function(e){var t=e.x;var i=e.y;return r._detectBoundingBoxes(t,i)}});t.events.onNodesSelected(this._onSelectionChange);t.events.onNodesUnselected(this._onSelectionChange)};Ky.prototype._init=function e(){this._enabled=false;this._nodesToHighlight=null;this._options=null;this._nodeBeingResized=null;this._pointedNode=null;this._cursorEnabled=false;this._x=0;this._y=0;this._additionalRadiuses=[]};Ky.prototype._enableCursor=function e(){if(!this._cursorEnabled){this._graphics.addCursorStyle(this._options.cursor);this._cursorEnabled=true}};Ky.prototype._disableCursor=function e(){if(this._cursorEnabled){this._graphics.removeCursorStyle(this._options.cursor);this._cursorEnabled=false}};Ky.prototype._detectBoundingBoxes=function e(t,r){var i=this;if(!this._enabled||this._nodeBeingResized||!this._nodesToHighlight){return}var n=this._options.handleSize,a=this._options.detectionMargin;this._pointedNode=null;this._forEachNodeToHighlight(function(e,o,s){var u=o.x+s-n/2-a,l=o.x+s+n/2+a,f=o.y-s-n/2-a,h=o.y-s+n/2+a;if(t>=u&&t<=l&&r>=f&&r<=h){i._pointedNode=e}});if(this._pointedNode){this._enableCursor()}else{this._disableCursor()}};Ky.prototype._forEachNodeToHighlight=function e(t){var r=this;this._nodesToHighlight.forEach(function(e){var i=e.getPositionOnScreen(),n=r._getTotalOnScreenRadius(e);t(e,i,n)})};Ky.prototype._displayHandles=function e(){var t=this;if(!this._enabled||!this._nodesToHighlight){return}var r=this._canvas,i=r.getContext("2d"),n=r.width,a=r.height,o=Tr();var s=this._options;var u=s.color;var l=s.lineWidth;var f=s.handleSize;var h=0;i.clearRect(0,0,n,a);if(this._nodeBeingResized){var d=this._getTotalOnScreenRadius(this._nodeBeingResized),v=this._nodeBeingResized.getPositionOnScreen();h=Math.max(this._x-(v.x+d),-(this._y-(v.y-d)))/2}this._additionalRadiuses=[];this._forEachNodeToHighlight(function(e,r,n){var a=0;if(t._nodeBeingResized){a=h;var s=-n+e.getAttribute("innerStroke.width")+e.getAttribute("outerStroke.width")+l/2+1;if(a<s){a=s}else{a=t._snap(e,a)}t._additionalRadiuses.push(a);var d=e.getAttribute("shape"),v=t._engine.getShapePoints(d),c=r.x+a,_=r.y-a,g=n+a;t._displayNodePreview(i,o,c,_,g,v)}i.strokeStyle=u;i.fillStyle=u;i.lineWidth=l;i.strokeRect((r.x-n)*o,(r.y-n-a*2)*o,(a+n)*2*o,(a+n)*2*o);i.fillRect((r.x+n+a*2-f/2)*o,(r.y-n-a*2-f/2)*o,f*o,f*o)})};Ky.prototype._displayNodePreview=function e(t,r,i,n,a,o){i*=r;n*=r;a*=r;t.beginPath();if(o.length===1){t.arc(i,n,a,0,Math.PI*2)}else{for(var s=0;s<o.length;++s){var u=o[s],l=i+u.x*a,f=n+u.y*a;if(s===0){t.moveTo(l,f)}else{t.lineTo(l,f)}}}t.fillStyle=this._options.previewColor;t.fill()};Ky.prototype._getTotalOnScreenRadius=function e(t){return t.getAttribute("radius")*this._camera.zoom+t.getAttribute("innerStroke.width")+t.getAttribute("outerStroke.width")+this._options.lineWidth/2};Ky.prototype._snap=function e(t,r){var i=this;var n=this._spatial.getNodesInScreenByDistance(t).filter(function(e){return!e.isSelected()}).slice(0,this._options.nbNodesToSnapTo),a=this._canvas.getContext("2d"),o=this._getTotalOnScreenRadius(t),s=o+r,u=this._options.snappingRatio,l=s/o,f=Math.round(Jy(l,u)),h=Math.pow(u,f),d=o*h,v=null;n.forEach(function(e){var t=i._getTotalOnScreenRadius(e);if(Math.abs(t-s)<=Math.abs(d-s)){d=t;v=e}});if(v){a.save();a.strokeStyle=this._options.sizeIndicatorColor;a.lineWidth=this._options.sizeIndicatorThickness;var c=v.getAttribute("radius");this._displaySizeIndicator(t,d);n.filter(function(e){return e.getAttribute("radius")===c}).forEach(function(e){return i._displaySizeIndicator(e)});a.restore()}return d-o};Ky.prototype._displaySizeIndicator=function e(t,r){var i=this._canvas.getContext("2d"),n=Tr(),a=t.getPositionOnScreen(),o=this._getTotalOnScreenRadius(t),s=r||o,u=r?r-o:0,l=u-this._options.sizeIndicatorOffset-(r?t.getAttribute("innerStroke.width")+t.getAttribute("outerStroke.width"):0),f=a.x-s+l|0,h=a.y-s-u|0,d=a.y+s-u|0,v=this._options.sizeIndicatorWidth;i.beginPath();i.moveTo((f-v)*n,h*n);i.lineTo((f+v)*n,h*n);i.moveTo(f*n,h*n);i.lineTo(f*n,d*n);i.moveTo((f-v)*n,d*n);i.lineTo((f+v)*n,d*n);i.stroke()};Ky.prototype.enable=function e(t){if(this._enabled){return}this._options=ct(t,$y);this._graphics.addCanvas(this._canvas);this._enabled=true};Ky.prototype.disable=function e(){if(!this._enabled){return}this._graphics.removeCanvas(this._canvas);this._disableCursor();this._init()};Ky.prototype.enabled=function e(){return this._enabled};function Jy(e,t){return Math.log(e)/Math.log(t)}b.extend(function(e){var t=new em(e);e.modules.rewiring=t;e.tools.rewire={enable:function e(r){return t.enable(r)},disable:function e(){return t.disable()},enabled:function e(){return t.enabled()}}});var Qy={color:"#00C3FF",radius:7,cursorOnHover:"grab",cursorOnDrag:"grabbing"};var em=function e(t){var r=this;this._ogma=t;this._dom=t.modules.dom;this._captor=t.modules.captor;this._mouse=t.modules.mouse;this._graph=t.modules.graph;this._camera=t.modules.camera;this._graphics=t.modules.graphics;this._selection=t.modules.selection;this._events=t.modules.events;this._settings=t.modules.settings;this._interactions=t.modules.interactions;this._classes=t.modules.classes;this._classes.create("__rewirable",{after:"hoverExtremityHighlighted"});this._enabled=false;this._filter=this._graph._addFilter(false);this._canvas=Er();this._ctx=this._canvas.getContext("2d");this._nodesToHighlight=null;this._movedEdges=null;this._startNode=null;this._cursorOnHoverEnabled=false;this._prevSettings=null;this._x=0;this._y=0;this._curvatureList=this._graph.getEdgeAttribute("curvature");this._interaction=this._interactions.onDrag({priority:"rewiring",check:function(e){var t=e.x;var i=e.y;var n=e.target;if(!r._enabled||!n||!n.isNode||!sm(r,n,t,i)){return false}var a=n.getAdjacentEdges().filter(function(e){return e.isSelected()});if(a.size){r._movedEdges=a;r._edgeColors=r._movedEdges.getAttribute("color");r._startNode=n;return true}else{return false}},onStart:function(){r._nodesToHighlight=r._nodesToHighlight.filter(function(e){return e!==r._startNode});om(r,true);var e=r._options.cursorOnDrag;r._prevSettings=r._settings.update({edgeHover:false,cursor:{default:e,node:e,edge:e}})},onProgress:function(e){var t=e.x;var i=e.y;r._x=t;r._y=i},onStop:function(){tm(r);var e=am(r);if(e){r._movedEdges.forEach(function(t){if(t.getTarget()===r._startNode){t.setTarget(e)}else{t.setSource(e)}})}om(r,false);r._movedEdges.setSelected(true);r._movedEdges=null;r._refreshHandles(r)}});this._refreshHandles=function(){if(!r._enabled||r._movedEdges){return}var e=r._ogma.getSelectedEdges();r._nodesToHighlight=e.getExtremities().dedupe();r._classes.clearEdges("__rewirable");e.addClass("__rewirable");lm(r)};this._refreshCanvas=function(){return lm(r)};this._events.on({cameraMove:this._refreshCanvas,mouseMove:this._refreshCanvas,progressMoveNodesByDragging:this._refreshCanvas});t.events.onEdgesSelected(this._refreshHandles);t.events.onEdgesUnselected(this._refreshHandles)};em.prototype.enable=function e(t){if(this._enabled){return}this._options=ct(t,Qy);this._enabled=true;this._graphics.addCanvas(this._canvas);this._refreshHandles()};em.prototype.disable=function e(){if(!this._enabled){return}this._interaction.stop();this._graphics.removeCursorStyle(this._options.cursorOnDrag);rm(this);tm(this);this._graphics.removeCanvas(this._canvas);this._classes.clearEdges("__rewirable");this._enabled=false};em.prototype.enabled=function e(){return this._enabled};function tm(e){if(e._prevSettings){e._settings.update(e._prevSettings);e._prevSettings=null}}function rm(e){if(e._cursorOnHoverEnabled){e._cursorOnHoverEnabled=false;e._graphics.removeCursorStyle(e._options.cursorOnHover)}}function im(e){if(!e._cursorOnHoverEnabled){e._cursorOnHoverEnabled=true;e._graphics.addCursorStyle(e._options.cursorOnHover)}}function nm(e){if(!e._movedEdges){return}var t=e._x,r=e._y,i=e._ctx,n=Tr(),a={x:t,y:r},o=e._camera.getZoom(),s=e._movedEdges;s.forEach(function(t,r){var s=e._edgeColors[r],u=t.getSource(),l=t.getTarget(),f=am(e),h=l===e._startNode?u:l,d=t.getAttribute("width")*o,v=h.getPositionOnScreen(),c=f?f.getPositionOnScreen():a;h.addClass("selectionExtremityHighlighted");i.beginPath();i.moveTo(v.x*n,v.y*n);i.lineTo(c.x*n,c.y*n);i.strokeStyle=s;i.lineWidth=d*n;i.stroke()})}function am(e){var t=e._captor.getPointedElement();return t&&t.isNode?t:null}function om(e,value){var t=e._movedEdges._indexes;for(var r=0;r<t.length;++r){e._filter.set(t[r],value)}e._graph._refreshFilters(false,t)}function sm(e,t,r,i){var n=e._camera.graphToScreenCoordinates(t.getPosition());return t.getAttribute("radius")*e._camera.zoom>e._options.radius&&distance(n.x,n.y,r,i)<e._options.radius}function um(e){e._canvas.getContext("2d").clearRect(0,0,e._canvas.width,e._canvas.height)}function lm(e){if(!e._enabled||!e._nodesToHighlight){return}var t={x:e._mouse.x,y:e._mouse.y},r=am(e),i=e._camera.zoom,n=e._canvas.getContext("2d"),a=Tr(),o=e._nodesToHighlight;var s=e._options;var u=s.color;var l=s.radius;var f=o.getPosition().map(function(t){return e._camera.graphToScreenCoordinates(t)});um(e);nm(e);n.fillStyle=u;n.strokeStyle=u;var h=false;f.forEach(function(e,r){var s=e.x;var u=e.y;if(o.get(r).getAttribute("radius")*i>l){n.fillRect((s-l)*a,(u-l)*a,l*a*2,l*a*2);if(distance(s,u,t.x,t.y)<l){h=true}}});if(e._movedEdges){var d=t;if(r){d=e._camera.graphToScreenCoordinates(r.getPosition())}n.fillRect((d.x-l)*a,(d.y-l)*a,l*a*2,l*a*2)}if(h){im(e)}else{rm(e)}}var fm={tolerance:5,centerSnapDistance:240,sideSnapDistanceFactor:3,guidelineWidth:1,guidelineColor:"#ff0000",preferredDistance:{enabled:true,ratio:1.13,tolerance:10,lineColor:"#00C3FF",lineWidth:1},neighbours:{enabled:true,offset:5,tolerance:3,lineColor:"#00C3FF",lineWidth:1}};var hm={NONE:0,CENTER:1,LEFT:2,RIGHT:3,TOP:4,BOTTOM:5};var dm=function e(t){this._graph=t.modules.graph;this._graphics=t.modules.graphics;this._spatial=t.modules.spatial;this._settings=t.modules.settings;this._events=t.modules.events;this._camera=t.modules.camera;this._options=dt(fm);this._enabled=false;this._canvas=Er();this._ctx=this._canvas.getContext("2d");this._ysnap=hm.NONE;this._xsnap=hm.NONE;this._node=null;this._r=0;this._viewport=null;this._horizontalGuideLine=null;this._verticalGuideLine=null;this._vguideline={start:{x:0,y:0},end:{x:0,y:0}};this._hguideline={start:{x:0,y:0},end:{x:0,y:0}};this._distanceGuidelines=[-1,-1];this._neighbourGuidelines=[]};dm.prototype.enable=function e(t){var r=this;if(this._enabled){return}var i=this._events;this._options=ct(t,fm);this._enabled=true;this._graphics.addCanvas(this._canvas);this._dragStartListener=i.on("startMoveNodesByDragging",function(e){return r._onNodeDragStart(e)});this._dragEndListener=i.on("endMoveNodesByDragging",function(e){return r._onNodeDragEnd(e)});this._settings.update({"interactions.drag.onBeforeDrag":function(e,t,i){return r._onBeforeDrag(e,t,i)}})};dm.prototype.disable=function e(){if(!this._enabled){return}var t=this._events;t.removeListener(this._dragStartListener);t.removeListener(this._dragEndListener);this._graphics.removeCanvas(this._canvas);this._settings.update({"interactions.drag.onBeforeDrag":null});this._enabled=false};dm.prototype.enabled=function e(){return this._enabled};dm.prototype._onNodeDragStart=function e(t){var r=t.nodes;if(r.size===1){this._node=r.get(0);this._cacheViewport();this._r=this._node.getAttribute("radius")}};dm.prototype._onBeforeDrag=function e(t,r,i){if(this._node){var n=i[0];this._scan(n);this._node.setAttributes(n)}};dm.prototype._onNodeDragEnd=function e(){this._node=null;this._clearCanvas()};dm.prototype._cacheViewport=function e(){var t=this._camera;var r=t.screenToGraphCoordinates({x:0,y:0});var i=t.screenToGraphCoordinates({x:t.width,y:t.height});this._viewport={xmin:r.x,ymin:r.y,xmax:i.x,ymax:i.y};this._nodes=this._spatial.getNodesByBoundingBox(r.x,r.y,i.x,i.y);var n=this._node._index;var a=this._nodes._indexes.slice();a.splice(a.indexOf(n),1);var o=this._graphics._getAttributeArray(true,"radius");var s=this._graph.getAttribute(true,"x")._buffer;var u=this._graph.getAttribute(true,"y")._buffer;var l=Un(a.slice(),s);var f=Un(a.slice(),u);var h={},d={};var v={},c={};var _=this._gridResolution=this._node.getAttribute("radius");for(var g=0,p=a.length;g<p;g++){var y=l[g],m=f[g];var b=s[y]/_|0,x=u[m]/_|0;if(!h[b]){h[b]=[]}if(!d[x]){d[x]=[]}h[b].push(y);d[x].push(m);v[y]=c[m]=g}this._nodesByX=l;this._nodesByY=f;this._nodesByXIndex=v;this._nodesByYIndex=c;this._xGrid=h;this._yGrid=d;this._X=s;this._Y=u;this._R=o};dm.prototype._clearCanvas=function e(){this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height)};dm.prototype._drawLine=function e(t,r,i,n){var a=this._ctx,o=Tr(),s=this._camera.graphToScreenCoordinates(t),u=this._camera.graphToScreenCoordinates(r);a.beginPath();a.moveTo(s.x*o,s.y*o);a.lineTo(u.x*o,u.y*o);a.strokeStyle=n;a.lineWidth=i;a.stroke()};dm.prototype._scan=function e(t){this._clearCanvas();var r=this._node._index;var i=t.x,n=t.y,a=this._r;var o=this._options;var s=this._R;var u=this._X;var l=this._Y;var f=this._camera.zoom;var h=Math.min(a,this._options.tolerance/f);var d=a*2*o.sideSnapDistanceFactor;var v=o.guidelineWidth;var c=o.guidelineColor;var _,g;var p=r;var y=r;var m,b,x,A,w,S,E;var T=false,M=false;p=vm(this._nodesByX,u,i);y=vm(this._nodesByY,l,n);if(Math.abs(u[p]-i)>o.centerSnapDistance){p=r}if(Math.abs(l[y]-n)>o.centerSnapDistance){y=r}this._xsnap=hm.NONE;if(p!==r){_=this._vguideline.start;g=this._vguideline.end;E=p;m=u[E];b=l[E];x=s.get(E);S=Math.abs(i-m);var C=Math.abs(i-a-(m-x));var k=Math.abs(i+a-(m+x));if(S<Math.max(a,x)){if(b<n){_.y=b-x;g.y=n+a}else{_.y=b+x;g.y=n-a}var N=Math.min(C,S,k);if(N===S){_.x=g.x=m;g.y=n;_.y=b;this._xsnap=hm.CENTER}else if(Math.abs(n-b)<x+a+d){if(N===C){_.x=g.x=m-x;this._xsnap=hm.LEFT}else{_.x=g.x=m+x;this._xsnap=hm.RIGHT}}if(N<h){T=true}}if(this._xsnap!==hm.NONE){this._drawLine(_,g,v,c)}}this._ysnap=hm.NONE;if(y!==r){_=this._hguideline.start;g=this._hguideline.end;E=y;m=u[E];b=l[E];x=s.get(E);S=Math.abs(n-b);var I=Math.abs(n-a-(b-x));var z=Math.abs(n+a-(b+x));if(S<Math.max(a,x)){if(m<i){_.x=m-x;g.x=i+a}else{_.x=m+x;g.x=i-a}var L=Math.min(I,S,z);if(L===S){_.y=g.y=b;g.x=i;_.x=m;this._ysnap=hm.CENTER}else if(Math.abs(i-m)<x+a+d){if(L===I){_.y=g.y=b-x;this._ysnap=hm.TOP}else{_.y=g.y=b+x;this._ysnap=hm.BOTTOM}}if(L<h){M=true}}if(this._ysnap!==hm.NONE){this._drawLine(_,g,v,c)}}if(o.preferredDistance.enabled){var R=o.preferredDistance.ratio;var D=Math.min(o.preferredDistance.tolerance/f,a);var F=Math.max(a,x);if(p!==r&&(this._xsnap===hm.NONE||!T)){E=p;m=u[E];b=l[E];x=s.get(E);A=Math.abs(i-m)-(a+x)*(1+R);if(A<=D&&A>=-D){var P=i<m?-1:1;_=this._vguideline.start;g=this._vguideline.end;_.x=g.x=m+P*(1+R)*(a+x);_.y=b-F;g.y=b+F;_.x=g.x=m;this._drawLine(_,g,v,c);_.y=n-F;g.y=n+F;_.x=g.x=m+P*(1+R)*(a+x);this._drawLine(_,g,v,c);this._xsnap=hm.CENTER;T=true}}else if(y!==r&&(this._ysnap===hm.NONE||!M)){E=y;m=u[E];b=l[E];x=s.get(E);w=Math.abs(n-b)-(a+x)*(1+R);if(w<=D&&w>=-D){var B=n<b?-1:1;_=this._hguideline.start;g=this._hguideline.end;_.x=m-F;g.x=m+F;_.y=g.y=b;this._drawLine(_,g,v,c);_.x=i-F;g.x=i+F;_.y=g.y=b+B*(1+R)*(a+x);this._drawLine(_,g,v,c);this._ysnap=hm.CENTER;M=true}}}if(o.neighbours.enabled){var O=this._gridResolution;var V=i/O|0,j=n/O|0;var U=this._xGrid,G=this._yGrid,X=[];var W=[].concat(G[j-1]||X,G[j]||X,G[j+1]||X);var H=[].concat(U[V-1]||X,U[V]||X,U[V+1]||X);var Y;if(W.length>1){Un(W,u);Y=this.findNeighboursToAlign(W,u,r,i,a,s,h);if(Y){this.drawNeighbourGuidelines(Y,t);T=false}}if(H.length>1&&!Y){Un(H,l);Y=this.findNeighboursToAlign(H,l,r,n,a,s,h);if(Y){this.drawNeighbourGuidelines(Y,t,true);M=false}}}if(T||M){this._snap(t,!T,!M)}};dm.prototype.findNeighboursToAlign=function e(t,r,i,n,a,o,s){var u,l,f,h=false,d,v,c;var _=Math.abs;for(var g=0,p=t.length;!h&&g<p;g++){for(var y=0;!h&&y<p;y++){if(g===y){continue}var m=t[g],b=t[y];if(y<g){d=b;b=m;m=d}var x=r[m],A=r[b];var w=o.get(m),S=o.get(b);if(x+w<n-a&&A-S>n+a&&_(_(x+w-(n-a))-_(A-S-(n+a)))<=s){u=m;l=i,f=b;c=x+w+Math.abs(A-S-(x+w))/2;v=[x+w,c-a,c+a,A-S];h=true}else if(x+w<n-a&&A+S<n-a&&_(_(x+w-(A-S))-_(Math.max(x+w,A+S)-(n-a)))<=s){u=m;l=b;f=i;c=A+w+_(_(x+w-(A-S)))+a;v=[x+w,A-S,A+S,c-a];h=true}else if(x-w>n+a&&A-S>n+a&&_(_(x+w-(A-S))-_(Math.min(x-w,A-S)-(n+a)))<=s){u=i;l=m;f=b;c=x-w-_(_(x+w-(A-S)))-a;v=[c+a,x-w,x+w,A-S];h=true}}}return h?{a:u,b:l,c:f,current:i,target:c,points:v}:null};dm.prototype.drawNeighbourGuidelines=function e(t,r,i){var n=t.a;var a=t.b;var o=t.c;var s=t.points;var u=t.target;var l=new Yi;var f=new Yi;var h=this._R,d=this._X,v=this._Y;var c=h.getMultiple([n,a,o]);var _=c[0];var g=c[1];var p=c[2];var y=this._options.neighbours;var m=y.offset;var b=y.lineWidth;var x=y.lineColor;var A,w;if(i){r.y=u;_=-_;g=-g;p=-p;A=f.x=l.x=Math.min(d[n]+_,d[a]+g,d[o]+p)-m;w=d}else{r.x=u;A=f.y=l.y=Math.max(v[n]+_,v[a]+g,v[o]+p)+m;w=v}var S=i?"y":"x";var E=i?"x":"y";l[S]=s[0];f[S]=s[1];this._drawLine(l,f,b,x);l[S]=s[2];f[S]=s[3];this._drawLine(l,f,b,x);l[S]=s[0];l[E]=A-m/2;f[S]=s[0];l[E]=w[n]+_;this._drawLine(l,f,b,x);l[S]=s[1];l[E]=A-m/2;f[S]=s[1];l[E]=w[a]+g;this._drawLine(l,f,b,x);l[S]=s[2];l[E]=A-m/2;f[S]=s[2];l[E]=w[a]+g;this._drawLine(l,f,b,x);l[S]=s[3];l[E]=A-m/2;f[S]=s[3];l[E]=w[o]+p;this._drawLine(l,f,b,x)};dm.prototype._snap=function e(t,r,i){var n=this._xsnap;var a=this._ysnap;var o;if(!r&&n!==hm.NONE){o=this._vguideline.end;if(n===hm.LEFT){t.x=o.x+this._r}else if(n===hm.RIGHT){t.x=o.x-this._r}else{t.x=o.x}}if(!i&&a!==hm.NONE){o=this._hguideline.end;if(a===hm.TOP){t.y=o.y+this._r}else if(a===hm.BOTTOM){t.y=o.y-this._r}else{t.y=o.y}}};function vm(e,t,r,i){var n=0,a=e.length-1;var o,s,u;var l=Math.abs;while(n<a){o=(n+a)/2|0;s=l(t[e[o]]-r);u=l(t[e[o+1]]-r);if(u<=s){n=o+1}else{a=o}}return i?a:e[a]}b.extend(function(e){var t=new dm(e);e.modules.snapping=t;e.tools.snapping={enable:function(e){return t.enable(e)},disable:function(){return t.disable()}}});b.extend(function(e){var t=new _m(e);e.modules.tooltip=t;e.tools.tooltip={};e.tools.tooltip.onNodeHover=function(e,r){Am(t,"hover.node",e,r)};e.tools.tooltip.onNodeClick=function(e,r){Am(t,"click.left.node",e,r)};e.tools.tooltip.onNodeRightClick=function(e,r){Am(t,"click.right.node",e,r)};e.tools.tooltip.onNodeDoubleClick=function(e,r){Am(t,"doubleClick.left.node",e,r)};e.tools.tooltip.onEdgeHover=function(e,r){Am(t,"hover.edge",e,r)};e.tools.tooltip.onEdgeClick=function(e,r){Am(t,"click.left.edge",e,r)};e.tools.tooltip.onEdgeRightClick=function(e,r){Am(t,"click.right.edge",e,r)};e.tools.tooltip.onEdgeDoubleClick=function(e,r){Am(t,"doubleClick.left.edge",e,r)};e.tools.tooltip.onBackgroundClick=function(e,r){Am(t,"click.left.background",e,r)};e.tools.tooltip.onBackgroundRightClick=function(e,r){Am(t,"click.right.background",e,r)};e.tools.tooltip.onBackgroundDoubleClick=function(e,r){Am(t,"doubleClick.left.background",e,r)};e.tools.tooltip.refresh=function(){return t.refresh()};e.tools.tooltip.isShown=function(){return t.isShown()};e.tools.tooltip.hide=function(){return t.hide()};e.events.onTooltipShown=function(t){e.modules.events.on("showTooltip",t);return e.events};e.events.onTooltipHidden=function(t){e.modules.events.on("hideTooltip",t);return e.events}});var cm=["top","bottom","left","right","cssDefined"];var _m=function e(t){var r=this;this._dom=t.modules.dom;this._interactions=t.modules.interactions;this._camera=t.modules.camera;this._events=t.modules.events;this._handlers={};this._currentHandlerName=null;this._tooltip=null;this._isHover=false;this._events.register(["showTooltip","hideTooltip"]);this._events.on({"up dragStart":function(){if(!r._isHover){Tm(r)}},unhover:function(){if(r._isHover){Tm(r)}},clear:function(){Tm(r)}});this._interactions.onHover(pm(this,"hover",true));this._interactions.onClick(pm(this,"click"));this._interactions.onDoubleClick(pm(this,"doubleClick"))};_m.prototype.hide=function e(){Tm(this,true)};_m.prototype.isShown=function e(){return!!this._tooltip};_m.prototype.refresh=function e(){ym(this)};function gm(e,t,r){if(e._timeout){clearTimeout(e._timeout)}e._timeout=setTimeout(function(){e._timeout=null;t()},r)}function pm(e,t,r){if(r===void 0)r=false;return{priority:"tooltip",check:function(i){var n=i.button;var a=i.target;var o=[];o.push(t);if(n){o.push(n)}o.push(a?a.isNode?"node":"edge":"background");var s=o.join("."),u=e._handlers[s];if(u&&u.condition(i)){e._currentHandlerName=s;return true}if(!r&&e._currentHandlerName&&!e._isHover){e._currentHandlerName=null;return!!e._tooltip}return false},handler:function t(i){var n=i.target;var a=i.x;var o=i.y;e._isHover=r;e._elt=n;e._x=a;e._y=o;ym(e)}}}function ym(e){if(!e._currentHandlerName){Tm(e);return}var t=e._handlers[e._currentHandlerName];var r=t.settings;var i=t.handler;var n=i(e._elt),a=n instanceof Promise?n:Promise.resolve(n);a.then(function(t){gm(e,function(){Em(e,t,r)},r.delay)})}var mm={top:{x:0,y:-1},bottom:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0}};var bm={position:"top",autoAdjust:true,delay:100,className:null};var xm={hover:{node:function(e){var t=e.target;return t&&t.isNode},edge:function(e){var t=e.target;return t&&!t.isNode}},click:{left:{node:function(e){var t=e.target;var r=e.button;return r==="left"&&t&&t.isNode},edge:function(e){var t=e.target;var r=e.button;return r==="left"&&t&&!t.isNode},background:function(e){var t=e.target;var r=e.button;return r==="left"&&!t}},right:{node:function(e){var t=e.target;var r=e.button;return r==="right"&&t&&t.isNode},edge:function(e){var t=e.target;var r=e.button;return r==="right"&&t&&!t.isNode},background:function(e){var t=e.target;var r=e.button;return r==="right"&&!t}}},doubleClick:{left:{node:function(e){var t=e.target;var r=e.button;return r==="left"&&t&&t.isNode},edge:function(e){var t=e.target;var r=e.button;return r==="left"&&t&&!t.isNode},background:function(e){var t=e.target;var r=e.button;return r==="left"&&!t}},right:{node:function(e){var t=e.target;var r=e.button;return r==="right"&&t&&t.isNode},edge:function(e){var t=e.target;var r=e.button;return r==="right"&&t&&!t.isNode},background:function(e){var t=e.target;var r=e.button;return r==="right"&&!t}}}};function Am(e,t,r,i){var n=ct(i,bm,"position");if(cm.indexOf(n.position)===-1){n.position="top"}e._handlers[t]={handler:r,condition:xt(xm,t),settings:n}}function wm(e){return typeof HTMLElement!=="undefined"?e instanceof HTMLElement:false}function Sm(e){return typeof document==="object"?document.createElement(e):{style:{},offsetWidth:10,offsetHeight:10}}function Em(e,t,r){Tm(e,false);var i=e._x,n=e._y,a=e._elt,o=e._dom.getDimensions();var s=r.className;var u=r.autoAdjust;var l=r.position,f=0,h=0;if(typeof t==="string"){e._tooltip=Sm("div");e._tooltip.innerHTML=t}else if(wm(t)){e._tooltip=t}else{throw new Error("invalid tooltip "+t+", expected HTML string or HTML element")}e._tooltip.__isOgmaTooltip=true;if(s){e._tooltip.className+=e._tooltip.className?" "+s:s}if(l!=="cssDefined"){e._tooltip.style.position="absolute"}e._dom.setLayer("tooltip",e._tooltip);if(a&&a.isNode){var d=e._camera.graphToScreenCoordinates(a.getPosition()),v=a.getAttribute("radius")*e._camera.getZoom()+a.getAttribute("innerStroke.width")+a.getAttribute("outerStroke.width")+1;i=d.x;n=d.y;f=v;h=v}var c=e._tooltip.offsetWidth,_=e._tooltip.offsetHeight,g=c/2,p=_/2;f+=g;h+=p;if(l!=="cssDefined"){var y=mm[l],m=y.x,b=y.y;if(u){var x=i+f*y.x,A=n+h*y.y;if(x-g<0||x+g>=o.width){if(l==="left"||l==="right"){m*=-1}else{if(x-g<0){m=(g-x+1)/f}else{m=(o.width-(x+g)-1)/f}}}if(A-p<0||A+p>=o.height){if(l==="top"||l==="bottom"){b*=-1}else{if(A-p<0){b=(p-A+1)/h}else{b=(o.height-(A+p)-1)/h}}}}e._tooltip.style.left=i+f*m-g+"px";e._tooltip.style.top=n+h*b-p+"px"}e._events.fire("showTooltip",{tooltip:e._tooltip})}function Tm(e,t){if(e._timeout){clearTimeout(e._timeout);e._timeout=null}if(t){e._currentHandlerName=null}if(e._tooltip){var r=e._tooltip;e._dom.setLayer("tooltip",null);e._tooltip=null;e._events.fire("hideTooltip",{tooltip:r})}}b.extend(function(e){e.debug={wait:function e(t){return new Promise(function(e){return setTimeout(e,t)})},initRandomGraph:function t(r){return e.generate.random(r).then(function(t){e.setGraph(t);e.view.locateGraph()})},initLine:function t(r){e.setGraph({nodes:[{id:0,attributes:{x:0,y:0}},{id:1,attributes:r?{x:0,y:50}:{x:50,y:0}}],edges:[{id:0,source:1,target:0}]});return e.view.locateGraph()},initSingleNode:function t(){e.setGraph({nodes:[{id:0,attributes:{x:0,y:0}}]});return e.view.locateGraph()},initContinuousRenderLoop:function t(r){if(r===void 0)r={};var i=r.triggerKey;if(i===void 0)i="r";var n=r.start;if(n===void 0)n=true;var a=n;document.addEventListener("keydown",function(e){var t=e.key;if(t===i){a=!a;o()}});var o=function(){if(a){e.modules.dom.beforeNextFrame().then(o)}};o()},appendToBody:function t(){var r=document.createElement("div");r.style.position="absolute";r.style.top="0";r.style.left="0";r.style.bottom="0";r.style.right="0";document.body.appendChild(r);e.setContainer(r)}}});function Mm(e,t){var r=t.styles;var i=t.nodes;var n=t.edges;var a=t.filter;var o={nodes:km(true,e,r,i,a),edges:km(false,e,r,n,a)};return o}var Cm={get:function(){return undefined}};function km(e,t,r,i,n){var a=t.modules.graph,o=a._filter(e,a._getIndexes(e,i),n);var s=a.getAttributes(e,["source","target","data","x","y","text.content","color","shape",e?"radius":"width"]).map(function(e){return e||Cm});var u=s[0];var l=s[1];var f=s[2];var h=s[3];var d=s[4];var v=s[5];var c=s[6];var _=s[7];var g=s[8];var p=new Array(o.length);if(r==="none"){v=Cm;c=Cm;_=Cm;g=Cm}else if(r==="original"){var y=t.modules.graphics._elts.fetch(e)._originalStyles;v=y["text.content"]||Cm;c=y.color||Cm;_=y.shape||Cm;g=y.size||Cm}for(var m=0;m<o.length;++m){var b=o[m],x={id:a._getId(e,b),data:f.get(b),x:h.get(b),y:d.get(b),color:c.get(b),size:g.get(b),shape:_.get(b),text:v.get(b)};if(!e){x.source=a._getId(true,u.get(b));x.target=a._getId(true,l.get(b))}if(Array.isArray(x.color)){x.color=x.color[0]}p[m]=x}return p}function Nm(e,t){for(var r=0;r<t.length;++r){if(e===undefined||e===null){return undefined}e=e[t[r]]}return e}function Im(e,t,value){for(var r=0;r<t.length-1;++r){var i=t[r],n=e[i];if(n===undefined){n={};e[i]=n}e=n}e[t[t.length-1]]=value}function zm(e,t,r){var i=new un,n=t?1:3,a=[];var o=function(o){var s=e[o],u=new Array(n),l=s.data;if(r){var f={};r.forEach(function(e){var t=Se(e),value=Nm(l,t);Im(f,t,value)});l=f}var h=sn(l);u[0]=s.id;if(!t){u[1]=s.source;u[2]=s.target}for(var d=0;d<h.length;++d){var v=h[d];var c=v.path;var value=v.value;if(c.length){if(i.has(c)){u[i.get(c)]=value}else{i.set(c,n);u[n]=value;n++}}}a.push(u)};for(var s=0;s<e.length;++s)o(s);var u=[];u.push("id");if(!t){u.push("source");u.push("target")}i.keys().forEach(function(e){return u.push(e[e.length-1])});a.unshift(u);a.forEach(function(e){return e.length=n});return a}var Lm={what:undefined,dataProperties:undefined,separator:",",textSeparator:'"',download:true,filename:"graph.csv",filter:"visible",nodes:undefined,edges:undefined};b.extend(function(e){e.export.csv=function(t){var r=ct(t,Lm,"what");var i=r.what;var n=r.dataProperties;var a=r.nodes;var o=r.edges;var s=r.separator;var u=r.textSeparator;var l=r.download;var f=r.filename;var h=r.filter;var d=Mm(e,{styles:"none",nodes:a,edges:o,filter:h}),v=Rm(d,{what:i,separator:s,textSeparator:u,dataProperties:n});if(l){Ir(v,f,"text")}return Promise.resolve(v)}});function Rm(e,t){var r=t.what;var i=t.separator;var n=t.textSeparator;var a=t.dataProperties;var o=new RegExp(""+n,"g");function s(e){e=Dm(e);e=n+e.replace(o,"\\$&")+n;return e}if(n&&n!=='"'&&n!=="'"){throw new TypeError('Invalid argument :"textSeparator" is not single-quote or double-quote, was '+n)}if(r!=="nodes"&&r!=="edges"){throw new TypeError('missing argument: "what": should have value "nodes" or "edges"')}var u=r==="nodes",l=u?e.nodes:e.edges,f=zm(l,u,a).map(function(e){return e.map(function(value){return s(value)})});return f.map(function(e){return e.join(i)}).join("\n")}function Dm(e){if(e instanceof Date){return e.toISOString()}else{return""+e}}var Fm={creator:undefined,description:undefined,styles:"all",download:true,filename:"graph.gexf",nodes:undefined,edges:undefined,filter:"visible"};b.extend(function(e){e.export.gexf=function(t){if(t===void 0)t={};var r=ct(t,Fm);var i=r.styles;var n=r.nodes;var a=r.edges;var o=r.download;var s=r.filename;var u=r.creator;var l=r.description;var f=r.filter;var h=Mm(e,{styles:i,nodes:n,edges:a,filter:f});var d=Pm(h,{creator:u,description:l});if(o){Ir(d,s,"text")}return Promise.resolve(d)}});function Pm(e,t){var r=new U;var i=function(e){return r.parseColor(e)};var n=qn();var a;var o={};var s=0;var u={};var l=0;var f;var h;var d;var v;var c;var _;var g;var p;var y;var m;var b;var x;var A;var w;var S;var E;var T;var M;S=n.createElement("gexf");S.setAttribute("xmlns","http://www.gexf.net/1.2draft");S.setAttribute("xmlns:viz","http://www.gexf.net/1.2draft/viz");S.setAttribute("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance");S.setAttribute("xsi:schemaLocation","http://www.gexf.net/1.2draft http://www.gexf.net/1.2draft/gexf.xsd");S.setAttribute("version","1.2");x=n.createElement("meta");x.setAttribute("lastmodifieddate",ue());if(t.creator){g=n.createElement("creator");M=n.createTextNode(""+t.creator);g.appendChild(M);x.appendChild(g)}if(t.description){p=n.createElement("description");M=n.createTextNode(""+t.description);p.appendChild(M);x.appendChild(p)}b=n.createElement("graph");b.setAttribute("mode","static");A=n.createElement("nodes");e.nodes.forEach(function(e){w=n.createElement("node");w.setAttribute("id",e.id);if(e.text){w.setAttribute("label",e.text)}if(Om(e.data)){a=Vm(e.data);h=n.createElement("attvalues");Object.keys(a).forEach(function(e){if(!(e in o)){o[e]={id:s,type:"integer"};s++}var t=a[e];o[e].type=Bm(t,o[e].type);d=n.createElement("attvalue");d.setAttribute("for",o[e].id);d.setAttribute("value",t);h.appendChild(d)});w.appendChild(h)}if(e.color){var t=i(e.color);_=n.createElement("viz:color");_.setAttribute("r",t[0]);_.setAttribute("g",t[1]);_.setAttribute("b",t[2]);_.setAttribute("a",t[3]);w.appendChild(_)}E=n.createElement("viz:position");E.setAttribute("x",e.x);E.setAttribute("y",-parseInt(e.y,10));w.appendChild(E);if(e.size){T=n.createElement("viz:size");T.setAttribute("value",e.size);w.appendChild(T)}A.appendChild(w)});v=n.createElement("attributes");v.setAttribute("class","node");Object.keys(o).forEach(function(e){f=n.createElement("attribute");f.setAttribute("id",o[e].id);f.setAttribute("title",e);f.setAttribute("type",o[e].type);v.appendChild(f)});y=n.createElement("edges");e.edges.forEach(function(e){m=n.createElement("edge");m.setAttribute("id",e.id);m.setAttribute("source",e.source);m.setAttribute("target",e.target);if(e.size){m.setAttribute("weight",e.size)}if(e.text){m.setAttribute("label",e.text)}if(Om(e.data)){a=Vm(e.data);h=n.createElement("attvalues");Object.keys(a).forEach(function(e){if(!(e in u)){u[e]={id:l,type:"integer"};l++}var t=a[e];u[e].type=Bm(t,u[e].type);d=n.createElement("attvalue");d.setAttribute("for",u[e].id);d.setAttribute("value",t);h.appendChild(d)});m.appendChild(h)}if(e.color){var t=i(e.color);_=n.createElement("viz:color");_.setAttribute("r",t[0]);_.setAttribute("g",t[1]);_.setAttribute("b",t[2]);m.appendChild(_)}if(e.size){T=n.createElement("viz:size");T.setAttribute("value",e.size);m.appendChild(T)}y.appendChild(m)});c=n.createElement("attributes");c.setAttribute("class","edge");Object.keys(u).forEach(function(e){f=n.createElement("attribute");f.setAttribute("id",u[e].id);f.setAttribute("title",e);f.setAttribute("type",u[e].type);c.appendChild(f)});b.appendChild(v);b.appendChild(c);b.appendChild(A);b.appendChild(y);S.appendChild(x);S.appendChild(b);n.appendChild(S);return'<?xml version="1.0" encoding="UTF-8"?>'+n.serialize()}function Bm(e,t){if(t==="integer"&&typeof e==="number"){if(e%1!==0){t="float"}}else if(typeof e!=="number"){t="string";if(typeof e==="boolean"){t="boolean"}}return t}function Om(value){return typeof value==="object"&&value!==null&&value.constructor===Object}function Vm(e,t){if(t===void 0)t={};wt(e,function(value,e){if(Om(value)){Vm(value,t)}else{t[e]=value}});return t}var jm={graphId:"G",directedEdges:true,styles:"all",download:true,filename:"graph.graphml",nodes:undefined,edges:undefined,filter:"visible"};b.extend(function(e){e.export.graphml=function(t){if(t===void 0)t={};var r=ct(t,jm);var i=r.styles;var n=r.nodes;var a=r.edges;var o=r.download;var s=r.filename;var u=r.graphId;var l=r.directedEdges;var f=r.filter;var h=Mm(e,{styles:i,nodes:n,edges:a,filter:f}),d=Um(h,{graphId:u,directedEdges:l});if(o){Ir(d,s,"text")}return Promise.resolve(d)}});function Um(e,t){var r=new U;var i=wr();function n(e){return r.parseColor(e)}function a(e){return r.toHexa(e)}function o(e,t){var r=n(t);e.r=r[0];e.g=r[1];e.b=r[2]}function s(e,t,r,n,a){r=r||{};var o=i.createElement(t);for(var s in r){if(!r.hasOwnProperty(s)){continue}var value=r[s];if(value!==undefined){o.setAttribute(s,value)}}if(n!==undefined||a){if(Object.prototype.toString.call(n)==="[object Object]"){n=JSON.stringify(n)}var u=i.createTextNode(n);o.appendChild(u)}e.appendChild(o);return o}var u=["id","source","target"];var l=["size","x","y","shape","color","text"];var f={size:{for:"all",type:"double"},x:{for:"node",type:"double"},y:{for:"node",type:"double"},shape:{for:"all",type:"string"},color:{for:"all",type:"string"},r:{for:"all",type:"int"},g:{for:"all",type:"int"},b:{for:"all",type:"int"},a:{for:"all",type:"double"},text:{for:"all",type:"string"}},h=[],d=[];function v(e,t){var r={id:e.id};l.forEach(function(i){var value=e[i];if(i==="y"&&value){value=-parseFloat(value)}if(value!==undefined){r[(t==="edge"?"edge_":"")+i]=value;if(i==="color"){o(r,value)}}});var i=e.data||{};wt(i,function(value,e){if(l.indexOf(e)!==-1||u.indexOf(e)!==-1){return}if(!f[e]){f[e]={for:t,type:"string"}}else if(f[e].for!==t){f[e].for="all"}r[e]=value});if(t==="edge"){r.source=e.source;r.target=e.target;d.push(r)}else{h.push(r)}}e.nodes.forEach(function(e){v(e,"node")});e.edges.forEach(function(e){v(e,"edge")});var c=s(i,"graphml",{xmlns:"http://graphml.graphdrawing.org/xmlns","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation":"http://graphml.graphdrawing.org/xmlns "+"http://www.yworks.com/xml/schema/graphml/1.1/ygraphml.xsd","xmlns:y":"http://www.yworks.com/xml/graphml","xmlns:java":"http://www.yworks.com/xml/yfiles-common/1.0/java","xmlns:sys":"http://www.yworks.com/xml/yfiles-common/markup/primitives/2.0","xmlns:x":"http://ww.yworks.com/xml/yfiles-common/markup/2.0"});wt(f,function(value,e){if(value.for==="node"||value.for==="all"){s(c,"key",{"attr.name":e,"attr.type":value.type,for:"node",id:e})}if(value.for==="edge"||value.for==="all"){s(c,"key",{"attr.name":e,"attr.type":value.type,for:"edge",id:"edge_"+e})}});s(c,"key",{id:"nodegraphics",for:"node","yfiles.type":"nodegraphics","attr.type":"string"});s(c,"key",{id:"edgegraphics",for:"edge","yfiles.type":"edgegraphics","attr.type":"string"});var _=s(c,"graph",{edgedefault:t.directedEdges||t.directedEdges===undefined?"directed":"undirected",id:t.graphId?t.graphId:"G","parse.nodes":e.nodes.length,"parse.edges":e.edges.length,"parse.order":"nodesfirst"});function g(e,t){var r=s(e,"data",{key:"nodegraphics"});var i=s(r,"y:ShapeNode");s(i,"y:Geometry",{x:t.x,y:t.y,width:t.size,height:t.size});s(i,"y:Fill",{color:a(t.color),transparent:false});s(i,"y:NodeLabel",null,t.text||"");s(i,"y:Shape",{type:t.shape})}function p(e,t){var r=s(e,"data",{key:"edgegraphics"});var i=s(r,"y:PolyLineEdge");s(i,"y:LineStyle",{type:t.edge_type,color:a(t.edge_color),width:t.edge_size});s(i,"y:EdgeLabel",null,t.edge_label)}h.forEach(function(e){var t=s(_,"node",{id:e.id});g(t,e);wt(e,function(value,e){if(u.indexOf(e)!==-1){return}s(t,"data",{key:e},value,true)})});d.forEach(function(e){var t=s(_,"edge",{id:e.id,source:e.source,target:e.target});p(t,e);wt(e,function(value,e){if(u.indexOf(e)!==-1){return}s(t,"data",{key:e},value,true)})});var y=Sr(i);return'<?xml version="1.0" encoding="UTF-8"?>\n'+y}var Gm={nodeAttributes:["x","y","color","radius","shape","text"],edgeAttributes:["color","width","text"],nodeData:function(e){return e},edgeData:function(e){return e},filter:"visible",pretty:false,download:true,filename:"graph.json"};b.extend(function(e){e.export.json=function(t){if(t===void 0)t={};var r=ct(t,Gm);var i=r.nodeAttributes;var n=r.edgeAttributes;var a=r.nodeData;var o=r.edgeData;var s=r.filter;var u=r.pretty;var l=r.download;var f=r.filename;var h={nodes:e.getNodes(typeof s==="object"?s.nodes:s).toJSON({attributes:i,data:a}),edges:e.getEdges(typeof s==="object"?s.edges:s).toJSON({attributes:n,data:o})};var d=u?JSON.stringify(h,null," "):JSON.stringify(h);if(l){Ir(d,f,"text")}return Promise.resolve(d)}});var Xm=10;function Wm(e,t){var r=e.view.get(),i=typeof t.margin==="number"?t.margin:Xm,n={pixelRatio:1,backgroundColor:r.backgroundColor};if(t.clip){n.zoom=r.zoom;n.width=r.width;n.height=r.height;n.x=r.x;n.y=r.y}else{if(t.width&&t.height){n.width=t.width;n.height=t.height}else{n.width=r.width;n.height=r.height}var a=e.getNodes(t.filter).getBoundingBox();n.x=a.cx;n.y=a.cy;n.zoom=Math.min(n.width/(a.width+i),n.height/(a.height+i))}if(e.modules.geo.isEnabled()){n.backgroundColor=null}else if(t.background!==undefined){n.backgroundColor=t.background}return n}function Hm(e,t,r,i,n){if(n===void 0)n=false;r.hideImages=n;r.isBufferDisplayable=function(e){return t.texts||!Ch(e)};return e.modules.graphics.export(i,r,t.filter,t)}b.extend(function(e){e.export.png=function(t){return eb(e,t,"png")};e.export.jpg=function(t){return eb(e,t,"jpg")};e.export.tiff=function(t){return eb(e,t,"tiff")};e.export.gif=function(t){return eb(e,t,"gif")}});function Ym(e){return{download:true,filter:"visible",filename:"graph."+e,clip:false,margin:10,width:undefined,height:undefined,background:null,legend:true,texts:true,map:true,textWatermark:{content:null,fontFamily:"Arial",fontSize:48,fontStyle:null,fontColor:"red",repeat:false,angle:0,alpha:.65,space:50,x:undefined,y:undefined},imageWatermark:{url:null,width:undefined,height:undefined,repeat:false,angle:0,alpha:.65,space:50,x:undefined,y:undefined},imageCrossOrigin:undefined}}var qm={png:Ym("png"),jpg:Ym("jpg"),tiff:Ym("tiff"),gif:Ym("gif")};function Zm(e){var t=e.canvas;var r=e.parameters;if(r.textWatermark.content){ab(t,r.textWatermark,tb,rb)}if(r.imageWatermark.url){return Br(r.imageWatermark.url).then(function(i){if(i){r.imageWatermark.content=i;ab(t,r.imageWatermark,nb,ib)}return e})}else{return e}}function $m(e){var t=e.ogma;var r=e.canvas;var i=e.parameters;if(i.legend&&t.modules.legend.enabled()){t.modules.legend.drawOnCanvas(r)}return e}function Km(e){var t=e.canvas;var r=e.ogma;var i=e.view;if(r.modules.geo.isEnabled()){return r.modules.geo.whenReady().then(function(){return r.modules.geo.exportBackground(t,i)}).then(function(){return e})}else{return e}}function Jm(e){var t=e.ogma;var r=e.parameters;var i=e.canvas;var n=e.view;var a=i.getContext("2d");return Hm(t,r,n,"canvas",false).then(function(i){try{i.getContext("2d").getImageData(0,0,1,1);a.drawImage(i,0,0);return e}catch(i){at(i);return Hm(t,r,n,"canvas",true).then(function(t){a.drawImage(t,0,0);return e})}})}function Qm(e){var t=e.canvas;var r=e.parameters;var i=e.type;var n=t.toDataURL("image/"+i);if(r.download){Ir(n,r.filename,"dataURL")}return n}function eb(e,t,r){t=ct(t,qm[r]);var i=Wm(e,t),n=Er(),a={ogma:e,parameters:t,canvas:n,view:i,type:r};n.width=i.width;n.height=i.height;return Promise.resolve(a).then(Km).then(Jm).then(Zm).then($m).then(Qm)}function tb(e,t,r,i){e.textAlign="center";e.textBaseline="middle";e.fillText(t,r,i)}function rb(e,t,r){return{width:e.measureText(t).width,height:r}}function ib(e,t,r,i,n){return{width:i===undefined?t.width:i,height:n===undefined?t.height:n}}function nb(e,t,r,i,n,a){e.drawImage(t,r-n/2,i-a/2,n,a)}function ab(e,t,r,i){if(!t){return}if(typeof t!=="object"){t={content:t}}else if(!t.content){return}var n=e.getContext("2d");var a=t.fontFamily;var o=t.fontSize;var s=t.fontStyle;var u=t.fontColor;var l=t.repeat;var f=t.angle;var h=t.alpha;var d=t.space;var v=t.content;var c=e.width,_=e.height,g=t.x===undefined?c/2:t.x,p=t.y===undefined?_/2:t.y,y=t.height,m=t.width;f=f/180*Math.PI;if(s){n.font=s+" "+o+'px "'+a+'"'}else{n.font=o+'px "'+a+'"'}n.fillStyle=u;n.globalAlpha=h;var b=i(n,v,o,m,y);if(!l){n.save();n.translate(g,p);n.rotate(f);r(n,v,0,0,b.width,b.height);n.restore()}else{var x=b.width+d,A=b.height+d,w=Math.sqrt(c*c+_*_);n.save();n.translate(0,0);n.rotate(f);for(var S=0;S<w;S+=x){for(var E=0;E<w;E+=A){r(n,v,S,E,b.width,b.height);if(E!==0){r(n,v,S,-E,b.width,b.height)}}}n.restore()}}b.extend(function(e){e.export.svg=function(t){return sb(e,t)}});var ob={download:true,filename:"graph.svg",width:undefined,height:undefined,background:null,texts:true,embedFonts:false,clip:false,margin:10};function sb(e,t){t=ct(t,ob);var r=Wm(e,t);return Hm(e,t,r,"svg").then(function(e){e.setAttribute("version","1.1");e.setAttribute("xmlns","http://www.w3.org/2000/svg");e.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");var r='<?xml version="1.0" encoding="utf-8"?>'+Sr(e);if(t.download){Ir(r,t.filename)}return r})}var ub={what:undefined,dataProperties:undefined,download:true,filename:"graph.xlsx",nodes:undefined,edges:undefined,filter:"visible"};b.extend(function(e){e.export.xlsx=function(t){var r=ct(t,ub,"what");var i=r.what;var n=r.nodes;var a=r.edges;var o=r.download;var s=r.filename;var u=r.dataProperties;var l=r.filter;var f=Mm(e,{styles:"none",nodes:n,edges:a,filter:l}),h=lb(f,{what:i,dataProperties:u});if(o){Ir(h,s,"blob")}return Promise.resolve(h)}});function lb(e,t){var r=t.what;var i=t.dataProperties;var n=ie("xlsx",{globalVarName:"XLSX"}),a=new db,o,s;if(!r){o=hb(n,zm(e.nodes,true,i));s=hb(n,zm(e.edges,false,i))}else{if(r==="nodes"){o=hb(n,zm(e.nodes,true,i))}else if(r==="edges"){s=hb(n,zm(e.edges,false,i))}else{throw new TypeError('Invalid argument: "what" is not "nodes" or "edges", was '+r)}}if(o){a.SheetNames.push("Nodes");a.Sheets.Nodes=o}if(s){a.SheetNames.push("Edges");a.Sheets.Edges=s}var u=n.write(a,{bookType:"xlsx",bookSST:false,type:"binary"});var l=kr([vb(u)]);return l}function fb(e){if(e===undefined){return""}else if(e instanceof Date){return e.toISOString()}else{return""+e}}function hb(e,t){var r={};var i={s:{c:1e7,r:1e7},e:{c:0,r:0}};for(var n=0;n!==t.length;++n){var a=t[n];for(var o=0;o!==a.length;++o){var value=a[o];if(i.s.r>n){i.s.r=n}if(i.s.c>o){i.s.c=o}if(i.e.r<n){i.e.r=n}if(i.e.c<o){i.e.c=o}var s={v:fb(value)},u=e.utils.encode_cell({c:o,r:n});r[u]=s}}if(i.s.c<1e7){r["!ref"]=e.utils.encode_range(i)}return r}function db(){if(!(this instanceof db)){return new db}this.SheetNames=[];this.Sheets={}}function vb(e){var t=new ArrayBuffer(e.length);var r=new Uint8Array(t);for(var i=0;i!==e.length;++i){r[i]=e.charCodeAt(i)&255}return t}b.default=b;b.geometry=To;b.algorithms=Jo;b.utils=Zn;return b});